.head 0 +  Application Description: SQLWindows version 5.0 starter application
.data CLASSPROPSSIZE
0000: 3D00
.enddata
.data CLASSPROPS
0000: 557365476C6F6261 6C50617468000400 0100000000417070 506174684C656E00
0020: 0400050000000041 7070506174680005 002E5C5069630000 0000000000
.enddata
.head 1 -  Outline Version - 4.0.35
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000200100 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFF000000 00000000002A0600 00B8020000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0200000000000000 0000D61FD7120500 1D00FFFF4D61696E
0020: 0029000100040000 0000000000E91E80 0A00008600FFFF49 6E7465726E616C20
0040: 46756E6374696F6E 7300200001000400 000000000000E91E 800A0000DF00FFFF
0060: 5661726961626C65 73001E0001000400 000000000000F51E 100D0000F400FFFF
0080: 436C617373657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.5"
.head 3 -  Top: 0.083"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? Yes
.head 3 -  Left: 10.3"
.head 3 -  Top: 1.167"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? Yes
.head 2 -  Enable Runtime Checks Of External References? No
.head 2 -  Use Release 4.0 Scope Rules? No
.head 2 -  Edit Fields Read Only On Disable? No
.head 1 +  Libraries
.head 2 -  !
.head 2 -  File Include: tools.apl
.head 2 -  File Include: sqlexecute.apl
.head 2 -  File Include: mdmain.apl
.head 2 -  File Include: combomzt.apl
.head 2 -  File Include: combolookup.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: hh:mm AMPM
.head 3 -  Date/Time: hhhh:mm
.head 3 -  Date/Time: hhh:mm
.head 3 -  Number: ###0
.head 3 -  Number: ###00
.head 3 -  Number: ###0000
.head 3 -  Number: #00
.head 3 -  Number: ###00
.head 3 -  Number: ###000
.head 3 -  Number: ###0000
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000
.head 3 -  Number: ###000
.head 3 -  Number: ###0000
.head 3 -  Number: ###000
.head 3 -  Number: ###0000
.head 3 -  Number: ###0000
.head 3 -  Number: ###0000
.head 3 -  Date/Time: dd.MM.yyyy hhhh:mm
.head 3 -  Number: ###000
.head 3 -  Number: ##0
.head 3 -  Number: ###00
.head 3 -  Number: ###000
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000
.head 3 -  Date/Time: S
.head 3 -  Number: ###000
.head 3 -  Number: ###0000
.head 3 -  Number: ###0000
.head 3 -  Number: ###0000
.head 3 -  Number: ###000;'($'###000')'
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 3 +  Enumerations
.head 2 +  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 1721881133
0000: EA080000C9050000 0000000000000000 020000490000003E 0600001019000000
0020: 016005F047000000 0073000000010000 00A3570600192500 01604800BC000073
0040: D100010000687006 0019000104600568 0300006E00730036 010089065A001900
0060: 01A260690300001B 730001008D00A206 00861900020160E8 CA0300001F800200
0080: FC00003F0600A100 A606001925000160 CB03BA000073C100 0100000008BF0600
00A0: 0400000001026005 3F0500006E007300 360100C3065A0004 0002A36D0500009B
00C0: 7300018D00C70600 9619000160E03309 0000004673000100 00A3E00600043500
00E0: 023409BA000073D9 00010068E4060004 008D023509006E00 7300360100E8065A
0100: 00040002A3360900 009B7300018D00EC 0600D6040002E837 0900006673000100
0120: 23F006009E000400 00076005100A8001 006E1E000073C900 01000068F406009E
0140: 008D07260A016E6E 730032010000F806 5A009E0007A33A0A 016E9B7300018C00
0160: 00FC060016190001 6005E0BE0A000000 4673000100008315 0700001925000160
0180: FA0BB800000073D1 00010000682E0700 1900890160FB0B00 6E00730034010000
01A0: 47071A0004000202 A260FC0B00007F80 F60200FF82010000 4B07009619000160
01C0: E0170C0000004673 00010000A3640700 1925000160180CBA 000073D100010000
01E0: 687D070004008E02 190C00FE00D98002 00FF0B0100008107 1A00040001028260
0200: 3A100000007F80F0 010000008F850700 E6040001E83B1000 009F8001FC0000A3
0220: 8907001925000460 5116B800000073D1 0001000068A20700 1900890160521600
0240: 6E00730034010000 BB075A00190001A2 60531600001B7300 01008D00D4070094
0260: 0400000260E85416 00006673000100A3 D807001921000104 605516FA00002780
0280: 010000FF68DC0700 1900090160971700 006E007300340100 00F5075A00190001
02A0: A260981700001B73 0001000D000E0800 009619000160E899 1700004673000100
02C0: 00A3270800192500 01608518B8000000 73D1000100006840 0800190089016086
02E0: 18006E0073003401 000059085A001900 01A260871800001B 730001008D007208
0300: 009619000160E8B8 1800004673000100 00A38B0800192500 0160B918BA000073
0320: D10001000068A408 001900890160BA18 006E007300340100 00BD085A00190001
0340: A260FD1800001B73 0001008D00D60800 9619000160E8FE18 0000467300010000
0360: A3EF080019250001 60FF18BA000073D1 0001000068080900 1900890160391900
0380: 6E00730034010000 21095A00190001A2 603A1900001B7300 01008D003A090096
03A0: 19000160E83B1900 00467300010000A3 5309001925000160 6319BA000073D100
03C0: 010000686C090019 008901606419006E 0073003401000085 095A001900018260
03E0: 9E1A0000001B7300 01008D009E090096 19000160E8B01A00 00467300010000A3
0400: B709000431000102 E01AFA0000278001 0000FF68BB090019 00890160E11A006E
0420: 00730034010000D4 095A00190001A260 E21A00001B730001 008D00ED09009619
0440: 000160E0991B0000 00467300010000A3 060A001925000160 9A1BBA000073D100
0460: 010000681F0A0019 008901609B1B006E 0073003401000038 0A5A001900018260
0480: 111C0000001B7300 01008D00510A0096 19000160E8121C00 00467300010000A3
04A0: 6A0A001925000160 131CBA000073D100 01000068830A0019 008901605A1C006E
04C0: 007300340100009C 0A5A00190001A260 5B1C00001B730001 008D00B50A009619
04E0: 000160E85C1C0000 467300010000A3CE 0A001925000160AA 1CBA000073D10001
0500: 000068E70A000400 81036005AB1C006E 007300360100EB0A 5A00190001A260AD
0520: 1C00001B73000100 8D00040B00961900 0160E8AE1C000046 7300010000A31D0B
0540: 001925000160AF1C BA000073D1000100 0068360B00190089 0160F31C006E0073
0560: 00340100004F0B5A 00190001A260F41C 00001B730001008D 00680B0096190001
0580: 60E0F01D00000046 7300010000A3810B 0019A10001016062 F800000027800100
05A0: 00FF68850B001900 8901606320006E00 7300340100009E0B 520004000002D30A
05C0: 00009B7300018D00 A20B009619000160 F408000046730001 000003
.enddata
.head 3 -  Window Handle: hWndArtikel
.head 2 +  Internal Functions
.head 2 +  Named Menus
.head 3 +  ! Menu: Rezeptur
.head 4 -  Title: Rezeptur
.head 4 -  Description: 
.head 4 -  Enabled when: ( bInhalt OR bRezeptur) AND 
( nUserLevel  > 3 OR Benutzer.HatRecht( REC_REZEPTUR ) ) 
.head 4 -  Status Text: Basisstammdaten
.head 4 -  Menu Item Name: 
.head 4 +  ! Menu Item: Artikel
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 +  If hWndArtikel
.head 7 -  Call SalBringWindowToTop( hWndArtikel )
.head 6 +  Else 
.head 7 -  Set hWndArtikel = SalCreateWindow( frmREZ_Artikel, hWndMDI )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: Mengeneinheiten
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgBD_ART_Mengeneinheiten, hWndMDI )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: Artikelpreis
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgART_Preis, hWndMDI )
.head 5 -  Menu Item Name: 
.head 4 -  Menu Separator 
.head 4 +  Menu Item: Artikel Typ
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgART_Typ, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: ArtikelGruppe
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgART_Gruppe, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 -  Menu Separator 
.head 4 +  Menu Item: LagerOrt
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgART_LagerOrt, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: LagerPosition
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgART_LagerPos, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 -  Menu Separator 
.head 4 +  Menu Item: Kostform Sollwerte
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: bInhalt
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgKF_Inhalte, hWndMDI )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: InhaltOrder in Rezept
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: bInhalt
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgREZ_IN_Sort, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 -  Menu Separator 
.head 4 +  Menu Item: InhaltsGruppen
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: bInhalt
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgBLS_Gruppe, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: InhaltsDefinition
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: bInhalt
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgBLS_Inhalt, hWndForm )
.head 5 -  Menu Item Name: 
.head 4 +  Menu Item: InhaltsAngaben
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: bInhalt 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 +  If hWndBLSDat
.head 7 -  Call SalBringWindowToTop( hWndBLSDat )
.head 6 +  Else 
.head 7 -  Set hWndBLSDat = SalCreateWindow( tblBLSDAT, hWndMDI, '' )
.head 5 -  Menu Item Name: 
.head 4 -  Menu Separator 
.head 4 +  Menu Item: Einstellungen
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call SalModalDialog( dlgART_Einstellungen, hWndForm )
.head 5 -  Menu Item Name: 
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 4285972097
0000: 4B0600002E040000 0000000000000000 0200001200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F19003C00 0009660063546F6F
0040: 6C54697000220000 00010000004F1900 0001016005070000 0003F00873000000
0060: 3401000001804032 000000010000000A 5461626C65436C07 4000000002780000
0080: 00194B000160EC74 01000073A2000001 0000CD1900191200 0160ED0100DD0073
00A0: 680001000001C880 1900000200000846 6F726D4D6110696E 2200000100BD0019
00C0: 250001600D000C00 0098097300D10001 0000000180040000 0003000000000F44
00E0: 617461460069656C 6455706461107465 22000001003D0004 0005000260050600
0100: 0C0000C40A7300D9 0001009801800400 04A10012446161FF 81655077642200E8
0120: 00010000AD040002 6D0700D0CC0A7300 01C6000180040000 05000000164461FD
0140: 610F654E6F74404E 756C6C220000F401 0000D60400023606 00120B6473000001
0160: 0003018021000000 0406000018436F6D 00626F5769746844 617D614B00756563
0180: 68656E0000EC0003 000D1900010160EF 003F8001F8000000 3704000443000102
01A0: 6007FB004F800100 FE00C10800000019 920001600800C600 960B736800010000
01C0: 018C8021000700F0 001B436FFFFF834F 776E6E00EC000300 8D19000101ED0600
01E0: 3F8001F900003704 00046300010207FB 004F800100FE00CD 080019D200016008
0200: C600BA0B73680001 000001CC80210008 F0001A436FFF1F6F 73744C466F6E0000
0220: F60300C619000101 F606009F8001FC00 009B040004B10001 0207FD0027800100
0240: 00FF660800190069 0160080063CC0B73 0034010000018006 040009000000380B
0260: 436F557067652200 F4010000D6040002 360600FC0B667300 0100630180040080
0280: 0A00000012436FFF FE4EA300010000B7 0400BE020021080C 730000011B000180
02A0: 0403000B0000000F 804D756C74696C69 7865557022A30001 0000B70400BE0200
02C0: 31140C7300011B00 01801903000C0000 000900496E736572 74426F8878220000
02E0: 0100DE0019D20001 60088600E80D7300 6800010000018080 7D0000000D000000
0300: 0D63526164696F60 4C697374429AB000 00000500B71900B4 01600600219E1B73
0320: 000001DA0000192C 00190001606D0700 9E8F000100260032 0000194B00016008
0340: DB009EA300010000 C14B000000199200 01600900F6009E68 0001000064B00000
0360: 001900A401600A00 003D9E00011A0000 01803203000E0000 000E006348657574
0380: 65576F00726B666C 6F774000D1000200 005B190001D2600C 00001B730001006D
03A0: 0019009619000160 F028000000467300 0100006301801900 000F00000007436A
03C0: 434E6C220000F401 00009619000160E8 1201000046730001 0000630180320000
03E0: 1000000009634F62 106A526563744000 D90002005B190001 DA60060010962673
0400: 000001006D001900 9619000160B60700 9647000100006301 8004008011000000
0420: 08634FC146696C65 22E8000100002D04 00026069050000BA C835730000010600
.enddata
.head 3 +  Data Field Class: ArtikelInhalte
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:
.head 6 -  Top:
.head 6 -  Width:  0.825"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Center
.head 5 -  Format: #0
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: fRezepturVariables
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: sItemName
.head 5 -  Number: nField
.head 5 -  String: m_sBI_KURZBEZ_ME
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Functions
.head 4 +  Message Actions
.head 5 +  On AM_FETCH ! th 20170110 BLS-Schlüsselwerte ausschließen
.head 6 +  If bInhalt 
.head 7 +  If frmREZ_Artikel.dfAR_SBLS
.head 8 -  Call SalGetItemName( hWndItem, sItemName)
.head 8 -  Set nField = SalStrToNumber( SalStrRightX( sItemName, 3 ) ) -1
.head 8 -  Call Sql_ExecAndCommit( hSql, 'SELECT ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1) 
FROM rezorder, blsinhalt JOIN blsgruppe ON bi_bg_nr = bg_nr
INTO :sGlobalTemp, :m_sBI_KURZBEZ_ME, :fRezVar.nBI_FAKTOR
WHERE ro_inhalt = bi_inhalt AND bg_nr != 0
order by ro_order' )
.head 8 +  If SqlFetchRow( hSql, nField, nFetch )
.head 9 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sGlobalTemp || ' FROM blsdat
INTO :nGlobalTemp
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS' )
.head 9 -  Call SalSetWindowLabelText( hWndItem, m_sBI_KURZBEZ_ME )
.head 9 -  Call SalSetWindowText( hWndItem, SalNumberToStrX( nGlobalTemp / fRezVar.nBI_FAKTOR, 0 ) )
.head 8 +  Else
.head 9 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 9 -  Call SalSetWindowText( hWndItem, '' )
.head 7 +  Else
.head 8 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 8 -  Call SalSetWindowText( hWndItem, '' )
.head 5 +  ! On AM_FETCH ! ga 20110921: doch ohne Druckprofile in Rezorder
.head 6 +  If bInhalt 
.head 7 +  If frmREZ_Artikel.dfAR_SBLS
.head 8 -  Call SalGetItemName( hWndItem, sItemName)
.head 8 -  Set nField = SalStrToNumber( SalStrRightX( sItemName, 3 ) ) -1
.head 8 -  Call Sql_ExecAndCommit( hSql, 'SELECT ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1) 
FROM rezorder, blsinhalt
INTO :sGlobalTemp, :m_sBI_KURZBEZ_ME, :fRezVar.nBI_FAKTOR
WHERE ro_inhalt = bi_inhalt
order by ro_order' )
.head 8 +  If SqlFetchRow( hSql, nField, nFetch )
.head 9 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sGlobalTemp || ' FROM blsdat
INTO :nGlobalTemp
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS' )
.head 9 -  Call SalSetWindowLabelText( hWndItem, m_sBI_KURZBEZ_ME )
.head 9 -  Call SalSetWindowText( hWndItem, SalNumberToStrX( nGlobalTemp / fRezVar.nBI_FAKTOR, 0 ) )
.head 8 +  Else 
.head 9 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 9 -  Call SalSetWindowText( hWndItem, '' )
.head 7 +  Else 
.head 8 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 8 -  Call SalSetWindowText( hWndItem, '' )
.head 5 +  ! On AM_FETCH
.head 6 +  If bInhalt 
.head 7 +  If frmREZ_Artikel.dfAR_SBLS
.head 8 -  Call SalGetItemName( hWndItem, sItemName)
.head 8 -  Set nField = SalStrToNumber( SalStrRightX( sItemName, 3 ) ) -1
.head 8 -  Call Sql_ExecAndCommit( hSql, 'SELECT ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1) 
FROM rezorder, blsinhalt
INTO :sGlobalTemp, :m_sBI_KURZBEZ_ME, :fRezVar.nBI_FAKTOR
WHERE ro_inhalt = bi_inhalt 
order by ro_order' )
.head 8 +  If SqlFetchRow( hSql, nField, nFetch )
.head 9 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sGlobalTemp || ' FROM blsdat
INTO :nGlobalTemp
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS' )
.head 9 -  Call SalSetWindowLabelText( hWndItem, m_sBI_KURZBEZ_ME )
.head 9 -  Call SalSetWindowText( hWndItem, SalNumberToStrX( nGlobalTemp / fRezVar.nBI_FAKTOR, 0 ) )
.head 8 +  Else 
.head 9 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 9 -  Call SalSetWindowText( hWndItem, '' )
.head 7 +  Else 
.head 8 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 8 -  Call SalSetWindowText( hWndItem, '' )
.head 5 +  ! On AM_FETCH
.head 6 +  If bInhalt AND frmREZ_Artikel.d1AR_NR
.head 7 -  Call SalGetItemName( hWndItem, sItemName)
.head 7 -  Set nField = SalStrToNumber( SalStrRightX( sItemName, 3 ) ) -1
.head 7 -  Call Sql_ExecAndCommit( hSql, 'SELECT ri_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), ri_menge, @IF(bi_faktor,bi_faktor,1)  FROM rezinhalt, rezorder, blsinhalt
INTO :sGlobalTemp, :sDummy, :nGlobalTemp, :fRezVar.nBI_FAKTOR
WHERE ri_inhalt = ro_inhalt AND ri_inhalt = bi_inhalt AND ri_re_nr = :frmSD_Rezept.dfRE_NR order by ro_order' )
.head 7 +  If SqlFetchRow( hSql, nField, nFetch )
.head 8 -  Call SalSetWindowLabelText( hWndItem, sDummy )
.head 8 -  Call SalSetWindowText( hWndItem, SalNumberToStrX( nGlobalTemp / fRezVar.nBI_FAKTOR, 0 ) )
.head 7 +  Else 
.head 8 -  Call SalSetWindowLabelText( hWndItem, '' )
.head 8 -  Call SalSetWindowText( hWndItem, '' )
.head 5 +  On AM_NEW
.head 6 -  Call SalClearField( hWndItem )
.head 3 +  Functional Class: cObjParamArtikel
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cObjParamData
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: m_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nAR_AT_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nAR_AG_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bUnchecked
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bOhneBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bInRezeptur
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bNichtInRezeptur
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_GESP
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_MILCH
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_GEPRUEFT
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_PARAMETER1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bLieferant
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Boolean: m_bTaxFehlt
.head 5 -  Number: m_nTU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nTH_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  ! th 20160202
.head 5 -  Boolean: m_bLaDatenUpdate
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  ! th 20160603
.head 5 -  Boolean: m_bLaZuordnungVorhanden
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bKeineLaZuordnungVorhanden
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: m_nAR_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: m_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: m_saFilterStringEx[*]
.head 4 +  Functions
.head 5 +  Function: GetWhere ! th 20160802  korrektur für SQLBase weil join auf artikellieferart in tblArtikel raus( mehrfachAnzeige); KeineZuordnung vorhanden
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If m_bLaDatenUpdate
.head 8 -  ! Datenabgleich möglich, wenn Artikel
.head 8 -  ! 1) Zuordnung hat, aber
.head 8 -  ! --- wurde noch nie abgeglichen
.head 8 -  ! --- letzter Abgleich älter als letzte Änderung der Zuordnung oder eines zug. LAs	
.head 8 -  ! 2) keine Z. hat, aber Protokoll-Eintrag hat, der älter als letzte Änderung am Artikel ist
.head 8 -  ! (weil beim Löschen einer Z. der Artikel apgedatet wird)
.head 8 -  !
.head 8 -  ! Set sGlobalTemp = '((a.al_ar_nr IS NOT NULL
		AND NOT EXISTS(SELECT 1 FROM artlog  x WHERE x.al_ar_nr = ar_nr AND (x.al_datum > a.al_update OR x.al_datum > la_update))) OR
	(EXISTS (SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr) AND NOT EXISTS(SELECT al_ar_nr FROM artlog WHERE al_ar_nr = ar_nr AND al_datum > ar_update))) OR ar_zuordnungneu = 1'
.head 8 -  Set sGlobalTemp = 'ar_zuordnungneu = 1'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sGlobalTemp) 
.head 8 -  !
.head 8 -  !
.head 8 -  !
.head 8 -  ! Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM lieferartikel JOIN artikellieferart x ON la_nr = x.al_la_nr AND x.al_ar_nr = ar_nr
					WHERE la_update > (SELECT @NULLVALUE(MAX(y.al_datum), \'19120402\') FROM artlog y WHERE y.al_ar_nr = ar_nr)
					 OR    x.al_update > (SELECT @NULLVALUE(MAX(y.al_datum), \'19120402\') FROM artlog y WHERE y.al_ar_nr = ar_nr))') 
.head 8 -  ! Set sWhere = StrAppend( sWhere, ' AND', ' al_ar_nr IS NOT NULL AND al_la_nr IS NOT NULL 
		AND NOT EXISTS(SELECT 1 FROM artlog y WHERE y.al_ar_nr = ar_nr AND (y.al_datum > la_update OR y.al_datum > al_update))') 
.head 8 -  ! Datenübertrag sinnvoll, wenn 
.head 8 -  ! Set sGlobalTemp = ' (EXISTS(SELECT 1 FROM artlog y LEFT JOIN artikellieferart z ON y.al_ar_nr = z.al_ar_nr LEFT JOIN lieferartikel ON la_nr = z.al_la_nr WHERE y.al_ar_nr = ar_nr AND (y.al_datum < la_update OR y.al_datum < al_update)) 
OR (NOT EXISTS(SELECT 1 FROM artlog z WHERE z.al_ar_nr = ar_nr) AND EXISTS(SELECT 1 FROM artikellieferart art WHERE art.al_ar_nr =ar_nr)))'
.head 7 +  If m_bLaZuordnungVorhanden
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM artikellieferart WHERE al_la_nr IS NOT NULL AND al_ar_nr = ar_nr)') 
.head 7 +  If m_bKeineLaZuordnungVorhanden
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' NOT EXISTS(SELECT 1 FROM artikellieferart WHERE al_la_nr IS NOT NULL AND al_ar_nr = ar_nr)') 
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  ! Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! th 20160721 kein SELECT .. innerhalb @NULLVALUE weil auf SQLBase nicht möglich
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If m_bLaDatenUpdate
.head 8 -  ! Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM lieferartikel JOIN artikellieferart x ON la_nr = x.al_la_nr AND x.al_ar_nr = ar_nr
					WHERE la_update > @NULLVALUE((SELECT MAX(al_datum) FROM artlog y WHERE y.al_ar_nr = ar_nr), \'19120402\')
					 OR    x.al_update > @NULLVALUE((SELECT MAX(al_datum) FROM artlog y WHERE y.al_ar_nr = ar_nr), \'19120402\'))') 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' al_ar_nr IS NOT NULL AND al_la_nr IS NOT NULL 
		AND NOT EXISTS(SELECT 1 FROM artlog y WHERE y.al_ar_nr = ar_nr AND (y.al_datum > la_update OR y.al_datum > al_update))') 
.head 7 +  If m_bLaZuordnungVorhanden
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM artikellieferart WHERE al_la_nr IS NOT NULL AND al_ar_nr = ar_nr)') 
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  ! Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! th 20160603: mit LaZuordnungVorhanden
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If m_bLaDatenUpdate
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM lieferartikel JOIN artikellieferart x ON la_nr = x.al_la_nr AND x.al_ar_nr = ar_nr
					WHERE la_update > @NULLVALUE((SELECT MAX(al_datum) FROM artlog y WHERE y.al_ar_nr = ar_nr), \'19120402\')
					 OR    x.al_update > @NULLVALUE((SELECT MAX(al_datum) FROM artlog y WHERE y.al_ar_nr = ar_nr), \'19120402\'))') 
.head 7 +  If m_bLaZuordnungVorhanden
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM artikellieferart WHERE al_la_nr IS NOT NULL AND al_ar_nr = ar_nr)') 
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  ! Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! th 20160223: mit LaDatenUpdate incl. al_update
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If m_bLaDatenUpdate
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND', ' EXISTS(SELECT 1 FROM lieferartikel JOIN artikellieferart x ON la_nr = x.al_la_nr AND x.al_ar_nr = ar_nr
					WHERE la_update > @NULLVALUE((SELECT MAX(al_datum) FROM artlog y WHERE y.al_ar_nr = ar_nr), \'19120402\')
					 OR    x.al_update > @NULLVALUE((SELECT MAX(al_datum) FROM artlog y WHERE y.al_ar_nr = ar_nr), \'19120402\'))') 
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  ! Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! ga 20150907: bei "In Rezeotur" Mandant berücksichtigen
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND ' || GetWhereRezept( TRUE ) || ')' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  ! Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! wl 20150821 keine ar_li_nr mehr verwenden
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  ! Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! ra 20150803 mit "nicht in rezeptur"
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'NOT EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! wl 20150618 bei InRezeptur <> rk_typ = 'A'
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT 1 FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND rk_typ = \'A\' AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! ra 20150213 mit Taxierung
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  ! ra 20150213 Taxierung
.head 7 +  If m_nTU_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung WHERE at_ar_nr = ar_nr AND at_tu_nr = ' || NumberToStrX( m_nTU_NR ) || ')' )
.head 7 +  If m_nTH_NR = NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr)' )
.head 7 +  Else If m_nTH_NR != NUMBER_Null
.head 8 +  If m_bTaxFehlt
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'NOT EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 8 +  Else 
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'EXISTS (SELECT * FROM artikeltaxierung,taxierungsuntergr
WHERE at_ar_nr = ar_nr AND at_tu_nr = tu_nr AND tu_th_nr = ' || NumberToStrX( m_nTH_NR ) || ')' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT * FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! wl 20131223 mit Lieferant, 20140309 mit Milchküche
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  ! If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 +  ! Else
.head 9 -  Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhereFilterString = '(@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\')'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sWhereFilterString )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , ' EXISTS( SELECT 1 FROM artikel l WHERE l.ar_ar_nr = artikel.ar_nr)' )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_milch = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT * FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  ! nur Basisartikel
.head 7 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! wl 20121122 nur > 0
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  ! If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 +  ! Else
.head 9 -  Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhereFilterString = '(@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\')'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sWhereFilterString )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT * FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! wl 20121112 nur in nicht gesperrten Rezepten"
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  ! If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 +  ! Else
.head 9 -  Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhereFilterString = '(@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\')'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sWhereFilterString )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT * FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! ga 20121009: "in Rezeptur"
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  ! If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 +  ! Else
.head 9 -  Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhereFilterString = '(@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\')'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sWhereFilterString )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT * FROM rezkomp WHERE rk_ar_nr = ar_nr)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  Function: GetWhereUser ! ra 20150803 mit "nicht in rezeptur"
.head 6 -  Description: ga 20070327: Anzeigetext für Filter bilden
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bMultiline
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sAnd
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sOr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Set sAnd = VisStrChoose( p_bMultiline, CR, '; ' )
.head 7 -  Set sOr = Translate ( ' oder ' )
.head 7 -  !
.head 7 +  If m_sFilterString
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = Translate( 'Nr.' ) || ' "' || m_sFilterString || '"'
.head 8 +  Else
.head 9 -  Set sWhereFilterString = Translate( 'Suche' ) || ' "' || m_sFilterString || '"'
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sTmp, sWhereFilterString )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, sOr, Translate( 'Intern, Quelle, BLS' ) || ' "' || CleanSearchString( m_sFilterString ) || '"' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, sWhereFilterString )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 +  While nColumn < nColumns
.head 9 +  If m_saFilterStringEx[nColumn]
.head 10 -  Set sWhereFilterString = StrAppend( sWhere, sAnd, saName[nColumn] || ' "' || m_saFilterStringEx[nColumn] || '"' )
.head 9 -  Set nColumn = nColumn + 1
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikelgruppe' ) || ' ' || GetName( 'artikelgruppe', 'ag_text', 'ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikeltyp' ) || ' ' || GetName( 'artikeltyp', 'at_text', 'at_nr = ' || NumberToStrX( m_nAR_AT_NR ) ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ohne BLS' ) )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ungeprüft' ) )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'geprüft' ) )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Sortiment' ) )
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'gesperrt' ) )
.head 7 +  Else
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht gesperrt' ) )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'in Rezeptur' ) )
.head 7 +  If m_bNichtInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht in Rezeptur' ) )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nur Lieferantenartikel' ) )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Milchküche' ) )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Vorlageartikel' ) )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'eigene Artikel' ) )
.head 7 -  !
.head 7 +  If sWhere
.head 8 -  Set sWhere = Translate( 'Filter' ) || ': ' || sWhere
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhereUser ! wl 20140309 mit Milchküche
.head 6 -  Description: ga 20070327: Anzeigetext für Filter bilden
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bMultiline
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sAnd
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sOr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set sAnd = VisStrChoose( p_bMultiline, CR, '; ' )
.head 7 -  Set sOr = Translate ( ' oder ' )
.head 7 -  !
.head 7 +  If m_sFilterString
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = Translate( 'Nr.' ) || ' "' || m_sFilterString || '"'
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = Translate( 'Suche' ) || ' "' || m_sFilterString || '"'
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sTmp, sWhereFilterString )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, sOr, Translate( 'Intern, Quelle, BLS' ) || ' "' || CleanSearchString( m_sFilterString ) || '"' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, sWhereFilterString )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 +  While nColumn < nColumns
.head 9 +  If m_saFilterStringEx[nColumn]
.head 10 -  Set sWhereFilterString = StrAppend( sWhere, sAnd, saName[nColumn] || ' "' || m_saFilterStringEx[nColumn] || '"' )
.head 9 -  Set nColumn = nColumn + 1
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikelgruppe' ) || ' ' || GetName( 'artikelgruppe', 'ag_text', 'ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikeltyp' ) || ' ' || GetName( 'artikeltyp', 'at_text', 'at_nr = ' || NumberToStrX( m_nAR_AT_NR ) ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ohne BLS' ) )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ungeprüft' ) )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'geprüft' ) )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Sortiment' ) )
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'gesperrt' ) )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht gesperrt' ) )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'in Rezeptur' ) )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nur Lieferantenartikel' ) )
.head 7 +  If m_bAR_MILCH
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Milchküche' ) )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Vorlageartikel' ) )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'eigene Artikel' ) )
.head 7 -  !
.head 7 +  If sWhere
.head 8 -  Set sWhere = Translate( 'Filter' ) || ': ' || sWhere
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhereUser ! ga 20121009: "in Rezeptur", 20131223 mit Lieferant
.head 6 -  Description: ga 20070327: Anzeigetext für Filter bilden
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bMultiline
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sAnd
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sOr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set sAnd = VisStrChoose( p_bMultiline, CR, '; ' )
.head 7 -  Set sOr = Translate ( ' oder ' )
.head 7 -  !
.head 7 +  If m_sFilterString
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = Translate( 'Nr.' ) || ' "' || m_sFilterString || '"'
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = Translate( 'Suche' ) || ' "' || m_sFilterString || '"'
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sTmp, sWhereFilterString )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, sOr, Translate( 'Intern, Quelle, BLS' ) || ' "' || CleanSearchString( m_sFilterString ) || '"' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, sWhereFilterString )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 +  While nColumn < nColumns
.head 9 +  If m_saFilterStringEx[nColumn]
.head 10 -  Set sWhereFilterString = StrAppend( sWhere, sAnd, saName[nColumn] || ' "' || m_saFilterStringEx[nColumn] || '"' )
.head 9 -  Set nColumn = nColumn + 1
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikelgruppe' ) || ' ' || GetName( 'artikelgruppe', 'ag_text', 'ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikeltyp' ) || ' ' || GetName( 'artikeltyp', 'at_text', 'at_nr = ' || NumberToStrX( m_nAR_AT_NR ) ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ohne BLS' ) )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ungeprüft' ) )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'geprüft' ) )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Sortiment' ) )
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'gesperrt' ) )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht gesperrt' ) )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'in Rezeptur' ) )
.head 7 +  If m_bLieferant
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nur Lieferantenartikel' ) )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Vorlageartikel' ) )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'eigene Artikel' ) )
.head 7 -  !
.head 7 +  If sWhere
.head 8 -  Set sWhere = Translate( 'Filter' ) || ': ' || sWhere
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! ga 20100414: mehrfache Suche mit Leerstelle getrennt
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  ! If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 +  ! Else
.head 9 -  Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhereFilterString = '(@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\')'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sWhereFilterString )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhereUser ! ga 20100414: mehrfache Suche mit Leerstelle getrennt
.head 6 -  Description: ga 20070327: Anzeigetext für Filter bilden
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bMultiline
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sAnd
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sOr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set sAnd = VisStrChoose( p_bMultiline, CR, '; ' )
.head 7 -  Set sOr = Translate ( ' oder ' )
.head 7 -  !
.head 7 +  If m_sFilterString
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = Translate( 'Nr.' ) || ' "' || m_sFilterString || '"'
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = Translate( 'Suche' ) || ' "' || m_sFilterString || '"'
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sTmp, sWhereFilterString )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, sOr, Translate( 'Intern, Quelle, BLS' ) || ' "' || CleanSearchString( m_sFilterString ) || '"' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, sWhereFilterString )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 +  While nColumn < nColumns
.head 9 +  If m_saFilterStringEx[nColumn]
.head 10 -  Set sWhereFilterString = StrAppend( sWhere, sAnd, saName[nColumn] || ' "' || m_saFilterStringEx[nColumn] || '"' )
.head 9 -  Set nColumn = nColumn + 1
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikelgruppe' ) || ' ' || GetName( 'artikelgruppe', 'ag_text', 'ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikeltyp' ) || ' ' || GetName( 'artikeltyp', 'at_text', 'at_nr = ' || NumberToStrX( m_nAR_AT_NR ) ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ohne BLS' ) )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ungeprüft' ) )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'geprüft' ) )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Sortiment' ) )
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'gesperrt' ) )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht gesperrt' ) )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Vorlageartikel' ) )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'eigene Artikel' ) )
.head 7 -  !
.head 7 +  If sWhere
.head 8 -  Set sWhere = Translate( 'Filter' ) || ': ' || sWhere
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 +  If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 -  Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhereFilterString = '(@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\')'
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', sWhereFilterString )
.head 7 +  ! If m_sFilterString
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhereUser
.head 6 -  Description: ga 20070327: Anzeigetext für Filter bilden
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bMultiline
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sAnd
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sOr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set sAnd = VisStrChoose( p_bMultiline, CR, '; ' )
.head 7 -  Set sOr = Translate ( ' oder ' )
.head 7 -  !
.head 7 +  If m_sFilterString
.head 8 +  If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = Translate( 'Patient Nr.' ) || ' "' || m_sFilterString || '%"'
.head 8 -  Set sWhereFilterString = StrAppend( sWhereFilterString, sOr, Translate( 'Intern, Quelle, BLS' ) || ' "' || CleanSearchString( m_sFilterString ) || '"' )
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, sWhereFilterString )
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikelgruppe' ) || ' ' || GetName( 'artikelgruppe', 'ag_text', 'ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikeltyp' ) || ' ' || GetName( 'artikeltyp', 'at_text', 'at_nr = ' || NumberToStrX( m_nAR_AT_NR ) ) )
.head 7 +  If NOT m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ohne BLS' ) )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ungeprüft' ) )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'geprüft' ) )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Sortiment' ) )
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'gesperrt' ) )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht gesperrt' ) )
.head 7 -  !
.head 7 +  If sWhere
.head 8 -  Set sWhere = Translate( 'Filter' ) || ': ' || sWhere
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  Function: GetName
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: p_sTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set sStmt = 'SELECT ' || p_sColumn || ' INTO :sGlobalTemp FROM ' || p_sTable || ' WHERE ' || p_sWhere
.head 7 +  If Sql_FetchOne( hSql, sStmt )
.head 8 -  Return '"' || sGlobalTemp || '"'
.head 7 +  Else
.head 8 +  While SalStrScan( p_sWhere, '=' ) >= 0
.head 9 -  Set p_sWhere = SalStrRightX( p_sWhere, SalStrLength( p_sWhere ) - SalStrScan( p_sWhere, '=' ) - 1 )
.head 8 -  Return SalStrTrimX( p_sWhere )
.head 5 +  Function: SetFilterString
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: p_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_sFilterString = p_sFilterString
.head 5 +  Function: SetAR_AT_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nAR_AT_NR = p_bParam
.head 5 +  Function: SetAR_AG_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nAR_AG_NR = p_bParam
.head 5 +  Function: SetUnchecked
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bUnchecked = p_bParam
.head 5 +  Function: SetOhneBLS
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bOhneBLS = p_bParam
.head 5 +  Function: SetInRezeptur
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bInRezeptur = p_bParam
.head 5 +  Function: SetNichtInRezeptur ! ra 20150803 neu
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bNichtInRezeptur = p_bParam
.head 5 +  Function: SetLieferant
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bLieferant = p_bParam
.head 5 +  Function: GetLieferant
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return m_bLieferant
.head 5 +  Function: SetAR_GESP
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bAR_GESP = p_bParam
.head 5 +  Function: SetAR_MILCH
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bAR_MILCH = p_bParam
.head 5 +  Function: SetAR_GEPRUEFT
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bAR_GEPRUEFT = p_bParam
.head 5 +  Function: SetAR_PARAMETER1
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bAR_PARAMETER1 = p_bParam
.head 5 +  Function: IsFilter	! th 20160802 keineLaZuordnung
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_bTaxFehlt
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bNichtInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bLieferant	! wl 20131223 
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_MILCH
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  Set bFilter = bFilter OR m_nTH_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_nTU_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_bLaDatenUpdate
.head 7 -  Set bFilter = bFilter OR m_bLaZuordnungVorhanden
.head 7 -  Set bFilter = bFilter OR m_bKeineLaZuordnungVorhanden
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  ! Function: IsFilter	! th 20160701 LaZuordnungVorhanden
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_bTaxFehlt
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bNichtInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bLieferant	! wl 20131223 
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_MILCH
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  Set bFilter = bFilter OR m_nTH_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_nTU_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_bLaDatenUpdate
.head 7 -  Set bFilter = bFilter OR m_bLaZuordnungVorhanden
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  ! Function: IsFilter	! th 20160202: LaDatenUpdate
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_bTaxFehlt
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bNichtInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bLieferant	! wl 20131223 
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_MILCH
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  Set bFilter = bFilter OR m_nTH_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_nTU_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_bLaDatenUpdate
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  ! Function: IsFilter	! ra 20150803 mit "nicht in rezeptur"
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_bTaxFehlt
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bNichtInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bLieferant	! wl 20131223 
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_MILCH
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  Set bFilter = bFilter OR m_nTH_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_nTU_NR!= NUMBER_Null
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  ! Function: IsFilter	! ra 20150213 mit Taxierung
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_bTaxFehlt
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bLieferant	! wl 20131223 
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_MILCH
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  Set bFilter = bFilter OR m_nTH_NR!= NUMBER_Null
.head 7 -  Set bFilter = bFilter OR m_nTU_NR!= NUMBER_Null
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  ! Function: IsFilter	! wl 20140309 mit Milchküche
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bLieferant	! wl 20131223 
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_MILCH
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  Function: SetAR_KU_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nAR_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nAR_KU_NR = p_nAR_KU_NR
.head 5 -  !
.head 5 -  ! Taxierung
.head 5 +  Function: SetTaxFehlt
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bTaxFehlt
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bTaxFehlt = p_bTaxFehlt
.head 5 +  Function: SetTU_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nTU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nTU_NR = p_nTU_NR
.head 5 +  Function: SetTH_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nTH_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nTH_NR = p_nTH_NR
.head 5 -  ! th 20160202
.head 5 +  Function: SetLaDatenUpdate
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bLaDatenUpdate = p_bParam
.head 5 -  ! th 20160603
.head 5 +  Function: SetLaZuordnungVorhanden
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bLaZuordnungVorhanden = p_bParam
.head 5 +  Function: SetKeineLaZuordnungVorhanden
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_bKeineLaZuordnungVorhanden = p_bParam
.head 5 -  !
.head 5 +  Function: SetFilterStringEx
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_saFilterStringEx[p_nIndex] = p_sFilterString
.head 5 +  Function: ClearFilterStringEx
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( m_saFilterStringEx, 1, -1 )
.head 5 +  Function: SetTable
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_hWndTable = p_hWndTable
.head 5 +  Function: GetTable
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return m_hWndTable
.head 5 +  Function: GetFilterString
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return m_sFilterString
.head 3 +  Functional Class: cObjParamArtikelZuordnung
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: cObjParamData
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  String: m_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nLA_AT_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nLA_AG_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nLA_LI_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nKU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: m_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: m_saFilterStringEx[*]
.head 4 +  Functions
.head 5 +  Function: GetWhere ! th 20160721 li_kostenstelle != '' und Hochstriche
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'la_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(la_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  If m_nLA_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_ag_nr = ' || NumberToStrX( m_nLA_AG_NR ) )
.head 7 +  Else If m_nLA_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_at_nr = ' || NumberToStrX( m_nLA_AT_NR ) )
.head 7 -  !
.head 7 +  If m_nLA_LI_NR != NUMBER_Null
.head 8 +  If Sql_FetchOne( hSql, 'SELECT li_kostenstelle FROM lieferant INTO :sGlobalTemp WHERE li_nr = ' || NumberToStrX( m_nLA_LI_NR ) )
	AND sGlobalTemp != ''
.head 9 -  ! li aus liefkueche immer e5-> la ev. auf e4 oder e3
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_li_nr IN (SELECT li_nr FROM lieferant WHERE li_kostenstelle = \''|| sGlobalTemp ||'\' 
	OR li_kostenstelle IN ( @LEFT( \'' || sGlobalTemp ||'\', 12)+\'000\', @LEFT( \'' || sGlobalTemp ||'\', 9)+\'000000\' ))' )
.head 7 -  !
.head 7 +  If m_nKU_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr IN (' || GetKstStringEx( m_nKU_NR, 'ku', FALSE) ||')' )
.head 7 +  Else
.head 8 +  If nUserKuecheNrMandant != NUMBER_Null
.head 9 -  ! Mandanten-Küche
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( nUserKuecheNrMandant ) )
.head 8 +  Else
.head 9 -  ! Basis-Küche
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( nUserKuecheNr ) )
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'la_nr > 0' )
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere ! th 20160615 KU_NR nun doch hierarchisch nach oben
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'la_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(la_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  If m_nLA_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_ag_nr = ' || NumberToStrX( m_nLA_AG_NR ) )
.head 7 +  Else If m_nLA_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_at_nr = ' || NumberToStrX( m_nLA_AT_NR ) )
.head 7 -  !
.head 7 +  If m_nLA_LI_NR != NUMBER_Null
.head 8 +  If Sql_FetchOne( hSql, 'SELECT li_kostenstelle FROM lieferant INTO :sGlobalTemp WHERE li_nr = ' || NumberToStrX( m_nLA_LI_NR ) )
.head 9 -  ! li aus liefkueche immer e5-> la ev. auf e4 oder e3
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_li_nr IN (SELECT li_nr FROM lieferant WHERE li_kostenstelle = '|| sGlobalTemp ||' 
	OR li_kostenstelle IN ( @LEFT( ' || sGlobalTemp ||', 12)+\'000\', @LEFT( ' || sGlobalTemp ||', 9)+\'000000\' ))' )
.head 7 -  !
.head 7 +  If m_nKU_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr IN (' || GetKstStringEx( m_nKU_NR, 'ku', FALSE) ||')' )
.head 7 +  Else 
.head 8 +  If nUserKuecheNrMandant != NUMBER_Null
.head 9 -  ! Mandanten-Küche
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( nUserKuecheNrMandant ) )
.head 8 +  Else 
.head 9 -  ! Basis-Küche
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( nUserKuecheNr ) )
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'la_nr > 0' )
.head 7 -  Return sWhere
.head 5 +  ! Function: GetWhere 
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'la_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(la_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 +  If m_nLA_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_ag_nr = ' || NumberToStrX( m_nLA_AG_NR ) )
.head 7 +  Else If m_nLA_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_at_nr = ' || NumberToStrX( m_nLA_AT_NR ) )
.head 7 -  !
.head 7 +  If m_nLA_LI_NR != NUMBER_Null
.head 8 +  If Sql_FetchOne( hSql, 'SELECT li_kostenstelle FROM lieferant INTO :sGlobalTemp WHERE li_nr = ' || NumberToStrX( m_nLA_LI_NR ) )
.head 9 -  ! li aus liefkueche immer e5-> la ev. auf e4 oder e3
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'la_li_nr IN (SELECT li_nr FROM lieferant WHERE li_kostenstelle = '|| sGlobalTemp ||' 
	OR li_kostenstelle IN ( @LEFT( ' || sGlobalTemp ||', 12)+\'000\', @LEFT( ' || sGlobalTemp ||', 9)+\'000000\' ))' )
.head 7 -  !
.head 7 +  If m_nKU_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( m_nKU_NR ) )
.head 7 +  Else 
.head 8 +  If nUserKuecheNrMandant != NUMBER_Null
.head 9 -  ! Mandanten-Küche
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( nUserKuecheNrMandant ) )
.head 8 +  Else 
.head 9 -  ! Basis-Küche
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', 'bs_ku_nr = ' || NumberToStrX( nUserKuecheNr ) )
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'la_nr > 0' )
.head 7 -  Return sWhere
.head 5 +  Function: SetFilterString
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: p_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_sFilterString = p_sFilterString
.head 5 +  Function: SetLA_AT_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nLA_AT_NR = p_nParam
.head 5 +  Function: SetLA_AG_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nLA_AG_NR = p_nParam
.head 5 +  Function: SetLA_LI_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nLA_LI_NR = p_nParam
.head 5 +  Function: IsFilter	
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_nLA_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nLA_AG_NR
.head 7 -  Set bFilter = bFilter OR m_nLA_LI_NR
.head 7 -  Set bFilter = bFilter OR m_nKU_NR
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  Function: SetKU_NR
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_nKU_NR = p_nParam
.head 5 -  !
.head 5 +  Function: SetFilterStringEx
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: p_nIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_saFilterStringEx[p_nIndex] = p_sFilterString
.head 5 +  Function: ClearFilterStringEx
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalArraySetUpperBound( m_saFilterStringEx, 1, -1 )
.head 5 +  Function: SetTable
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set m_hWndTable = p_hWndTable
.head 5 +  Function: GetTable
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return m_hWndTable
.head 5 +  Function: GetFilterString
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return m_sFilterString
.head 3 +  Combo Box Class: ComboLookupLieferArtikel2
.head 4 -  Window Location and Size
.head 5 -  Left:
.head 5 -  Top:
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List in Tool Palette? Yes
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Description:
.head 4 +  Derived From
.head 5 -  Class: ComboLookup
.head 4 -  Class Variables
.head 4 -  Instance Variables
.head 4 +  Functions
.head 5 +  Function: classCreateLookup
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 +  Parameters
.head 7 -  String: p_sKey
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sValue
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sChar
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sWhere
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SalCreateWindow( _LieferArtikelLookup2, hWndForm, hWndItem, p_sKey, p_sValue, p_sChar, p_sWhere )
.head 5 +  Function: classGetValue
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  String: p_sKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If p_sKey AND Sql_FetchOne( hSql, 'SELECT la_intern INTO :sGlobalTemp FROM lieferartikel
	WHERE
		la_nr = ' || p_sKey )
.head 8 -  Return sGlobalTemp
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  ! Functional Class: cObjParamLieferartikel
.winattr
.end
.head 4 -  Description: 
.head 4 +  Derived From 
.head 5 -  Class: cObjParamData
.head 4 -  Class Variables 
.head 4 +  Instance Variables 
.head 5 -  String: m_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nAR_AT_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nAR_AG_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: m_nAR_LI_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bUnchecked
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bOhneBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bInRezeptur
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_GESP
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_GEPRUEFT
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: m_bAR_PARAMETER1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: m_nAR_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: m_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: m_saFilterStringEx[*]
.head 4 +  Functions 
.head 5 +  Function: GetWhere ! wl 20131223 mit Lieferant
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If m_sFilterString
.head 8 -  ! ga 20100420: mehrfache Suche mit Leerstelle getrennt
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = 'ar_nr = ' || SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 )
.head 8 -  ! ga 20101018: nur ein Zeichen filtert auf Nachname
.head 8 +  Else If ( SalStrLength( SalStrTrimX( m_sFilterString ) ) = 1 )
.head 9 -  Set sWhereFilterString = '@UPPER(ar_intern) LIKE \'' || SalStrTrimX( SalStrUpperX( m_sFilterString ) ) || '%\''
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString )
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 +  ! If SalStrIsValidNumber( m_sFilterString ) AND ( SalNumberMod( SalStrToNumber( m_sFilterString ), 1 ) = 0 )
.head 9 -  Set sWhereFilterString = '@STRING(ar_nr, 0) LIKE \'' || NumberToStrX( SalStrToNumber( m_sFilterString ) ) || '%\''
.head 8 +  ! Else
.head 9 -  Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sWhereFilterString, sTmp )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, ' OR ', '
	@UPPER(ar_intern) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_quelle) LIKE \'' || CleanSearchString( m_sFilterString ) || '\' OR
	@UPPER(ar_sbls) LIKE \'' || CleanSearchString( m_sFilterString ) || '\'' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set sWhereFilterString = p_hWndTable.TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_at_nr = ' || NumberToStrX( m_nAR_AT_NR ) )
.head 7 +  If m_nAR_LI_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_li_nr = ' || NumberToStrX( m_nAR_LI_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_sbls IS NULL' )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_geprueft IS NULL OR ar_geprueft = 0)' )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_geprueft = 1' )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_parameter1 = 1' )
.head 7 -  ! wl 20091016 keine gesperrten anzeigen
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_gesp = 1' )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , '(ar_gesp = 0 or ar_gesp IS NULL)' )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'EXISTS (SELECT * FROM rezkomp,rezept WHERE rk_ar_nr = ar_nr AND rk_re_nr = re_nr AND @NULLVALUE(re_gesp,0) = 0)' )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr IS NULL' )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_ku_nr = ' || NumberToStrX( m_nAR_KU_NR ) )
.head 7 +  Else 
.head 8 -  ! eigene und Standard (ohne "ar_gesp" -> nicht mit Standardfkt.)
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', '(' || GetKU_KU_NRWhere( 'ar_ku_nr' ) || ' OR ar_ku_nr IS NULL)' )
.head 7 -  !
.head 7 +  If NOT ( SalStrLeftX( m_sFilterString, 1 ) = '#' )
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_nr > 0' )
.head 7 -  !
.head 7 -  Set sWhere = StrAppend( sWhere, ' AND ' , 'ar_li_nr IS NOT NULL' )
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  Function: GetWhereUser ! ga 20121009: "in Rezeptur", 20131223 mit Lieferant
.head 6 -  Description: ga 20070327: Anzeigetext für Filter bilden
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bMultiline
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sAnd
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sOr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhereFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set sAnd = VisStrChoose( p_bMultiline, CR, '; ' )
.head 7 -  Set sOr = Translate ( ' oder ' )
.head 7 -  !
.head 7 +  If m_sFilterString
.head 8 +  If ( SalStrLeftX( m_sFilterString, 1 ) = '#' ) AND SalStrToNumber( SalStrRightX( m_sFilterString, SalStrLength( m_sFilterString ) - 1 ) )
.head 9 -  Set sWhereFilterString = Translate( 'Nr.' ) || ' "' || m_sFilterString || '"'
.head 8 +  Else 
.head 9 -  Set sWhereFilterString = Translate( 'Suche' ) || ' "' || m_sFilterString || '"'
.head 9 -  ! Call p_hWndTable.TableClass..PopulateGetFilter( m_sFilterString, sTmp, sWhereFilterString )
.head 8 -  ! Set sWhereFilterString = StrAppend( sWhereFilterString, sOr, Translate( 'Intern, Quelle, BLS' ) || ' "' || CleanSearchString( m_sFilterString ) || '"' )
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, sWhereFilterString )
.head 7 -  !
.head 7 +  If p_hWndTable.TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 +  While nColumn < nColumns
.head 9 +  If m_saFilterStringEx[nColumn]
.head 10 -  Set sWhereFilterString = StrAppend( sWhere, sAnd, saName[nColumn] || ' "' || m_saFilterStringEx[nColumn] || '"' )
.head 9 -  Set nColumn = nColumn + 1
.head 8 +  If sWhereFilterString
.head 9 -  Set sWhere = StrAppend( sWhere, sAnd, '(' || sWhereFilterString || ')' )
.head 7 -  !
.head 7 +  If m_nAR_AG_NR
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikelgruppe' ) || ' ' || GetName( 'artikelgruppe', 'ag_text', 'ag_nr = ' || NumberToStrX( m_nAR_AG_NR ) ) )
.head 7 +  Else If m_nAR_AT_NR != NUMBER_Null
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Artikeltyp' ) || ' ' || GetName( 'artikeltyp', 'at_text', 'at_nr = ' || NumberToStrX( m_nAR_AT_NR ) ) )
.head 7 +  If m_nAR_LI_NR
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', 'ar_li_nr = ' || NumberToStrX( m_nAR_LI_NR ) )
.head 7 +  If m_bOhneBLS
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ohne BLS' ) )
.head 7 +  If m_bUnchecked
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'ungeprüft' ) )
.head 7 +  If m_bAR_GEPRUEFT
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'geprüft' ) )
.head 7 +  If m_bAR_PARAMETER1
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Sortiment' ) )
.head 7 +  If m_bAR_GESP
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'gesperrt' ) )
.head 7 +  Else 
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'nicht gesperrt' ) )
.head 7 -  ! ga 20121009
.head 7 +  If m_bInRezeptur
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'in Rezeptur' ) )
.head 7 -  !
.head 7 -  ! ga 20100705: Mandant
.head 7 +  If m_nAR_KU_NR = -1
.head 8 -  ! Standardkomponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'Vorlageartikel' ) )
.head 7 +  Else If m_nAR_KU_NR != NUMBER_Null
.head 8 -  ! nur eigene Komponenten
.head 8 -  Set sWhere = StrAppend( sWhere, sAnd, Translate( 'eigene Artikel' ) )
.head 7 -  !
.head 7 +  If sWhere
.head 8 -  Set sWhere = Translate( 'Filter' ) || ': ' || sWhere
.head 7 -  !
.head 7 -  Return sWhere
.head 5 +  Function: GetName
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 +  Parameters 
.head 7 -  String: p_sTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set sStmt = 'SELECT ' || p_sColumn || ' INTO :sGlobalTemp FROM ' || p_sTable || ' WHERE ' || p_sWhere
.head 7 +  If Sql_FetchOne( hSql, sStmt )
.head 8 -  Return '"' || sGlobalTemp || '"'
.head 7 +  Else 
.head 8 +  While SalStrScan( p_sWhere, '=' ) >= 0
.head 9 -  Set p_sWhere = SalStrRightX( p_sWhere, SalStrLength( p_sWhere ) - SalStrScan( p_sWhere, '=' ) - 1 )
.head 8 -  Return SalStrTrimX( p_sWhere )
.head 5 +  Function: SetFilterString
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  String: p_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_sFilterString = p_sFilterString
.head 5 +  Function: SetAR_AT_NR
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_nAR_AT_NR = p_bParam
.head 5 +  Function: SetAR_AG_NR
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_nAR_AG_NR = p_bParam
.head 5 +  Function: SetAR_LI_NR
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_nAR_LI_NR = p_bParam
.head 5 +  Function: SetUnchecked
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_bUnchecked = p_bParam
.head 5 +  Function: SetOhneBLS
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_bOhneBLS = p_bParam
.head 5 +  Function: SetInRezeptur
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_bInRezeptur = p_bParam
.head 5 +  Function: SetAR_GESP
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_bAR_GESP = p_bParam
.head 5 +  Function: SetAR_GEPRUEFT
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_bAR_GEPRUEFT = p_bParam
.head 5 +  Function: SetAR_PARAMETER1
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bParam
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_bAR_PARAMETER1 = p_bParam
.head 5 +  Function: IsFilter	! wl 20131223
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: saName[*]
.head 7 -  String: saColumn[*]
.head 7 -  Number: naType[*]
.head 7 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set bFilter = bFilter OR ( SalStrLength( m_sFilterString ) > 1  OR ( m_sFilterString != '%' AND SalStrLength( m_sFilterString ) > 0 ) )
.head 7 -  Set bFilter = bFilter OR m_nAR_AT_NR
.head 7 -  Set bFilter = bFilter OR m_nAR_AG_NR
.head 7 -  Set bFilter = bFilter OR m_bUnchecked
.head 7 -  Set bFilter = bFilter OR m_bOhneBLS
.head 7 -  Set bFilter = bFilter OR m_bInRezeptur
.head 7 -  Set bFilter = bFilter OR m_bAR_GESP
.head 7 -  Set bFilter = bFilter OR m_bAR_GEPRUEFT
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR m_bAR_PARAMETER1
.head 7 -  Set bFilter = bFilter OR ( m_nAR_KU_NR != NUMBER_Null )
.head 7 -  !
.head 7 +  If GetTable(  )
.head 8 +  If GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 9 -  Set bFilter = bFilter OR ( GetTable(  ).TableClass..PopulateSetFilterItems( m_saFilterStringEx, saName, saColumn, naType, nColumns ) != '' )
.head 7 -  !
.head 7 -  Return bFilter
.head 5 +  Function: SetAR_KU_NR
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nAR_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_nAR_KU_NR = p_nAR_KU_NR
.head 5 -  !
.head 5 +  Function: SetFilterStringEx
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sFilterString
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_saFilterStringEx[p_nIndex] = p_sFilterString
.head 5 +  Function: ClearFilterStringEx
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Call SalArraySetUpperBound( m_saFilterStringEx, 1, -1 )
.head 5 +  Function: SetTable
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Window Handle: p_hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set m_hWndTable = p_hWndTable
.head 5 +  Function: GetTable
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Window Handle: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return m_hWndTable
.head 5 +  Function: GetFilterString
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  String: 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return m_sFilterString
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box: DialogOkEsc
.head 3 -  Table Window: Service
.head 3 -  Quest Window:
.head 3 -  Data Field: DataFieldWithComboBox
.head 3 -  Spin Field:
.head 3 -  Multiline Field: MultilineShowOnly
.head 3 -  Pushbutton: ToolbarDelete
.head 3 -  Radio Button: RadioButtonUpdate
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box: CheckUpdate
.head 3 -  Child Table: TableShowOnly
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box: ComboWithDataField
.head 3 -  Picture: cQuickPicture
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column: ColShowOnly
.head 3 -  Background Text: BackGroundText
.head 3 -  Group Box: GropuBox
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cQuickGraph
.head 2 +  Application Actions
.head 3 +  ! On SAM_AppStartup
.head 4 +  ! If SalAppFind( 'sana20', TRUE )
.head 5 -  Call SalQuit(  )
.head 4 -  Call SalCreateWindow( dlgLogo, hWndNULL )
.head 4 +  If SalModalDialog( dlgLogon, hWndForm, INI_DATEI, 'DataBase')
.head 5 -  Call SqlSetParameter( hSql, DBP_PRESERVE, TRUE, sParam )
.head 5 -  Call SqlSetIsolationLevel( hSql, 'RL')
.head 5 -  Call SqlSetLockTimeout( hSql, NormalLockWaitTime )
.head 5 -  !
.head 5 -  ! altes Programm?
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT ve_nr, ve_lastskript FROM version
INTO :nKey, :dtGlobalTemp
WHERE ve_prog = \'SANA20\'' )
.head 5 +  If VERSION < nKey
.head 6 -  Call SalMessageBeep( -1 )
.head 6 -  Call MessageBox( 'Programm ist nicht die letzte Version.
Bitte wenden sie sich ehestens an ihren Betreuer.', 'ProgrammVersion', MB_IconStop )
.head 5 -  ! richtige DB-Version?
.head 5 +  If LASTSKRIPT > dtGlobalTemp
.head 6 -  Call SalMessageBeep( -1 )
.head 6 -  Call SalMessageBox( 'Programm und Datenbank haben nicht dieselbe Version!
DAs Programm kann nicht verwendet werden.', 'Versionskonflikt', MB_IconStop )
.head 6 -  Call SalQuit(  )
.head 5 -  !
.head 5 -  Call SqlConnect( hSqlSub )
.head 5 -  Call SqlSetParameter( hSqlSub, DBP_PRESERVE, TRUE, sParam )
.head 5 -  Call SqlSetIsolationLevel( hSqlSub, 'RL')
.head 5 -  Call SqlSetLockTimeout( hSqlSub, NormalLockWaitTime )
.head 5 -  !
.head 5 -  ! Drucken ?
.head 5 -  Set bDruckVorschau =  SalGetProfileInt( 'Reports', 'DruckVorschau', 0, INI_DATEI )
.head 5 +  If Sql_FetchOne( hSql, 'SELECT * FROM sysadm.systriggers
WHERE name = \'TRG_KONFLIKT\'' )
.head 6 -  Set bTRG_KONFLIKT = TRUE
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT ku_name FROM kunde
INTO :sKunde' )
.head 5 -  Call SalEndDialog( hWndForm, TRUE )
.head 4 +  Else 
.head 5 -  Call SalQuit(  )
.head 1 -  ! Lieferantenartikel
.head 1 +  ! CjTaskPanel: cjLieferartikelTaskPanel
.winattr class Dialog Box:
.head 2 -  Class: CjTaskPanel
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Standard
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modeless
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Data Field: dfFilterString
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.183"
.head 6 -  Top: 0.448"
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbArtikeltyp
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboOutline
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! ga 20091005: noch nicht verfügbar "at_aktiv=1"
.head 6 -  Call InitOutline( Translate( SC_ALLE ), 'at_nr', 'at_text', 'artikeltyp', '', 'at_text', 1 )
.head 6 -  ! ga 20091005: noch nicht verfügbar "ag_aktiv=1"
.head 6 -  Call AddLevel( 'ag_nr', 'ag_at_nr', 'ag_text', 'artikelgruppe', '', 'ag_text' )
.head 5 +  On SAM_AnyEdit
.head 6 +  If lParam != SAM_Create ! nicht in Verbindung mit Initialisierung
.head 7 -  Call ApplyFilter(   )
.head 3 +  Combo Box: cmbMandant
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboKeyValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalListSetSelect( hWndItem, AddAll(  ) )
.head 6 -  Call Add( nUserKuecheNrMandant, Translate( 'Eigene Artikel' ) )
.head 6 -  Call Add( -1, Translate( 'Vorlageartikel' ) )
.head 5 +  On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbLieferant
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboKeyValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SetKeyValue( 'li_nr', 'li_lieferant', 'lieferant', '', 'li_sort, li_lieferant', TRUE )
.head 5 +  On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  ActiveX: axTaskPanel
.data CLASSPROPSSIZE
0000: 3101
.enddata
.data CLASSPROPS
0000: 4C69634B65790012 015400610073006B 00500061006E0065 006C00200043006F
0020: 006E00740072006F 006C00200043006F 0070007900720069 0067006800740020
0040: 0028006300290020 0032003000300033 002D003200300030 003900200043006F
0060: 00640065006A006F 0063006B00200053 006F006600740077 006100720065000D
0080: 000A00500052004F 0044005500430054 002D00490044003A 00200043006F0064
00A0: 0065006A006F0063 006B002E00540061 0073006B00500061 006E0065006C002E
00C0: 0041006300740069 007600650058002E 007600310033002E 0032000D000A0056
00E0: 0041004C00490044 004100540045002D 0043004F00440045 003A00200044004A
0100: 004E002D00540058 0041002D00530047 0058002D00450046 005900004C69634B
0120: 65794C656E000400 1201000000000000 00
.enddata
.data RESOURCE 5 0 1 3753798604
0000: 000A000012020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000456FBDEC05 73494E0087A1ABAE
0100: 1483BE7CF8000000 0F40047189004C6C CA0103000000F280 0000204A00450045
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2450000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF0002000D 0061020000084F03
01C0: 0040000000E80102 0000E90100002702 0000013300016400 FC0000FFFFFFFFFF
01E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0200: FFFFFFFFFFFFFFFF FFFFFFFFFFFF280C 00001A49000088FF A402684E9F02FA00
0220: 00FFFFFF
.enddata
.winattr
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjTaskPanel
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Double Click
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.0"
.head 6 -  Top: 0.0"
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 -  Message Actions 
.head 2 +  Functions 
.head 3 +  Function: classCreate	! wl 20131223 mit Lieferanten
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Lieferant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbLieferant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: classItemClick	! wl 20131223 mit Lieferanten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nColumn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: nOffset
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamLieferartikel ) AND oParamLieferartikel.GetTable(  )
.head 7 +  If oParamLieferartikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  Function: ApplyFilter		! wl 20131223 mit Lieferanten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamLieferartikel.ClearFilterStringEx(  )
.head 5 -  Call oParamLieferartikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamLieferartikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamLieferartikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamLieferartikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamLieferartikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamLieferartikel.SetAR_LI_NR( cmbLieferant.GetKeyX(  ) ) 
.head 5 -  Call oParamLieferartikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamLieferartikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamLieferartikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamLieferartikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamLieferartikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamLieferartikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamLieferartikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedLieferartikelFilter, oParamLieferartikel )
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = LIEFERARTIKEL.AnsichtAlphabet
.head 6 -  Set dfFilterString = ParamGetStr( p_nKey )
.head 6 -  Call SalPostMsg( dfFilterString, SAM_Validate, 0, 0 )
.head 3 +  Function: ClearFilter
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: GetCaption ! ga 20130205: ohne Webdings Dropdown Pfeil, weil in der Schweiz nicht verfügbar
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  String: p_sCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sXaml
.head 4 +  Actions 
.head 5 -  Return p_sCaption || '...'
.head 2 -  Window Parameters 
.head 2 +  Window Variables 
.head 3 -  ! Erste Instanz des Filterobjekts, die weiteren Filter "holen" sich dann eine Referenz bei Bedarf
.head 3 -  FunctionalVar: oParamLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 4 -  Class: cObjParamLieferartikel
.end
.head 3 -  !
.head 3 -  Number: nIdFilterString
.head 3 -  Number: nIdFilterClear
.head 3 -  Number: nIdOhneBLS
.head 3 -  Number: nIdUnchecked
.head 3 -  Number: nIdAR_GESP
.head 3 -  Number: nIdAR_GEPRUEFT
.head 3 -  Number: nIdAR_PARAMETER1
.head 3 -  Number: nIdInRezeptur
.head 3 -  !
.head 3 -  Number: nFilterIndex
.head 2 +  Message Actions 
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus( dfFilterString )
.head 1 -  !
.head 1 +  Form Window: cjArtikelTable
.head 2 -  Class: CjCommandBars
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Komponente
.head 2 -  Icon File: Artikel.ico
.data RESOURCE 2 0 1 1333308764
0000: CE1E00005C140000 0000000000000000 0200C20001000300 0C00002000A81000
0020: 0000360000001818 3800000188092000 00DE100010103A00 016804000000661A
0040: 0000280008000020 0000400078000001 00A380100000FFFF 03F6F6F774E3E300
0060: E3FED0D1D0FFCCCD 00CCFFCCCCCDFFCC CD00CDFFD5D5D5FF ECEC00ECE6F6F6F6
0080: 270000FE00FFFFFF FFFFFFFFFFFF3FE7 EA00E81BC9DFCAF0 8AB8008BFF80AF81
00A0: FF7FAE2080FF80AE 8098B28098FFB5B5 B5FFCC02CCF3F3F3 A00000FE00FFFFFF
00C0: FFFFFFFFFFFF3FBC D800BB922E862FFF 297E8029FF287E28 FF2813297FFF2D88
00E0: 002CFF80A980FFC1 C100C1FFEEEEEED0 0000FE00FFFFFFFF FFFFFFFFFF3F73A8
0100: 0072D5277727FF25 77FE273F26770227 4D8E4FFFC0C0C8C0 FFEEEED0FE00FFFF
0120: FFFFFFFFFFFFFF3F 6BA7806BD8267827 FF260028FF257627 FF27740027FF2673
0140: 28FF26740028FF49 874AFFBDBC00BEFF E7E7E7D284848084 0C4545450C45CC45
0160: 0C450CCC450C450C CC450C450CCC450C 450CCC450C450CCC 450C450CCC450C45
0180: 0CCC450C450C0C45 0C450C7A7A007A0F B0B0B0056BA771D9 26787713205CFF02
01A0: 014001FF010001FF 016001FF00010100 C800FF0000FFCC00 FF00FFCC00FF00FF
01C0: CC00FF00FFCC00FF 00FFCC00FF00FFCC 00FF00FFCC00FF00 FFCC00FF00FFCC00
01E0: FF00FFCC00FF00FF 0000FFCCCCCC176B A7FF731F5C008C01 FF00FF00CC00FF00
0200: FFCC00FF00FFCC00 FF00FFCC00FF00FF CC00FF00FFCC00FF 00FFCC00FF00FFCC
0220: 00FF00FFCC00FF00 FFCC00FF00FFCC00 FF00FFCC00FF00FF 0000FF5252520C6B
0240: A7FF03247025FF1D 5A401FFF1E591FFF 5A001EFF3A6839FF 91910091FFAEAEAE
0260: DC5F5F005F464747 474547470C474547 4551510051455A5A 5A45606000604578
0280: 78784A7272007249 5C5C5C4552528852 4547474547804745 4F4F4F455A005A45
02A0: 5B5B5B4566660066 4574747448606000 6045535353454B4B 004B45545454036B
02C0: A7FFFB267F780026 FF498B4AFFC0BFCC C1FFEED0FE00FF03 E7E7E72E6E6E006E
02E0: 845B5B5BB6676700 67A0C1C1C1480000 FE003FF0F000F030 7575757D56560056
0300: B26A6A6AA9B6B600 B655C3C3C3010000 BE006B6F2777FF7F 78FE26CFEED0FE00
0320: 03A0A0A001DDDD00 DD6A252525EC0000 C800FF0000FF0000 FF080808FC9C9C80
0340: 9C7CC9C9C9040002 00E4E4E445353580 35EE000000FF000C 00FF00FF04040004
0360: FD8E8E8E90D3D3A8 D30900006B6F2777 FF7F78FE26CFEED0 FE0003AAAAAA0652
0380: 528052D4000000FF 00CC00FF00FF0C00 FF00FF0F0F000FFC DCDCDC2EF5F500F5
03A0: 026A6A6AB00000C8 00FF0000FFCC00FF 00FF0000FF090909 FCD1D1A0D1370000
03C0: 006B6F2777FF7F78 FE26CFEED0FE0003 8181810F09098009 FD000000FF00CC00
03E0: FF00FFCC00FF00FF 0000FFA3A3A37200 000200252525E900 00C800FF0000FFCC
0400: 00FF00FF0C00FF00 FF9595A095800000 006B6F2777FF7F78 FE26CFEED0FE0003
0420: 7D7D7D0F08088808 FD0000FF00CC00FF 00FFCC00FF00FF00 00FF9B9B9B6FCCCC
0440: 00CC01222222EA00 00C800FF0000FFCC 00FF00FF0C00FF00 FF8B8BA08B7C0000
0460: 006B6F2777FF7F78 FE26CFEED0FE0003 A9A9A90949498049 D2000000FF00CC00
0480: FF00FF0C00FF00FF 0C0C000CFBC2C2C2 2B00000200666666 BD0000C800FF0000
04A0: FFCC00FF00FF0000 FF060606FDC0C0A0 C03A0000006B6F27 77FF7F78FE26CFEE
04C0: D0FE003FC9C900C9 441D1D1DF30000C8 00FF0000FF0000FF 050505FE95950095
04E0: 8CBDBDBD02000002 00D9D9D93A2C2C80 2CF0000000FF000C 00FF00FF02020002
0500: FE8383839DCDCDA0 CD080000006B6F27 77FF7F78FE26CFEE D0FE003FC3C300C3
0520: 03CBCBCB2E606000 6099282828B93B3B 003BA6B7B7B761D7 D7E0D70500000003
0540: C1C1C103CFCF00CF 206B6B6B902A2A00 2AB73F3F3FABB1B1 80B16FD1D1D10500
0560: BE006B6F2777B325 77258F26FF250B49 49FFC0C0CCC1FFEE D0FE00FFFFFFFFFF
0580: FFFFFF3F8D8D008D 02B0B0B0046BA7BF 2603226723FF1334 C013FF123313FF03
05A0: 223C22FF53530053 FF676767E9373700 3798262626972626 CC26972697CC2697
05C0: 2697CC26972697CC 26972697CC269726 97CC26972697CC26 972697CC26972697
05E0: 0C26972697444400 44A2DBDBDB186BA7 FF7B1F018DFF00FF 00CC00FF00FFCC00
0600: FF00FFCC00FF00FF CC00FF00FFCC00FF 00FFCC00FF00FFCC 00FF00FFCC00FF00
0620: FFCC00FF00FFCC00 FF00FFCC00FF00FF CC00FF00FF8000FF 6464640C6BFF0322
0640: 6423FF0E240810FF 0E0EFF0E25000EFF 182B18FF3A3A003B FF474747EF212180
0660: 21B91C1C1CB91C80 1CB91B1B1BB91BCC 1BB91BB9CC1BB91B B9CC1BB91BB98C1B
0680: B91BB91C8C1CB91B B91BCC1BB91BB9CC 1BB91BB90C1BB91B B92C2C002CBFDADA
06A0: DA1B6BA7FFFB267F 786E264ABF03D8D8 D8DAA1A100A13DCB CBCB260000FE00FF
06C0: FFFF3FCCCC00CC1F 959595399D9D009D 3AC2C2C20D0000FE 00FFBF6B6F2777FF
06E0: 7F780226407F40FF 3F3D803FFF020202 FF000000FF111111 F88686008692C0C0
0700: C0060000FE00FF3F E9E900E90EB8B8B8 8922228022EF0000 00FF000000FF2F2F
0720: 2FE6C4C480C463B2 B2B20100FE00BF6B 6F2777FF2F272777 830C220DFF00C800
0740: FF0000FFCC00FF00 FF0000FE8C8C8C82 0000FE00FFBFC3C0 C353090909FDCC00
0760: FF00FF0C00FF00FF 17170017F6D6D6D6 350000FE00BF6BBF 26FE282F271F60E0
0780: 21FF010001C800FF 0000FFCC00FF00FF 0800FF2F2FE3E4E4 E8E4090000FF03A3
07A0: A3A30162628062C5 000000FF00CC00FF 00FFCC00FF00FF00 00FF696969990000
07C0: FE00BF6BBF26FE28 077628FF1A4F881B FF0000FF00CC00FF 00FFCC00FF00FF00
07E0: 00FF0C0C0CF9DDDD E0DD13000000FF03 9D9D9D033A3A883A D40000FF00CC00FF
0800: 00FFCC00FF00FF00 00FF393939AC0000 FE00BF6B7F77FB26 3776205E89FF0000
0820: FF00CC00FF00FFCC 00FF00FF0000FF27 2727E4C3C3E8C302 0000FF03A4A4A403
0840: 5D5D805DC0000000 FF00CC00FF00FFCC 00FF00FF0000FF62 6262950000FE00BF
0860: 6B7F77FB262F2727 7682270B1F0CFF00 C800FF0000FFCC00 FF00FF8000FF9696
0880: 969500FE00FF3FB3 B380B358070707FD 00C800FF0000FF0C 00FF00FF14148014
08A0: F7D3D3D34000FE00 BF6BBF26FE28EF27 02263E7D3EFF3736 8838FF0000FF0008
08C0: 00FF0C0CFB787880 7898F2F2F21000FE 00FF3FDFDF00DF07 A9A9A9761B1B801B
08E0: F2000000FF000000 FF282828EDB1B180 B15EB9B9B90200FE 00BF6BFFFE287F78
0900: 3A2649C2C200C4FF CDCDCDCF8D8D008D 44CCCCCC28C6C6E0 C603000000FFFFFF
0920: 03E2E2E204EBEB00 EB238282823C9D9D 009D3DEEEEEE1E00 00FE00FF3F70A970
0940: 6FD7267777FE27FF 02264C8D4DFFD5D4 00D5FFF5F5F58600 00FE00FFFFFFFFFF
0960: FFFFFFFF3FA0D000 9FAC2B862CFF267B 8028FF287B27FF28 3F2980002AFF89B8
0980: 86FDF3F200F2ABEA EAEA0E0000FE00FF FFFFFFFFFFFFFFFF 3FDDEE00DC1BA0DB
09A0: A1A972C50071D267 C268C868C202686A C26BC799D40099C1 EDF7EC3C0000FE00
09C0: FFFFFFFFFFFFFFFF FFFF3F803FE0FFFF 003FFF7F00FE007F 3E000F0300380201
09E0: 0038E8000100026E 00023C0C02010603 003FE1FC0000007F 0F00FC3F0003F00F
0A00: 00038701E00F007F 037F0750F83F003F FF3F07FFFFFF2800 1000001800003000
0A20: 60000001002000A3 60090000FF3F92B0 009329DBE4DCC8C0 CC00C0FEB9C5B9FF
0A40: BCC500BCFFC9CBC9 FFE8E800E8C2A0AC A0220000FE00FFFF FFFFFFFF3FBCD500
0A60: BC7E6AA66BFB5597 0055FE539654FF5B 99005BFE8CAA8CFE D1D100D1ED9EAB9F
0A80: 5B0000FE00FFFFFF FFFFFF3F6EA5006D D3277928FE257818 27FE25FF267A0027
0AA0: FE4D8E4EFECBCB00 CBF39DAA9D670000 FE00FFFFFFFFFFFF 3F599B205AE22677
0AC0: 2724710425FF571D FF1C56801EFF3061 31FF950096F68888 88933F3F803F4833
0AE0: 33334833CC334833 48CC33483348CC33 483348CC33483348 CC334833480C3348
0B00: 3348474700474A5A 5A5A19599B032577 27FE21620021FE01 0000FF0000C000FE
0B20: 000000FECC00FF00 FECC00FE00FFCC00 FE00FFCC00FE00FE CC00FE00FFCC00FE
0B40: 00FECC00FF00FECC 00FE00FF0000FE6B 6B6B4C599B3F236D 0024FE164317FF16
0B60: 430016FE264B25FE 72720072F8646464 AC39390039733535 3573393900397341
0B80: 4141734C4C004C74 5757577649498049 743B3B3B73350C35 7339734343004373
0BA0: 4848487354540054 75454545733B3B08 3B73393920599B1B 26FF2677FA282602
0BC0: 27408641FFCBCB80 CCF39BAB9C67003E 005E69005E0DA5A7 A54D4E4E004EAC48
0BE0: 4848C08181008185 4444441700000200 5252520CA7A700A7 6F4C4C4CB14B4B00
0C00: 4BC07A7A7A685555 A855130000591B25 FE2576A1FE267728 251026FE4086FECB
0C20: CA80CCF398A89867 003E006E76006E51 333333E000000800 FE0000FE02020002
0C40: FD61616193595900 590C8888885C1313 8013F8000000FE00 0000FE141414F08E
0C60: 8E008E725C5C5C07 599BAF2725FB26FE 268394A394670002 0049584903464880
0C80: 467F060606FC00C8 00FE0000FE0000FE 2F2F2FD76E6E006E 30333333A400008C
0CA0: 00FF00FE000C00FE 00FE53530053B54E 4E4E1B599B8B2627 FF26FA2826DA2740
0CC0: FF8392A092670002 004B574B035050C0 5080060606FCCC00 FF00FF0000FF2B2B
0CE0: 2BD6666600662F30 3030A70000C800FF 0000FF0C00FF00FF 4C4C004CB5494949
0D00: 1A599B8B2527FE25 AB262825DE26FE83 93A2936700020047 5647017E81007E47
0D20: 2D2D2DDD00000800 FE0000FE01010001 FE5A5A5A98525200 520B8282825C1010
0D40: 8010F9000000FE00 0000FE111111F285 8500857657575708 599B8B2627FF26FA
0D60: 2826DA2740FF8395 A59567003E00535F 0053099193914C3D 3D003DB8252525C3
0D80: 7373007395464646 1D00000200535353 0C909000906A3737 37BA2B2B002BC277
0DA0: 7777785555A05516 000000590B2527FE 24730026FE206621 FF20650021FE3772
0DC0: 37FEAEAE00AFF482 8F837E354B003625 3545362539430039 253C413C253C3C00
0DE0: 3C25343434252F2F 002F252E2E2E252D 2D882D252D2D252E 002E253030302532
0E00: 3280322533333325 3400342754545411 599B3F21660023FE 0A1A09FF08190009
0E20: FE0E1C0FFE2C2C00 2CFC272727DF1515 8015CB121212CB12 CC12CB12CBCC12CB
0E40: 12CBCC12CB12CBCC 12CB12CBCC12CB12 CB0C12CB12CB1A1A 001ACD8080804159
0E60: 9B3F226705FE1B0B FF0A1B000AFE101F 10FE2D2D002EFC26 2626DE15158015CA
0E80: 141414CA14CC14CA 14CACC14CA14CACC 14CA14CACC14CA14 CACC14CA14CA0C14
0EA0: CA14CA1A1A001ACC 95959545599B9B26 FF26FE2802273E84 3FFFA09F00A1F88D
0EC0: 8D8DA8939300935F 4151411B0000FE00 FF035A5A5A0B7979 00793A7C7C7C647F
0EE0: 7F007F617878782E 3A3AE83A060000BF 599B25FE259B26FF 260226265A26FE17
0F00: 170817FF0000FE06 060006FC4A4C4AA7 4D56E04D21000000 FF03B8B8B8553838
0F20: 0038DD040404FC05 050005FC424242CF 7F7FE07F3F000000 BF599FFE25032677
0F40: 27FF236E8024FE0B 1F0BFE008800FF00 00FE000800FE1111 F17F81807F685B5F
0F60: 5B0100FE00035C5C 5CBE01018801FE00 00FE000800FF0202 FD6464E0649F0000
0F80: 00BF59BB26263628 7620648022FF0614 07FF00C800FF0000 FF0800FF0404FC62
0FA0: 6400628156595603 00003E002E2E002E 02323232DB0000C8 00FF0000FF0C00FF
0FC0: 00FF3232E032BC00 0000BF599B25FE25 03267627FF247081 FE0C260DFE00C800
0FE0: FF0000FE0800FE17 17EE494EE0495E00 0000BF2E002E0166 6666A801018C01FE
1000: 00FE000800FF0505 FC7676E0768E0000 00BF59BF2581FE26 7727FF260026FE2E
1020: 692EFE1E1E881FFF 0000FE060006FC7A 7A7A918A91E88B18 0000FF036464643A
1040: 4A4A004AC6050505 FC07070007FB5353 53BA6A6AE06A2E00 00003F5A9B7A5A26
1060: 77FF7826FF40CA01 EEA6ABA67799A280 99233955390100FE 00FF3F838300830E
1080: 8383832893930093 277F7F7F0B0000FE 003F70AD006FD127 7B28FE26780027FE
10A0: 277927FF277A0227 599859FEE7E600E6 B290A390240000FE 00FFFFFFFFFFFF3F
10C0: BBDE00BA5F70BC71 CD59B00059D758B0 58D56BB7006BD2BE DDBD856585806520
10E0: 4A6D4A0100FE00FF FFFFFFFFFF7FFFFC FF00F7007FC02881 0000000080330080
1100: 00806300C08100FF 073E0700001E4407 000E07000C440700 1C07001E073F0F00
1120: 00FFBF2891001000 00206900012000A3 40040000FF3FBDCF 00BE5FAFC6AFFEA5
1140: BD80A6FFBBC2BBFF E8E0E8AB000000FF FFFFFF3F619F1060 D9267AFF267A0348
1160: 8D48FFD7D7E0D7E7 000000FFFFFFFF3F 488F1049EB2470FF 143A0014FF1C3F1D
1180: FF69680069F33232 32852222C8228522 2285CC22852285CC 22852285CC228522
11A0: 850022855E5E5E4A 488F01EC236E25FF 0F2C000FFF163015 FF4F4F004FF62929
11C0: 29A223230023A22A 2A2AA236360036A3 333333A326260026 A2252525A22D2D08
11E0: 2DA23636A22C2C00 2CA233333354488F 2326772826770337 8138FFD7D6ECD7E7
1200: 00038E908E613232 0032CE4C4C4CB84B 4B004B205C5C5C11 66660066A6303030
1220: D660600060785D5D 5D02488FBF26FB37 2F004F5D804F0516 1616F3000000FF00
1240: 0000FF63630063A6 3939396600008800 FF0000FF020002FE 7373732D488FBF26
1260: FB372F00656D8065 06141414F3000800 FF0000FF5A5A005A A53636366A000008
1280: 00FF0000FF010180 01FE6A6A6A2D48BF 26FB37EF00037D80 7D5A22220022D43D
12A0: 3D3DC14B4B004B24 5C5C5C0F59590059 A71A1A1AD85C5C80 5C835C5C5C024813
12C0: 2473FF1B55001CFF 285C29FF9A9A009A ED3443344B313A00 314B3438344B3434
12E0: 00344B2C2C2C4B2B 2B882B4B2B2B4B2C 002C4B2E2E2E4B2F 2F002F4B61616130
1300: 488F03236B24FF07 120007FF091409FF 20200020FB0F0F0F DC0D0DC80DDC0D0D
1320: DCCC0DDC0DDCCC0D DC0DDCCC0DDC0DDC 000DDC5A5A5A7948 8FBB262603357E35
1340: FF76750076F55F5F 5F964855E8482600 003F808000802560 606091636300638B
1360: 565656190000BE00 48BF268227143E15 FF000800FF0000FF 2E2E802ED8656A65
1380: 02003E004B4B884B C50000FF008000FF 555555B000BE0048 6F287682280E2B0E
13A0: FF000800FF0000FF 0C0C800CF65F645F 05000A002E2E0125 258025E4000000FF
13C0: 000000FF262626CF 0000BE00483F2677 0227256225FF0D0D 000EFF030303FE80
13E0: 80E0808F0000003F 6868006874060606 FB0A0A000AFA7474 746500003E00498F
1400: B04AEB2677262338 8138D6D680D6D46F 816F1B00FE003F43 4300430178787817
1420: 7E7EE87E1600003F 92C700929B499F4A E6489E0048E38EC0 8DBE92A7E8922E00
1440: 00FFFFFFFF3F07FF BC0000003F060091 0004000004D90006 003F01C320000000
1460: C300008338000001 03C738000007
.enddata
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  Allow Child Docking? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axCommandBars
.data CLASSPROPSSIZE
0000: 3901
.enddata
.data CLASSPROPS
0000: 4C69634B6579001A 0143006F006D006D 0061006E00640042 0061007200730020
0020: 0043006F006E0074 0072006F006C0020 0043006F00700079 0072006900670068
0040: 0074002000280063 0029002000320030 00300033002D0032 0030003000390020
0060: 0043006F00640065 006A006F0063006B 00200053006F0066 0074007700610072
0080: 0065000D000A0050 0052004F00440055 00430054002D0049 0044003A00200043
00A0: 006F00640065006A 006F0063006B002E 0043006F006D006D 0061006E00640042
00C0: 006100720073002E 0041006300740069 007600650058002E 007600310033002E
00E0: 0032000D000A0056 0041004C00490044 004100540045002D 0043004F00440045
0100: 003A002000510051 0053002D0050004E 0046002D004F004A 0056002D00560042
0120: 005800004C69634B 65794C656E000400 1A01000000000000 00
.enddata
.data RESOURCE 5 0 1 3759460269
0000: 000A000089020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000F627FCAD45 ED51460092246D9E
0100: 1B8702B9F8000000 0FD05BE589004A6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF01A0000 00FFFFFFFFFFFFFF FFAFFFFFFFFA0000 FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFAFFFFF FFFA0000FFFFFFFF FFF6FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0002000D00 7B020000EE7B006F
01C0: 0100FFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF0F32
01E0: 002E000245004507 2A0F0010188C9C02 2AA20209004C6900 6200A27261007279
0200: 0100540049004600 884400545600500E 61730065003E4C00 008A546F70004C22
0220: 657600656C00EA43 6F6EAB6F6C6CAA65 7250720A69760000 5500824941007500
0240: 74A26F6D006174AA 696F6E43AA6C6965 6E82740000580074 AA72656D652A2044
0260: 6F6300286B00696E 6700AB50616EAE65 4163AA74697665AA 5820436FAA6E7472
0280: 6F0A6C2031003300 2A2E312E3000E800 005874BA656D20AE 44636B
.enddata
.head 4 -  Class Child Ref Key: 10
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axDockingPane
.data CLASSPROPSSIZE
0000: 3D01
.enddata
.data CLASSPROPS
0000: 4C69634B6579001E 0144006F0063006B 0069006E00670020 00500061006E0065
0020: 007300200043006F 006E00740072006F 006C00200043006F 0070007900720069
0040: 0067006800740020 0028006300290020 0032003000300033 002D003200300030
0060: 003900200043006F 00640065006A006F 0063006B00200053 006F006600740077
0080: 006100720065000D 000A00500052004F 0044005500430054 002D00490044003A
00A0: 00200043006F0064 0065006A006F0063 006B002E0044006F 0063006B0069006E
00C0: 006700500061006E 0065002E00410063 0074006900760065 0058002E00760031
00E0: 0033002E0032000D 000A00560041004C 0049004400410054 0045002D0043004F
0100: 00440045003A0020 005500430059002D 004B004D0053002D 004300490049002D
0120: 004F004300460000 4C69634B65794C65 6E0004001E010000 0000000000
.enddata
.data RESOURCE 5 0 1 2534580657
0000: 000A0000D4020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 0000006D8DC0A886 C48B4200ABA244A6
0100: 05B84FA2F8000000 0FE0155824004B6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF0180000 00FFFFFFFFFFFFFF FFAFFFFFFFFA0000 FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFAFFFFF FFFA0000FFFFFFFF FFF6FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0002000D00 7B020000EE7B00F6
01C0: 0100206500730073 6900886200696C00 699A7479004A2061 007600615700AA65
01E0: 625374AA61727420 C031002E00300088 540079700065AA20 4C6962BA726179A0
0200: 00004700726FAA6F 766543226F6D006D 75008A6E69630061 AA74696F6EBA7353
0220: 612B75734100E26E 640043EB7472AA6C 536572AA76696365 AE736C7008680061
0240: 00006B002A69746C 5F00AA73657269AA 616C2031BF54AB70 6520EE4C622A6172
0260: 790000284E006574 4600B877005470FB 4CB80000476FAA6F 766520AA436C6965
0280: AE6E2031BF54BF20 AE4C62722E617900 00AE476F6FBE7643 AA6F6D706FAA6E65
02A0: 6E74EA732031EF54 AA7065204CBF618B 79000047AB6F6F76 BB5762AA466F726D
02C0: AA73546F6FBA6C53 72EA766963A00000 58007472AA656D65 20AA50726F70AB72
02E0: 7479BA204769
.enddata
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axImageManager
.data RESOURCE 5 0 1 526195220
0000: 000A0000EA020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000AA6CCEFEDB E14C4500BB619591
0100: 8BE6DF65F8000000 0F703E2B8A004A6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2160000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF0002000D007B 020000EE7B003402
01C0: 00009900D8000001 008203319E000000 D017800100008603 9D000000E005C000
01E0: 0000DB01000B0106 409F009846009900 016C0000039E8B00 088001FD00E00580
0200: 000000FFFFE0837F 0000000869000032 221F0000F0453C03 100DB803204F0070
0220: 007473000848006F 6C0064000331002E 003000A354007970 286500204C690088
0240: 6200726100728279 00004700728A6F6F 7600652B436F6D00 A26D75006E69A863
0260: 00617469AA6F6E73 20AA53657276AA69 636573A341006C70 A86800612054AB70
0280: 6520EE4C62AA6172 79203E310000A84D 006963722A6F736F 6600AA742048652E
02A0: 6C204400AA617461 20AE537276AF6573 FA2031BA205470EA 65204CAE62617222
02C0: 7900004F4900AA6E 666F20AA41637469 CA76655800AE436E 74AA726F6C20AA6D
02E0: 6F64758A6C650000 73AA63702031BF54 AB706520EE4C622E 61790000
.enddata
.head 4 -  Class Child Ref Key: 12
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classCreate
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call CjSetClient( SalCreateWindowEx( tblArtikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild ) )
.head 3 +  Function: classCreateClientDone
.head 4 -  Description: ShortcutBar Wechsel, Eintrag wurde erstmalig gewählt.

neues Clientfenster (Hauptarbeitsbereich) wurde erzeugt, hier kann ggf. noch der Ribbon nach dem Wechseln verändert werden
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nId = SHORTCUT.Artikel
.head 6 -  ! ga 20090928: pro Benutzer
.head 6 +  If GetProfileInt( 'Window', 'ArtikelLeseModus', 0, INI_DATEI_USER )
.head 7 -  Call LeseModus(  )
.head 6 +  If GetProfileInt( 'Window', 'ArtikelAlphabet', 0, INI_DATEI_USER )
.head 7 -  Call Alphabet( NUMBER_Null )
.head 3 +  ! Function: classCreateClientDone
.head 4 -  Description: ShortcutBar Wechsel, Eintrag wurde erstmalig gewählt.

neues Clientfenster (Hauptarbeitsbereich) wurde erzeugt, hier kann ggf. noch der Ribbon nach dem Wechseln verändert werden
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nId = SHORTCUT.Artikel
.head 6 -  ! ga 20090928: pro Benutzer
.head 6 +  If GetProfileInt( 'Window', 'ArtikelLeseModus', 0, INI_DATEI_USER )
.head 7 -  Call LeseModus(  )
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  Select Case ParamGetInt( p_nKey )
.head 7 +  Case ARTIKEL.AnsichtLeseModus
.head 8 -  Call LeseModus(  )
.head 8 -  Break
.head 7 +  Case ARTIKEL.AnsichtAlphabet
.head 8 -  Call Alphabet( NUMBER_Null )
.head 8 -  Break
.head 7 +  Case ARTIKEL.AnsichtAlphabetLinks
.head 8 -  Call Alphabet( DockingDirection.DockLeftOf )
.head 8 -  Break
.head 7 +  Case ARTIKEL.AnsichtAlphabetRechts
.head 8 -  Call Alphabet( DockingDirection.DockRightOf )
.head 8 -  Break
.head 7 +  Case ARTIKEL.AnsichtAlphabetOben
.head 8 -  Call Alphabet( DockingDirection.DockTopOf )
.head 8 -  Break
.head 7 +  Case ARTIKEL.AnsichtAlphabetUnten
.head 8 -  Call Alphabet( DockingDirection.DockBottomOf )
.head 8 -  Break
.head 5 +  If p_nKey = PARAM.ChangedArtikelNrLeseModus
.head 6 +  If IsParam( PARAM.ChangedArtikelNrLeseModus ) AND ( hWndLeseModus != hWndNULL ) AND ParamGetStr( PARAM.ChangedArtikelNrLeseModus ) 
.head 7 +  If Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = ' || ParamGetStr( PARAM.ChangedArtikelNrLeseModus ) )
.head 8 -  Call CjSetPaneTitle( 1, sGlobalTemp )
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  Select Case ParamGetInt( p_nKey )
.head 7 +  Case ARTIKEL.AnsichtLeseModus
.head 8 -  Call LeseModus(  )
.head 8 -  Break 
.head 5 +  If p_nKey = PARAM.ChangedArtikelNrLeseModus
.head 6 +  If IsParam( PARAM.ChangedArtikelNrLeseModus ) AND ( hWndLeseModus != hWndNULL ) AND ParamGetStr( PARAM.ChangedArtikelNrLeseModus ) 
.head 7 +  If Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = ' || ParamGetStr( PARAM.ChangedArtikelNrLeseModus ) )
.head 8 -  Call CjSetPaneTitle( 1, sGlobalTemp )
.head 3 +  Function: LeseModus
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If hWndLeseModus
.head 6 +  If hWndLeseModus.cjArtikel.CjCanClose(  )
.head 7 -  Call SalDestroyWindow( hWndLeseModus )
.head 7 -  Set hWndLeseModus = hWndNULL
.head 7 -  Call CjDestroyPane( 1 )
.head 7 -  Call CjSettings( TRUE, TRUE, FALSE )
.head 6 +  Else
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Set hWndLeseModus = SalCreateWindowEx( cjArtikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild, PARAM.ChangedArtikelNrLeseModus )
.head 6 -  Call CjCreatePane( 1, 'Artikel', 11.5, 5, DockingDirection.DockRightOf, 0, 0, hWndLeseModus )
.head 6 -  Call CjSettings( TRUE, TRUE, FALSE )
.head 6 -  Call CjSettings( FALSE, TRUE, FALSE )
.head 6 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, ParamGetInt( PARAM.ChangedArtikelNrLeseModus)  )
.head 5 -  ! ga 20090928: pro Benutzer
.head 5 -  Call SalSetProfileString( 'Window', 'ArtikelLeseModus', SalNumberToStrX( hWndLeseModus != hWndNULL, 0 ), INI_DATEI_USER )
.head 5 -  Call CjSetItemChecked( ARTIKEL.AnsichtLeseModus, ( hWndLeseModus != hWndNULL ) )
.head 3 +  Function: Alphabet
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Number: p_nDirection
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! enum DockingDirection
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If hWndAlphabet
.head 6 +  If ( p_nDirection != NUMBER_Null ) AND ( p_nDirection != nPrevDirection )
.head 7 -  Call CjDockPane( 2, 0.4, 0.333, p_nDirection, 0 )
.head 6 +  Else
.head 7 -  Call CjDestroyPane( 2 )
.head 7 -  Call SalDestroyWindow( hWndAlphabet )
.head 7 -  Set hWndAlphabet = hWndNULL
.head 6 -  Set nPrevDirection = p_nDirection
.head 6 -  Call CjSettings( TRUE, TRUE, FALSE )
.head 5 +  Else
.head 6 -  Set nPrevDirection = p_nDirection
.head 6 +  If NOT p_nDirection
.head 7 -  Set p_nDirection = DockingDirection.DockLeftOf
.head 6 -  Set hWndAlphabet = SalCreateWindowEx( _Alphabet, hWndForm, 0, 0, 0, 0, CREATE_AsChild, ARTIKEL.AnsichtAlphabet )
.head 6 -  Call CjCreatePane( 2, 'ABC', 0.4, 0.333, p_nDirection, 0, PaneOptions.PaneNoCaption | PaneOptions.PaneNoCloseable | PaneOptions.PaneNoFloatable | PaneOptions.PaneNoHideable, hWndAlphabet )
.head 6 -  Call CjSettings( TRUE, TRUE, FALSE )
.head 6 -  Call CjSettings( FALSE, TRUE, FALSE )
.head 5 -  Call SalSetProfileString( 'Window', 'ArtikelAlphabet', SalNumberToStrX( hWndAlphabet != hWndNULL, 0 ), INI_DATEI_USER )
.head 5 -  Call CjSetItemChecked( ARTIKEL.AnsichtAlphabet, ( hWndAlphabet != hWndNULL ) )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndLeseModus
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Window Handle: hWndAlphabet
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: nPrevDirection
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Message Actions
.head 1 +  Table Window: tblArtikel
.head 2 -  Class: StandardTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  13.288"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 3 -  Allow Child Docking? Class Default
.head 3 -  Docking Orientation: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.25"
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Data Field: dfStatus
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DataFieldLabel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 0.0"
.head 7 -  Top: 0.0"
.head 7 -  Width:  5.0"
.head 7 -  Width Editable? Class Default
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? No
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colAR_INTERN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Artikel
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  4.175"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_KURZBEZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KurzBez
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.388"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_MENGE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: g
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.713"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: #0
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_QUELLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Quelle
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.525"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAM_KURZBEZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ME
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.775"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_SBLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BLS
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_EK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: EK
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.725"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_DP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DP
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.725"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_VK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: VK
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.725"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_TAX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MWSt
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.725"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_PARAMETER1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sort
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.638"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Class Default
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_GESP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: gesp.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.638"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Class Default
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_GEPRUEFT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: gepr.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.638"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Class Default
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLO_TEXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Lagerort
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.775"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_MILCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MiKü
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.638"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Class Default
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Nr
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.763"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! ColShowOnly: colLI_KURZBEZ
.winattr class Column:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Lieferant
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.775"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  ! ColShowOnly: colAR_SB_NR
.winattr class Column:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SB
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values 
.head 4 -  Message Actions 
.head 3 +  Column: colAR_SB_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColUpdate_SB
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SB
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_UPDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Update
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: dd.MM.yyyy hhhh:mm
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAR_KU_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ColShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Küche
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.763"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: classNotify	! wl 20131227 mit Lieferant
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmpSBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nTmpAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  Select Case p_nKey
.head 6 +  Case PARAM.Execute	! Menüs
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Artikel
.head 9 -  Call OpenArtikel( colAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call OpenArtikel( NUMBER_Null )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.NeuAusBLS
.head 9 -  Set sTmpSBLS = oParamArtikel.GetFilterString(  )
.head 9 +  If SalModalDialog( dlgBLS, hWndForm, sTmpSBLS, 1 )
.head 10 -  Set nTmpAR_NR = NUMBER_Null
.head 10 +  If SalModalDialog( dlgRezFromBLS, hWndMain, sTmpSBLS, nTmpAR_NR, 1 )
.head 11 -  Call Refresh( colAR_NR, nTmpAR_NR,
	'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr LEFT OUTER JOIN lieferant ON li_nr = ar_li_nr', '' )
.head 11 -  Call OpenArtikel( nTmpAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Refresh
.head 9 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 9 -  Break 
.head 7 -  Break 
.head 6 +  Case PARAM.ChangedArtikelFilter
.head 7 +  If ParamGetData( p_nKey, oParamArtikel )
.head 8 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  Break 
.head 6 +  Case ARTIKEL.SpeichernDone
.head 7 -  Call Refresh( colAR_NR, ParamGetInt( p_nKey ), 'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr LEFT OUTER JOIN lieferant ON li_nr = ar_li_nr', '' )
.head 7 -  Break 
.head 3 +  Function: classNotify	! wl 20131109 mit NeuAusBLS
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmpSBLS
.head 5 -  Number: nTmpAR_NR
.head 4 +  Actions
.head 5 +  Select Case p_nKey
.head 6 +  Case PARAM.Execute	! Menüs
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Artikel
.head 9 -  Call OpenArtikel( colAR_NR )
.head 9 -  Break
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call OpenArtikel( NUMBER_Null )
.head 9 -  Break
.head 8 +  Case ARTIKEL.NeuAusBLS
.head 9 -  Set sTmpSBLS = oParamArtikel.GetFilterString(  )
.head 9 +  If SalModalDialog( dlgBLS, hWndForm, sTmpSBLS, 1 )
.head 10 -  Set nTmpAR_NR = NUMBER_Null
.head 10 +  If SalModalDialog( dlgRezFromBLS, hWndMain, sTmpSBLS, nTmpAR_NR, 1 )
.head 11 -  Call Refresh( colAR_NR, nTmpAR_NR,
	'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr', '' )
.head 11 -  Call OpenArtikel( nTmpAR_NR )
.head 9 -  Break
.head 8 +  Case ARTIKEL.Refresh
.head 9 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 9 -  Break
.head 7 -  Break
.head 6 +  Case PARAM.ChangedArtikelFilter
.head 7 +  If ParamGetData( p_nKey, oParamArtikel )
.head 8 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  Break
.head 6 +  Case ARTIKEL.SpeichernDone
.head 7 -  Call Refresh( colAR_NR, ParamGetInt( p_nKey ), 'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr', '' )
.head 7 -  Break
.head 3 +  ! Function: classNotify	! wl 20130306 mit Lagerort
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  Select Case p_nKey
.head 6 +  Case PARAM.Execute	! Menüs
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Artikel
.head 9 -  Call OpenArtikel( colAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call OpenArtikel( NUMBER_Null )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Refresh
.head 9 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 9 -  Break 
.head 7 -  Break 
.head 6 +  Case PARAM.ChangedArtikelFilter
.head 7 +  If ParamGetData( p_nKey, oParamArtikel )
.head 8 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  Break 
.head 6 +  Case ARTIKEL.SpeichernDone
.head 7 -  Call Refresh( colAR_NR, ParamGetInt( p_nKey ), 'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr', '' )
.head 7 -  Break 
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  Select Case p_nKey
.head 6 +  Case PARAM.Execute	! Menüs
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Artikel
.head 9 -  Call OpenArtikel( colAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call OpenArtikel( NUMBER_Null )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Refresh
.head 9 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 9 -  Break 
.head 7 -  Break 
.head 6 +  Case PARAM.ChangedArtikelFilter
.head 7 +  If ParamGetData( p_nKey, oParamArtikel )
.head 8 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  Break 
.head 6 +  Case ARTIKEL.SpeichernDone
.head 7 -  Call Refresh( colAR_NR, ParamGetInt( p_nKey ), 'artikel, artikelme', 'ar_am_nr = am_nr' )
.head 7 -  Break 
.head 3 +  Function: EnableDisable
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bDisabled
.head 4 +  Actions
.head 5 -  ! Call CjSetItemEnabled( PPL.KompErsetzen, TRUE )
.head 3 +  ! Function: cbChecked
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: p_nPos
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sValue
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Call ParamGet( PARAM.ChangedRezeptCheckBox, sValue)
.head 5 -  Return SalStrToNumber( SalStrMidX( sValue, p_nPos, 1 ) )
.head 3 +  ! Function: OnPopulate	! wl 20131223 mit Lieferant
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nCount
.head 4 +  Actions 
.head 5 -  ! ga 20100705: Mandant - färben von nicht editierbaren Artikeln
.head 5 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 6 -  Set nColorDisabled = COLOR_Blue
.head 5 +  Else 
.head 6 -  Set nColorDisabled = 0
.head 5 -  !
.head 5 +  If SalObjIsNull( oParamArtikel ) OR ( NOT oParamArtikel.IsFilter(  ) )
.head 6 -  Call SetNoData( TRUE, '', hWndNULL )
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call SetNoData( FALSE, '', hWndNULL )
.head 5 -  !
.head 5 +  If ConnectAll(  )
.head 6 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 7 -  Set sWhere = oParamArtikel.GetWhere( hWndForm ) 
.head 7 -  Call PopulateAndCount( hSql, 'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr LEFT OUTER JOIN lieferant ON li_nr = ar_li_nr', sWhere, 'ar_intern', TBL_FillAll, nCount )
.head 7 -  Set dfStatus = TranslateSubstNum( '%1 Zeilen gefunden', nCount )
.head 3 +  Function: OnPopulate	! th 20160802 mit left join und distinct
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sWhere
.head 5 -  Number: nCount
.head 5 -  String: sTable
.head 4 +  Actions
.head 5 -  ! ga 20100705: Mandant - färben von nicht editierbaren Artikeln
.head 5 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 6 -  Set nColorDisabled = COLOR_Blue
.head 5 +  Else
.head 6 -  Set nColorDisabled = 0
.head 5 -  !
.head 5 +  If SalObjIsNull( oParamArtikel ) OR ( NOT oParamArtikel.IsFilter(  ) )
.head 6 -  Call SetNoData( TRUE, '', hWndNULL )
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SetNoData( FALSE, '', hWndNULL )
.head 5 -  !
.head 5 +  If ConnectAll(  )
.head 6 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 7 -  Set sWhere = oParamArtikel.GetWhere( hWndForm ) 
.head 7 -  Set sTable = '      artikel 
	     JOIN artikelme          ON  ar_am_nr = am_nr 
           LEFT JOIN lagerort            ON         lo_nr = ar_lo_nr
           LEFT JOIN artikellieferart a ON a.al_ar_nr = ar_nr
           LEFT JOIN lieferartikel       ON         la_nr = al_la_nr'
.head 7 -  Call PopulateAndCountEx( hSql, sTable, sWhere, 'ar_intern', TBL_FillAll, nCount, TRUE )
.head 7 -  Set dfStatus = TranslateSubstNum( '%1 Zeilen gefunden', nCount )
.head 3 +  ! Function: OnPopulate	! th 20160801 left join raus!
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nCount
.head 5 -  String: sTable
.head 4 +  Actions 
.head 5 -  ! ga 20100705: Mandant - färben von nicht editierbaren Artikeln
.head 5 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 6 -  Set nColorDisabled = COLOR_Blue
.head 5 +  Else 
.head 6 -  Set nColorDisabled = 0
.head 5 -  !
.head 5 +  If SalObjIsNull( oParamArtikel ) OR ( NOT oParamArtikel.IsFilter(  ) )
.head 6 -  Call SetNoData( TRUE, '', hWndNULL )
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call SetNoData( FALSE, '', hWndNULL )
.head 5 -  !
.head 5 +  If ConnectAll(  )
.head 6 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 7 -  Set sWhere = oParamArtikel.GetWhere( hWndForm ) 
.head 7 -  Set sTable = '      artikel 
	     JOIN artikelme        ON ar_am_nr = am_nr 
           LEFT JOIN lagerort          ON        lo_nr = ar_lo_nr'
.head 7 -  Call PopulateAndCount( hSql, sTable, sWhere, 'ar_intern', TBL_FillAll, nCount )
.head 7 -  Set dfStatus = TranslateSubstNum( '%1 Zeilen gefunden', nCount )
.head 3 +  ! Function: OnPopulate	! th 20160721 left join auf artikellieferart und lieferartikel
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nCount
.head 5 -  String: sTable
.head 4 +  Actions 
.head 5 -  ! ga 20100705: Mandant - färben von nicht editierbaren Artikeln
.head 5 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 6 -  Set nColorDisabled = COLOR_Blue
.head 5 +  Else 
.head 6 -  Set nColorDisabled = 0
.head 5 -  !
.head 5 +  If SalObjIsNull( oParamArtikel ) OR ( NOT oParamArtikel.IsFilter(  ) )
.head 6 -  Call SetNoData( TRUE, '', hWndNULL )
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call SetNoData( FALSE, '', hWndNULL )
.head 5 -  !
.head 5 +  If ConnectAll(  )
.head 6 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 7 -  Set sWhere = oParamArtikel.GetWhere( hWndForm ) 
.head 7 -  Set sTable = '      artikel 
	     JOIN artikelme          ON  ar_am_nr = am_nr 
           LEFT JOIN lagerort            ON         lo_nr = ar_lo_nr
           LEFT JOIN artikellieferart a ON a.al_ar_nr = ar_nr
           LEFT JOIN lieferartikel       ON         la_nr = al_la_nr'
.head 7 -  Call PopulateAndCount( hSql, sTable, sWhere, 'ar_intern', TBL_FillAll, nCount )
.head 7 -  Set dfStatus = TranslateSubstNum( '%1 Zeilen gefunden', nCount )
.head 3 +  ! Function: OnPopulate	! wl 20130306 mit Lagerort
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nCount
.head 4 +  Actions 
.head 5 -  ! ga 20100705: Mandant - färben von nicht editierbaren Artikeln
.head 5 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 6 -  Set nColorDisabled = COLOR_Blue
.head 5 +  Else 
.head 6 -  Set nColorDisabled = 0
.head 5 -  !
.head 5 +  If SalObjIsNull( oParamArtikel ) OR ( NOT oParamArtikel.IsFilter(  ) )
.head 6 -  Call SetNoData( TRUE, '', hWndNULL )
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call SetNoData( FALSE, '', hWndNULL )
.head 5 -  !
.head 5 +  If ConnectAll(  )
.head 6 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 7 -  Set sWhere = oParamArtikel.GetWhere( hWndForm ) 
.head 7 -  Call PopulateAndCount( hSql, 'artikel JOIN artikelme ON ar_am_nr = am_nr LEFT OUTER JOIN lagerort ON lo_nr = ar_lo_nr', sWhere, 'ar_intern', TBL_FillAll, nCount )
.head 7 -  Set dfStatus = TranslateSubstNum( '%1 Zeilen gefunden', nCount )
.head 3 +  ! Function: OnPopulate
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nCount
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  ! ga 20100705: Mandant - färben von nicht editierbaren Artikeln
.head 5 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 6 -  Set nColorDisabled = COLOR_Blue
.head 5 +  Else 
.head 6 -  Set nColorDisabled = 0
.head 5 -  !
.head 5 +  If SalObjIsNull( oParamArtikel ) OR ( NOT oParamArtikel.IsFilter(  ) )
.head 6 -  Call SetNoData( TRUE, '', hWndNULL )
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 -  Call SetNoData( FALSE, '', hWndNULL )
.head 5 -  !
.head 5 +  If ConnectAll(  )
.head 6 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 7 -  Set sWhere = StrAppend( 'ar_am_nr = am_nr', ' AND ', oParamArtikel.GetWhere( hWndForm ) )
.head 7 -  Call PopulateAndCount( hSql, 'artikel, artikelme', sWhere, 'ar_intern', TBL_FillAll, nCount )
.head 7 -  Set dfStatus = TranslateSubstNum( '%1 Zeilen gefunden', nCount )
.head 3 +  Function: classPrint
.head 4 -  Description: ga 20100325: Tabelle wird gedruckt, hier kann ggf. noch zusätzliche Information mitgedruckt werden
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  FunctionalVar: p_oParams
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: fcMTblPrintParams
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSpacer = OBJ_Null
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: fcMTblPrintLine
.head 5 -  FunctionalVar: oLine = OBJ_Null
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: fcMTblPrintLine
.head 4 +  Actions
.head 5 -  Set sWhere = oParamArtikel.GetWhereUser( hWndForm, FALSE )
.head 5 +  If sWhere
.head 6 -  ! ga 20100325: ggf. aktiven Filter drucken
.head 6 -  Set oLine = new fcMTblPrintLine
.head 6 -  Call oLine.Init(  )
.head 6 -  Set oLine.LeftText = sWhere
.head 6 -  Call p_oParams.AddPageHeader( oLine )
.head 6 -  !
.head 6 -  ! Abstand
.head 6 -  Set oSpacer = new fcMTblPrintLine
.head 6 -  Call oSpacer.Init(  )
.head 6 -  Set oSpacer.CenterText = ' '
.head 6 -  Call p_oParams.AddPageHeader( oSpacer )
.head 3 -  !
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oParamArtikel = OBJ_Null
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class: cObjParamArtikel
.head 3 -  Number: nColorDisabled
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Message Actions
.head 3 +  On SAM_Create ! ga 20110512: erw. Filter
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 +  If ParamGetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 5 -  Call oParamArtikel.SetTable( hWndForm )
.head 3 +  On AM_POPULATE
.head 4 -  Call OnPopulate(  )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call OpenArtikel( colAR_NR )
.head 3 +  On SAM_Click
.head 4 -  Call SalTimerKill( hWndForm, SAM_Click )
.head 4 -  Call SalTimerSet( hWndForm, SAM_Click, 250 )
.head 3 +  On SAM_Timer
.head 4 +  If wParam = SAM_Click
.head 5 -  Call SalTimerKill( hWndForm, SAM_Click )
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  !
.head 5 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, colAR_NR )
.head 5 -  !
.head 5 -  Call SalWaitCursor( FALSE )
.head 3 +  ! On SAM_Click
.head 4 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, colAR_NR )
.head 3 +  On SAM_FetchRowDone
.head 4 +  If nColorDisabled AND ( colAR_KU_NR != nUserKuecheNrMandant )
.head 5 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 1 +  Form Window: cjArtikel
.head 2 -  Class: CjCommandBars
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File: Artikel.ico
.data RESOURCE 2 0 1 1333308764
0000: CE1E00005C140000 0000000000000000 0200C20001000300 0C00002000A81000
0020: 0000360000001818 3800000188092000 00DE100010103A00 016804000000661A
0040: 0000280008000020 0000400078000001 00A380100000FFFF 03F6F6F774E3E300
0060: E3FED0D1D0FFCCCD 00CCFFCCCCCDFFCC CD00CDFFD5D5D5FF ECEC00ECE6F6F6F6
0080: 270000FE00FFFFFF FFFFFFFFFFFF3FE7 EA00E81BC9DFCAF0 8AB8008BFF80AF81
00A0: FF7FAE2080FF80AE 8098B28098FFB5B5 B5FFCC02CCF3F3F3 A00000FE00FFFFFF
00C0: FFFFFFFFFFFF3FBC D800BB922E862FFF 297E8029FF287E28 FF2813297FFF2D88
00E0: 002CFF80A980FFC1 C100C1FFEEEEEED0 0000FE00FFFFFFFF FFFFFFFFFF3F73A8
0100: 0072D5277727FF25 77FE273F26770227 4D8E4FFFC0C0C8C0 FFEEEED0FE00FFFF
0120: FFFFFFFFFFFFFF3F 6BA7806BD8267827 FF260028FF257627 FF27740027FF2673
0140: 28FF26740028FF49 874AFFBDBC00BEFF E7E7E7D284848084 0C4545450C45CC45
0160: 0C450CCC450C450C CC450C450CCC450C 450CCC450C450CCC 450C450CCC450C45
0180: 0CCC450C450C0C45 0C450C7A7A007A0F B0B0B0056BA771D9 26787713205CFF02
01A0: 014001FF010001FF 016001FF00010100 C800FF0000FFCC00 FF00FFCC00FF00FF
01C0: CC00FF00FFCC00FF 00FFCC00FF00FFCC 00FF00FFCC00FF00 FFCC00FF00FFCC00
01E0: FF00FFCC00FF00FF 0000FFCCCCCC176B A7FF731F5C008C01 FF00FF00CC00FF00
0200: FFCC00FF00FFCC00 FF00FFCC00FF00FF CC00FF00FFCC00FF 00FFCC00FF00FFCC
0220: 00FF00FFCC00FF00 FFCC00FF00FFCC00 FF00FFCC00FF00FF 0000FF5252520C6B
0240: A7FF03247025FF1D 5A401FFF1E591FFF 5A001EFF3A6839FF 91910091FFAEAEAE
0260: DC5F5F005F464747 474547470C474547 4551510051455A5A 5A45606000604578
0280: 78784A7272007249 5C5C5C4552528852 4547474547804745 4F4F4F455A005A45
02A0: 5B5B5B4566660066 4574747448606000 6045535353454B4B 004B45545454036B
02C0: A7FFFB267F780026 FF498B4AFFC0BFCC C1FFEED0FE00FF03 E7E7E72E6E6E006E
02E0: 845B5B5BB6676700 67A0C1C1C1480000 FE003FF0F000F030 7575757D56560056
0300: B26A6A6AA9B6B600 B655C3C3C3010000 BE006B6F2777FF7F 78FE26CFEED0FE00
0320: 03A0A0A001DDDD00 DD6A252525EC0000 C800FF0000FF0000 FF080808FC9C9C80
0340: 9C7CC9C9C9040002 00E4E4E445353580 35EE000000FF000C 00FF00FF04040004
0360: FD8E8E8E90D3D3A8 D30900006B6F2777 FF7F78FE26CFEED0 FE0003AAAAAA0652
0380: 528052D4000000FF 00CC00FF00FF0C00 FF00FF0F0F000FFC DCDCDC2EF5F500F5
03A0: 026A6A6AB00000C8 00FF0000FFCC00FF 00FF0000FF090909 FCD1D1A0D1370000
03C0: 006B6F2777FF7F78 FE26CFEED0FE0003 8181810F09098009 FD000000FF00CC00
03E0: FF00FFCC00FF00FF 0000FFA3A3A37200 000200252525E900 00C800FF0000FFCC
0400: 00FF00FF0C00FF00 FF9595A095800000 006B6F2777FF7F78 FE26CFEED0FE0003
0420: 7D7D7D0F08088808 FD0000FF00CC00FF 00FFCC00FF00FF00 00FF9B9B9B6FCCCC
0440: 00CC01222222EA00 00C800FF0000FFCC 00FF00FF0C00FF00 FF8B8BA08B7C0000
0460: 006B6F2777FF7F78 FE26CFEED0FE0003 A9A9A90949498049 D2000000FF00CC00
0480: FF00FF0C00FF00FF 0C0C000CFBC2C2C2 2B00000200666666 BD0000C800FF0000
04A0: FFCC00FF00FF0000 FF060606FDC0C0A0 C03A0000006B6F27 77FF7F78FE26CFEE
04C0: D0FE003FC9C900C9 441D1D1DF30000C8 00FF0000FF0000FF 050505FE95950095
04E0: 8CBDBDBD02000002 00D9D9D93A2C2C80 2CF0000000FF000C 00FF00FF02020002
0500: FE8383839DCDCDA0 CD080000006B6F27 77FF7F78FE26CFEE D0FE003FC3C300C3
0520: 03CBCBCB2E606000 6099282828B93B3B 003BA6B7B7B761D7 D7E0D70500000003
0540: C1C1C103CFCF00CF 206B6B6B902A2A00 2AB73F3F3FABB1B1 80B16FD1D1D10500
0560: BE006B6F2777B325 77258F26FF250B49 49FFC0C0CCC1FFEE D0FE00FFFFFFFFFF
0580: FFFFFF3F8D8D008D 02B0B0B0046BA7BF 2603226723FF1334 C013FF123313FF03
05A0: 223C22FF53530053 FF676767E9373700 3798262626972626 CC26972697CC2697
05C0: 2697CC26972697CC 26972697CC269726 97CC26972697CC26 972697CC26972697
05E0: 0C26972697444400 44A2DBDBDB186BA7 FF7B1F018DFF00FF 00CC00FF00FFCC00
0600: FF00FFCC00FF00FF CC00FF00FFCC00FF 00FFCC00FF00FFCC 00FF00FFCC00FF00
0620: FFCC00FF00FFCC00 FF00FFCC00FF00FF CC00FF00FF8000FF 6464640C6BFF0322
0640: 6423FF0E240810FF 0E0EFF0E25000EFF 182B18FF3A3A003B FF474747EF212180
0660: 21B91C1C1CB91C80 1CB91B1B1BB91BCC 1BB91BB9CC1BB91B B9CC1BB91BB98C1B
0680: B91BB91C8C1CB91B B91BCC1BB91BB9CC 1BB91BB90C1BB91B B92C2C002CBFDADA
06A0: DA1B6BA7FFFB267F 786E264ABF03D8D8 D8DAA1A100A13DCB CBCB260000FE00FF
06C0: FFFF3FCCCC00CC1F 959595399D9D009D 3AC2C2C20D0000FE 00FFBF6B6F2777FF
06E0: 7F780226407F40FF 3F3D803FFF020202 FF000000FF111111 F88686008692C0C0
0700: C0060000FE00FF3F E9E900E90EB8B8B8 8922228022EF0000 00FF000000FF2F2F
0720: 2FE6C4C480C463B2 B2B20100FE00BF6B 6F2777FF2F272777 830C220DFF00C800
0740: FF0000FFCC00FF00 FF0000FE8C8C8C82 0000FE00FFBFC3C0 C353090909FDCC00
0760: FF00FF0C00FF00FF 17170017F6D6D6D6 350000FE00BF6BBF 26FE282F271F60E0
0780: 21FF010001C800FF 0000FFCC00FF00FF 0800FF2F2FE3E4E4 E8E4090000FF03A3
07A0: A3A30162628062C5 000000FF00CC00FF 00FFCC00FF00FF00 00FF696969990000
07C0: FE00BF6BBF26FE28 077628FF1A4F881B FF0000FF00CC00FF 00FFCC00FF00FF00
07E0: 00FF0C0C0CF9DDDD E0DD13000000FF03 9D9D9D033A3A883A D40000FF00CC00FF
0800: 00FFCC00FF00FF00 00FF393939AC0000 FE00BF6B7F77FB26 3776205E89FF0000
0820: FF00CC00FF00FFCC 00FF00FF0000FF27 2727E4C3C3E8C302 0000FF03A4A4A403
0840: 5D5D805DC0000000 FF00CC00FF00FFCC 00FF00FF0000FF62 6262950000FE00BF
0860: 6B7F77FB262F2727 7682270B1F0CFF00 C800FF0000FFCC00 FF00FF8000FF9696
0880: 969500FE00FF3FB3 B380B358070707FD 00C800FF0000FF0C 00FF00FF14148014
08A0: F7D3D3D34000FE00 BF6BBF26FE28EF27 02263E7D3EFF3736 8838FF0000FF0008
08C0: 00FF0C0CFB787880 7898F2F2F21000FE 00FF3FDFDF00DF07 A9A9A9761B1B801B
08E0: F2000000FF000000 FF282828EDB1B180 B15EB9B9B90200FE 00BF6BFFFE287F78
0900: 3A2649C2C200C4FF CDCDCDCF8D8D008D 44CCCCCC28C6C6E0 C603000000FFFFFF
0920: 03E2E2E204EBEB00 EB238282823C9D9D 009D3DEEEEEE1E00 00FE00FF3F70A970
0940: 6FD7267777FE27FF 02264C8D4DFFD5D4 00D5FFF5F5F58600 00FE00FFFFFFFFFF
0960: FFFFFFFF3FA0D000 9FAC2B862CFF267B 8028FF287B27FF28 3F2980002AFF89B8
0980: 86FDF3F200F2ABEA EAEA0E0000FE00FF FFFFFFFFFFFFFFFF 3FDDEE00DC1BA0DB
09A0: A1A972C50071D267 C268C868C202686A C26BC799D40099C1 EDF7EC3C0000FE00
09C0: FFFFFFFFFFFFFFFF FFFF3F803FE0FFFF 003FFF7F00FE007F 3E000F0300380201
09E0: 0038E8000100026E 00023C0C02010603 003FE1FC0000007F 0F00FC3F0003F00F
0A00: 00038701E00F007F 037F0750F83F003F FF3F07FFFFFF2800 1000001800003000
0A20: 60000001002000A3 60090000FF3F92B0 009329DBE4DCC8C0 CC00C0FEB9C5B9FF
0A40: BCC500BCFFC9CBC9 FFE8E800E8C2A0AC A0220000FE00FFFF FFFFFFFF3FBCD500
0A60: BC7E6AA66BFB5597 0055FE539654FF5B 99005BFE8CAA8CFE D1D100D1ED9EAB9F
0A80: 5B0000FE00FFFFFF FFFFFF3F6EA5006D D3277928FE257818 27FE25FF267A0027
0AA0: FE4D8E4EFECBCB00 CBF39DAA9D670000 FE00FFFFFFFFFFFF 3F599B205AE22677
0AC0: 2724710425FF571D FF1C56801EFF3061 31FF950096F68888 88933F3F803F4833
0AE0: 33334833CC334833 48CC33483348CC33 483348CC33483348 CC334833480C3348
0B00: 3348474700474A5A 5A5A19599B032577 27FE21620021FE01 0000FF0000C000FE
0B20: 000000FECC00FF00 FECC00FE00FFCC00 FE00FFCC00FE00FE CC00FE00FFCC00FE
0B40: 00FECC00FF00FECC 00FE00FF0000FE6B 6B6B4C599B3F236D 0024FE164317FF16
0B60: 430016FE264B25FE 72720072F8646464 AC39390039733535 3573393900397341
0B80: 4141734C4C004C74 5757577649498049 743B3B3B73350C35 7339734343004373
0BA0: 4848487354540054 75454545733B3B08 3B73393920599B1B 26FF2677FA282602
0BC0: 27408641FFCBCB80 CCF39BAB9C67003E 005E69005E0DA5A7 A54D4E4E004EAC48
0BE0: 4848C08181008185 4444441700000200 5252520CA7A700A7 6F4C4C4CB14B4B00
0C00: 4BC07A7A7A685555 A855130000591B25 FE2576A1FE267728 251026FE4086FECB
0C20: CA80CCF398A89867 003E006E76006E51 333333E000000800 FE0000FE02020002
0C40: FD61616193595900 590C8888885C1313 8013F8000000FE00 0000FE141414F08E
0C60: 8E008E725C5C5C07 599BAF2725FB26FE 268394A394670002 0049584903464880
0C80: 467F060606FC00C8 00FE0000FE0000FE 2F2F2FD76E6E006E 30333333A400008C
0CA0: 00FF00FE000C00FE 00FE53530053B54E 4E4E1B599B8B2627 FF26FA2826DA2740
0CC0: FF8392A092670002 004B574B035050C0 5080060606FCCC00 FF00FF0000FF2B2B
0CE0: 2BD6666600662F30 3030A70000C800FF 0000FF0C00FF00FF 4C4C004CB5494949
0D00: 1A599B8B2527FE25 AB262825DE26FE83 93A2936700020047 5647017E81007E47
0D20: 2D2D2DDD00000800 FE0000FE01010001 FE5A5A5A98525200 520B8282825C1010
0D40: 8010F9000000FE00 0000FE111111F285 8500857657575708 599B8B2627FF26FA
0D60: 2826DA2740FF8395 A59567003E00535F 0053099193914C3D 3D003DB8252525C3
0D80: 7373007395464646 1D00000200535353 0C909000906A3737 37BA2B2B002BC277
0DA0: 7777785555A05516 000000590B2527FE 24730026FE206621 FF20650021FE3772
0DC0: 37FEAEAE00AFF482 8F837E354B003625 3545362539430039 253C413C253C3C00
0DE0: 3C25343434252F2F 002F252E2E2E252D 2D882D252D2D252E 002E253030302532
0E00: 3280322533333325 3400342754545411 599B3F21660023FE 0A1A09FF08190009
0E20: FE0E1C0FFE2C2C00 2CFC272727DF1515 8015CB121212CB12 CC12CB12CBCC12CB
0E40: 12CBCC12CB12CBCC 12CB12CBCC12CB12 CB0C12CB12CB1A1A 001ACD8080804159
0E60: 9B3F226705FE1B0B FF0A1B000AFE101F 10FE2D2D002EFC26 2626DE15158015CA
0E80: 141414CA14CC14CA 14CACC14CA14CACC 14CA14CACC14CA14 CACC14CA14CA0C14
0EA0: CA14CA1A1A001ACC 95959545599B9B26 FF26FE2802273E84 3FFFA09F00A1F88D
0EC0: 8D8DA8939300935F 4151411B0000FE00 FF035A5A5A0B7979 00793A7C7C7C647F
0EE0: 7F007F617878782E 3A3AE83A060000BF 599B25FE259B26FF 260226265A26FE17
0F00: 170817FF0000FE06 060006FC4A4C4AA7 4D56E04D21000000 FF03B8B8B8553838
0F20: 0038DD040404FC05 050005FC424242CF 7F7FE07F3F000000 BF599FFE25032677
0F40: 27FF236E8024FE0B 1F0BFE008800FF00 00FE000800FE1111 F17F81807F685B5F
0F60: 5B0100FE00035C5C 5CBE01018801FE00 00FE000800FF0202 FD6464E0649F0000
0F80: 00BF59BB26263628 7620648022FF0614 07FF00C800FF0000 FF0800FF0404FC62
0FA0: 6400628156595603 00003E002E2E002E 02323232DB0000C8 00FF0000FF0C00FF
0FC0: 00FF3232E032BC00 0000BF599B25FE25 03267627FF247081 FE0C260DFE00C800
0FE0: FF0000FE0800FE17 17EE494EE0495E00 0000BF2E002E0166 6666A801018C01FE
1000: 00FE000800FF0505 FC7676E0768E0000 00BF59BF2581FE26 7727FF260026FE2E
1020: 692EFE1E1E881FFF 0000FE060006FC7A 7A7A918A91E88B18 0000FF036464643A
1040: 4A4A004AC6050505 FC07070007FB5353 53BA6A6AE06A2E00 00003F5A9B7A5A26
1060: 77FF7826FF40CA01 EEA6ABA67799A280 99233955390100FE 00FF3F838300830E
1080: 8383832893930093 277F7F7F0B0000FE 003F70AD006FD127 7B28FE26780027FE
10A0: 277927FF277A0227 599859FEE7E600E6 B290A390240000FE 00FFFFFFFFFFFF3F
10C0: BBDE00BA5F70BC71 CD59B00059D758B0 58D56BB7006BD2BE DDBD856585806520
10E0: 4A6D4A0100FE00FF FFFFFFFFFF7FFFFC FF00F7007FC02881 0000000080330080
1100: 00806300C08100FF 073E0700001E4407 000E07000C440700 1C07001E073F0F00
1120: 00FFBF2891001000 00206900012000A3 40040000FF3FBDCF 00BE5FAFC6AFFEA5
1140: BD80A6FFBBC2BBFF E8E0E8AB000000FF FFFFFF3F619F1060 D9267AFF267A0348
1160: 8D48FFD7D7E0D7E7 000000FFFFFFFF3F 488F1049EB2470FF 143A0014FF1C3F1D
1180: FF69680069F33232 32852222C8228522 2285CC22852285CC 22852285CC228522
11A0: 850022855E5E5E4A 488F01EC236E25FF 0F2C000FFF163015 FF4F4F004FF62929
11C0: 29A223230023A22A 2A2AA236360036A3 333333A326260026 A2252525A22D2D08
11E0: 2DA23636A22C2C00 2CA233333354488F 2326772826770337 8138FFD7D6ECD7E7
1200: 00038E908E613232 0032CE4C4C4CB84B 4B004B205C5C5C11 66660066A6303030
1220: D660600060785D5D 5D02488FBF26FB37 2F004F5D804F0516 1616F3000000FF00
1240: 0000FF63630063A6 3939396600008800 FF0000FF020002FE 7373732D488FBF26
1260: FB372F00656D8065 06141414F3000800 FF0000FF5A5A005A A53636366A000008
1280: 00FF0000FF010180 01FE6A6A6A2D48BF 26FB37EF00037D80 7D5A22220022D43D
12A0: 3D3DC14B4B004B24 5C5C5C0F59590059 A71A1A1AD85C5C80 5C835C5C5C024813
12C0: 2473FF1B55001CFF 285C29FF9A9A009A ED3443344B313A00 314B3438344B3434
12E0: 00344B2C2C2C4B2B 2B882B4B2B2B4B2C 002C4B2E2E2E4B2F 2F002F4B61616130
1300: 488F03236B24FF07 120007FF091409FF 20200020FB0F0F0F DC0D0DC80DDC0D0D
1320: DCCC0DDC0DDCCC0D DC0DDCCC0DDC0DDC 000DDC5A5A5A7948 8FBB262603357E35
1340: FF76750076F55F5F 5F964855E8482600 003F808000802560 606091636300638B
1360: 565656190000BE00 48BF268227143E15 FF000800FF0000FF 2E2E802ED8656A65
1380: 02003E004B4B884B C50000FF008000FF 555555B000BE0048 6F287682280E2B0E
13A0: FF000800FF0000FF 0C0C800CF65F645F 05000A002E2E0125 258025E4000000FF
13C0: 000000FF262626CF 0000BE00483F2677 0227256225FF0D0D 000EFF030303FE80
13E0: 80E0808F0000003F 6868006874060606 FB0A0A000AFA7474 746500003E00498F
1400: B04AEB2677262338 8138D6D680D6D46F 816F1B00FE003F43 4300430178787817
1420: 7E7EE87E1600003F 92C700929B499F4A E6489E0048E38EC0 8DBE92A7E8922E00
1440: 00FFFFFFFF3F07FF BC0000003F060091 0004000004D90006 003F01C320000000
1460: C300008338000001 03C738000007
.enddata
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? No
.head 3 -  Allow Child Docking? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: 0.825"
.head 4 -  Top: 0.906"
.head 4 -  Width:  11.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.5"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axCommandBars
.data CLASSPROPSSIZE
0000: 3901
.enddata
.data CLASSPROPS
0000: 4C69634B6579001A 0143006F006D006D 0061006E00640042 0061007200730020
0020: 0043006F006E0074 0072006F006C0020 0043006F00700079 0072006900670068
0040: 0074002000280063 0029002000320030 00300033002D0032 0030003000390020
0060: 0043006F00640065 006A006F0063006B 00200053006F0066 0074007700610072
0080: 0065000D000A0050 0052004F00440055 00430054002D0049 0044003A00200043
00A0: 006F00640065006A 006F0063006B002E 0043006F006D006D 0061006E00640042
00C0: 006100720073002E 0041006300740069 007600650058002E 007600310033002E
00E0: 0032000D000A0056 0041004C00490044 004100540045002D 0043004F00440045
0100: 003A002000510051 0053002D0050004E 0046002D004F004A 0056002D00560042
0120: 005800004C69634B 65794C656E000400 1A01000000000000 00
.enddata
.data RESOURCE 5 0 1 3759460269
0000: 000A000089020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000F627FCAD45 ED51460092246D9E
0100: 1B8702B9F8000000 0FD05BE589004A6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF01A0000 00FFFFFFFFFFFFFF FFAFFFFFFFFA0000 FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFAFFFFF FFFA0000FFFFFFFF FFF6FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0002000D00 7B020000EE7B006F
01C0: 0100FFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF0F32
01E0: 002E000245004507 2A0F0010188C9C02 2AA20209004C6900 6200A27261007279
0200: 0100540049004600 884400545600500E 61730065003E4C00 008A546F70004C22
0220: 657600656C00EA43 6F6EAB6F6C6CAA65 7250720A69760000 5500824941007500
0240: 74A26F6D006174AA 696F6E43AA6C6965 6E82740000580074 AA72656D652A2044
0260: 6F6300286B00696E 6700AB50616EAE65 4163AA74697665AA 5820436FAA6E7472
0280: 6F0A6C2031003300 2A2E312E3000E800 005874BA656D20AE 44636B
.enddata
.head 4 -  Class Child Ref Key: 10
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axDockingPane
.data CLASSPROPSSIZE
0000: 3D01
.enddata
.data CLASSPROPS
0000: 4C69634B6579001E 0144006F0063006B 0069006E00670020 00500061006E0065
0020: 007300200043006F 006E00740072006F 006C00200043006F 0070007900720069
0040: 0067006800740020 0028006300290020 0032003000300033 002D003200300030
0060: 003900200043006F 00640065006A006F 0063006B00200053 006F006600740077
0080: 006100720065000D 000A00500052004F 0044005500430054 002D00490044003A
00A0: 00200043006F0064 0065006A006F0063 006B002E0044006F 0063006B0069006E
00C0: 006700500061006E 0065002E00410063 0074006900760065 0058002E00760031
00E0: 0033002E0032000D 000A00560041004C 0049004400410054 0045002D0043004F
0100: 00440045003A0020 005500430059002D 004B004D0053002D 004300490049002D
0120: 004F004300460000 4C69634B65794C65 6E0004001E010000 0000000000
.enddata
.data RESOURCE 5 0 1 2534580657
0000: 000A0000D4020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 0000006D8DC0A886 C48B4200ABA244A6
0100: 05B84FA2F8000000 0FE0155824004B6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF0180000 00FFFFFFFFFFFFFF FFAFFFFFFFFA0000 FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFAFFFFF FFFA0000FFFFFFFF FFF6FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0002000D00 7B020000EE7B00F6
01C0: 0100206500730073 6900886200696C00 699A7479004A2061 007600615700AA65
01E0: 625374AA61727420 C031002E00300088 540079700065AA20 4C6962BA726179A0
0200: 00004700726FAA6F 766543226F6D006D 75008A6E69630061 AA74696F6EBA7353
0220: 612B75734100E26E 640043EB7472AA6C 536572AA76696365 AE736C7008680061
0240: 00006B002A69746C 5F00AA73657269AA 616C2031BF54AB70 6520EE4C622A6172
0260: 790000284E006574 4600B877005470FB 4CB80000476FAA6F 766520AA436C6965
0280: AE6E2031BF54BF20 AE4C62722E617900 00AE476F6FBE7643 AA6F6D706FAA6E65
02A0: 6E74EA732031EF54 AA7065204CBF618B 79000047AB6F6F76 BB5762AA466F726D
02C0: AA73546F6FBA6C53 72EA766963A00000 58007472AA656D65 20AA50726F70AB72
02E0: 7479BA204769
.enddata
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axImageManager
.data RESOURCE 5 0 1 526195220
0000: 000A0000EA020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000AA6CCEFEDB E14C4500BB619591
0100: 8BE6DF65F8000000 0F703E2B8A004A6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2160000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF0002000D007B 020000EE7B003402
01C0: 00009900D8000001 008203319E000000 D017800100008603 9D000000E005C000
01E0: 0000DB01000B0106 409F009846009900 016C0000039E8B00 088001FD00E00580
0200: 000000FFFFE0837F 0000000869000032 221F0000F0453C03 100DB803204F0070
0220: 007473000848006F 6C0064000331002E 003000A354007970 286500204C690088
0240: 6200726100728279 00004700728A6F6F 7600652B436F6D00 A26D75006E69A863
0260: 00617469AA6F6E73 20AA53657276AA69 636573A341006C70 A86800612054AB70
0280: 6520EE4C62AA6172 79203E310000A84D 006963722A6F736F 6600AA742048652E
02A0: 6C204400AA617461 20AE537276AF6573 FA2031BA205470EA 65204CAE62617222
02C0: 7900004F4900AA6E 666F20AA41637469 CA76655800AE436E 74AA726F6C20AA6D
02E0: 6F64758A6C650000 73AA63702031BF54 AB706520EE4C622E 61790000
.enddata
.head 4 -  Class Child Ref Key: 12
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If ParamGetInt(p_nKey) = ARTIKEL.Neu
.head 7 -  Call ClearPaneClients ()
.head 3 +  Function: classCreate	! th 20160802 Zuordnung niedriger
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: fcWinSave
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  !
.head 5 -  Set bLieferartikel = Benutzer.HatModul( MODUL.EINKAUF ) AND  Benutzer.HatRecht( REC_LIEFERARTIKEL )
.head 5 -  !
.head 5 +  Set hWndArtikel = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 6 -  ! hWndArtikel auch als Window-Variable (vgl. Komponente) 
.head 5 -  Call CjCreatePane( 1, Translate( 'Artikel' ), 10.5, 4, DockingDirection.DockLeftOf, 0, 0, hWndArtikel )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( cjArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, ARTIKEL.Taxierung, ARTIKEL.Herkunft , ARTIKEL.Zutaten ) )
.head 5 +  If bLieferartikel
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferartikel-Zuordnung' ), 8, 2.5, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  ! Call CjDockPane( 2, 0, 0, -1, 1 )
.head 5 -  ! Call CjActivatePane( 1 )
.head 5 -  !
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  ! ga 20131219: falls das Pane durch die Fenstereinstellungen ausgeblendet ist...
.head 5 +  If bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND NOT bVisible
.head 6 -  Call CjSetPaneVisible( 3, TRUE, FALSE )
.head 5 +  Else If NOT bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND bVisible
.head 6 -  Call CjDestroyPane( 3 )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, Translate('Löschen'), '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, Translate('Beenden'), '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, Translate('Speichern'), 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, Translate('Kopieren'), 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, Translate('in Rezeptur'), 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, Translate('in Sortiment'), 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, Translate('Taxierung'), 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Zutaten, Translate('Zutaten'), 'Zutaten', 'Ctrl+Shift+Z', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Herkunft, Translate('Herkunft'), 'Herkunft', 'Ctrl+Shift+H', FALSE, FALSE )
.head 5 -  !
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.UpdateLieferTax, Translate('Daten aus Lieferartikel'), 'Taxierung', '', FALSE, FALSE )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.Protokoll, Translate('Protokoll'), 'ArtProtokoll', 'Ctrl+Shift+P', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  ! Function: classCreate	! th 20151217: Artikel-Protokoll artlog
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  !
.head 5 -  Set bLieferartikel = Benutzer.HatModul( MODUL.EINKAUF ) AND  Benutzer.HatRecht( REC_LIEFERARTIKEL )
.head 5 -  !
.head 5 -  Set hWndArtikel = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, hWndArtikel )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, ARTIKEL.Taxierung, ARTIKEL.Herkunft , ARTIKEL.Zutaten ) )
.head 5 +  If bLieferartikel
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferartikel-Zuordnung' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  ! Call CjDockPane( 2, 0, 0, -1, 1 )
.head 5 -  ! Call CjActivatePane( 1 )
.head 5 -  !
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  ! ga 20131219: falls das Pane durch die Fenstereinstellungen ausgeblendet ist...
.head 5 +  If bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND NOT bVisible
.head 6 -  Call CjSetPaneVisible( 3, TRUE, FALSE )
.head 5 +  Else If NOT bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND bVisible
.head 6 -  Call CjDestroyPane( 3 )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, Translate('Löschen'), '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, Translate('Beenden'), '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, Translate('Speichern'), 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, Translate('Kopieren'), 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, Translate('in Rezeptur'), 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, Translate('in Sortiment'), 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, Translate('Taxierung'), 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Zutaten, Translate('Zutaten'), 'Zutaten', 'Ctrl+Shift+Z', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Herkunft, Translate('Herkunft'), 'Herkunft', 'Ctrl+Shift+H', FALSE, FALSE )
.head 5 -  !
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.UpdateLieferTax, Translate('Daten aus Lieferartikel'), 'Taxierung', '', FALSE, FALSE )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.Protokoll, Translate('Protokoll'), 'ArtProtokoll', 'Ctrl+Shift+P', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  ! Function: classCreate	! th 20151105: REC_STAMMDATEN_DEKLARATION bei CjAdd unnötig, da sichtbar aber disabled sein soll-> siehe frm enable/disable fkt
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  !
.head 5 -  Set bLieferartikel = Benutzer.HatModul( MODUL.EINKAUF ) AND  Benutzer.HatRecht( REC_LIEFERARTIKEL )
.head 5 -  !
.head 5 -  Set hWndArtikel = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, hWndArtikel )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, ARTIKEL.Taxierung, ARTIKEL.Herkunft , ARTIKEL.Zutaten ) )
.head 5 +  If bLieferartikel
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferartikel-Zuordnung' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  ! Call CjDockPane( 2, 0, 0, -1, 1 )
.head 5 -  ! Call CjActivatePane( 1 )
.head 5 -  !
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  ! ga 20131219: falls das Pane durch die Fenstereinstellungen ausgeblendet ist...
.head 5 +  If bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND NOT bVisible
.head 6 -  Call CjSetPaneVisible( 3, TRUE, FALSE )
.head 5 +  Else If NOT bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND bVisible
.head 6 -  Call CjDestroyPane( 3 )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, Translate('Löschen'), '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, Translate('Beenden'), '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, Translate('Speichern'), 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, Translate('Kopieren'), 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, Translate('in Rezeptur'), 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, Translate('in Sortiment'), 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, Translate('Taxierung'), 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Zutaten, Translate('Zutaten'), 'Zutaten', 'Ctrl+Shift+Z', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Herkunft, Translate('Herkunft'), 'Herkunft', 'Ctrl+Shift+H', FALSE, FALSE )
.head 5 -  !
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.UpdateLieferTax, Translate('Daten aus Lieferartikel'), 'Taxierung', '', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  ! Function: classCreate	! wl 20150626 Translate
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  !
.head 5 -  Set bLieferartikel = Benutzer.HatModul( MODUL.EINKAUF ) AND  Benutzer.HatRecht( REC_LIEFERARTIKEL )
.head 5 -  !
.head 5 -  Set hWndArtikel = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, hWndArtikel )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, ARTIKEL.Taxierung ) )
.head 5 +  If bLieferartikel
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferartikel' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  ! Call CjDockPane( 2, 0, 0, -1, 1 )
.head 5 -  ! Call CjActivatePane( 1 )
.head 5 -  !
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  ! ga 20131219: falls das Pane durch die Fenstereinstellungen ausgeblendet ist...
.head 5 +  If bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND NOT bVisible
.head 6 -  Call CjSetPaneVisible( 3, TRUE, FALSE )
.head 5 +  Else If NOT bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND bVisible
.head 6 -  Call CjDestroyPane( 3 )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, Translate('Löschen'), '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, Translate('Beenden'), '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, Translate('Speichern'), 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, Translate('Kopieren'), 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, Translate('in Rezeptur'), 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, Translate('in Sortiment'), 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, Translate('Taxierung'), 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.UpdateLieferTax, Translate('Taxierung aus Lieferartikel'), 'Taxierung', '', FALSE, TRUE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  ! Function: classCreate	! wl 20150217 Update LieferTax
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  !
.head 5 -  Set bLieferartikel = Benutzer.HatModul( MODUL.EINKAUF ) AND  Benutzer.HatRecht( REC_LIEFERARTIKEL )
.head 5 -  !
.head 5 -  Set hWndArtikel = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, hWndArtikel )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, ARTIKEL.Taxierung ) )
.head 5 +  If bLieferartikel
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferartikel' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  ! Call CjDockPane( 2, 0, 0, -1, 1 )
.head 5 -  ! Call CjActivatePane( 1 )
.head 5 -  !
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  ! ga 20131219: falls das Pane durch die Fenstereinstellungen ausgeblendet ist...
.head 5 +  If bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND NOT bVisible
.head 6 -  Call CjSetPaneVisible( 3, TRUE, FALSE )
.head 5 +  Else If NOT bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND bVisible
.head 6 -  Call CjDestroyPane( 3 )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, 'Löschen', '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, 'Beenden', '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, 'Speichern', 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, 'Kopieren', 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, 'in Rezeptur', 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, 'in Sortiment', 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, 'Taxierung', 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 6 -  Call oRibbonArtikel.AddButton( ARTIKEL.UpdateLieferTax, 'Taxierung aus Lieferartikel', 'Taxierung', '', FALSE, TRUE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  ! Function: classCreate	! wl 20131219 mit Lieferanten
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bLieferartikel
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  !
.head 5 -  Set bLieferartikel = Benutzer.HatModul( MODUL.EINKAUF ) AND  Benutzer.HatRecht( REC_LIEFERARTIKEL )
.head 5 -  !
.head 5 -  Set hWndArtikel = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, hWndArtikel )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, ARTIKEL.Taxierung ) )
.head 5 +  If bLieferartikel
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferartikel' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  ! Call CjDockPane( 2, 0, 0, -1, 1 )
.head 5 -  ! Call CjActivatePane( 1 )
.head 5 -  !
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  ! ga 20131219: falls das Pane durch die Fenstereinstellungen ausgeblendet ist...
.head 5 +  If bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND NOT bVisible
.head 6 -  Call CjSetPaneVisible( 3, TRUE, FALSE )
.head 5 +  Else If NOT bLieferartikel AND CjGetPaneVisible( 3, bVisible, bClosed ) AND bVisible
.head 6 -  Call CjDestroyPane( 3 )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, 'Löschen', '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, 'Beenden', '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, 'Speichern', 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, 'Kopieren', 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, 'in Rezeptur', 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, 'in Sortiment', 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, 'Taxierung', 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  ! Function: classCreate
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 4 +  Actions 
.head 5 -  ! ! Window Status / Größe
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( ARTIKEL.Delete, 'Löschen', '', '', TRUE, TRUE )
.head 5 -  Call oMenu.AddButton( FILE.Beenden, 'Beenden', '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Start\\Aktionen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Speichern, 'Speichern', 'Save', 'Ctrl+S', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Kopieren, 'Kopieren', 'Copy', 'Ctrl+K', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.KommtVor, 'in Rezeptur', 'KommtVor', 'Ctrl+Shift+R', FALSE, FALSE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Ersetzen, 'in Sortiment', 'KommtVor', 'Ctrl+Shift+S', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call oRibbonArtikel.AddPopup( 'Merkmale\\Zuordnungen', FALSE, TRUE )
.head 5 -  Call oRibbonArtikel.AddButton( ARTIKEL.Taxierung, 'Taxierung', 'Taxierung', 'Ctrl+T', FALSE, FALSE )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  Function: classClose ! ra 20140814 Speicherabfrage
.head 4 -  Description: Fenster soll geschlossen werden

Return TRUE, um zu schließen
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: oWinSave
.head 6 -  Class: fcWinSave
.head 4 +  Actions
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.WriteInitWinEx( hWndForm, FALSE )
.head 5 -  !
.head 5 -  Call hWndArtikel.frmREZ_Artikel.CjCanClose ( )
.head 5 -  Return TRUE
.head 3 +  ! Function: classClose
.head 4 -  Description: Fenster soll geschlossen werden

Return TRUE, um zu schließen
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oWinSave
.winattr class
.head 6 -  Class: fcWinSave
.end
.head 4 +  Actions 
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.WriteInitWinEx( hWndForm, FALSE )
.head 5 -  !
.head 5 -  Return TRUE
.head 3 +  Function: classCreateClient	! 2l 20131219 mit Lieferanten
.head 4 -  Description: ShortcutBar Wechsel, Eintrag wurde erstmalig gewählt.

neues Clientfenster (Hauptarbeitsbereich) erzeugen: "SalCreateWindowEx"

Ribbonbar Menü wird mitübergeben, Wechseln erfolgt dann automatisch
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nLeft
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nTop
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nWidth
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nHeight
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive Window Handle: r_hWndClient
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  FunctionalVar: r_oMenu
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: CjMenuItem
.head 6 -  ! Ribbonbar Menu
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Set r_hWndClient = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  ! Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, r_hWndClient )
.head 5 +  ! If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM ) )
.head 5 +  ! If Benutzer.HatModul( MODUL.LAGER )
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferanten' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  Set r_oMenu = oRibbonArtikel
.head 3 +  ! Function: classCreateClient
.head 4 -  Description: ShortcutBar Wechsel, Eintrag wurde erstmalig gewählt.

neues Clientfenster (Hauptarbeitsbereich) erzeugen: "SalCreateWindowEx"

Ribbonbar Menü wird mitübergeben, Wechseln erfolgt dann automatisch
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nLeft
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nTop
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nWidth
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nHeight
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive Window Handle: r_hWndClient
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  FunctionalVar: r_oMenu
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: CjMenuItem
.end
.head 6 -  ! Ribbonbar Menu
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set r_hWndClient = SalCreateWindowEx( frmREZ_Artikel, hWndForm, p_nLeft, p_nTop, p_nWidth, p_nHeight, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 +  If bInhalt
.head 6 -  Call CjCreatePane( 1, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM ) )
.head 5 -  Set r_oMenu = oRibbonArtikel
.head 3 +  Function: classExecute
.head 4 -  Description: Button oder Menü wurde angeklickt
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case p_nId
.head 6 +  Case FILE.Beenden
.head 7 +  If classClose()
.head 8 -  Call SalDestroyWindow( hWndForm )
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call ParamSetInt( PARAM.Execute, p_nId )
.head 7 -  Break
.head 2 +  Window Parameters
.head 3 -  Number: wp_nPARAM
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oMenu
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class: CjMenuItem
.head 3 -  FunctionalVar: oRibbonArtikel
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class: CjMenuItem
.head 3 -  Window Handle: hWndArtikel
.head 2 -  Message Actions
.head 1 +  Dialog Box: cjArtikelMerkmale
.head 2 -  Class: CjTaskPanel
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Merkmale
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Class Default
.head 3 -  Horizontal Scroll? Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axTaskPanel
.data CLASSPROPSSIZE
0000: 3101
.enddata
.data CLASSPROPS
0000: 4C69634B65790012 015400610073006B 00500061006E0065 006C00200043006F
0020: 006E00740072006F 006C00200043006F 0070007900720069 0067006800740020
0040: 0028006300290020 0032003000300033 002D003200300030 003900200043006F
0060: 00640065006A006F 0063006B00200053 006F006600740077 006100720065000D
0080: 000A00500052004F 0044005500430054 002D00490044003A 00200043006F0064
00A0: 0065006A006F0063 006B002E00540061 0073006B00500061 006E0065006C002E
00C0: 0041006300740069 007600650058002E 007600310033002E 0032000D000A0056
00E0: 0041004C00490044 004100540045002D 0043004F00440045 003A00200044004A
0100: 004E002D00540058 0041002D00530047 0058002D00450046 005900004C69634B
0120: 65794C656E000400 1201000000000000 00
.enddata
.data RESOURCE 5 0 1 3753798604
0000: 000A000012020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000456FBDEC05 73494E0087A1ABAE
0100: 1483BE7CF8000000 0F40047189004C6C CA0103000000F280 0000204A00450045
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2450000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF0002000D 0061020000084F03
01C0: 0040000000E80102 0000E90100002702 0000013300016400 FC0000FFFFFFFFFF
01E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0200: FFFFFFFFFFFFFFFF FFFFFFFFFFFF280C 00001A49000088FF A402684E9F02FA00
0220: 00FFFFFF
.enddata
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjTaskPanel
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classCreate ! ga 20140203: Lieferartikel
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: oColorSet
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: XtremeTaskPanel_ITaskPanelColorSet
.head 4 +  Actions
.head 5 -  Call CjSetTheme( XTPTaskPanelVisualTheme.xtpTaskPanelThemeOfficeXPPlain, FALSE )
.head 5 -  Set bZuatzstoffe =  Sql_FetchOne( hSql, 'SELECT * FROM taxierungsuntergr WHERE tu_zusatz >= 1' )
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  Call classNotify( hWndForm, wp_nPARAM )
.head 3 +  ! Function: classCreate
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  FunctionalVar: oColorSet
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: XtremeTaskPanel_ITaskPanelColorSet
.end
.head 4 +  Actions 
.head 5 -  Call CjSetTheme( XTPTaskPanelVisualTheme.xtpTaskPanelThemeOfficeXPPlain, FALSE )
.head 5 -  Set bZuatzstoffe =  Sql_FetchOne( hSql, 'SELECT * FROM taxierungsuntergr WHERE tu_zusatz = 1' )
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  Call classNotify( hWndForm, PARAM.ChangedArtikelNr )
.head 3 +  Function: classNotify ! th 20180614: Artikel.Neu
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = wp_nPARAM
.head 6 +  If ParamGetInt ( wp_nPARAM ) 
.head 7 -  Call ArtikelMerkmale( ParamGetInt ( wp_nPARAM ) )
.head 3 +  ! Function: classNotify ! ga 20140203: Lieferartikel
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = SalParentWindow( hWndForm )
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case LIEFERARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Default 
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If ParamGetInt ( wp_nPARAM ) 
.head 7 -  Call ArtikelMerkmale( ParamGetInt ( wp_nPARAM ) )
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = SalParentWindow( hWndForm )
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Default 
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If ParamGetInt ( wp_nPARAM ) 
.head 7 -  Call ArtikelMerkmale( ParamGetInt ( wp_nPARAM ) )
.head 3 -  !
.head 3 +  Function: ArtikelMerkmale ! th 20151104: Inhalte->"Nährwerte"; Prefix bei ArtikelInhalte weg weil überflüssig
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call LoadArtikel( p_nAR_NR )
.head 5 -  !
.head 5 -  Call ArtikelInhalte( 1, Translate( 'Nährwerte pro 100g' ), p_nAR_NR )
.head 5 -  ! nur wenn es auch Zusätze gibt
.head 5 +  If bZuatzstoffe
.head 6 -  Call ArtikelTaxierung( 2, p_nAR_NR)
.head 5 -  Call ArtikelZutaten(3,p_nAR_NR)
.head 5 -  Call ArtikelHerkunft(4, p_nAR_NR)
.head 3 +  ! Function: ArtikelMerkmale ! th 20151005: Herkunft inkludieren
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call LoadArtikel( p_nAR_NR )
.head 5 -  !
.head 5 -  Call ArtikelInhalte( 1, Translate( 'Inhalte pro 100g' ), p_nAR_NR, 'AR')
.head 5 -  ! nur wenn es auch Zusätze gibt
.head 5 +  If bZuatzstoffe
.head 6 -  Call ArtikelTaxierung( 2, p_nAR_NR)
.head 5 -  Call ArtikelZutaten(3,p_nAR_NR)
.head 5 -  Call ArtikelHerkunft(4, p_nAR_NR)
.head 3 +  ! Function: ArtikelMerkmale
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call LoadArtikel( p_nAR_NR )
.head 5 -  !
.head 5 -  Call ArtikelInhalte( 1, Translate( 'Inhalte pro 100g' ), p_nAR_NR, 'AR')
.head 5 -  ! nur wenn es auch Zusätze gibt
.head 5 +  If bZuatzstoffe
.head 6 -  Call ArtikelTaxierung( 2, p_nAR_NR)
.head 3 +  Function: ArtikelInhalte ! wl 20160821 Performance optimieren, dritte BLS Variante #238
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nGroup
.head 5 -  String: p_sGroupCaption
.head 5 -  Number: p_nNR
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSelect
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 5 -  Number: nBI_NACHKOMMA
.head 5 -  ! th 20151217
.head 5 -  String: sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sAR_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sAR_SBLS2
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bAR_CHECKSBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nNR
.head 6 -  Call Sql_ExecEx( hSql, 	'SELECT 
				ar_sbls, ar_sbls1, ar_sbls2, ar_checksbls1 
			FROM	artikel 
			INTO 
				:sAR_SBLS, :sAR_SBLS1, :sAR_SBLS2, :bAR_CHECKSBLS1
			WHERE 
				ar_nr = ' || NumberToStrX( p_nNR ), FALSE )
.head 6 +  If SqlFetchNext( hSql, nFetch)
.head 7 -  Set nFetch = 0
.head 7 -  Call Sql_Prepare( hSql, 		'SELECT
					ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1),
					@NULLVALUE( bi_nachkomma , 0 )
				FROM
					rezorder, blsinhalt JOIN blsgruppe ON bi_bg_nr = bg_nr
				INTO
					:sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR, :nBI_NACHKOMMA
				WHERE
					ro_inhalt = bi_inhalt AND bg_nr != 0
				ORDER BY
					ro_order' )
.head 7 -  Call SqlExecute( hSql )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 +  If nBI_NACHKOMMA > 3
.head 9 -  Set nBI_NACHKOMMA = 3
.head 8 +  Else If nBI_NACHKOMMA < 0
.head 9 -  Set nBI_NACHKOMMA = 0
.head 8 +  If bAR_CHECKSBLS1 = 2
.head 9 -  Set sGlobalTemp = sAR_SBLS2
.head 8 +  Else If bAR_CHECKSBLS1 = 1
.head 9 -  Set sGlobalTemp = sAR_SBLS1
.head 8 +  Else
.head 9 -  Set sGlobalTemp = sAR_SBLS
.head 8 -  Set nGlobalTemp = NUMBER_Null
.head 8 +  If sGlobalTemp != ''
.head 9 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls LIKE \''|| sGlobalTemp ||'%\'' )
.head 8 -  !
.head 8 -  ! Schranke je nach Anz.d. Nachkommastellen: 10^... x5 abschneiden
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= SalNumberPower( 10, - ( nBI_NACHKOMMA+1 ) ) * 5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="40" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || SalNumberToStrX( nGlobalTemp / nBI_FAKTOR, nBI_NACHKOMMA ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 7 +  If n = 0
.head 8 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte ! th 20160/"" wegen Leerstellen hinter zl.. sbls in blsdat LIKE
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.head 5 -  String: p_sGroupCaption
.head 5 -  Number: p_nNR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 5 -  Number: nBI_NACHKOMMA
.head 5 -  ! th 20151217
.head 5 -  String: sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sAR_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bAR_CHECKSBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nNR
.head 6 -  Call Sql_ExecEx( hSql, 	'SELECT 
				ar_sbls, ar_sbls1, ar_checksbls1 
			FROM	artikel 
			INTO 
				:sAR_SBLS, :sAR_SBLS1, :bAR_CHECKSBLS1
			WHERE 
				ar_nr = ' || NumberToStrX( p_nNR ), FALSE )
.head 6 +  If SqlFetchNext( hSql, nFetch)
.head 7 -  Set nFetch = 0
.head 7 -  Call Sql_Prepare( hSql, 		'SELECT
					ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1),
					@NULLVALUE( bi_nachkomma , 0 )
				FROM
					rezorder, blsinhalt
				INTO
					:sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR, :nBI_NACHKOMMA
				WHERE
					ro_inhalt = bi_inhalt
				ORDER BY
					ro_order' )
.head 7 -  Call SqlExecute( hSql )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 +  If nBI_NACHKOMMA > 3
.head 9 -  Set nBI_NACHKOMMA = 3
.head 8 +  Else If nBI_NACHKOMMA < 0
.head 9 -  Set nBI_NACHKOMMA = 0
.head 8 +  If bAR_CHECKSBLS1
.head 9 -  Set sGlobalTemp = sAR_SBLS1
.head 8 +  Else 
.head 9 -  Set sGlobalTemp = sAR_SBLS
.head 8 -  Set nGlobalTemp = NUMBER_Null
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls LIKE \''|| sGlobalTemp ||'%\'' )
.head 8 -  !
.head 8 -  ! Schranke je nach Anz.d. Nachkommastellen: 10^... x5 abschneiden
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= SalNumberPower( 10, - ( nBI_NACHKOMMA+1 ) ) * 5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="40" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || SalNumberToStrX( nGlobalTemp / nBI_FAKTOR, nBI_NACHKOMMA ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 8 +  If n = 0
.head 9 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte ! th 20160310: ar_sbls IS NOT NULL  raus!
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.head 5 -  String: p_sGroupCaption
.head 5 -  Number: p_nNR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 5 -  Number: nBI_NACHKOMMA
.head 5 -  ! th 20151217
.head 5 -  String: sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sAR_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bAR_CHECKSBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nNR
.head 6 -  Call Sql_ExecEx( hSql, 	'SELECT 
				ar_sbls, ar_sbls1, ar_checksbls1 
			FROM	artikel 
			INTO 
				:sAR_SBLS, :sAR_SBLS1, :bAR_CHECKSBLS1
			WHERE 
				ar_nr = ' || NumberToStrX( p_nNR ), FALSE )
.head 6 +  If SqlFetchNext( hSql, nFetch)
.head 7 -  Set nFetch = 0
.head 7 -  Call Sql_Prepare( hSql, 		'SELECT
					ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1),
					@NULLVALUE( bi_nachkomma , 0 )
				FROM
					rezorder, blsinhalt
				INTO
					:sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR, :nBI_NACHKOMMA
				WHERE
					ro_inhalt = bi_inhalt
				ORDER BY
					ro_order' )
.head 7 -  Call SqlExecute( hSql )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 +  If nBI_NACHKOMMA > 3
.head 9 -  Set nBI_NACHKOMMA = 3
.head 8 +  Else If nBI_NACHKOMMA < 0
.head 9 -  Set nBI_NACHKOMMA = 0
.head 8 +  If bAR_CHECKSBLS1
.head 9 -  Set sGlobalTemp = sAR_SBLS1
.head 8 +  Else 
.head 9 -  Set sGlobalTemp = sAR_SBLS
.head 8 -  Set nGlobalTemp = NUMBER_Null
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls = :sGlobalTemp ' )
.head 8 -  !
.head 8 -  ! Schranke je nach Anz.d. Nachkommastellen: 10^... x5 abschneiden
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= SalNumberPower( 10, - ( nBI_NACHKOMMA+1 ) ) * 5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="40" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || SalNumberToStrX( nGlobalTemp / nBI_FAKTOR, nBI_NACHKOMMA ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 8 +  If n = 0
.head 9 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte ! th 20151217: 'Variable reference problem' behoben
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.head 5 -  String: p_sGroupCaption
.head 5 -  Number: p_nNR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 5 -  Number: nBI_NACHKOMMA
.head 5 -  ! th 20151217
.head 5 -  String: sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sAR_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bAR_CHECKSBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nNR
.head 6 -  Call Sql_ExecEx( hSql, 	'SELECT 
				ar_sbls, ar_sbls1, ar_checksbls1 
			FROM	artikel 
			INTO 
				:sAR_SBLS, :sAR_SBLS1, :bAR_CHECKSBLS1
			WHERE 
				ar_sbls IS NOT NULL 
				AND  ar_nr = ' || NumberToStrX( p_nNR ), FALSE )
.head 6 +  If SqlFetchNext( hSql, nFetch)
.head 7 -  Set nFetch = 0
.head 7 -  Call Sql_Prepare( hSql, 		'SELECT
					ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1),
					@NULLVALUE( bi_nachkomma , 0 )
				FROM
					rezorder, blsinhalt
				INTO
					:sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR, :nBI_NACHKOMMA
				WHERE
					ro_inhalt = bi_inhalt
				ORDER BY
					ro_order' )
.head 7 -  Call SqlExecute( hSql )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 +  If nBI_NACHKOMMA > 3
.head 9 -  Set nBI_NACHKOMMA = 3
.head 8 +  Else If nBI_NACHKOMMA < 0
.head 9 -  Set nBI_NACHKOMMA = 0
.head 8 +  If bAR_CHECKSBLS1
.head 9 -  Set sGlobalTemp = sAR_SBLS1
.head 8 +  Else 
.head 9 -  Set sGlobalTemp = sAR_SBLS
.head 8 -  Set nGlobalTemp = NUMBER_Null
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls = :sGlobalTemp ' )
.head 8 -  !
.head 8 -  ! Schranke je nach Anz.d. Nachkommastellen: 10^... x5 abschneiden
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= SalNumberPower( 10, - ( nBI_NACHKOMMA+1 ) ) * 5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="40" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || SalNumberToStrX( nGlobalTemp / nBI_FAKTOR, nBI_NACHKOMMA ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 8 +  If n = 0
.head 9 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte ! th 20151123: ar_sbls oder ar_sbls1 nehmen abhängig von ar_checksbls
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.head 5 -  String: p_sGroupCaption
.head 5 -  Number: p_nNR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 5 -  Number: nBI_NACHKOMMA
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nNR
.head 6 +  If Sql_FetchOne( hSql, 	'SELECT 
				ar_sbls, ar_sbls1, ar_checksbls1 
			FROM	artikel 
			INTO 
				:dlgArtikelMerkmale.sAR_SBLS, :dlgArtikelMerkmale.sAR_SBLS1, :dlgArtikelMerkmale.bAR_CHECKSBLS1
			WHERE 
				ar_sbls IS NOT NULL 
				AND  ar_nr = ' || NumberToStrX( p_nNR ) )
.head 7 -  Call Sql_Prepare( hSql, 		'SELECT
					ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1),
					@NULLVALUE( bi_nachkomma , 0 )
				FROM
					rezorder, blsinhalt
				INTO
					:sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR, :nBI_NACHKOMMA
				WHERE
					ro_inhalt = bi_inhalt
				ORDER BY
					ro_order' )
.head 7 -  Call SqlExecute( hSql )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 +  If nBI_NACHKOMMA > 3
.head 9 -  Set nBI_NACHKOMMA = 3
.head 8 +  Else If nBI_NACHKOMMA < 0
.head 9 -  Set nBI_NACHKOMMA = 0
.head 8 +  If bAR_CHECKSBLS1
.head 9 -  Set sGlobalTemp = sAR_SBLS1
.head 8 +  Else 
.head 9 -  Set sGlobalTemp = sAR_SBLS
.head 8 -  Set nGlobalTemp = NUMBER_Null
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls = :sGlobalTemp ' )
.head 8 -  !
.head 8 -  ! Schranke je nach Anz.d. Nachkommastellen: 10^... x5 abschneiden
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= SalNumberPower( 10, - ( nBI_NACHKOMMA+1 ) ) * 5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="40" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || SalNumberToStrX( nGlobalTemp / nBI_FAKTOR, nBI_NACHKOMMA ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 8 +  If n = 0
.head 9 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte ! th 20150817 verallgem. Anzeige der Inhalte im TaskPanel
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.head 5 -  String: p_sGroupCaption
.head 5 -  Number: p_nNR
.head 5 -  String: p_Prefix ! zB LA, AR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 5 -  Number: nBI_NACHKOMMA
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nNR
.head 6 +  If Sql_FetchOne( hSql, 	'SELECT '
				|| p_Prefix || '_sbls FROM artikel INTO :sGlobalTemp
			WHERE '
				|| p_Prefix || '_sbls IS NOT NULL AND ' || p_Prefix || '_nr = ' || NumberToStrX( p_nNR ) )
.head 7 -  Call Sql_ExecAndCommit( hSql, 	'SELECT
					ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1),
					@NULLVALUE( bi_nachkomma , 0 )
				FROM
					rezorder, blsinhalt
				INTO
					:sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR, :nBI_NACHKOMMA
				WHERE
					ro_inhalt = bi_inhalt
				ORDER BY
					ro_order' )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 +  If nBI_NACHKOMMA > 3
.head 9 -  Set nBI_NACHKOMMA = 3
.head 8 +  Else If nBI_NACHKOMMA < 0
.head 9 -  Set nBI_NACHKOMMA = 0
.head 8 -  Set nGlobalTemp = NUMBER_Null
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls = :sGlobalTemp' )
.head 8 -  !
.head 8 -  ! Schranke je nach Anz.d. Nachkommastellen: 10^... x5 abschneiden
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= SalNumberPower( 10, - ( nBI_NACHKOMMA+1 ) ) * 5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="40" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || SalNumberToStrX( nGlobalTemp / nBI_FAKTOR, nBI_NACHKOMMA ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 8 +  If n = 0
.head 9 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte ! ga 20110921: doch ohne Druckprofile in Rezorder
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sGroupCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nAR_NR
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel INTO :sGlobalTemp 
WHERE ar_sbls IS NOT NULL AND ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 7 -  Call Sql_ExecAndCommit( hSql, 'SELECT ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1) 
FROM rezorder, blsinhalt
INTO :sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR
WHERE ro_inhalt = bi_inhalt
order by ro_order' )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls = :sGlobalTemp' )
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= 0.5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="30" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || NumberToStrX( nGlobalTemp / nBI_FAKTOR ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 7 +  If n = 0
.head 8 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  ! Function: ArtikelInhalte
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroup
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sGroupCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nFetch
.head 5 -  String: sInhalt
.head 5 -  Number: nMENGE
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: n
.head 5 -  String: sCaption
.head 5 -  Number: nBI_FAKTOR
.head 5 -  String: sBI_KURZBEZ_ME
.head 4 +  Actions 
.head 5 -  Call CjDelete( p_nGroup,TRUE )
.head 5 +  If p_nAR_NR
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel INTO :sGlobalTemp 
WHERE ar_sbls IS NOT NULL AND ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 7 -  Call Sql_ExecAndCommit( hSql, 'SELECT ro_inhalt, bi_kurzbez || \' \' || @NULLVALUE(bi_me,\'\'), @NULLVALUE(bi_faktor, 1) 
FROM rezorder, blsinhalt
INTO :sInhalt, :sBI_KURZBEZ_ME, :nBI_FAKTOR
WHERE ro_inhalt = bi_inhalt 
order by ro_order' )
.head 7 -  Set n = 0
.head 7 -  Call CjAddGroup( p_nGroup, p_sGroupCaption, '' )
.head 7 +  While SqlFetchNext( hSql, nFetch )
.head 8 -  Call Sql_FetchOne( hSqlSub, 'SELECT ' || sInhalt || ' FROM blsdat INTO :nGlobalTemp WHERE sbls = :sGlobalTemp' )
.head 8 +  If nGlobalTemp / nBI_FAKTOR >= 0.5
.head 9 -  Set n = n + 1
.head 9 -  Set sCaption = '<StackPanel Orientation="Horizontal">
 <TextBlock Width="30" TextAlignment="Right" Margin="0,0,10,0"  FontWeight="Bold">' || NumberToStrX( nGlobalTemp / nBI_FAKTOR ) || '</TextBlock>
 <TextBlock Width="50" >' || sBI_KURZBEZ_ME  || '</TextBlock>
</StackPanel>'
.head 9 -  Call CjAddGroupItem( n, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 7 +  If n = 0
.head 8 -  Call CjDelete( p_nGroup,TRUE )
.head 3 +  Function: ArtikelTaxierung ! th 20171211 Tu_sort
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: nAT_ART
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sTU_BEZEICHNUNG
.head 5 -  Number: nTU_ZUSATZ
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sListReichAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sListArmAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bGroup
.head 4 +  Actions
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  !
.head 5 -  ! ga 20110523: bei Artikel ist dzt. nur "reich an" vorgesehen (-> Zusätze)
.head 5 -  Set sStmt = 'SELECT
		at_art, tu_bezeichnung, tu_zusatz
	INTO
		:nAT_ART, :sTU_BEZEICHNUNG, :nTU_ZUSATZ
	FROM
		artikeltaxierung, taxierungsuntergr
	WHERE
		tu_nr = at_tu_nr AND
		at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	ORDER BY
		tu_sort, at_art, tu_bezeichnung'
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 -  Call SqlGetResultSetCount( hSql, nGlobalTemp )
.head 5 +  If nGlobalTemp
.head 6 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 6 +  While bOk AND SqlFetchNext( hSql, nInd )
.head 7 -  ! Set sListReichAn = StrAppend( sListReichAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 7 +  Select Case nTU_ZUSATZ
.head 8 +  Case 0 ! Komponententax
.head 9 -  ! Rot weil falsch hier
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock Foreground="#FF0000">' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break
.head 8 +  Case 1 ! Artikeltax
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break
.head 8 +  Case 2 ! Lieferartikeltax
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock Foreground="'|| Color_LaTax_HexStr ||'">' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break
.head 7 +  If NOT bGroup
.head 8 -  Set bGroup = TRUE
.head 5 -  !
.head 5 +  ! If sListReichAn
.head 6 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || sListReichAn || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListReichAn
.head 6 -  Set sListReichAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'reich an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListReichAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListReichAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListArmAn
.head 6 -  Set sListArmAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'arm an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListArmAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListArmAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  If IsEditable(  )
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroupItem( wp_nTaxierungItemId, Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 +  ! Function: ArtikelTaxierung ! th 20160630 tu_zusatz statt ar_art und farb-rgb-konstanten
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: nAT_ART
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sTU_BEZEICHNUNG
.head 5 -  Number: nTU_ZUSATZ
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sListReichAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sListArmAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bGroup
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  !
.head 5 -  ! ga 20110523: bei Artikel ist dzt. nur "reich an" vorgesehen (-> Zusätze)
.head 5 -  Set sStmt = 'SELECT
		at_art, tu_bezeichnung, tu_zusatz
	INTO
		:nAT_ART, :sTU_BEZEICHNUNG, :nTU_ZUSATZ
	FROM
		artikeltaxierung, taxierungsuntergr
	WHERE
		tu_nr = at_tu_nr AND
		at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	ORDER BY
		at_art, tu_bezeichnung'
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 -  Call SqlGetResultSetCount( hSql, nGlobalTemp )
.head 5 +  If nGlobalTemp
.head 6 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 6 +  While bOk AND SqlFetchNext( hSql, nInd )
.head 7 -  ! Set sListReichAn = StrAppend( sListReichAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 7 +  Select Case nTU_ZUSATZ
.head 8 +  Case 0 ! Komponententax
.head 9 -  ! Rot weil falsch hier
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock Foreground="#FF0000">' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break 
.head 8 +  Case 1 ! Artikeltax
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break 
.head 8 +  Case 2 ! Lieferartikeltax
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock Foreground="'|| Color_LaTax_HexStr ||'">' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break 
.head 7 +  If NOT bGroup
.head 8 -  Set bGroup = TRUE
.head 5 -  !
.head 5 +  ! If sListReichAn
.head 6 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || sListReichAn || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListReichAn
.head 6 -  Set sListReichAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'reich an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListReichAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListReichAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListArmAn
.head 6 -  Set sListArmAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'arm an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListArmAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListArmAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  If IsEditable(  )
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroupItem( wp_nTaxierungItemId, Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 +  ! Function: ArtikelTaxierung ! wl 20150216 Liefeartikel in blau
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: nAT_ART
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sTU_BEZEICHNUNG
.head 5 -  !
.head 5 -  String: sListReichAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sListArmAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bGroup
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  !
.head 5 -  ! ga 20110523: bei Artikel ist dzt. nur "reich an" vorgesehen (-> Zusätze)
.head 5 -  Set sStmt = 'SELECT
		at_art, tu_bezeichnung
	INTO
		:nAT_ART, :sTU_BEZEICHNUNG
	FROM
		artikeltaxierung, taxierungsuntergr
	WHERE
		tu_nr = at_tu_nr AND
		at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	ORDER BY
		at_art, tu_bezeichnung'
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 -  Call SqlGetResultSetCount( hSql, nGlobalTemp )
.head 5 +  If nGlobalTemp
.head 6 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 6 +  While bOk AND SqlFetchNext( hSql, nInd )
.head 7 -  ! Set sListReichAn = StrAppend( sListReichAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 7 +  Select Case nAT_ART
.head 8 +  Case 1 ! Artikeltax
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break 
.head 8 +  Case 2 ! Lieferartikeltax
.head 9 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock Foreground="#20B8F5">' || StringToXaml( sTU_BEZEICHNUNG )  || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 9 -  Break 
.head 7 +  If NOT bGroup
.head 8 -  Set bGroup = TRUE
.head 5 -  !
.head 5 +  ! If sListReichAn
.head 6 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || sListReichAn || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListReichAn
.head 6 -  Set sListReichAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'reich an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListReichAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListReichAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListArmAn
.head 6 -  Set sListArmAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'arm an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListArmAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListArmAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  If IsEditable(  )
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroupItem( wp_nTaxierungItemId, Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 -  !
.head 3 -  ! th 20151002: Herkunft + Zutaten für Etikettendruck: statt Reiter-> analog zu zB Taxierungen
.head 3 +  Function: ArtikelHerkunft ! th 20151104: Anzeige von Recht "Stammdaten-Deklaration" abh.
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sAR_HERKUNFT
.head 5 -  !
.head 5 -  Boolean: bGroup
.head 4 +  Actions
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Set sStmt = 'SELECT
		ar_herkunft
	FROM
		artikel
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	INTO
		:sAR_HERKUNFT '
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  If bOk AND SqlFetchNext(hSql, nInd) 
.head 6 +  If sAR_HERKUNFT != ''
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Herkunft' ), '' )
.head 7 -  Call CjAddGroupItem( p_nGroupId , sAR_HERKUNFT , XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 7 +  If Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION ) 
.head 8 -  Call CjAddGroupItem( wp_nAr_HerkunftId , Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 6 +  Else
.head 7 +  If Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION ) 
.head 8 -  Call CjAddGroup( p_nGroupId, Translate( 'Herkunft' ), '' )
.head 8 -  Call CjAddGroupItem( wp_nAr_HerkunftId , Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 7 +  Else
.head 8 -  Return FALSE
.head 3 +  ! Function: ArtikelHerkunft
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sAR_HERKUNFT
.head 5 -  !
.head 5 -  Boolean: bGroup
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  Call CjAddGroup( p_nGroupId, Translate( 'Herkunft' ), '' )
.head 5 -  !
.head 5 -  Set sStmt = 'SELECT
		ar_herkunft
	FROM
		artikel
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	INTO
		:sAR_HERKUNFT '
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  If bOk AND SqlFetchNext(hSql, nInd) AND sAR_HERKUNFT != ''
.head 6 -  Call CjAddGroupItem( p_nGroupId , sAR_HERKUNFT , XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! If IsEditable(  )
.head 5 -  Call CjAddGroupItem( wp_nAr_HerkunftId , Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 +  Function: ArtikelZutaten ! th 20151104: Anzeige von Recht "Stammdaten-Deklaration" abh.
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Long String: lsAR_ZUTATEN
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Boolean: bGroup
.head 4 +  Actions
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  !
.head 5 -  Set sStmt = 'SELECT
		ar_zutaten
	INTO
		:lsAR_ZUTATEN
	FROM
		artikel
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 +  If bOk AND SqlFetchNext(hSql, nInd)
.head 6 +  If lsAR_ZUTATEN != ''
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Zutaten' ), '' )
.head 7 -  Call CjAddGroupItem( p_nGroupId ,  lsAR_ZUTATEN  , XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 7 +  If Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION ) 
.head 8 -  Call CjAddGroupItem( wp_nAr_ZutatenId , Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 6 +  Else
.head 7 +  If Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION ) 
.head 8 -  Call CjAddGroup( p_nGroupId, Translate( 'Zutaten' ), '' )
.head 8 -  Call CjAddGroupItem( wp_nAr_ZutatenId , Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 7 +  Else
.head 8 -  Return FALSE
.head 3 +  ! Function: ArtikelZutaten
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Long String: lsAR_ZUTATEN
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Boolean: bGroup
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  Call CjAddGroup( p_nGroupId, Translate( 'Zutaten' ), '' )
.head 5 -  !
.head 5 -  Set sStmt = 'SELECT
		ar_zutaten
	INTO
		:lsAR_ZUTATEN
	FROM
		artikel
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  If bOk AND SqlFetchNext(hSql, nInd) AND lsAR_ZUTATEN != ''
.head 6 -  Call CjAddGroupItem( p_nGroupId ,  lsAR_ZUTATEN  , XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! If IsEditable(  )
.head 5 -  Call CjAddGroupItem( wp_nAr_ZutatenId , Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 +  ! Function: ArtikelTaxierung ! ga 20140203: Lieferartikel
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: nAT_ART
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sTU_BEZEICHNUNG
.head 5 -  !
.head 5 -  String: sListReichAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sListArmAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bGroup
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  !
.head 5 -  ! ga 20110523: bei Artikel ist dzt. nur "reich an" vorgesehen (-> Zusätze)
.head 5 -  Set sStmt = 'SELECT
		at_art, tu_bezeichnung
	INTO
		:nAT_ART, :sTU_BEZEICHNUNG
	FROM
		artikeltaxierung, taxierungsuntergr
	WHERE
		tu_nr = at_tu_nr AND
		(at_art = 0 OR at_art = 1) AND
		at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	ORDER BY
		at_art, tu_bezeichnung'
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  While bOk AND SqlFetchNext( hSql, nInd )
.head 6 +  Select Case nAT_ART
.head 7 +  Case 1 ! reich an
.head 8 -  Set sListReichAn = StrAppend( sListReichAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 8 -  Break 
.head 7 +  ! Case 0 ! arm an
.head 8 -  Set sListArmAn = StrAppend( sListArmAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 8 -  Break 
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 5 -  !
.head 5 +  If sListReichAn
.head 6 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || sListReichAn || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListReichAn
.head 6 -  Set sListReichAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'reich an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListReichAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListReichAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListArmAn
.head 6 -  Set sListArmAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'arm an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListArmAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListArmAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  If IsEditable(  )
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroupItem( wp_nTaxierungItemId, Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 +  ! Function: ArtikelTaxierung ! ga 20110523
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nGroupId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Number: nAT_ART
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sTU_BEZEICHNUNG
.head 5 -  !
.head 5 -  String: sListReichAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sListArmAn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bGroup
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Call CjDelete( p_nGroupId,TRUE )
.head 5 -  !
.head 5 -  ! ga 20110523: bei Artikel ist dzt. nur "reich an" vorgesehen (-> Zusätze)
.head 5 -  Set sStmt = 'SELECT
		at_art, tu_bezeichnung
	INTO
		:nAT_ART, :sTU_BEZEICHNUNG
	FROM
		artikeltaxierung, taxierungsuntergr
	WHERE
		tu_nr = at_tu_nr AND
		(at_art = 0 OR at_art = 1) AND
		at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || '
	ORDER BY
		at_art, tu_bezeichnung'
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  While bOk AND SqlFetchNext( hSql, nInd )
.head 6 +  Select Case nAT_ART
.head 7 +  Case 1 ! reich an
.head 8 -  Set sListReichAn = StrAppend( sListReichAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 8 -  Break 
.head 7 +  ! Case 0 ! arm an
.head 8 -  Set sListArmAn = StrAppend( sListArmAn, '<LineBreak/>', StringToXaml( sTU_BEZEICHNUNG ) )
.head 8 -  Break 
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 5 -  !
.head 5 +  If sListReichAn
.head 6 -  Call CjAddGroupItem( p_nGroupId, '<TextBlock>' || sListReichAn || '</TextBlock>', XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListReichAn
.head 6 -  Set sListReichAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'reich an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListReichAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListReichAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  ! If sListArmAn
.head 6 -  Set sListArmAn = '<StackPanel>
		<TextBlock><Bold>' || Translate( 'arm an' ) || '</Bold></TextBlock>
		<TextBlock Margin="16,0,0,0">' || sListArmAn || '</TextBlock>
	</StackPanel>'
.head 6 -  Call CjAddGroupItem( p_nGroupId, sListArmAn, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 +  If IsEditable(  )
.head 6 +  If NOT bGroup
.head 7 -  Call CjAddGroup( p_nGroupId, Translate( 'Taxierung' ), '' )
.head 7 -  Set bGroup = TRUE
.head 6 -  Call CjAddGroupItem( ARTIKEL.Taxierung, Translate( 'bearbeiten...' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 3 +  Function: classItemClick ! th 20151006: Herkunft+Zutaten bearbeiten
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If ( p_nId = wp_nTaxierungItemId ) OR ( p_nId = wp_nAr_HerkunftId ) OR ( p_nId = wp_nAr_ZutatenId )
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick ! ga 20140203: Lieferartikel, OpenArtikel entfernt
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nId = wp_nTaxierungItemId
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sCaption
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nGroup
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nGroupItem
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nId = ARTIKEL.Taxierung
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 5 +  Else 
.head 6 -  Set nGroup = SalNumberLow( p_nId )
.head 6 -  Set nGroupItem = SalNumberHigh( p_nId )
.head 6 +  Select Case nGroup
.head 7 +  Case 5
.head 8 +  If nGroupItem >= 0
.head 9 -  Call OpenArtikel( 0)
.head 8 -  Break 
.head 3 +  Function: IsEditable
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return nAR_KU_NR = nUserKuecheNrMandant AND Benutzer.HatRecht( REC_ARTIKEL )
.head 3 +  Function: LoadArtikel
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bOk
.head 5 -  !
.head 5 -  String: sStmt
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Set bOk = TRUE
.head 5 -  !
.head 5 -  Set nAR_KU_NR = NUMBER_Null
.head 5 -  !
.head 5 -  Set sStmt = 'SELECT
		ar_ku_nr
	INTO
		:nAR_KU_NR
	FROM
		artikel
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 -  Set bOk = bOk AND SqlFetchNext( hSql, nInd )
.head 5 -  !
.head 5 -  Return bOk
.head 2 +  Window Parameters
.head 3 -  Number: wp_nPARAM
.data INHERITPROPS
0000: 0100
.enddata
.head 3 +  Number: wp_nTaxierungItemId
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! ARTIKEL.Taxierung oder LIEFERARTIKEL.Taxierung
.head 3 -  !
.head 3 -  Number: wp_nAr_HerkunftId
.head 3 -  Number: wp_nAr_ZutatenId
.head 2 +  Window Variables
.head 3 -  Number: nAR_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Boolean: bZuatzstoffe
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Message Actions
.head 1 -  ! !
.head 1 +  ! FormMain: frmREZ_ArtikelOld
.winattr class Form Window:
.head 2 -  Class: FormMain
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? No
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: 4.113"
.head 4 -  Top: 0.979"
.head 4 -  Width:  9.138"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.271"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: 
.head 2 -  Named Menus 
.head 2 -  Menu 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: 0.385"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 7 +  If NOT ( nUserLevel > 1 OR Benutzer.HatRecht( REC_ARTIKEL ) )
.head 8 -  Call SalDisableWindow( hWndItem )
.head 4 +  Pushbutton: pbSearch
.winattr
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: search.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On AM_FETCH
.head 7 +  If SalSendMsg( hWndForm, AM_CAN_UPDATE, 0, 0 )
.head 8 -  Call SalSendClassMessage( AM_FETCH, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 7 +  If NOT ( nUserLevel > 1 OR Benutzer.HatRecht( REC_ARTIKEL ) )
.head 8 -  Call SalDisableWindow( hWndItem )
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 2.05"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbFirst
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 2.75"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: FIRST.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrev
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 3.15"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: PREV.BMP
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbNext
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 4.5"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: NEXT.BMP
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbLast
.winattr
.head 5 -  Class Child Ref Key: 10
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 4.9"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: LAST.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: dfRecord
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 3.588"
.head 7 -  Top: 0.094"
.head 7 -  Width:  0.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  ! ToolbarCopy: pbCopy
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 +  If NOT ( nUserLevel > 1 OR Benutzer.HatRecht( REC_ARTIKEL ) )
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 -  Call ToolTip( 'Artikel kopieren' )
.head 6 +  On SAM_Click
.head 7 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?',
'Kopieren', MB_YesNo )
.head 8 -  Call CopyArtikel( 'ARTIKEL' )
.head 4 +  Data Field: dfAR_NR
.winattr
.head 5 -  Class Child Ref Key: 6
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 5.788"
.head 7 -  Top: -0.01"
.head 7 -  Width:  1.413"
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 +  Message Actions 
.head 6 +  On AM_SETKEY
.head 7 -  Call SalSendClassMessage( AM_SETKEY, 0, 0 )
.head 7 -  Set d1AR_NR = dfAR_NR
.head 4 +  Pushbutton: pbResultList
.winattr
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 5.35"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: AUSWAHL.BMP
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Set hWndResultList= SalCreateWindow( dlgART_Result, hWndForm)
.head 4 +  ! ToolbarNavigator: pb13
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbRezeptur
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ToolbarRezepte
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 6.488"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: rezeptopen24m.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull( d1AR_NR )
.head 8 -  Call SalModalDialog( dlgART_InREZ, frmREZ_Artikel, d1AR_NR )
.head 6 +  On SAM_Create
.head 7 -  Call ToolTip( 'Rezepturen mit diesem Artikel' )
.head 4 +  Pushbutton: pbChangeSort
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ToolbarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 6.938"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: searchReplace.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull( d1AR_NR )
.head 8 -  Call SalModalDialog( dlgART_InSort, frmREZ_Artikel, d1AR_NR )
.head 6 +  On SAM_Create
.head 7 -  Call ToolTip( 'Sortimente mit diesem Artikel' )
.head 4 +  Data Field: dfAR_SB_NR
.winattr
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 6.488"
.head 7 -  Top: -0.01"
.head 7 -  Width:  0.638"
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Data Field: dfAR_UPDATE
.winattr
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMain
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 6.688"
.head 7 -  Top: 0.156"
.head 7 -  Width:  0.638"
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 -  Group Box: Komponente
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 0.073"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Intern
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.344"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: d1AR_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldKeyShow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.988"
.head 6 -  Top: 0.281"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 -  On AM_UPDATE
.head 5 +  On AM_INSERT
.head 6 -  Call hWndForm.CjClass..ParamSetInt( wp_nPARAM, MyValue )
.head 5 +  ! On WM_ENABLE
.head 6 -  Return 0
.head 3 -  Background Text: Quelle
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.635"
.head 5 -  Width:  0.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_QUELLE
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.988"
.head 6 -  Top: 0.573"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 -  Group Box: Status
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.588"
.head 5 -  Top: 0.073"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Check Box: cbAR_GESP
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: gesperrt
.head 4 -  Window Location and Size
.head 5 -  Left: 2.788"
.head 5 -  Top: 0.24"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 -  Message Actions 
.head 3 +  Check Box: cbAR_GEPRUEFT
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: geprüft
.head 4 -  Window Location and Size
.head 5 -  Left: 2.788"
.head 5 -  Top: 0.49"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 -  !
.head 3 -  Group Box: Bezeichnung
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 1.031"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.375"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Artikel
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 0.338"
.head 5 -  Top: 1.26"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_INTERN
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 50
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.338"
.head 6 -  Top: 1.49"
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalSendClassMessage( SAM_AnyEdit, wParam, lParam )
.head 6 -  Call SalSendMsg( hWndItem, AM_FETCH, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 -  Call SalSetWindowText( SalParentWindow( hWndForm ), MyValue )
.head 3 -  Background Text: KurzBez
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.338"
.head 5 -  Top: 1.802"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_KURZBEZ	! law 20071029 optional disablen
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.338"
.head 6 -  Top: 1.99"
.head 6 -  Width:  4.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  ! On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( d1AR_NR )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  Else If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 +  If hWndItem = SalGetFocus(  )
.head 8 -  Call SalSetFocus( dfAR_INTERN)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Gray )
.head 5 +  On AM_NEW
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 -  Call SalSendClassMessage( AM_NEW, 0, 0 )
.head 3 -  !
.head 3 -  Group Box: Einheit je Portion
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 2.448"
.head 5 -  Width:  5.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.792"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Einheit
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 2.677"
.head 5 -  Width:  1.05"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfVBAnzahl
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.538"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = '1'
.head 3 +  Combo Box: cmAM_KURZBEZ	! law 20071029 optional disablen
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.838"
.head 5 -  Top: 2.615"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmAM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_AM_NR','','' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  ! If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( dfAR_AM_NR ) OR NOT Sql_FetchOne( hSql, 'Select AM_KURZBEZ into :frmREZ_Artikel.cmAM_KURZBEZ
FROM artikelme WHERE AM_NR = :frmREZ_Artikel.dfAR_AM_NR' )
.head 7 -  Call SalClearField( hWndItem)
.head 6 -  Set dfArtikelMenge = MyValue
.head 6 -  !
.head 6 +  If SalIsNull( d1AR_NR )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  Else If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 +  If hWndItem = SalGetFocus(  )
.head 8 -  Call SalSetFocus( dfAR_MENGE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_3DFace )
.head 5 +  On AM_NEW
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 -  Call SalSendClassMessage( AM_NEW, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  ! Call SalClearField( dfAR_AM_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set dfArtikelMenge = MyValue
.head 3 -  Background Text: =
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.288"
.head 5 -  Top: 2.677"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_MENGE
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.638"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfGramm
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.538"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = Translate( 'g' )
.head 3 -  Background Text: Lager
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.488"
.head 5 -  Top: 2.927"
.head 5 -  Width:  0.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfLagerAnz
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.538"
.head 6 -  Top: 2.906"
.head 6 -  Width:  0.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = '1'
.head 3 +  Combo Box: c1AM_KURZBEZ
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.838"
.head 5 -  Top: 2.906"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call c1AM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_LE_AM_NR','','' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( dfAR_LE_AM_NR ) OR NOT Sql_FetchOne( hSql, 'Select AM_KURZBEZ into :frmREZ_Artikel.c1AM_KURZBEZ
FROM artikelme WHERE AM_NR = :frmREZ_Artikel.dfAR_LE_AM_NR' )
.head 7 -  Call SalClearField( hWndItem)
.head 5 +  On SAM_DropDown
.head 6 -  ! Call SalClearField( dfAR_AM_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 3 -  Background Text: =
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.288"
.head 5 -  Top: 2.927"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_LAGEREINHEIT
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.638"
.head 6 -  Top: 2.906"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfArtikelMenge
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.538"
.head 6 -  Top: 2.906"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 -  Group Box: Artikel
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.588"
.head 5 -  Top: 0.073"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.917"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Typ
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 4.688"
.head 5 -  Top: 0.385"
.head 5 -  Width:  0.725"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.end
.head 3 +  Combo Box: cmAT_TEXT
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.538"
.head 5 -  Top: 0.323"
.head 5 -  Width:  2.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.104"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmAT_TEXT.SetKeyDataField( 'artikeltyp', 'at_nr',
':frmREZ_Artikel.dfAR_AT_NR',
'',  'at_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  ! Call SalClearField( dfAR_AT_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 3 +  Data Field: dfAR_AT_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.588"
.head 6 -  Top: 0.49"
.head 6 -  Width:  1.413"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( dfAR_AT_NR ) OR NOT Sql_FetchOne( hSql,'SELECT at_text  FROM artikeltyp
WHERE at_nr = :frmREZ_Artikel.dfAR_AT_NR
INTO :frmREZ_Artikel.cmAT_TEXT ')
.head 7 -  Call SalClearField( cmAT_TEXT )
.head 3 -  Background Text: Gruppe
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 4.688"
.head 5 -  Top: 0.635"
.head 5 -  Width:  0.725"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.end
.head 3 +  Combo Box: cmAG_TEXT
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.538"
.head 5 -  Top: 0.615"
.head 5 -  Width:  2.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.271"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'',  'ag_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'ag_at_nr = :frmREZ_Artikel.dfAR_AT_NR',  'ag_sort' )
.head 6 -  Call SalClearField( dfAR_AG_NR )
.head 6 -  Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'',  'ag_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 -  !
.head 3 -  Group Box: Lager
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.588"
.head 5 -  Top: 1.021"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.958"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: LagerOrt
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 5.988"
.head 5 -  Top: 1.292"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Combo Box: cmLO_TEXT
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.988"
.head 5 -  Top: 1.521"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.771"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmLO_TEXT.SetKeyDataField( 'lagerort', 'lo_nr',
':frmREZ_Artikel.dfAR_LO_NR',
'',  'lo_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  ! Call SalClearField( dfAR_LO_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 3 +  Data Field: dfAR_LO_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.588"
.head 6 -  Top: 0.479"
.head 6 -  Width:  1.413"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( frmREZ_Artikel.dfAR_LO_NR ) OR NOT Sql_FetchOne( hSql,'SELECT lo_text  FROM lagerort
WHERE lo_nr = :frmREZ_Artikel.dfAR_LO_NR
INTO :frmREZ_Artikel.cmLO_TEXT ')
.head 7 -  Call SalClearField( cmLO_TEXT )
.head 3 -  ! BackGroundText: LagerPosition
.head 3 +  ! ComboWithDataField: cmLP_TEXT
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmLP_TEXT.SetKeyDataField( 'lagerpos', 'lp_nr',
':frmREZ_Artikel.dfAR_LP_NR',
'',  'lp_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  Call cmLP_TEXT.SetKeyDataField( 'lagerpos', 'lp_nr',
':frmREZ_Artikel.dfAR_LP_NR',
'lp_lo_nr =  :frmREZ_Artikel.dfAR_LO_NR',  'lp_sort' )
.head 6 -  Call SalClearField( dfAR_LP_NR )
.head 6 -  Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 -  Call cmLP_TEXT.SetKeyDataField( 'lagerpos', 'lp_nr',
':frmREZ_Artikel.dfAR_LP_NR',
'',  'lp_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  ! DataFieldWithComboBox: dfAR_LP_NR
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( frmREZ_Artikel.dfAR_LP_NR ) OR NOT Sql_FetchOne( hSql,'SELECT lp_text  FROM lagerpos
WHERE lp_nr = :frmREZ_Artikel.dfAR_LP_NR
INTO :frmREZ_Artikel.cmLP_TEXT ')
.head 7 -  Call SalClearField( cmLP_TEXT )
.head 3 +  Data Field: dfAR_AG_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.588"
.head 6 -  Top: 0.49"
.head 6 -  Width:  1.413"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( frmREZ_Artikel.dfAR_AG_NR ) OR NOT Sql_FetchOne( hSql,'SELECT ag_text  FROM artikelgruppe
WHERE ag_nr = :frmREZ_Artikel.dfAR_AG_NR
INTO :frmREZ_Artikel.cmAG_TEXT ')
.head 7 -  Call SalClearField( cmAG_TEXT )
.head 3 +  Data Field: dfAR_AM_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.013"
.head 6 -  Top: -0.01"
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfAR_LE_AM_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.013"
.head 6 -  Top: -0.01"
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Group Box: Kennzeichen
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.588"
.head 5 -  Top: 1.99"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.958"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.end
.head 3 +  Check Box: cbAR_PARAMETER1
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sortiment
.head 4 -  Window Location and Size
.head 5 -  Left: 2.788"
.head 5 -  Top: 0.74"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: MaxMenge
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 6.538"
.head 5 -  Top: 2.26"
.head 5 -  Width:  1.225"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_MAXMENGE
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.838"
.head 6 -  Top: 2.24"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: #00
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: Bestellschritte
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 6.438"
.head 5 -  Top: 2.552"
.head 5 -  Width:  1.325"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_STEP
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.838"
.head 6 -  Top: 2.531"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  Group Box: BLS
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 3.24"
.head 5 -  Width:  6.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.583"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: BLS
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 3.51"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_SBLS
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.938"
.head 6 -  Top: 3.448"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_AnyEdit
.head 6 +  If bInhalt
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT st FROM blsdat 
INTO :frmREZ_Artikel.dfST
WHERE sbls LIKE \'' || dfAR_SBLS || '%\' ORDER BY sbls' )
.head 5 +  On SAM_Validate
.head 6 +  If bInhalt
.head 7 +  If NOT SalIsNull( hWndItem )
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT sbls FROM blsdat 
INTO :frmREZ_Artikel.dfAR_SBLS
WHERE st = \'' || dfST || '\'' )
.head 9 -  Call SalClearField( hWndItem )
.head 5 +  On AM_UPDATE
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND (ar_sbls != :frmREZ_Artikel.dfAR_SBLS OR ar_sbls IS NULL)' )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR)')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 3 +  Pushbutton: pbBLS
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarBLS
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.838"
.head 5 -  Top: 3.427"
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: SAMM_NEU.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Set sSBLS = dfAR_SBLS
.head 6 +  If SalModalDialog( dlgBLS, hWndForm, sSBLS )
.head 7 -  Set dfAR_SBLS = sSBLS
.head 7 +  If SalIsNull( dfAR_MENGE )
.head 8 -  Call Sql_FetchOne( hSql, 'SELECT gp FROM blsdat 
INTO :frmREZ_Artikel.dfAR_MENGE 
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS')
.head 7 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 7 -  Call SalSendMsg( dfAR_SBLS, SAM_AnyEdit, 0, 0 )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If NOT bInhalt
.head 7 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field: dfST
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 2.238"
.head 6 -  Top: 3.448"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If bInhalt
.head 7 +  If SalIsNull( frmREZ_Artikel.dfAR_SBLS ) OR NOT Sql_FetchOne( hSql, 'SELECT st FROM blsdat
INTO :frmREZ_Artikel.dfST 
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS')
.head 8 -  Call SalClearField( hWndItem )
.head 3 -  !
.head 3 -  Background Text: MWSt.
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 6.938"
.head 5 -  Top: 3.51"
.head 5 -  Width:  0.825"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_TAX
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.838"
.head 6 -  Top: 3.49"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 -  Group Box: Preise
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 3.865"
.head 5 -  Width:  5.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.042"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfWHG
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.488"
.head 6 -  Top: 4.219"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = sWHG
.head 3 +  Data Field: dfWHG2
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.488"
.head 6 -  Top: 4.51"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call Sql_FetchOne( hSql, 'SELECT ku_kbez FROM kunde INTO :frmREZ_Artikel.dfWHG2' )
.head 6 +  If SalIsNull( dfWHG2 )
.head 7 -  Set dfWHG2 = 'EUR'
.head 3 -  Background Text: EK
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 1.488"
.head 5 -  Top: 4.01"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_EK
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.438"
.head 6 -  Top: 4.198"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: DP
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.088"
.head 5 -  Top: 4.01"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_DP
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.038"
.head 6 -  Top: 4.198"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: VK
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 4.638"
.head 5 -  Top: 4.01"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_VK
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.588"
.head 6 -  Top: 4.198"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfAR_EK_EUR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.438"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Set MyValue = dfAR_EK * nEURO
.head 5 -  On AM_FIELDS
.head 5 +  ! On AM_FIELDS
.head 6 +  If sFields != ''
.head 7 -  Set sFields = sFields || ','
.head 6 -  Set sFields = sFields || 'AR_EK * :nEURO'  
.head 6 +  If sResult != ''
.head 7 -  Set sResult = sResult || ','
.head 6 -  Set sResult = sResult || ':' || sItemName
.head 5 -  On AM_SEARCH
.head 3 +  Data Field: dfAR_DP_EUR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.038"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Set MyValue = dfAR_DP * nEURO
.head 5 +  ! On AM_FIELDS
.head 6 +  If sFields != ''
.head 7 -  Set sFields = sFields || ','
.head 6 -  Set sFields = sFields || 'AR_DP * :nEURO' 
.head 6 +  If sResult != ''
.head 7 -  Set sResult = sResult || ','
.head 6 -  Set sResult = sResult || ':' || sItemName
.head 5 -  On AM_FIELDS
.head 5 -  On AM_SEARCH
.head 3 +  Data Field: dfAR_VK_EUR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.588"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Set MyValue = dfAR_VK * nEURO
.head 5 +  ! On AM_FIELDS
.head 6 +  If sFields != ''
.head 7 -  Set sFields = sFields || ','
.head 6 -  Set sFields = sFields || 'AR_VK * :nEURO'
.head 6 +  If sResult != ''
.head 7 -  Set sResult = sResult || ','
.head 6 -  Set sResult = sResult || ':' || sItemName
.head 5 -  On AM_FIELDS
.head 5 -  On AM_SEARCH
.head 3 -  Group Box: Zusätze
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.138"
.head 5 -  Top: 3.865"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.042"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_KENNZS1
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.588"
.head 6 -  Top: 4.198"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfAR_KENNZS2
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.588"
.head 6 -  Top: 4.49"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfAR_KENNZN1
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.638"
.head 6 -  Top: 4.198"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfAR_KENNZN2
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.638"
.head 6 -  Top: 4.49"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 -  !
.head 3 +  Pushbutton: pbSearchKey
.winattr
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: FormMain
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Suchen
.head 4 -  Window Location and Size
.head 5 -  Left: 8.283"
.head 5 -  Top: 0.071"
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 -  Message Actions 
.head 2 +  Functions 
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = SalParentWindow( hWndForm )
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 9 -  !
.head 9 -  ! Tabelle aktualisieren
.head 9 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 10 -  Set nAR_NR = dfAR_NR
.head 10 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 10 -  !
.head 10 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, d1AR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, d1AR_NR )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 -  Set d1AR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( d1AR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  Call EnableDisable(  )
.head 3 +  Function: EnableDisable
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bDisabled
.head 4 +  Actions 
.head 5 +  If NOT SalIsNull( d1AR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, TRUE )
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Return SqlVarSetup( p_hSql )
.head 3 +  Function: CopyArtikel
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sInsert
.head 5 -  String: sAbgeleitetVon
.head 5 -  String: sAbgeleitetNach
.head 5 -  Number: nAbgeleitetNach
.head 5 -  Number: nAbgelietetVon
.head 4 +  Actions 
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Set sGlobalTemp = dfAR_INTERN || ' (copy)'
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_intern = :sGlobalTemp')
.head 7 -  Call MessageBox( 'Name schon vorhanden!
Bitte ändern Sie den internen Namen.', 'Artikel kopieren...' ,MB_Ok )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set sAbgeleitetVon = SalNumberToStrX( dfAR_NR, 0 )
.head 6 -  Call Sql_GetKeyCounter( 'AR_NR', dfAR_NR, hSql )
.head 6 -  Set d1AR_NR = dfAR_NR
.head 6 -  Set dfAR_INTERN = dfAR_INTERN || ' (copy)'
.head 6 -  Set sFields = ''
.head 6 -  Set sResult = ''
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_INSERT, 0, 0 )
.head 6 -  Set sInsert = 'INSERT INTO artikel (
		' || sFields || '
	) VALUES (
		' || sResult || ')'
.head 6 -  Call Sql_Exec( hSql, sInsert )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  !
.head 6 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( d1AR_NR ), '', 2 )
.head 6 -  ! ga 20091005: Tabelle aktualisieren
.head 6 -  Call ParamSetInt( ARTIKEL.SpeichernDone, d1AR_NR )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Sie müssen den Artikel zuerst speichern!', 'Achtung', MB_IconStop | MB_Ok )
.head 3 +  Function: Suchen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  String: sTable
.head 5 -  String: sWhereParameter
.head 5 -  String: sFrom
.head 5 -  Number: bDialog
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sSelect
.head 5 -  String: sItemName
.head 5 -  String: sFieldName
.head 5 -  !
.head 5 -  String: sSelectWhere
.head 5 -  String: sSelectOrder
.head 5 -  String: sWhereDialog
.head 4 +  Actions 
.head 5 -  Set sWhere = ''
.head 5 -  ! Set sWhere = sWhereParameter
.head 5 -  Set sFields = ''
.head 5 -  Set sResult = ''
.head 5 -  Set sSelectOrder = sOrderRow
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  ! If bDialog < 2
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_SEARCH_KEY, 0,0 )
.head 5 +  ! If bDialog < 2 AND sWhere = ''
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_SEARCH, 0,0 )
.head 5 +  ! If NOT (sWhereParameter = '')
.head 6 +  If sWhere != ''
.head 7 -  Set sWhere = sWhere || ' AND '
.head 6 -  Set sWhere = sWhere || sWhereParameter
.head 5 -  !
.head 5 -  Set sWhere = 'AR_NR = :frmREZ_Artikel.d1AR_NR'
.head 5 -  Call SalSendMsgToChildren( hWndForm, AM_FIELDS, 0,0 )
.head 5 -  !
.head 5 +  If NOT (sWhere = '')
.head 6 +  If NOT (sTableWhere = '')
.head 7 -  Set sWhere = sWhere || ' AND ' || sTableWhere
.head 6 -  Call SalStrTrim( sWhere, sWhere )
.head 6 +  If sFrom != ''
.head 7 -  Set sTable = sTable || ', ' || sFrom
.head 6 -  Set sSelect = 'SELECT ' || sFields ||
' INTO ' || sResult ||
' FROM ' || sTable || '  WHERE '|| sWhere
.head 6 +  If sSelectOrder != ''
.head 7 -  Set sSelect = sSelect || ' ORDER BY ' || sSelectOrder
.head 6 -  Call StatusText( 'Abfrage wird bearbeitet' )
.head 6 -  Call Sql_ExecAndCommit( hSqlObject, sSelect )
.head 6 -  !
.head 6 -  ! Anzahl ermitteln
.head 6 -  Call StatusText( 'Anzahl wird ermittelt' )
.head 6 -  Call SqlGetResultSetCount( hSqlObject, nRowCount )
.head 6 +  If nRowCount=0
.head 7 -  Call SalMessageBeep( 0 )
.head 7 -  Set nActRow = 0
.head 7 -  Call StatusText( 'Keine entsprechenden Daten gefunden' )
.head 6 +  Else 
.head 7 -  Set nActRow = 1
.head 7 -  Call SqlFetchRow( hSqlObject, 0, nFetch )
.head 7 -  Call StatusText( '' )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 6 -  Call Sql_Commit( hSqlObject )
.head 6 -  Set bAnyEdit = FALSE
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Keine Suchkriterien angegeben!', 'Suchen',
MB_IconQuestion|MB_Ok )
.head 5 -  Call SalWaitCursor( FALSE )
.head 2 +  Window Parameters 
.head 3 -  Number: wp_nPARAM
.data INHERITPROPS
0000: 0100
.enddata
.head 3 +  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! Ribbon Container
.head 2 +  Window Variables 
.head 3 -  String: sSBLS
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call frmREZ_Artikel.SetTableName('ARTIKEL')
.head 4 -  ! Call frmREZ_Artikel.SetOrder
.head 4 -  ! Call frmREZ_Artikel.SetOrderPopulate( 'AR_QUELLE, AR_INTERN' )
.head 4 -  Call SalSendClassMessage( SAM_Create,0,0 )
.head 4 -  ! Call frmREZ_Artikel.setLbResultName( 'dlgREZ_Result')
.head 4 -  ! ga 20090806: nicht mehr erforderlich? - SalSendMsgToChildren( hWndForm, AM_FETCH,0,0)
.head 3 +  On AM_SAVE
.head 4 +  If ( nUserLevel > 1 OR Benutzer.HatRecht( REC_ARTIKEL ) )
.head 5 +  If ( SalIsNull( dfAR_MENGE )  OR SalIsNull( dfAR_AM_NR )  
OR SalIsNull( dfAR_AT_NR) OR SalIsNull( dfAR_AG_NR)  OR SalIsNull( dfAR_INTERN) )
.head 6 -  Call MessageBox( 'Bitte alle roten Felder ausfüllen!', 'Speichern', MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalSendClassMessage( AM_SAVE, 0, 0 )
.head 3 +  ! On AM_SAVE
.head 4 +  If SalIsNull( dfKey )
.head 5 -  Call Insert( sTableName )
.head 4 +  Else 
.head 5 -  Call Update( sTableName )
.head 3 +  On SAM_Destroy
.head 4 -  Set hWndArtikel = hWndNULL
.head 3 +  On AM_SEARCH
.head 4 +  If wParam		! skip bei SQLServer
.head 5 -  Call SalSendClassMessage( AM_SEARCH,1,0 )
.head 4 +  Else 
.head 5 +  If hWndResultList
.head 6 -  Call SalDestroyWindow( hWndResultList )
.head 5 -  Call SalSendClassMessage( AM_SEARCH,0,0 )
.head 3 +  On AM_DELETE
.head 4 +  If SalModalDialog( dlgART_Loeschen, frmREZ_Artikel, dfAR_NR )
.head 5 -  ! Call DeleteArtikel( dfAR_NR )
.head 5 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 5 -  ! Call frmREZ_Artikel.SetClean(  )
.head 5 -  ! Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 5 -  ! Call SalMessageBeep( -1 )
.head 3 +  On AM_ANY_EDIT
.head 4 +  If ( nUserLevel > 1 OR Benutzer.HatRecht( REC_ARTIKEL ) )
.head 5 -  Call SalSendClassMessage( AM_ANY_EDIT, 0, 0 )
.head 3 +  On AM_CAN_UPDATE
.head 4 +  If ( nUserLevel > 1 OR Benutzer.HatRecht( REC_ARTIKEL ) )
.head 5 -  Return TRUE
.head 4 +  Else 
.head 5 -  Return FALSE
.head 3 -  !
.head 3 -  ! ga 20081204: Referenzierung
.head 3 +  On AM_REMOTE
.head 4 +  If wParam = REM_Search
.head 5 -  Call Suchen('artikel', 'ar_nr = ' || NumberToStrX( lParam ), '', 2 )
.head 5 -  Return TRUE
.head 1 +  Dialog Box: dlgART_InREZ ! th 20150907: nur nicht gesperrte Rezepte anzeigen
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel in Rezept
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  8.667"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.958"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Yes
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.375"
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.55"
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbChangeArtikel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ToolbarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: Ersetzen.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call ArtikelErsetzen(  )
.head 6 +  On SAM_Create
.head 7 -  Call ToolTip( 'Artikel in allen markierten Rezepturen tauschen' )
.head 2 +  Contents
.head 3 +  Child Table: tblART_InRezept
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.073"
.head 6 -  Width:  7.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colRE_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRE_INTERN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Intern
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.613"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRE_KU_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Küche
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Unformatted
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKU_BEZEICHNUNG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Küche
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 8 +  If NOT Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL )
.head 9 -  Call SalHideWindow( hWndItem )
.head 5 +  Column: colAR_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: PopulateMitMandanten
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.head 7 -  Number: nLocalUserKuecheNr
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Set sTable = 'rezept 
	JOIN rezkomp ON re_nr = rk_re_nr
	JOIN artikel ON rk_ar_nr = ar_nr
	LEFT JOIN kueche ON re_ku_nr = ku_nr'
.head 7 -  Set sWhere = 'rk_typ = \'A\' AND ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND 
@NULLVALUE( re_gesp, 0) = 0 AND re_nr >= 0'
.head 7 -  ! Mandanten-Küchen-Nr
.head 7 +  If NOT Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL )
.head 8 -  ! Ohne Recht 819 darf Mandanten-Küche Basis-Rezepte und eigene sehen; (mit Recht alle!)
.head 8 +  If nUserKuecheNrMandant != NUMBER_Null
.head 9 -  Set sWhere = sWhere || ' AND
( re_ku_nr = '||NumberToStrX( nUserKuecheNrMandant ) ||' OR re_ku_nr IS NULL)'
.head 8 +  Else
.head 9 -  Set sWhere = sWhere || ' AND re_ku_nr IS NULL'
.head 7 -  Call PopulateTable( sTable, sWhere, 'ku_bezeichnung, re_intern' )
.head 4 +  Window Variables
.head 5 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nColorDisabled
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! ga 20100705: Mandant; Färben von nicht editierbaren Artikeln
.head 6 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 7 -  Set nColorDisabled = COLOR_Blue
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_CreateComplete ! th 20170313 mit Küche
.head 6 -  Call PopulateMitMandanten ()
.head 6 -  Call SetReportName( 'ArtInRez.qrp' )
.head 5 +  ! On SAM_CreateComplete
.head 6 -  ! ga 20100707: Mandant
.head 6 -  !
.head 6 -  Set sWhere = 're_nr = rk_re_nr AND rk_ar_nr = ar_nr AND rk_typ = \'A\' AND ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND ' || GetWhereRezept( TRUE ) 
.head 6 -  Call PopulateTable( 'rezept, rezkomp, artikel', sWhere, 're_intern' )
.head 6 -  Call SetReportName( 'ArtInRez.qrp' )
.head 5 +  On SAM_FetchRowDone ! th 20170313 Küche
.head 6 +  If nColorDisabled AND ( colRE_KU_NR != nUserKuecheNrMandant )
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 6 -  ! Basis
.head 6 +  If colRE_KU_NR = NUMBER_Null
.head 7 -  Set colKU_BEZEICHNUNG = '(Basis)'
.head 5 +  ! On SAM_FetchRowDone
.head 6 +  If nColorDisabled AND ( colRE_KU_NR != nUserKuecheNrMandant )
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 5 +  ! On AM_DRAGDROP	! cj
.head 6 +  If SalTblAnyRows( tblART_InRezept, ROW_Selected, 0 )
.head 7 -  Call OpenRezept( tblART_InRezept.colRE_NR )
.head 5 +  ! On SAM_DragCanAutoStart
.head 6 -  Return TRUE
.head 2 +  Functions
.head 3 +  Function: ArtikelErsetzen ! wl 20170726 erweiteter Parameter
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 5 -  !
.head 5 -  String: sListInvalid
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 +  If tblART_InRezept.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InRezept.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, tblART_InRezept, nAR_NRi, 'A', 'R' )
.head 7 +  If nAR_NRi != tblART_InRezept.colAR_NR 
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tblART_InRezept, nRow, ROW_Selected, 0 ) AND SalTblSetContext( tblART_InRezept, nRow )
.head 9 -  ! Mit Recht 819 ist MandantenNummer egal, dh kann bei allen Komponenten ersetzt werden; ohne Recht gilt alte Regelung
.head 9 +  If Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL ) OR 
	( tblART_InRezept.colRE_KU_NR = nUserKuecheNrMandant )
.head 10 +  If nAR_NRi
.head 11 -  Call Sql_Exec( hSql, 'UPDATE rezkomp SET
		rk_ar_nr = ' || NumberToStrX( nAR_NRi ) || '
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 +  Else
.head 11 -  Call Sql_Exec( hSql, 'DELETE FROM rezkomp
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET re_inhaltneu = 1
	WHERE
		re_nr = :tblART_InRezept.colRE_NR' )
.head 10 -  Call Sql_Commit( hSql )
.head 9 +  Else
.head 10 -  Set sListInvalid = StrAppend( sListInvalid, ', ', tblART_InRezept.colRE_INTERN )
.head 8 -  !
.head 8 -  ! ggf. Fehlermeldung, wenn Rezepte mit fremdem Mandanten markiert waren
.head 8 +  If sListInvalid
.head 9 -  Call SalMessageBox( TranslateSubstString( 'Vorlagenkomponenten können nicht verändert werden und wurden ignoriert:

%1', sListInvalid ), Translate( 'Artikel ersetzen' ), MB_IconExclamation | MB_Ok )
.head 8 -  !
.head 8 -  Call SalSendMsg( tblART_InRezept, SAM_CreateComplete, 0, 0 )
.head 3 +  ! Function: ArtikelErsetzen ! th 20170317 bei Recht 819 auch bei Mandanten ersetzen möglich
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 5 -  !
.head 5 -  String: sListInvalid
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If tblART_InRezept.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InRezept.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, tblART_InRezept, nAR_NRi )
.head 7 +  If nAR_NRi != tblART_InRezept.colAR_NR 
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tblART_InRezept, nRow, ROW_Selected, 0 ) AND SalTblSetContext( tblART_InRezept, nRow )
.head 9 -  ! Mit Recht 819 ist MandantenNummer egal, dh kann bei allen Komponenten ersetzt werden; ohne Recht gilt alte Regelung
.head 9 +  If Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL ) OR 
	( tblART_InRezept.colRE_KU_NR = nUserKuecheNrMandant )
.head 10 +  If nAR_NRi
.head 11 -  Call Sql_Exec( hSql, 'UPDATE rezkomp SET
		rk_ar_nr = ' || NumberToStrX( nAR_NRi ) || '
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 +  Else 
.head 11 -  Call Sql_Exec( hSql, 'DELETE FROM rezkomp
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET re_inhaltneu = 1
	WHERE
		re_nr = :tblART_InRezept.colRE_NR' )
.head 10 -  Call Sql_Commit( hSql )
.head 9 +  Else 
.head 10 -  Set sListInvalid = StrAppend( sListInvalid, ', ', tblART_InRezept.colRE_INTERN )
.head 8 -  !
.head 8 -  ! ggf. Fehlermeldung, wenn Rezepte mit fremdem Mandanten markiert waren
.head 8 +  If sListInvalid
.head 9 -  Call SalMessageBox( TranslateSubstString( 'Vorlagenkomponenten können nicht verändert werden und wurden ignoriert:

%1', sListInvalid ), Translate( 'Artikel ersetzen' ), MB_IconExclamation | MB_Ok )
.head 8 -  !
.head 8 -  Call SalSendMsg( tblART_InRezept, SAM_CreateComplete, 0, 0 )
.head 3 +  ! Function: ArtikelErsetzen ! ga 20100707: Mandant
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 5 -  !
.head 5 -  String: sListInvalid
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If tblART_InRezept.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InRezept.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, tblART_InRezept, nAR_NRi )
.head 7 +  If nAR_NRi != tblART_InRezept.colAR_NR 
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tblART_InRezept, nRow, ROW_Selected, 0 ) AND SalTblSetContext( tblART_InRezept, nRow )
.head 9 +  If ( tblART_InRezept.colRE_KU_NR = nUserKuecheNrMandant )
.head 10 +  If nAR_NRi
.head 11 -  Call Sql_Exec( hSql, 'UPDATE rezkomp SET
		rk_ar_nr = ' || NumberToStrX( nAR_NRi ) || '
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 +  Else 
.head 11 -  Call Sql_Exec( hSql, 'DELETE FROM rezkomp
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET re_inhaltneu = 1
	WHERE
		re_nr = :tblART_InRezept.colRE_NR' )
.head 10 -  Call Sql_Commit( hSql )
.head 9 +  Else 
.head 10 -  Set sListInvalid = StrAppend( sListInvalid, ', ', tblART_InRezept.colRE_INTERN )
.head 8 -  !
.head 8 -  ! ggf. Fehlermeldung, wenn Rezepte mit fremdem Mandanten markiert waren
.head 8 +  If sListInvalid
.head 9 -  Call SalMessageBox( TranslateSubstString( 'Vorlagenkomponenten können nicht verändert werden und wurden ignoriert:

%1', sListInvalid ), Translate( 'Artikel ersetzen' ), MB_IconExclamation | MB_Ok )
.head 8 -  !
.head 8 -  Call SalSendMsg( tblART_InRezept, SAM_CreateComplete, 0, 0 )
.head 3 +  ! Function: ArtikelErsetzen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 4 +  Actions 
.head 5 +  If tblART_InRezept.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InRezept.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, hWndForm, nAR_NRi )
.head 7 +  If nAR_NRi != tblART_InRezept.colAR_NR 
.head 8 -  Set nRow = -1
.head 8 +  While SalTblFindNextRow( tblART_InRezept, nRow, ROW_Selected, 0 ) 
.head 9 -  Call SalTblSetContext( tblART_InRezept, nRow )
.head 9 +  If nAR_NRi
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezkomp SET rk_ar_nr = ' || SalNumberToStrX( nAR_NRi,0 ) || '
WHERE  rk_re_nr = :tblART_InRezept.colRE_NR AND rk_ar_nr = :dlgART_InREZ.nAR_NR')
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'DELETE FROM rezkomp 
WHERE  rk_re_nr = :tblART_InRezept.colRE_NR AND rk_ar_nr = :dlgART_InREZ.nAR_NR')
.head 9 -  Call Sql_Exec( hSql, 'UPDATE rezept SET re_inhaltneu = 1
WHERE  re_nr = :tblART_InRezept.colRE_NR ')
.head 9 -  Call Sql_Commit( hSql )
.head 8 -  Call SalSendMsg( tblART_InRezept, SAM_CreateComplete, 0, 0 )
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SqlVarSetup( p_hSql )
.head 2 +  Window Parameters
.head 3 -  Number: nAR_NR
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oResizables
.head 4 -  Class: cObjResizables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern FROM artikel
INTO :sGlobalTemp WHERE ar_nr = '  || SalNumberToStrX( nAR_NR, 0 ) )
.head 4 -  Call SalSetWindowText( hWndForm, sGlobalTemp )
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( dlgART_InREZ.tblART_InRezept, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 1 +  ! InsertBox: dlgART_InREZ ! ga 20100705: Mandant; Färben von nicht editierbaren Artikeln
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel in Rezept
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  6.788"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.615"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.375"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.55"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbChangeArtikel
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ToolbarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: Ersetzen.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Call ArtikelErsetzen(  )
.head 6 +  On SAM_Create
.head 7 -  Call ToolTip( 'Artikel in allen markierten Rezepturen tauschen' )
.head 2 +  Contents 
.head 3 +  Child Table: tblART_InRezept
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.073"
.head 6 -  Width:  6.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colRE_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colRE_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Intern
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.613"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colRE_KU_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Küche
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 +  Window Variables 
.head 5 -  String: sWhere
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nColorDisabled
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! ga 20100705: Mandant; Färben von nicht editierbaren Artikeln
.head 6 +  If Benutzer.HatMandant(  ) AND ( nUserKuecheNrMandant != NUMBER_Null )
.head 7 -  Set nColorDisabled = COLOR_Blue
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 5 +  On SAM_CreateComplete
.head 6 -  ! ga 20100707: Mandant
.head 6 -  Set sWhere = 're_nr = rk_re_nr AND rk_ar_nr = ar_nr AND rk_typ = \'A\' AND ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND ' || GetWhereRezept( TRUE )
.head 6 -  Call PopulateTable( 'rezept, rezkomp, artikel', sWhere, 're_intern' )
.head 6 -  Call SetReportName( 'ArtInRez.qrp' )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If nColorDisabled AND ( colRE_KU_NR != nUserKuecheNrMandant )
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 5 +  ! On AM_DRAGDROP	! cj
.head 6 +  If SalTblAnyRows( tblART_InRezept, ROW_Selected, 0 )
.head 7 -  Call OpenRezept( tblART_InRezept.colRE_NR )
.head 5 +  ! On SAM_DragCanAutoStart
.head 6 -  Return TRUE
.head 2 +  Functions 
.head 3 +  Function: ArtikelErsetzen ! ga 20100707: Mandant
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 5 -  !
.head 5 -  String: sListInvalid
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If tblART_InRezept.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InRezept.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, tblART_InRezept, nAR_NRi )
.head 7 +  If nAR_NRi != tblART_InRezept.colAR_NR 
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tblART_InRezept, nRow, ROW_Selected, 0 ) AND SalTblSetContext( tblART_InRezept, nRow )
.head 9 +  If ( tblART_InRezept.colRE_KU_NR = nUserKuecheNrMandant )
.head 10 +  If nAR_NRi
.head 11 -  Call Sql_Exec( hSql, 'UPDATE rezkomp SET
		rk_ar_nr = ' || NumberToStrX( nAR_NRi ) || '
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 +  Else 
.head 11 -  Call Sql_Exec( hSql, 'DELETE FROM rezkomp
	WHERE
		rk_re_nr = :tblART_InRezept.colRE_NR AND
		rk_ar_nr = :dlgART_InREZ.nAR_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET re_inhaltneu = 1
	WHERE
		re_nr = :tblART_InRezept.colRE_NR' )
.head 10 -  Call Sql_Commit( hSql )
.head 9 +  Else 
.head 10 -  Set sListInvalid = StrAppend( sListInvalid, ', ', tblART_InRezept.colRE_INTERN )
.head 8 -  !
.head 8 -  ! ggf. Fehlermeldung, wenn Rezepte mit fremdem Mandanten markiert waren
.head 8 +  If sListInvalid
.head 9 -  Call SalMessageBox( TranslateSubstString( 'Vorlagenkomponenten können nicht verändert werden und wurden ignoriert:

%1', sListInvalid ), Translate( 'Artikel ersetzen' ), MB_IconExclamation | MB_Ok )
.head 8 -  !
.head 8 -  Call SalSendMsg( tblART_InRezept, SAM_CreateComplete, 0, 0 )
.head 3 +  ! Function: ArtikelErsetzen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 4 +  Actions 
.head 5 +  If tblART_InRezept.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InRezept.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, hWndForm, nAR_NRi )
.head 7 +  If nAR_NRi != tblART_InRezept.colAR_NR 
.head 8 -  Set nRow = -1
.head 8 +  While SalTblFindNextRow( tblART_InRezept, nRow, ROW_Selected, 0 ) 
.head 9 -  Call SalTblSetContext( tblART_InRezept, nRow )
.head 9 +  If nAR_NRi
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezkomp SET rk_ar_nr = ' || SalNumberToStrX( nAR_NRi,0 ) || '
WHERE  rk_re_nr = :tblART_InRezept.colRE_NR AND rk_ar_nr = :dlgART_InREZ.nAR_NR')
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'DELETE FROM rezkomp 
WHERE  rk_re_nr = :tblART_InRezept.colRE_NR AND rk_ar_nr = :dlgART_InREZ.nAR_NR')
.head 9 -  Call Sql_Exec( hSql, 'UPDATE rezept SET re_inhaltneu = 1
WHERE  re_nr = :tblART_InRezept.colRE_NR ')
.head 9 -  Call Sql_Commit( hSql )
.head 8 -  Call SalSendMsg( tblART_InRezept, SAM_CreateComplete, 0, 0 )
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Return SqlVarSetup( p_hSql )
.head 2 +  Window Parameters 
.head 3 -  Number: nAR_NR
.head 2 -  Window Variables 
.head 2 +  Message Actions 
.head 3 +  On SAM_CreateComplete
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern FROM artikel
INTO :sGlobalTemp WHERE ar_nr = '  || SalNumberToStrX( nAR_NR, 0 ) )
.head 4 -  Call SalSetWindowText( hWndForm, sGlobalTemp )
.head 1 +  Dialog Box: dlgART_InSort ! ga 20100705: Mandant; Färben von nicht editierbaren Artikeln
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel in Sortiment
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  8.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.865"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Yes
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.55"
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbChangeArtikel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ToolbarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: Ersetzen.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call ArtikelErsetzen(  )
.head 6 +  On SAM_Create
.head 7 -  Call ToolTip( 'Artikel in allen markierten Sortimenten tauschen' )
.head 2 +  Contents
.head 3 +  Child Table: tblART_InSort
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  7.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colSR_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSR_BEZEICHNUNG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Intern
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.613"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 +  If wp_sTyp = 'R'
.head 9 -  Set strFields = StrAppend( strFields, ',', 'RE_NR' )
.head 8 +  Else
.head 9 -  Set strFields = StrAppend( strFields, ',', GetFieldName( hWndItem ) )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  Column: colKU_BEZEICHNUNG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Küche
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 8 +  If NOT Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL )
.head 9 -  Call SalHideWindow( hWndItem )
.head 4 +  Functions
.head 5 +  Function: PopulateMitMandanten	! wl 20170726 auch Rezepte
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.head 7 -  Number: nLocalUserKuecheNr
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 +  If wp_sTyp = 'R'
.head 8 -  Set sTable = 'rezept
	JOIN stationsort ON re_nr = so_ar_nr AND so_typ = \'R\'
	JOIN sortiment ON so_sr_nr = sr_nr 
	LEFT JOIN kueche ON sr_ku_nr = ku_nr'
.head 8 -  Set sWhere = 're_nr = ' || NumberToStrX( wp_nAR_NR )
.head 7 +  Else
.head 8 -  Set sTable = 'artikel
	JOIN stationsort ON ar_nr = so_ar_nr AND so_typ = \'A\'
	JOIN sortiment ON so_sr_nr = sr_nr 
	LEFT JOIN kueche ON sr_ku_nr = ku_nr'
.head 8 -  Set sWhere = 'ar_nr = ' || NumberToStrX( wp_nAR_NR )
.head 7 -  ! Mandanten-Küchen-Nr
.head 7 +  If NOT Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL )
.head 8 -  Set sWhere = sWhere || ' AND sr_ku_nr = '|| GetKU_NRStr ()
.head 7 -  Call PopulateTable( sTable, sWhere, 'ku_bezeichnung, sr_bezeichnung' )
.head 5 +  ! Function: PopulateMitMandanten
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sTable
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWhere
.head 7 -  Number: nLocalUserKuecheNr
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Set sTable = 'artikel
	JOIN stationsort ON ar_nr = so_ar_nr
	JOIN sortiment ON so_sr_nr = sr_nr 
	LEFT JOIN kueche ON sr_ku_nr = ku_nr'
.head 7 -  Set sWhere = 'ar_nr = ' || NumberToStrX( wp_nAR_NR )
.head 7 -  ! Mandanten-Küchen-Nr
.head 7 +  If NOT Benutzer.HatRecht( REC_ARTIKEL_KOMMTVOR_GLOBAL )
.head 8 -  Set sWhere = sWhere || ' AND sr_ku_nr = '|| GetKU_NRStr ()
.head 7 -  Call PopulateTable( sTable, sWhere, 'ku_bezeichnung, sr_bezeichnung' )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_CreateComplete ! th 20170317 mit Recht 819 usw
.head 6 -  Call PopulateMitMandanten ()
.head 6 -  Call SetReportName( 'ArtInRez.qrp' )
.head 5 +  ! On SAM_CreateComplete
.head 6 -  ! ga 20100707: Mandant
.head 6 -  Set sWhere = 'so_sr_nr = sr_nr AND ar_nr = so_ar_nr AND ar_nr = ' || NumberToStrX( wp_nAR_NR ) || ' AND sr_ku_nr = ' || GetKU_NRStr(  )
.head 6 -  Call PopulateTable( 'artikel, stationsort, sortiment', sWhere, 'sr_bezeichnung' )
.head 6 -  Call SetReportName( 'ArtInRez.qrp' )
.head 2 +  Functions
.head 3 +  Function: ArtikelErsetzen ! wl 20170726 mit Rezept
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 4 +  Actions
.head 5 +  If tblART_InSort.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InSort.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, hWndForm, nAR_NRi, wp_sTyp, 'S' )
.head 7 +  If nAR_NRi != tblART_InSort.colAR_NR 
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tblART_InSort, nRow, ROW_Selected, 0 ) AND SalTblSetContext( tblART_InSort, nRow )
.head 9 +  If nAR_NRi
.head 10 -  Call Sql_Exec( hSql, 'UPDATE stationsort SET
		so_ar_nr = ' || NumberToStrX( nAR_NRi ) || '
	WHERE
		so_sr_nr = :tblART_InSort.colSR_NR AND
		so_ar_nr = :dlgART_InSort.wp_nAR_NR AND
		so_typ = \'' || wp_sTyp || '\'' )
.head 9 +  Else
.head 10 -  Call Sql_Exec( hSql, 'DELETE FROM stationsort
	WHERE
		so_sr_nr = :tblART_InSort.colSR_NR AND
		so_ar_nr = :dlgART_InSort.wp_nAR_NR AND
		so_typ = \'' || wp_sTyp || '\'' )
.head 9 -  Call Sql_Commit( hSql )
.head 8 -  Call SalSendMsg( tblART_InSort, SAM_CreateComplete, 0, 0 )
.head 3 +  ! Function: ArtikelErsetzen ! ga 20100707: Mandant
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nRow
.head 5 -  Number: nAR_NRi
.head 4 +  Actions 
.head 5 +  If tblART_InSort.colAR_NR
.head 6 -  Set nAR_NRi = tblART_InSort.colAR_NR
.head 6 +  If SalModalDialog( dlgArtikelErsetzen, hWndForm, nAR_NRi )
.head 7 +  If nAR_NRi != tblART_InSort.colAR_NR 
.head 8 -  Set nRow = TBL_MinRow
.head 8 +  While SalTblFindNextRow( tblART_InSort, nRow, ROW_Selected, 0 ) AND SalTblSetContext( tblART_InSort, nRow )
.head 9 +  If nAR_NRi
.head 10 -  Call Sql_Exec( hSql, 'UPDATE stationsort SET
		so_ar_nr = ' || NumberToStrX( nAR_NRi ) || '
	WHERE
		so_sr_nr = :tblART_InSort.colSR_NR AND
		so_ar_nr = :dlgART_InSort.wp_nAR_NR' )
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'DELETE FROM stationsort
	WHERE
		so_sr_nr = :tblART_InSort.colSR_NR AND
		so_ar_nr = :dlgART_InSort.wp_nAR_NR' )
.head 9 -  Call Sql_Commit( hSql )
.head 8 -  Call SalSendMsg( tblART_InSort, SAM_CreateComplete, 0, 0 )
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SqlVarSetup( p_hSql )
.head 2 +  Window Parameters
.head 3 -  Number: wp_nAR_NR
.head 3 -  String: wp_sTyp
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oResizables
.head 4 -  Class: cObjResizables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete ! th 20180517 WindowText bei Komponente
.head 4 +  If wp_sTyp = 'R' 
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT re_intern INTO :sGlobalTemp FROM rezept WHERE re_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 4 +  Else
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 4 -  Call SalSetWindowText( hWndForm, sGlobalTemp )
.head 3 +  ! On SAM_CreateComplete
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 4 -  Call SalSetWindowText( hWndForm, sGlobalTemp )
.head 3 +  On SAM_Create ! th 20180517 WindowText raus
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( dlgART_InSort.tblART_InSort, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 3 +  ! On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( dlgART_InSort.tblART_InSort, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 4 +  If wp_sTyp = 'R'
.head 5 -  Call SalSetWindowText( hWndForm, 'Komponenten in Sortiment' )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 1 +  Dialog Box: dlgArtikelErsetzen
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel ersetzen
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 1.688"
.head 4 -  Top: 1.417"
.head 4 -  Width:  6.733"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 1.448"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.983"
.head 5 -  Top: 0.99"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfAR_ERSATZ
.head 7 -  Set wr_nAR_NR = dfAR_ERSATZ
.head 7 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbEsc
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 5.283"
.head 5 -  Top: 0.99"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Standard
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbDelete
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Löschen
.head 4 -  Window Location and Size
.head 5 -  Left: 1.383"
.head 5 -  Top: 0.99"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If IDYES = MessageBox( 'Wollen sie alle markierten Positionen löschen?', 'Löschen', MB_YesNo )
.head 7 -  Set wr_nAR_NR = 0
.head 7 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 -  Background Text: Artikel
.head 4 -  Resource Id: 46427
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: -0.014"
.head 5 -  Top: 0.26"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: d1AR_INTERN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.383"
.head 6 -  Top: 0.24"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Komponente
.head 4 -  Resource Id: 44705
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.117"
.head 5 -  Top: 0.26"
.head 5 -  Width:  1.167"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: d1RE_INTERN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.383"
.head 6 -  Top: 0.24"
.head 6 -  Width:  5.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: ersetzen durch
.head 4 -  Resource Id: 46428
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.267"
.head 5 -  Top: 0.594"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmAR_INTERN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboLookupArtikel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.383"
.head 5 -  Top: 0.573"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create ! th 20180515 ar_sortiment ^= ar_parameter1
.head 6 +  If wp_sTyp = 'R'
.head 7 -  Call SalHideWindow( hWndItem )
.head 6 +  Else If wp_sHerkunft = 'S'
.head 7 -  Call SetWhere( GetWhereArtikel( TRUE ) || ' AND ar_parameter1 = 1' )
.head 6 +  Else
.head 7 -  Call SetWhere( GetWhereArtikel( TRUE ))
.head 5 +  ! On SAM_Create
.head 6 +  If wp_sTyp = 'R'
.head 7 -  Call SalHideWindow( hWndItem )
.head 6 +  Else 
.head 7 -  Call SetWhere( GetWhereArtikel( TRUE )  )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfAR_ERSATZ = SalStrToNumber( GetKey(  ) )
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 3 +  Combo Box: cmRE_INTERN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboLookupRezept
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.383"
.head 5 -  Top: 0.573"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.26"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create	! wl 20180718 just in case wie beim Artikel: wenn Herkunft != Sortiment, dann kein Filter auf sortiment. 
.head 6 +  If wp_sTyp = 'R' AND wp_sHerkunft = 'S'
.head 7 -  Call SetWhere( GetWhereRezept( TRUE ) || ' AND re_sortiment = 1' )
.head 6 +  Else If wp_sTyp = 'R' 
.head 7 -  Call SetWhere( GetWhereRezept( TRUE ) )
.head 6 +  Else
.head 7 -  Call SalHideWindow( hWndItem )
.head 5 +  ! On SAM_Create
.head 6 +  If wp_sTyp = 'R'
.head 7 -  Call SetWhere( GetWhereRezept( TRUE ) || ' AND re_sortiment = 1' )
.head 6 +  Else 
.head 7 -  Call SalHideWindow( hWndItem )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfAR_ERSATZ = SalStrToNumber( GetKey(  ) )
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 3 +  Data Field: dfAR_ERSATZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBoxForTables
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.086"
.head 6 -  Top: 0.031"
.head 6 -  Width:  0.813"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  ! ComboWithDataFieldForTables: cmAR_INTERN
.winattr class Combo Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataFieldForTables
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.688"
.head 5 -  Top: 0.531"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! ga 20100707: Mandant
.head 6 -  Call SetKeyDataField( 'artikel', 'ar_nr', ':dlgArtikelErsetzen.dfAR_ERSATZ', GetWhereArtikel( TRUE ), 'ar_intern' )
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  ! ComboWithDataFieldAuto: cmAR_INTERN
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create ! ga 20100714: Mandant
.head 6 -  Call SetAllowNew( FALSE )
.head 6 -  Call SetKeyDataField( 'artikel, artikelme', 'ar_nr, am_kurzbez', ':dlgLagerErsetzen.dfAR_NR, :dlgLagerErsetzen.dfAM_KURZBEZ',
	'ar_am_nr = am_nr AND ar_nr > 0 AND ar_at_nr IS NOT NULL AND ar_ag_nr IS NOT NULL AND ' || GetWhereArtikel( TRUE ), 'ar_intern' )
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalTimerSet( hWndItem, SAM_AnyEdit, 250 )
.head 5 +  On SAM_Timer
.head 6 -  Call SalTimerKill( hWndItem, SAM_AnyEdit )
.head 6 -  !
.head 6 -  ! ggf. automatisch Nachladen
.head 6 +  If NOT SalListQueryCount( hWndItem )
.head 7 -  Set sGlobalTemp = MyValue
.head 7 -  Call SalSendMsg( hWndItem, SAM_DropDown, 0, 0 )
.head 7 -  Set MyValue = sGlobalTemp
.head 7 -  Call SalSendMsg (hWndItem, CB_SETEDITSEL, 0, VisNumberMakeLong (SalStrLength( MyValue ), -1))
.head 6 -  !
.head 6 +  If SalListQueryCount( hWndItem )
.head 7 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 7 -  Call SalSendClassMessage( SAM_AnyEdit, wParam, lParam )
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Number: wr_nAR_NR
.head 3 -  String: wp_sTyp
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: wp_sHerkunft
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete	! th 20180517 wenn, dann ohne Schlamperei
.head 4 +  If wp_sTyp = 'R'
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT re_intern INTO :dlgArtikelErsetzen.d1RE_INTERN FROM rezept WHERE re_nr = ' || NumberToStrX( wr_nAR_NR ) )
.head 5 -  Call SalHideWindowAndLabel( d1AR_INTERN)
.head 4 +  Else
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :dlgArtikelErsetzen.d1AR_INTERN FROM artikel WHERE ar_nr = ' || NumberToStrX( wr_nAR_NR ) )
.head 5 -  Call SalHideWindowAndLabel( d1RE_INTERN)
.head 4 -  Call SalSetWindowText( hWndForm, Translate( VisStrChoose(wp_sTyp = 'R', 'Komponente', 'Artikel') || ' ersetzen'))
.head 3 +  ! On SAM_CreateComplete	! wl 20170726
.head 4 +  If wp_sTyp = 'R'
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT re_intern INTO :dlgArtikelErsetzen.d1AR_INTERN FROM rezept WHERE re_nr = ' || NumberToStrX( wr_nAR_NR ) )
.head 4 +  Else 
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :dlgArtikelErsetzen.d1AR_INTERN FROM artikel WHERE ar_nr = ' || NumberToStrX( wr_nAR_NR ) )
.head 3 +  ! On SAM_CreateComplete
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :dlgArtikelErsetzen.d1AR_INTERN FROM artikel WHERE ar_nr = ' || NumberToStrX( wr_nAR_NR ) )
.head 1 +  ! ResultList: dlgART_Result
.winattr class Dialog Box:
.head 2 -  Class: ResultList
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Suchergebnis
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modeless
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.864"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  List Box: lbResult
.winattr
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ResultList
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: 0.042"
.head 5 -  Width:  3.338"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.729"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  ! On SAM_DoubleClick
.head 6 -  Set nSelection=SalListQuerySelection( lbResult )
.head 6 -  Set nSelection=dlgREZ_Result.nActivRow + nSelection + nCount -
.head 6 -  Call frmSD_Rezept.SetFetch( nSelection )
.head 5 +  ! On AM_KEYDOWN
.head 6 +  If wParam=34
.head 7 +  If NOT bEOF
.head 8 -  Set nInt=0
.head 8 -  Call SalListClear(  dlgREZ_Result.lbResult )
.head 8 -  Set nCount = nCount + nRows -1
.head 8 -  Call SqlFetchRow(dlgREZ_Result.hSqlResult, nCount ,nFetch )
.head 8 +  While NOT nFetch=FETCH_EOF AND nInt < 10
.head 9 -  Set dlgREZ_Result.sListItem=frmSD_Rezept.dfRE_INTERN
.head 9 -  Call SalListAdd( dlgREZ_Result.lbResult, dlgREZ_Result.sListItem )
.head 9 -  Call SqlFetchNext(dlgREZ_Result.hSqlResult, nFetch )
.head 9 -  Set nPgCount = nPgCount + 1
.head 9 -  Set nCount=nCount + 1
.head 7 -  Call SqlFetchRow(dlgREZ_Result.hSqlResult, dlgREZ_Result.nActivRow -1,nFetch )
.head 7 -  Set nPage=nPage+10
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call StatusText( '' )
.head 6 +  If wParam=33 and nCount >19
.head 7 -  Call SalListClear(  dlgREZ_Result.lbResult )
.head 7 -  Call SqlFetchRow(dlgREZ_Result.hSqlResult, dlgREZ_Result.nActivRow - 1 + nCount - 20 ,nFetch )
.head 7 -  Set nPgCount=0
.head 7 +  While NOT nCount=0 AND nPgCount <10
.head 8 -  Set dlgREZ_Result.sListItem=frmSD_Rezept.dfRE_INTERN
.head 8 -  Call SalListAdd( dlgREZ_Result.lbResult, dlgREZ_Result.sListItem )
.head 8 -  Call SqlFetchNext(dlgREZ_Result.hSqlResult, nFetch )
.head 8 -  Set nPgCount = nPgCount + 1
.head 8 -  Set nCount=nCount - 1
.head 7 -  Call SqlFetchRow(dlgREZ_Result.hSqlResult, dlgREZ_Result.nActivRow -1,nFetch )
.head 7 -  Set nPage=nPage-10
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 -  Call StatusText( '' )
.head 5 -  ! old Version
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nSelection=SalListQuerySelection( lbResult )
.head 6 -  Set nSelection=dlgART_Result.nActivRow+nSelection-1
.head 6 -  Call frmREZ_Artikel.SetFetch( nSelection )
.head 6 -  ! Call SalSendMsg( hWndForm, AM_EXIT, 0, 0 )
.head 3 +  Pushbutton: pbDestroy
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarExit
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 -  Message Actions 
.head 2 -  Functions 
.head 2 -  Window Parameters 
.head 2 +  Window Variables 
.head 3 -  Number: nSelection
.head 3 -  Number: nCount
.head 3 -  Number: nPgCount
.head 3 -  Number: nPage
.head 3 -  Number: nInt
.head 3 -  Number: nRow
.head 2 +  Message Actions 
.head 3 +  On SAM_CreateComplete
.head 4 -  Call StatusText( 'Daten werden eingelesen' )
.head 4 -  Call SalDisableWindow(frmREZ_Artikel.pbResultList )
.head 4 -  Call dlgART_Result.setVar( frmREZ_Artikel.nActRow, frmREZ_Artikel.hSqlObject )
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set nCount = 0
.head 4 -  Call SqlFetchRow( hSqlResult, nActivRow - 1,nFetch )
.head 4 -  ! Änderung am 28.05.99 von FIA auf Wunsch von Dietmar Langer
.head 4 +  ! While NOT nFetch=FETCH_EOF AND nCount < 50
.head 5 -  Set sListItem=frmSD_Rezept.dfRE_INTERN
.head 5 -  Call SalListAdd( dlgREZ_Result.lbResult, sListItem )
.head 5 -  Call SqlFetchNext( hSqlResult, nFetch )
.head 5 -  Set nCount=nCount + 1
.head 4 +  While NOT nFetch=FETCH_EOF AND nCount < 50
.head 5 -  Set sListItem=frmREZ_Artikel.dfAR_INTERN
.head 5 -  Call SalListAdd( dlgART_Result.lbResult, sListItem )
.head 5 -  Call SqlFetchNext( hSqlResult, nFetch )
.head 5 -  Set nCount=nCount + 1
.head 4 -  Call SqlFetchRow( hSqlResult, nActivRow-1,nFetch )
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call StatusText( '' )
.head 3 -  ! old Version
.head 3 +  ! On SAM_CreateComplete
.head 4 -  Call StatusText( 'Daten werden eingelesen' )
.head 4 -  Call SalDisableWindow( frmSD_VT_Patient.pbResultList )
.head 4 -  Call dlgPAT_Result.setVar( frmSD_VT_Patient.nActRow, frmSD_VT_Patient.hSqlObject )
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set nCount = 0
.head 4 -  Call SqlFetchRow( hSqlResult, nActivRow -1,nFetch )
.head 4 -  Call SalListSetTabs( dlgPAT_Result.lbResult, nTabStops )
.head 4 +  While NOT nFetch=FETCH_EOF AND nCount < 50
.head 5 -  Set sListItem= frmSD_VT_Patient. dfPT_NACHNAME ||'	'|| frmSD_VT_Patient.dfST_KBEZ
.head 5 -  Call SalListAdd( dlgPAT_Result.lbResult, sListItem )
.head 5 -  Call SqlFetchNext( hSqlResult, nFetch )
.head 5 -  Set nCount = nCount + 1
.head 4 -  Call SqlFetchRow( hSqlResult, nActivRow -1,nFetch )
.head 4 -  Call SalWaitCursor( FALSE )
.head 4 -  Call StatusText( '' )
.head 3 +  On SAM_Destroy
.head 4 +  If hWndArtikel
.head 5 -  Call SalEnableWindow(frmREZ_Artikel.pbResultList )
.head 4 -  Set hWndResultList = hWndNULL
.head 3 +  On AM_EXIT
.head 4 -  Call SalDestroyWindow( hWndForm )
.head 1 -  !
.head 1 +  Dialog Box: dlgART_Preis ! ra 20150217 mit resize
.head 2 -  Class: DialogStammdaten
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Preis pro Artikel
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  9.825"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.594"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 7 -  Call SalSendMsg( tblART_Preis, SAM_CreateComplete, 0, 0 )
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Data Field: dfAT_NR
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DataFieldWithComboBoxForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 3.488"
.head 7 -  Top: -0.01"
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text: ArtikelTyp
.head 5 -  Resource Id: 51005
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: BackGroundText
.head 5 -  Window Location and Size
.head 6 -  Left: 1.783"
.head 6 -  Top: 0.094"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 +  Combo Box: cmAT_TEXT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ComboWithDataFieldAll
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 3.038"
.head 6 -  Top: 0.063"
.head 6 -  Width:  3.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.271"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SetKeyDataField( 'artikeltyp', 'at_nr', ':dlgART_Preis.dfAT_NR' , 'at_aktiv = 1', 'at_sort, at_text' )
.head 7 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 7 -  Call SalSendMsg( tblART_Preis, SAM_CreateComplete, 0, 0 )
.head 4 +  Check Box: c1AR_PARAMETER1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: CheckShowOnly
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Sortiment
.head 5 -  Window Location and Size
.head 6 -  Left: 6.638"
.head 6 -  Top: 0.073"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tblART_Preis, SAM_CreateComplete, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set MyValue = TRUE
.head 2 +  Contents
.head 3 +  Child Table: tblART_Preis
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.917"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colAR_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_QUELLE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 20
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_INTERN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_TAX
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: MWSt
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.663"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_VK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VK (netto)
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_DATUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ab Datum
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.063"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_VK_NEU
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VK neu
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: ###000
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_SB_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call SetTableName( 'artikel' )
.head 6 -  Call SetWhereForUpdate( 'ar_nr = :dlgART_Preis.tblART_Preis.colAR_NR' )
.head 6 -  Call SetOrderForPopulate( 'ar_intern' )
.head 6 -  Call SetWhereForPopulate( '' )
.head 5 +  On SAM_CreateComplete
.head 6 -  ! ga 20100707: Mandant
.head 6 -  Set sWhereArtikel = GetWhereArtikel( FALSE )
.head 6 +  If NOT SalIsNull( dfAT_NR )
.head 7 -  Set sWhereArtikel = StrAppend( sWhereArtikel, ' AND ', 'ar_at_nr = :dlgART_Preis.dfAT_NR' )
.head 6 +  If c1AR_PARAMETER1
.head 7 -  Set sWhereArtikel = StrAppend( sWhereArtikel, ' AND ', 'ar_parameter1 = 1' )
.head 6 -  Call PopulateTable( '', sWhereArtikel, 'ar_intern' )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sWhereArtikel
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlgART_Typ ! ra 20150217 mit resize
.head 2 -  Class: DialogStammdaten
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ArtikelTyp
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  9.467"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.813"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblART_Typ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.073"
.head 6 -  Width:  8.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colAT_KURZBEZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAT_TEXT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAT_SORT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAT_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call colAT_NR.SetTableName( 'ARTIKELTYP' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colAT_SB_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAT_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAT_QUELLE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle*
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAT_AKTIV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: für Artikelpreis
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_Typ.SetTableName( 'ARTIKELTYP' )
.head 6 -  Call tblART_Typ.SetWhereForUpdate ('at_nr = :dlgART_Typ.tblART_Typ.colAT_NR')
.head 6 -  ! Call tblBLS_Gruppe.SetWhereForPopulate ('ri_re_nr = :dlgBLS_Gruppe.nRE_NR')
.head 6 -  Call tblART_Typ.SetOrderForPopulate ('at_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_Typ.PopulateTable('','','at_sort')
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlgART_Gruppe ! ra 20150217 mit resize
.head 2 -  Class: DialogStammdaten
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ArtikelGruppe
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  7.9"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.646"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull( dfAG_AT_NR )
.head 8 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 8 -  Set tblART_Gruppe.colAG_AT_NR = dfAG_AT_NR
.head 7 +  Else
.head 8 -  Call SalMessageBeep( MB_IconHand )
.head 8 -  Call MessageBox( 'Sie müssen zuerst einen Typ auswählen!', 'Achtung',MB_Ok | MB_IconHand )
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Combo Box: cmAT_TEXT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ComboWithDataFieldForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 2.288"
.head 6 -  Top: 0.02"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.271"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmAT_TEXT.SetKeyDataField( 'ARTIKELTYP',
'AT_NR', ':dlgART_Gruppe.dfAG_AT_NR' , '', '' )
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 7 -  Call SalSendMsg( tblART_Gruppe, SAM_CreateComplete, 0, 0 )
.head 4 +  Data Field: dfAG_AT_NR
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DataFieldWithComboBoxForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 3.488"
.head 7 -  Top: -0.01"
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblART_Gruppe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  7.05"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colAG_KURZBEZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAG_TEXT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAG_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call colAG_NR.SetTableName( 'ARTIKELGRUPPE' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colAG_SORT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAG_AT_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAG_SB_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAG_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAG_QUELLE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle*
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_Gruppe.SetTableName( 'ARTIKELGRUPPE' )
.head 6 -  Call tblART_Gruppe.SetWhereForUpdate ('ag_nr = :dlgART_Gruppe.tblART_Gruppe.colAG_NR')
.head 6 -  Call tblART_Gruppe.SetWhereForPopulate ('AG_AT_NR = :dlgART_Gruppe.dfAG_AT_NR')
.head 6 -  Call tblART_Gruppe.SetOrderForPopulate ('ag_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_Gruppe.PopulateTable('','AG_AT_NR = :dlgART_Gruppe.dfAG_AT_NR','AG_SORT')
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlgART_LagerOrt ! ra 20160610 mit lo_quelle
.head 2 -  Class: DialogStammdaten
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: LagerOrt
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  5.813"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.688"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblART_LagerOrt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  5.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colLO_KURZBEZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLO_TEXT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLO_SORT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLO_QUELLE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLO_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call colLO_NR.SetTableName( 'LAGERORT' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colLO_SB_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLO_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_LagerOrt.SetTableName( 'LAGERORT' )
.head 6 -  Call tblART_LagerOrt.SetWhereForUpdate ('lo_nr = :dlgART_LagerOrt.tblART_LagerOrt.colLO_NR')
.head 6 -  ! Call tblBLS_Gruppe.SetWhereForPopulate ('ri_re_nr = :dlgBLS_Gruppe.nRE_NR')
.head 6 -  Call tblART_LagerOrt.SetOrderForPopulate ('lo_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_LagerOrt.PopulateTable('','','lo_sort')
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  ! DialogStammdaten: dlgART_LagerOrt ! ra 20150217 mit resize
.winattr class Dialog Box:
.head 2 -  Class: DialogStammdaten
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: LagerOrt
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  5.813"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.688"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? Yes
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DialogStammdaten
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Child Table: tblART_LagerOrt
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  5.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colLO_KURZBEZ
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_TEXT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_SORT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Call colLO_NR.SetTableName( 'LAGERORT' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colLO_SB_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Update
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_LagerOrt.SetTableName( 'LAGERORT' )
.head 6 -  Call tblART_LagerOrt.SetWhereForUpdate ('lo_nr = :dlgART_LagerOrt.tblART_LagerOrt.colLO_NR')
.head 6 -  ! Call tblBLS_Gruppe.SetWhereForPopulate ('ri_re_nr = :dlgBLS_Gruppe.nRE_NR')
.head 6 -  Call tblART_LagerOrt.SetOrderForPopulate ('lo_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_LagerOrt.PopulateTable('','','lo_sort')
.head 2 -  Functions 
.head 2 -  Window Parameters 
.head 2 -  Window Variables 
.head 2 -  Message Actions 
.head 1 +  ! InsertBox: dlgART_Preis
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Preis pro Artikel
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  9.825"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.594"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 7 -  Call SalSendMsg( tblART_Preis, SAM_CreateComplete, 0, 0 )
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 -  !
.head 4 +  Data Field: dfAT_NR
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DataFieldWithComboBoxForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 3.488"
.head 7 -  Top: -0.01"
.head 7 -  Width:  1.413"
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 -  Background Text: ArtikelTyp
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: BackGroundText
.head 5 -  Window Location and Size
.head 6 -  Left: 1.783"
.head 6 -  Top: 0.094"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 +  Combo Box: cmAT_TEXT
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ComboWithDataFieldAll
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 3.038"
.head 6 -  Top: 0.063"
.head 6 -  Width:  3.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.271"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? No
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 5 -  List Initialization 
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call SetKeyDataField( 'artikeltyp', 'at_nr', ':dlgART_Preis.dfAT_NR' , 'at_aktiv = 1', 'at_sort, at_text' )
.head 7 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 7 -  Call SalSendMsg( tblART_Preis, SAM_CreateComplete, 0, 0 )
.head 4 +  Check Box: c1AR_PARAMETER1
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: CheckShowOnly
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Sortiment
.head 5 -  Window Location and Size
.head 6 -  Left: 6.638"
.head 6 -  Top: 0.073"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tblART_Preis, SAM_CreateComplete, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Set MyValue = TRUE
.head 2 +  Contents 
.head 3 +  Child Table: tblART_Preis
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  9.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colAR_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_QUELLE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 20
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 100
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_TAX
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: MWSt
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.663"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_VK
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VK (netto)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_DATUM
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ab Datum
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.063"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_VK_NEU
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: VK neu
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_SB_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Update
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call SetTableName( 'artikel' )
.head 6 -  Call SetWhereForUpdate( 'ar_nr = :dlgART_Preis.tblART_Preis.colAR_NR' )
.head 6 -  Call SetOrderForPopulate( 'ar_intern' )
.head 6 -  Call SetWhereForPopulate( '' )
.head 5 +  On SAM_CreateComplete
.head 6 -  ! ga 20100707: Mandant
.head 6 -  Set sWhereArtikel = GetWhereArtikel( FALSE )
.head 6 +  If NOT SalIsNull( dfAT_NR )
.head 7 -  Set sWhereArtikel = StrAppend( sWhereArtikel, ' AND ', 'ar_at_nr = :dlgART_Preis.dfAT_NR' )
.head 6 +  If c1AR_PARAMETER1
.head 7 -  Set sWhereArtikel = StrAppend( sWhereArtikel, ' AND ', 'ar_parameter1 = 1' )
.head 6 -  Call PopulateTable( '', sWhereArtikel, 'ar_intern' )
.head 2 -  Functions 
.head 2 -  Window Parameters 
.head 2 +  Window Variables 
.head 3 -  String: sWhereArtikel
.head 2 -  Message Actions 
.head 1 +  ! InsertBox: dlgART_Typ
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ArtikelTyp
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  6.788"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.688"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Child Table: tblART_Typ
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.073"
.head 6 -  Width:  6.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colAT_KURZBEZ
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez*
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAT_TEXT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text**
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAT_SORT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAT_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Call colAT_NR.SetTableName( 'ARTIKELTYP' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colAT_SB_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAT_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Update
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_Typ.SetTableName( 'ARTIKELTYP' )
.head 6 -  Call tblART_Typ.SetWhereForUpdate ('at_nr = :dlgART_Typ.tblART_Typ.colAT_NR')
.head 6 -  ! Call tblBLS_Gruppe.SetWhereForPopulate ('ri_re_nr = :dlgBLS_Gruppe.nRE_NR')
.head 6 -  Call tblART_Typ.SetOrderForPopulate ('at_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_Typ.PopulateTable('','','at_sort')
.head 2 -  Functions 
.head 2 -  Window Parameters 
.head 2 -  Window Variables 
.head 2 -  Message Actions 
.head 1 +  ! InsertBox: dlgART_Gruppe
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ArtikelGruppe
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  5.813"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.646"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull( dfAG_AT_NR )
.head 8 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 8 -  Set tblART_Gruppe.colAG_AT_NR = dfAG_AT_NR
.head 7 +  Else 
.head 8 -  Call SalMessageBeep( MB_IconHand )
.head 8 -  Call MessageBox( 'Sie müssen zuerst einen Typ auswählen!', 'Achtung',MB_Ok | MB_IconHand )
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 -  !
.head 4 +  Combo Box: cmAT_TEXT
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ComboWithDataFieldForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 2.288"
.head 6 -  Top: 0.02"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.271"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? No
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? No
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 5 -  List Initialization 
.head 5 +  Message Actions 
.head 6 +  On SAM_Create
.head 7 -  Call cmAT_TEXT.SetKeyDataField( 'ARTIKELTYP',
'AT_NR', ':dlgART_Gruppe.dfAG_AT_NR' , '', '' )
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 7 -  Call SalSendMsg( tblART_Gruppe, SAM_CreateComplete, 0, 0 )
.head 4 +  Data Field: dfAG_AT_NR
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DataFieldWithComboBoxForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 3.488"
.head 7 -  Top: -0.01"
.head 7 -  Width:  1.413"
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Child Table: tblART_Gruppe
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  5.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colAG_KURZBEZ
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez*
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAG_TEXT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text**
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAG_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Call colAG_NR.SetTableName( 'ARTIKELGRUPPE' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colAG_SORT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAG_AT_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAG_SB_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAG_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Update
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_Gruppe.SetTableName( 'ARTIKELGRUPPE' )
.head 6 -  Call tblART_Gruppe.SetWhereForUpdate ('ag_nr = :dlgART_Gruppe.tblART_Gruppe.colAG_NR')
.head 6 -  Call tblART_Gruppe.SetWhereForPopulate ('AG_AT_NR = :dlgART_Gruppe.dfAG_AT_NR')
.head 6 -  Call tblART_Gruppe.SetOrderForPopulate ('ag_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_Gruppe.PopulateTable('','AG_AT_NR = :dlgART_Gruppe.dfAG_AT_NR','AG_SORT')
.head 2 -  Functions 
.head 2 -  Window Parameters 
.head 2 -  Window Variables 
.head 2 -  Message Actions 
.head 1 +  ! InsertBox: dlgART_LagerOrt
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: LagerOrt
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  5.813"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.688"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Standard
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Child Table: tblART_LagerOrt
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  5.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colLO_KURZBEZ
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_TEXT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_SORT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 -  Call colLO_NR.SetTableName( 'LAGERORT' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colLO_SB_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SB
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLO_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Update
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_LagerOrt.SetTableName( 'LAGERORT' )
.head 6 -  Call tblART_LagerOrt.SetWhereForUpdate ('lo_nr = :dlgART_LagerOrt.tblART_LagerOrt.colLO_NR')
.head 6 -  ! Call tblBLS_Gruppe.SetWhereForPopulate ('ri_re_nr = :dlgBLS_Gruppe.nRE_NR')
.head 6 -  Call tblART_LagerOrt.SetOrderForPopulate ('lo_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_LagerOrt.PopulateTable('','','lo_sort')
.head 2 -  Functions 
.head 2 -  Window Parameters 
.head 2 -  Window Variables 
.head 2 -  Message Actions 
.head 1 -  !
.head 1 +  Dialog Box: dlgART_LagerPos
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: LagerPosition
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  5.813"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.646"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If NOT SalIsNull( dfLP_LO_NR )
.head 8 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 8 -  Set tblART_LagerPos.colLP_LO_NR = dfLP_LO_NR
.head 7 +  Else
.head 8 -  Call SalMessageBeep( MB_IconHand )
.head 8 -  Call MessageBox( 'Sie müssen zuerst einen Lagerort auswählen!', 'Achtung', MB_Ok | MB_IconHand )
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 -  !
.head 4 +  Combo Box: cmLO_TEXT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ComboWithDataFieldForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 2.288"
.head 6 -  Top: 0.02"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.771"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmLO_TEXT.SetKeyDataField( 'LAGERORT',
'LO_NR', ':dlgART_LagerPos.dfLP_LO_NR' , '', '' )
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 7 -  Call SalSendMsg( tblART_LagerPos, SAM_CreateComplete, 0, 0 )
.head 4 +  Data Field: dfLP_LO_NR
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: DataFieldWithComboBoxForTables
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: 3.488"
.head 7 -  Top: -0.01"
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblART_LagerPos
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.188"
.head 6 -  Top: 0.156"
.head 6 -  Width:  5.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.958"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colLP_KURZBEZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 10
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.163"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLP_TEXT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Text
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.238"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLP_SORT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Sort
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLP_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call colLP_NR.SetTableName( 'LAGERPOS' )
.head 8 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  Column: colLP_LO_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.463"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLP_SB_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_SB
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLP_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SqlVarSetup( p_hSql )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblART_LagerPos.SetTableName( 'LAGERPOS' )
.head 6 -  Call tblART_LagerPos.SetWhereForUpdate ('lp_nr = :dlgART_LagerPos.tblART_LagerPos.colLP_NR')
.head 6 -  Call tblART_LagerPos.SetWhereForPopulate ('LP_LO_NR = :dlgART_LagerPos.dfLP_LO_NR')
.head 6 -  Call tblART_LagerPos.SetOrderForPopulate ('lp_sort')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblART_LagerPos.PopulateTable('','LP_LO_NR = :dlgART_LagerPos.dfLP_LO_NR','lp_sort')
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlgART_Einstellungen
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Rezeptureinstellungen
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 3.875"
.head 4 -  Top: 2.031"
.head 4 -  Width:  4.413"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 2.927"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: 0.031"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Group Box: Rezptureinstellungen
.head 4 -  Resource Id: 64437
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 0.073"
.head 5 -  Width:  3.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Group Box: Preisfindung
.head 4 -  Resource Id: 30777
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 1.156"
.head 5 -  Width:  3.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfRZ_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 25
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.588"
.head 6 -  Top: 0.24"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Basismenge
.head 4 -  Resource Id: 64435
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.283"
.head 5 -  Top: 0.51"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfRZ_BASISMENGE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 25
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.738"
.head 6 -  Top: 0.49"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Stück
.head 4 -  Resource Id: 64436
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 2.688"
.head 5 -  Top: 0.552"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfRZ_FAKTOR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 25
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.738"
.head 6 -  Top: 0.781"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: g = 1
.head 4 -  Resource Id: 64438
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 2.588"
.head 5 -  Top: 0.844"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Center
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfRZ_BASISEINHEIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.138"
.head 6 -  Top: 0.781"
.head 6 -  Width:  0.65"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: EK + %
.head 4 -  Resource Id: 30776
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 2.183"
.head 5 -  Top: 1.76"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfRZ_RUNDUNG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.238"
.head 6 -  Top: 1.74"
.head 6 -  Width:  0.65"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbRZ_LAPREISE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: über LA-Preissätze
.head 4 -  Window Location and Size
.head 5 -  Left: 0.467"
.head 5 -  Top: 1.396"
.head 5 -  Width:  2.317"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If NOT Benutzer.HatModul(MODUL.EINKAUF)
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 3 +  Check Box: cbRZ_FIXBETRAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Fixbeträge
.head 4 -  Window Location and Size
.head 5 -  Left: 0.467"
.head 5 -  Top: 1.719"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: BerechnungsBasis
.head 4 -  Resource Id: 57904
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.788"
.head 5 -  Top: 2.135"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmRZ_BASIS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.238"
.head 5 -  Top: 2.073"
.head 5 -  Width:  0.65"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.729"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 +  List Initialization
.head 5 -  Text: EK
.head 5 -  Text: DP
.head 5 -  Text: VK
.head 4 -  Message Actions
.head 3 +  Data Field: dfRZ_SB_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate_SB
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfRZ_UPDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate_Update
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SqlVarSetup( p_hSql )
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On AM_SAVE
.head 4 +  If SalIsNull( dfRZ_NR )
.head 5 -  Set dfRZ_NR = 1
.head 4 -  Call SalSendClassMessage( AM_SAVE, 0, 0 )
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 4 -  Call dlgART_Einstellungen.SetTableName( 'REZEPTUR' )
.head 4 -  Call dlgART_Einstellungen.SetWhereForUpdate ('RZ_NR = :dlgART_Einstellungen.dfRZ_NR')
.head 3 +  On SAM_CreateComplete ! th 20180502 über LA-Preissätze
.head 4 -  Call Sql_FetchOne(hSql, 'SELECT rz_nr, rz_basiseinheit, rz_faktor, rz_basismenge, rz_fixbetrag, rz_rundung, 
rz_basis, rz_lapreise
FROM rezeptur
INTO :dlgART_Einstellungen.dfRZ_NR,  :dlgART_Einstellungen.dfRZ_BASISEINHEIT,  
:dlgART_Einstellungen.dfRZ_FAKTOR,  :dlgART_Einstellungen.dfRZ_BASISMENGE,
:dlgART_Einstellungen.cbRZ_FIXBETRAG, :dlgART_Einstellungen.dfRZ_RUNDUNG,
:dlgART_Einstellungen.cmRZ_BASIS, :dlgART_Einstellungen.cbRZ_LAPREISE')
.head 3 +  ! On SAM_CreateComplete
.head 4 -  Call Sql_FetchOne(hSql, 'SELECT rz_nr, rz_basiseinheit, rz_faktor, rz_basismenge, rz_fixbetrag, rz_rundung, 
rz_basis
FROM rezeptur
INTO :dlgART_Einstellungen.dfRZ_NR,  :dlgART_Einstellungen.dfRZ_BASISEINHEIT,  
:dlgART_Einstellungen.dfRZ_FAKTOR,  :dlgART_Einstellungen.dfRZ_BASISMENGE,
:dlgART_Einstellungen.cbRZ_FIXBETRAG, :dlgART_Einstellungen.dfRZ_RUNDUNG,
:dlgART_Einstellungen.cmRZ_BASIS')
.head 1 -  !
.head 1 +  Dialog Box: dlgART_Loeschen
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel löschen
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  4.85"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 2.813"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Der Artikel kommt vor...
.head 4 -  Resource Id: 15928
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.338"
.head 5 -  Top: 0.094"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Löschen ist nicht möglich
.head 4 -  Resource Id: 15930
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 1.802"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Red
.head 4 -  Background Color: Class Default
.head 3 +  List Box: lbInstanzes
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.406"
.head 5 -  Width:  4.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.229"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.938"
.head 5 -  Top: 2.24"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! nicht löschen, wenn er verwendet wird
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 +  Pushbutton: pbEsc
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.238"
.head 5 -  Top: 2.24"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Standard
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: CheckArtikel
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sWhere
.head 5 -  Boolean: bKommtVor
.head 4 +  Actions
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set nGlobalTemp = 0
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Rezeptur...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM rezkomp
	WHERE
		rk_typ = \'A\' AND
		rk_ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Rezeptur')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Stationsanforderungen...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM stationsanford
	WHERE
		sa_re_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Stationsanforderungen')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Sortimente...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM stationsort
	WHERE
		so_ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Sortimenten')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Lagerbedarf...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM lagerbedarf
	WHERE
		lb_ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Lagerbedarf')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  Call StatusText( '' )
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return bKommtVor
.head 3 +  ! Function: CheckArtikel
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Boolean: bKommtVor
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 -  Set nGlobalTemp = 0
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Rezeptur...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM rezkomp
	WHERE
		rk_typ = \'A\' AND
		rk_ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Rezeptur')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Stationsanforderungen...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM stationsanford
	WHERE
		sa_re_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Stationsanforderungen')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  Call StatusText( 'Prüfe Sortimente...' )
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT COUNT(*) INTO :nGlobalTemp FROM stationsort
	WHERE
		so_ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 5 +  If nGlobalTemp > 0
.head 6 -  Call SalListAdd( lbInstanzes, PadLeft( SalNumberToStrX( nGlobalTemp, 0 ), 4 ) || ' x in Sortimenten')
.head 6 -  Set bKommtVor = TRUE
.head 5 -  !
.head 5 -  !
.head 5 -  Call StatusText( '' )
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Return bKommtVor
.head 2 +  Window Parameters
.head 3 -  Number: wp_nAR_NR
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalHideWindow( hWndForm )
.head 3 +  On SAM_CreateComplete
.head 4 +  If CheckArtikel(  )
.head 5 -  Call SalShowWindow( hWndForm )
.head 4 +  Else
.head 5 -  Call SalEndDialog( hWndForm, TRUE )
.head 1 -  !
.head 1 +  Dialog Box: cjArtikelTaskPanel ! ra 20150803 mit "nicht in rezeptur"
.head 2 -  Class: CjTaskPanel
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Standard
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modeless
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilterString
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.183"
.head 6 -  Top: 0.448"
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbArtikeltyp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboOutline
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! ga 20091005: noch nicht verfügbar "at_aktiv=1"
.head 6 -  Call InitOutline( Translate( SC_ALLE ), 'at_nr', 'at_text', 'artikeltyp', '', 'at_text', 1 )
.head 6 -  ! ga 20091005: noch nicht verfügbar "ag_aktiv=1"
.head 6 -  Call AddLevel( 'ag_nr', 'ag_at_nr', 'ag_text', 'artikelgruppe', '', 'ag_text' )
.head 5 +  On SAM_AnyEdit
.head 6 +  If lParam != SAM_Create ! nicht in Verbindung mit Initialisierung
.head 7 -  Call ApplyFilter(   )
.head 5 +  ! On SAM_Create
.head 6 -  Call SetKeyValue( 'at_nr', 'at_text', 'artikeltyp', '', '', TRUE )
.head 5 +  ! On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbMandant
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboKeyValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListSetSelect( hWndItem, AddAll(  ) )
.head 6 -  Call Add( nUserKuecheNrMandant, Translate( 'Eigene Artikel' ) )
.head 6 -  Call Add( -1, Translate( 'Vorlageartikel' ) )
.head 5 +  On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbTaxierung
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboOutline
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.514"
.head 5 -  Top: 2.25"
.head 5 -  Width:  1.871"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call InitOutline( Translate( SC_ALLE ), 'th_nr', 'th_bezeichnung', 'taxierungshauptgr', '', 'th_sort,th_bezeichnung', 1 )
.head 6 -  Call AddLevel( 'tu_nr', 'tu_th_nr', 'tu_bezeichnung', 'taxierungsuntergr', 'EXISTS (SELECT * FROM ARTIKELTAXIERUNG WHERE AT_TU_NR = tu_nr)', 'tu_sort, tu_bezeichnung' )
.head 5 +  On SAM_AnyEdit
.head 6 +  If lParam != SAM_Create ! nicht in Verbindung mit Initialisierung
.head 7 -  Call ApplyFilter(   )
.head 3 +  ActiveX: axTaskPanel
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65790012 015400610073006B 00500061006E0065 006C00200043006F
0020: 006E00740072006F 006C00200043006F 0070007900720069 0067006800740020
0040: 0028006300290020 0032003000300033 002D003200300030 003900200043006F
0060: 00640065006A006F 0063006B00200053 006F006600740077 006100720065000D
0080: 000A00500052004F 0044005500430054 002D00490044003A 00200043006F0064
00A0: 0065006A006F0063 006B002E00540061 0073006B00500061 006E0065006C002E
00C0: 0041006300740069 007600650058002E 007600310033002E 0032000D000A0056
00E0: 0041004C00490044 004100540045002D 0043004F00440045 003A00200044004A
0100: 004E002D00540058 0041002D00530047 0058002D00450046 005900004C69634B
0120: 65794C656E000400 1201000000000000 00
.enddata
.data CLASSPROPSSIZE
0000: 3101
.enddata
.data RESOURCE 5 0 1 3753798604
0000: 000A000012020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000456FBDEC05 73494E0087A1ABAE
0100: 1483BE7CF8000000 0F40047189004C6C CA0103000000F280 0000204A00450045
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2450000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF0002000D 0061020000084F03
01C0: 0040000000E80102 0000E90100002702 0000013300016400 FC0000FFFFFFFFFF
01E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0200: FFFFFFFFFFFFFFFF FFFFFFFFFFFF280C 00001A49000088FF A402684E9F02FA00
0220: 00FFFFFF
.enddata
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjTaskPanel
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Double Click
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.0"
.head 6 -  Top: 0.0"
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classCreate	! th 20160802 Zuordnung und keine Zuordnung vorhanden
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Set nIdTaxFehlt = 28
.head 5 -  Set nIdNichtInRezeptur = 29
.head 5 -  Set nIdLaDatenUpdate = 30
.head 5 -  Set nIdLaZuordnungVorhanden = 31
.head 5 -  Set nIdKeineLaZuordnungVorhanden = 32
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Taxierung' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbTaxierung )
.head 5 -  Call CjAddGroupItemControl( nIdTaxFehlt, Translate( 'keine Taxierung' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 3, Translate( 'Kriterien' ), '' )
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdNichtInRezeptur, Translate( 'nicht in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ra 20150803 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF )
.head 6 -  Call CjAddGroupItemControl( nIdLaDatenUpdate, Translate( 'Lieferart.-Daten Update' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 6 -  Call CjAddGroupItemControl( nIdLaZuordnungVorhanden, Translate( 'Zuordnung vorhanden' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 6 -  Call CjAddGroupItemControl( nIdKeineLaZuordnungVorhanden, Translate( 'keine Zuordnung vorhanden' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! th 20160603: neue CheckBox "Zuordnung(en) vorhanden", Zuodnung usw nur mit Einkaufsmodul anzeigen
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Set nIdTaxFehlt = 28
.head 5 -  Set nIdNichtInRezeptur = 29
.head 5 -  Set nIdLaDatenUpdate = 30
.head 5 -  Set nIdLaZuordnungVorhanden = 31
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Taxierung' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbTaxierung )
.head 5 -  Call CjAddGroupItemControl( nIdTaxFehlt, Translate( 'keine Taxierung' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 3, Translate( 'Kriterien' ), '' )
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdNichtInRezeptur, Translate( 'nicht in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ra 20150803 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.EINKAUF )
.head 6 -  Call CjAddGroupItemControl( nIdLaDatenUpdate, Translate( 'Lieferart.-Daten Update' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 6 -  Call CjAddGroupItemControl( nIdLaZuordnungVorhanden, Translate( 'Zuordnung(en) vorhanden' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! th 20160202: neue CheckBox "Lieferartikel-Daten Update"
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Set nIdTaxFehlt = 28
.head 5 -  Set nIdNichtInRezeptur = 29
.head 5 -  Set nIdLaDatenUpdate = 30
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Taxierung' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbTaxierung )
.head 5 -  Call CjAddGroupItemControl( nIdTaxFehlt, Translate( 'keine Taxierung' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 3, Translate( 'Kriterien' ), '' )
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdNichtInRezeptur, Translate( 'nicht in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ra 20150803 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdLaDatenUpdate, Translate( 'Lieferart.-Daten Update' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! ra 20150213 mit Taxierung
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Set nIdTaxFehlt = 28
.head 5 -  Set nIdNichtInRezeptur = 29
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Taxierung' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbTaxierung )
.head 5 -  Call CjAddGroupItemControl( nIdTaxFehlt, Translate( 'keine Taxierung' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 3, Translate( 'Kriterien' ), '' )
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdNichtInRezeptur, Translate( 'nicht in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ra 20150803 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! wl 20140309 mit Milchküche
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! wl 20131223 mit Lieferanten
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: classItemClick	!  th 20160802: mit nIdKeineLaZuordnungVorhanden
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.head 6 -  Class: cObjMenu
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH ) OR ( p_nId = nIdTaxFehlt ) OR ( p_nId = nIdNichtInRezeptur ) OR (p_nId = nIdLaDatenUpdate) OR (p_nId = nIdLaZuordnungVorhanden)
OR (p_nId = nIdKeineLaZuordnungVorhanden)
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	!  th 20160603: mit nIdLaZuordnungVorhanden
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH ) OR ( p_nId = nIdTaxFehlt ) OR ( p_nId = nIdNichtInRezeptur ) OR (p_nId = nIdLaDatenUpdate) OR (p_nId = nIdLaZuordnungVorhanden)
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	!  th 20160202: mit nIdLaDatenUpdate
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH ) OR ( p_nId = nIdTaxFehlt ) OR ( p_nId = nIdNichtInRezeptur ) OR (p_nId = nIdLaDatenUpdate)
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	!  ra 20150803 mit nicht in rezeptur
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH ) OR ( p_nId = nIdTaxFehlt ) OR ( p_nId = nIdNichtInRezeptur )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	! ra 20150213 mit Taxierung
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH ) OR ( p_nId = nIdTaxFehlt ) 
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	! wl 20140309 mit Milchküche
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	! wl 20131223 mit Lieferanten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  OR ( p_nId = nIdLieferant 
)
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  Function: ApplyFilter		! th 20160802: Set LaKeineZuordnungVorhanden
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetTaxFehlt( CjIsGroupItemChecked(nIdTaxFehlt) )
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetNichtInRezeptur( CjIsGroupItemChecked(nIdNichtInRezeptur) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  Call oParamArtikel.SetLaDatenUpdate( CjIsGroupItemChecked( nIdLaDatenUpdate ) )
.head 5 -  Call oParamArtikel.SetLaZuordnungVorhanden( CjIsGroupItemChecked( nIdLaZuordnungVorhanden ) )
.head 5 -  Call oParamArtikel.SetKeineLaZuordnungVorhanden( CjIsGroupItemChecked( nIdKeineLaZuordnungVorhanden ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  Call oParamArtikel.SetTU_NR( cmbTaxierung.GetKeyX( 2 ) )
.head 5 -  Call oParamArtikel.SetTH_NR( cmbTaxierung.GetKeyX( 1 ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! th 20160603: Set LaZuordnungVorhanden
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetTaxFehlt( CjIsGroupItemChecked(nIdTaxFehlt) )
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetNichtInRezeptur( CjIsGroupItemChecked(nIdNichtInRezeptur) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  Call oParamArtikel.SetLaDatenUpdate( CjIsGroupItemChecked( nIdLaDatenUpdate ) )
.head 5 -  Call oParamArtikel.SetLaZuordnungVorhanden( CjIsGroupItemChecked( nIdLaZuordnungVorhanden ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  Call oParamArtikel.SetTU_NR( cmbTaxierung.GetKeyX( 2 ) )
.head 5 -  Call oParamArtikel.SetTH_NR( cmbTaxierung.GetKeyX( 1 ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! th 20160202: Set LaDatenUpdate
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetTaxFehlt( CjIsGroupItemChecked(nIdTaxFehlt) )
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetNichtInRezeptur( CjIsGroupItemChecked(nIdNichtInRezeptur) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  Call oParamArtikel.SetLaDatenUpdate( CjIsGroupItemChecked( nIdLaDatenUpdate ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  Call oParamArtikel.SetTU_NR( cmbTaxierung.GetKeyX( 2 ) )
.head 5 -  Call oParamArtikel.SetTH_NR( cmbTaxierung.GetKeyX( 1 ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! ra 20150803 mit nicht in rezeptur
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetTaxFehlt( CjIsGroupItemChecked(nIdTaxFehlt) )
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetNichtInRezeptur( CjIsGroupItemChecked(nIdNichtInRezeptur) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  Call oParamArtikel.SetTU_NR( cmbTaxierung.GetKeyX( 2 ) )
.head 5 -  Call oParamArtikel.SetTH_NR( cmbTaxierung.GetKeyX( 1 ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! ra 20150213 mit Taxierung
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetTaxFehlt( CjIsGroupItemChecked(nIdTaxFehlt) )
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  Call oParamArtikel.SetTU_NR( cmbTaxierung.GetKeyX( 2 ) )
.head 5 -  Call oParamArtikel.SetTH_NR( cmbTaxierung.GetKeyX( 1 ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! wl 20140309 mit Milchküche
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! wl 20131223 mit Lieferanten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = ARTIKEL.AnsichtAlphabet
.head 6 -  Set dfFilterString = ParamGetStr( p_nKey )
.head 6 -  Call SalPostMsg( dfFilterString, SAM_Validate, 0, 0 )
.head 3 +  Function: ClearFilter	! th 20160802: LaDatenUpdate
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call cmbTaxierung.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdTaxFehlt, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdNichtInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_MILCH, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdLaDatenUpdate, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdLaZuordnungVorhanden, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdKeineLaZuordnungVorhanden, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: ClearFilter	! th 20160202: LaDatenUpdate
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call cmbTaxierung.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdTaxFehlt, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdNichtInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_MILCH, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdLaDatenUpdate, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: ClearFilter	! ra 20150213 mit Taxierung
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call cmbTaxierung.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdTaxFehlt, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdNichtInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_MILCH, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: ClearFilter	! wl 20140309 mit Milchküche
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_MILCH, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: ClearFilter
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: GetCaption ! ga 20130205: ohne Webdings Dropdown Pfeil, weil in der Schweiz nicht verfügbar
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: p_sCaption
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sXaml
.head 4 +  Actions
.head 5 -  Return p_sCaption || '...'
.head 3 +  ! Function: GetCaption
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sXaml
.head 4 +  Actions 
.head 5 -  Set sXaml = '<StackPanel Orientation="Horizontal">'
.head 5 -  Set sXaml = sXaml || '<TextBlock VerticalAlignment="Center">' || p_sCaption || '</TextBlock>'
.head 5 -  Set sXaml = sXaml || '<TextBlock Padding="6, 0, 0, 0" FontFamily="Webdings" VerticalAlignment="Center">6</TextBlock>'
.head 5 -  Set sXaml = sXaml || '</StackPanel>'
.head 5 -  Return sXaml
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  ! Erste Instanz des Filterobjekts, die weiteren Filter "holen" sich dann eine Referenz bei Bedarf
.head 3 -  FunctionalVar: oParamArtikel
.head 4 -  Class: cObjParamArtikel
.head 3 -  !
.head 3 -  Number: nIdFilterString
.head 3 -  Number: nIdFilterClear
.head 3 -  Number: nIdOhneBLS
.head 3 -  Number: nIdUnchecked
.head 3 -  Number: nIdAR_GESP
.head 3 -  Number: nIdAR_MILCH
.head 3 -  Number: nIdAR_GEPRUEFT
.head 3 -  Number: nIdAR_PARAMETER1
.head 3 -  Number: nIdInRezeptur
.head 3 -  Number: nIdNichtInRezeptur
.head 3 -  Number: nIdLieferant
.head 3 -  ! th 20160202
.head 3 -  Number: nIdLaDatenUpdate
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: nIdLaZuordnungVorhanden
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: nIdKeineLaZuordnungVorhanden
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  !
.head 3 -  Number: nFilterIndex
.head 3 -  !
.head 3 -  Number: nIdTaxFehlt
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus( dfFilterString )
.head 1 +  ! CjTaskPanel: cjArtikelTaskPanel
.winattr class Dialog Box:
.head 2 -  Class: CjTaskPanel
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Standard
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modeless
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Data Field: dfFilterString
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.183"
.head 6 -  Top: 0.448"
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbArtikeltyp
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboOutline
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! ga 20091005: noch nicht verfügbar "at_aktiv=1"
.head 6 -  Call InitOutline( Translate( SC_ALLE ), 'at_nr', 'at_text', 'artikeltyp', '', 'at_text', 1 )
.head 6 -  ! ga 20091005: noch nicht verfügbar "ag_aktiv=1"
.head 6 -  Call AddLevel( 'ag_nr', 'ag_at_nr', 'ag_text', 'artikelgruppe', '', 'ag_text' )
.head 5 +  On SAM_AnyEdit
.head 6 +  If lParam != SAM_Create ! nicht in Verbindung mit Initialisierung
.head 7 -  Call ApplyFilter(   )
.head 5 +  ! On SAM_Create
.head 6 -  Call SetKeyValue( 'at_nr', 'at_text', 'artikeltyp', '', '', TRUE )
.head 5 +  ! On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbMandant
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboKeyValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SalListSetSelect( hWndItem, AddAll(  ) )
.head 6 -  Call Add( nUserKuecheNrMandant, Translate( 'Eigene Artikel' ) )
.head 6 -  Call Add( -1, Translate( 'Vorlageartikel' ) )
.head 5 +  On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbTaxierung
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboOutline
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.514"
.head 5 -  Top: 2.25"
.head 5 -  Width:  1.871"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.104"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call InitOutline( Translate( SC_ALLE ), 'th_nr', 'th_bezeichnung', 'taxierungshauptgr', '', 'th_sort,th_bezeichnung', 1 )
.head 6 -  Call AddLevel( 'tu_nr', 'tu_th_nr', 'tu_bezeichnung', 'taxierungsuntergr', 'EXISTS (SELECT * FROM ARTIKELTAXIERUNG WHERE AT_TU_NR = tu_nr)', 'tu_sort, tu_bezeichnung' )
.head 5 +  On SAM_AnyEdit
.head 6 +  If lParam != SAM_Create ! nicht in Verbindung mit Initialisierung
.head 7 -  Call ApplyFilter(   )
.head 3 +  ActiveX: axTaskPanel
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65790012 015400610073006B 00500061006E0065 006C00200043006F
0020: 006E00740072006F 006C00200043006F 0070007900720069 0067006800740020
0040: 0028006300290020 0032003000300033 002D003200300030 003900200043006F
0060: 00640065006A006F 0063006B00200053 006F006600740077 006100720065000D
0080: 000A00500052004F 0044005500430054 002D00490044003A 00200043006F0064
00A0: 0065006A006F0063 006B002E00540061 0073006B00500061 006E0065006C002E
00C0: 0041006300740069 007600650058002E 007600310033002E 0032000D000A0056
00E0: 0041004C00490044 004100540045002D 0043004F00440045 003A00200044004A
0100: 004E002D00540058 0041002D00530047 0058002D00450046 005900004C69634B
0120: 65794C656E000400 1201000000000000 00
.enddata
.data CLASSPROPSSIZE
0000: 3101
.enddata
.winattr
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjTaskPanel
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Double Click
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.0"
.head 6 -  Top: 0.0"
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 -  Message Actions 
.head 2 +  Functions 
.head 3 +  Function: classCreate	! ra 20150213 mit Taxierung
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Set nIdTaxFehlt = 28
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Taxierung' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbTaxierung )
.head 5 -  Call CjAddGroupItemControl( nIdTaxFehlt, Translate( 'keine Taxierung' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 3, Translate( 'Kriterien' ), '' )
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! wl 20140309 mit Milchküche
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Set nIdAR_MILCH = 27
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_MILCH, Translate( 'Milchküche' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate	! wl 20131223 mit Lieferanten
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Set nIdLieferant = 26
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 +  If Benutzer.HatModul( MODUL.MENUMANAGER )
.head 6 -  ! Call CjAddGroup( 3, Translate( 'Lieferanten' ), '' )
.head 6 -  Call CjAddGroupItemControl( nIdLieferant, Translate( 'Lieferantenartikel' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! wl 29131223 neu
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 2, Translate( 'Filter' ), '' )
.head 5 -  ! Call CjAddGroup( 1, Translate( 'Filter' ), '' )
.head 5 -  ! Set sColor = ColorToHex( g_oTheme.GetCaptionTextInActive(  ) )
.head 5 -  ! Set sCaption = '<TextBlock>' || Translate( 'Suche' ) || ' <Run FontSize="9" Foreground = "' || sColor || '" BaselineAlignment="Bottom">' || Translate( '(Intern, Quelle, BLS)' ) || '</Run></TextBlock>'
.head 5 -  ! Call CjAddGroupItem( 10, sCaption, XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  ! Call CjAddGroupItem( 11, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 +  If Benutzer.HatMandant(  ) AND nUserKuecheNrMandant != NUMBER_Null
.head 6 -  Call CjAddGroupItem( 14, Translate( 'Mandant' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 6 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbMandant )
.head 5 +  Else 
.head 6 -  Call SalHideWindow( cmbMandant )
.head 5 -  !
.head 5 -  Call CjAddGroup( 2, Translate( 'Kriterien' ), '' )
.head 5 -  Set nIdOhneBLS = 21
.head 5 -  Set nIdUnchecked = 22
.head 5 -  Set nIdAR_GESP = 23
.head 5 -  Set nIdAR_GEPRUEFT = 24
.head 5 -  Set nIdInRezeptur = 25
.head 5 -  Call CjAddGroupItemControl( nIdOhneBLS, Translate( 'ohne BLS' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdUnchecked, Translate( 'ungeprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_GESP, Translate( 'gesperrt' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdInRezeptur, Translate( 'in Rezeptur' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' ) ! ga 20121009: neu
.head 5 -  Call CjAddGroupItemControl( nIdAR_GEPRUEFT, Translate( 'geprüft' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  Call CjAddGroupItemControl( nIdAR_PARAMETER1, Translate( 'Sortiment' ), XTPTaskPanelItemControl.CheckBox, FALSE, '' )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: classItemClick	! ra 20150213 mit Taxierung
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH ) OR ( p_nId = nIdTaxFehlt )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	! wl 20140309 mit Milchküche
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  
OR ( p_nId = nIdLieferant ) OR ( p_nId = nIdAR_MILCH )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick	! wl 20131223 mit Lieferanten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )  OR ( p_nId = nIdLieferant 
)
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  ! Function: classItemClick
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.winattr class
.head 6 -  Class: cObjMenu
.end
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions 
.head 5 +  If ( p_nId = nIdAR_GEPRUEFT ) OR ( p_nId = nIdAR_GESP ) OR ( p_nId = nIdOhneBLS ) OR ( p_nId = nIdUnchecked ) OR ( p_nId = nIdAR_PARAMETER1 ) OR ( p_nId = nIdInRezeptur )
.head 6 -  Call CjSetGroupItemChecked( p_nId, NOT CjIsGroupItemChecked( p_nId ), FALSE )
.head 6 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikel ) AND oParamArtikel.GetTable(  )
.head 7 +  If oParamArtikel.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else 
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else 
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  Function: ApplyFilter		! ra 20150213 mit Taxierung
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetTaxFehlt( CjIsGroupItemChecked(nIdTaxFehlt) )
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  Call oParamArtikel.SetTU_NR( cmbTaxierung.GetKeyX( 2 ) )
.head 5 -  Call oParamArtikel.SetTH_NR( cmbTaxierung.GetKeyX( 1 ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! wl 20140309 mit Milchküche
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  Call oParamArtikel.SetAR_MILCH( CjIsGroupItemChecked( nIdAR_MILCH ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter		! wl 20131223 mit Lieferanten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  Call oParamArtikel.SetLieferant( CjIsGroupItemChecked( nIdLieferant ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  ! Function: ApplyFilter
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  Call oParamArtikel.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikel.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikel.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else 
.head 6 -  Call oParamArtikel.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikel.SetAR_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikel.SetAR_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikel.SetAR_GESP( CjIsGroupItemChecked( nIdAR_GESP ) )
.head 5 -  Call oParamArtikel.SetAR_GEPRUEFT( CjIsGroupItemChecked( nIdAR_GEPRUEFT ) )
.head 5 -  Call oParamArtikel.SetAR_PARAMETER1( CjIsGroupItemChecked( nIdAR_PARAMETER1 ) )
.head 5 -  Call oParamArtikel.SetUnchecked( CjIsGroupItemChecked( nIdUnchecked ) )
.head 5 -  Call oParamArtikel.SetOhneBLS( CjIsGroupItemChecked( nIdOhneBLS ) )
.head 5 -  Call oParamArtikel.SetInRezeptur( CjIsGroupItemChecked( nIdInRezeptur ) )
.head 5 -  !
.head 5 -  ! ga 20100705: Mandant
.head 5 -  Call oParamArtikel.SetAR_KU_NR( cmbMandant.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelFilter, oParamArtikel )
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = ARTIKEL.AnsichtAlphabet
.head 6 -  Set dfFilterString = ParamGetStr( p_nKey )
.head 6 -  Call SalPostMsg( dfFilterString, SAM_Validate, 0, 0 )
.head 3 +  Function: ClearFilter	! ra 20150213 mit Taxierung
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call cmbTaxierung.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdTaxFehlt, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_MILCH, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: ClearFilter	! wl 20140309 mit Milchküche
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_MILCH, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: ClearFilter
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbMandant.ClearKey(  )
.head 5 -  Call CjSetGroupItemChecked( nIdOhneBLS, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdUnchecked, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GESP, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_GEPRUEFT, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdAR_PARAMETER1, FALSE, FALSE )
.head 5 -  Call CjSetGroupItemChecked( nIdInRezeptur, FALSE, FALSE )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: GetCaption ! ga 20130205: ohne Webdings Dropdown Pfeil, weil in der Schweiz nicht verfügbar
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sXaml
.head 4 +  Actions 
.head 5 -  Return p_sCaption || '...'
.head 3 +  ! Function: GetCaption
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  String: p_sCaption
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sXaml
.head 4 +  Actions 
.head 5 -  Set sXaml = '<StackPanel Orientation="Horizontal">'
.head 5 -  Set sXaml = sXaml || '<TextBlock VerticalAlignment="Center">' || p_sCaption || '</TextBlock>'
.head 5 -  Set sXaml = sXaml || '<TextBlock Padding="6, 0, 0, 0" FontFamily="Webdings" VerticalAlignment="Center">6</TextBlock>'
.head 5 -  Set sXaml = sXaml || '</StackPanel>'
.head 5 -  Return sXaml
.head 2 -  Window Parameters 
.head 2 +  Window Variables 
.head 3 -  ! Erste Instanz des Filterobjekts, die weiteren Filter "holen" sich dann eine Referenz bei Bedarf
.head 3 -  FunctionalVar: oParamArtikel
.winattr class
.head 4 -  Class: cObjParamArtikel
.end
.head 3 -  !
.head 3 -  Number: nIdFilterString
.head 3 -  Number: nIdFilterClear
.head 3 -  Number: nIdOhneBLS
.head 3 -  Number: nIdUnchecked
.head 3 -  Number: nIdAR_GESP
.head 3 -  Number: nIdAR_MILCH
.head 3 -  Number: nIdAR_GEPRUEFT
.head 3 -  Number: nIdAR_PARAMETER1
.head 3 -  Number: nIdInRezeptur
.head 3 -  Number: nIdLieferant
.head 3 -  !
.head 3 -  Number: nFilterIndex
.head 3 -  !
.head 3 -  Number: nIdTaxFehlt
.head 2 +  Message Actions 
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus( dfFilterString )
.head 1 -  !
.head 1 -  ! th 20160322
.head 1 +  Form Window: cjArtikelZuordnung
.head 2 -  Class: CjCommandBars
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File: Artikel.ico
.data RESOURCE 2 0 1 1333308764
0000: CE1E00005C140000 0000000000000000 0200C20001000300 0C00002000A81000
0020: 0000360000001818 3800000188092000 00DE100010103A00 016804000000661A
0040: 0000280008000020 0000400078000001 00A380100000FFFF 03F6F6F774E3E300
0060: E3FED0D1D0FFCCCD 00CCFFCCCCCDFFCC CD00CDFFD5D5D5FF ECEC00ECE6F6F6F6
0080: 270000FE00FFFFFF FFFFFFFFFFFF3FE7 EA00E81BC9DFCAF0 8AB8008BFF80AF81
00A0: FF7FAE2080FF80AE 8098B28098FFB5B5 B5FFCC02CCF3F3F3 A00000FE00FFFFFF
00C0: FFFFFFFFFFFF3FBC D800BB922E862FFF 297E8029FF287E28 FF2813297FFF2D88
00E0: 002CFF80A980FFC1 C100C1FFEEEEEED0 0000FE00FFFFFFFF FFFFFFFFFF3F73A8
0100: 0072D5277727FF25 77FE273F26770227 4D8E4FFFC0C0C8C0 FFEEEED0FE00FFFF
0120: FFFFFFFFFFFFFF3F 6BA7806BD8267827 FF260028FF257627 FF27740027FF2673
0140: 28FF26740028FF49 874AFFBDBC00BEFF E7E7E7D284848084 0C4545450C45CC45
0160: 0C450CCC450C450C CC450C450CCC450C 450CCC450C450CCC 450C450CCC450C45
0180: 0CCC450C450C0C45 0C450C7A7A007A0F B0B0B0056BA771D9 26787713205CFF02
01A0: 014001FF010001FF 016001FF00010100 C800FF0000FFCC00 FF00FFCC00FF00FF
01C0: CC00FF00FFCC00FF 00FFCC00FF00FFCC 00FF00FFCC00FF00 FFCC00FF00FFCC00
01E0: FF00FFCC00FF00FF 0000FFCCCCCC176B A7FF731F5C008C01 FF00FF00CC00FF00
0200: FFCC00FF00FFCC00 FF00FFCC00FF00FF CC00FF00FFCC00FF 00FFCC00FF00FFCC
0220: 00FF00FFCC00FF00 FFCC00FF00FFCC00 FF00FFCC00FF00FF 0000FF5252520C6B
0240: A7FF03247025FF1D 5A401FFF1E591FFF 5A001EFF3A6839FF 91910091FFAEAEAE
0260: DC5F5F005F464747 474547470C474547 4551510051455A5A 5A45606000604578
0280: 78784A7272007249 5C5C5C4552528852 4547474547804745 4F4F4F455A005A45
02A0: 5B5B5B4566660066 4574747448606000 6045535353454B4B 004B45545454036B
02C0: A7FFFB267F780026 FF498B4AFFC0BFCC C1FFEED0FE00FF03 E7E7E72E6E6E006E
02E0: 845B5B5BB6676700 67A0C1C1C1480000 FE003FF0F000F030 7575757D56560056
0300: B26A6A6AA9B6B600 B655C3C3C3010000 BE006B6F2777FF7F 78FE26CFEED0FE00
0320: 03A0A0A001DDDD00 DD6A252525EC0000 C800FF0000FF0000 FF080808FC9C9C80
0340: 9C7CC9C9C9040002 00E4E4E445353580 35EE000000FF000C 00FF00FF04040004
0360: FD8E8E8E90D3D3A8 D30900006B6F2777 FF7F78FE26CFEED0 FE0003AAAAAA0652
0380: 528052D4000000FF 00CC00FF00FF0C00 FF00FF0F0F000FFC DCDCDC2EF5F500F5
03A0: 026A6A6AB00000C8 00FF0000FFCC00FF 00FF0000FF090909 FCD1D1A0D1370000
03C0: 006B6F2777FF7F78 FE26CFEED0FE0003 8181810F09098009 FD000000FF00CC00
03E0: FF00FFCC00FF00FF 0000FFA3A3A37200 000200252525E900 00C800FF0000FFCC
0400: 00FF00FF0C00FF00 FF9595A095800000 006B6F2777FF7F78 FE26CFEED0FE0003
0420: 7D7D7D0F08088808 FD0000FF00CC00FF 00FFCC00FF00FF00 00FF9B9B9B6FCCCC
0440: 00CC01222222EA00 00C800FF0000FFCC 00FF00FF0C00FF00 FF8B8BA08B7C0000
0460: 006B6F2777FF7F78 FE26CFEED0FE0003 A9A9A90949498049 D2000000FF00CC00
0480: FF00FF0C00FF00FF 0C0C000CFBC2C2C2 2B00000200666666 BD0000C800FF0000
04A0: FFCC00FF00FF0000 FF060606FDC0C0A0 C03A0000006B6F27 77FF7F78FE26CFEE
04C0: D0FE003FC9C900C9 441D1D1DF30000C8 00FF0000FF0000FF 050505FE95950095
04E0: 8CBDBDBD02000002 00D9D9D93A2C2C80 2CF0000000FF000C 00FF00FF02020002
0500: FE8383839DCDCDA0 CD080000006B6F27 77FF7F78FE26CFEE D0FE003FC3C300C3
0520: 03CBCBCB2E606000 6099282828B93B3B 003BA6B7B7B761D7 D7E0D70500000003
0540: C1C1C103CFCF00CF 206B6B6B902A2A00 2AB73F3F3FABB1B1 80B16FD1D1D10500
0560: BE006B6F2777B325 77258F26FF250B49 49FFC0C0CCC1FFEE D0FE00FFFFFFFFFF
0580: FFFFFF3F8D8D008D 02B0B0B0046BA7BF 2603226723FF1334 C013FF123313FF03
05A0: 223C22FF53530053 FF676767E9373700 3798262626972626 CC26972697CC2697
05C0: 2697CC26972697CC 26972697CC269726 97CC26972697CC26 972697CC26972697
05E0: 0C26972697444400 44A2DBDBDB186BA7 FF7B1F018DFF00FF 00CC00FF00FFCC00
0600: FF00FFCC00FF00FF CC00FF00FFCC00FF 00FFCC00FF00FFCC 00FF00FFCC00FF00
0620: FFCC00FF00FFCC00 FF00FFCC00FF00FF CC00FF00FF8000FF 6464640C6BFF0322
0640: 6423FF0E240810FF 0E0EFF0E25000EFF 182B18FF3A3A003B FF474747EF212180
0660: 21B91C1C1CB91C80 1CB91B1B1BB91BCC 1BB91BB9CC1BB91B B9CC1BB91BB98C1B
0680: B91BB91C8C1CB91B B91BCC1BB91BB9CC 1BB91BB90C1BB91B B92C2C002CBFDADA
06A0: DA1B6BA7FFFB267F 786E264ABF03D8D8 D8DAA1A100A13DCB CBCB260000FE00FF
06C0: FFFF3FCCCC00CC1F 959595399D9D009D 3AC2C2C20D0000FE 00FFBF6B6F2777FF
06E0: 7F780226407F40FF 3F3D803FFF020202 FF000000FF111111 F88686008692C0C0
0700: C0060000FE00FF3F E9E900E90EB8B8B8 8922228022EF0000 00FF000000FF2F2F
0720: 2FE6C4C480C463B2 B2B20100FE00BF6B 6F2777FF2F272777 830C220DFF00C800
0740: FF0000FFCC00FF00 FF0000FE8C8C8C82 0000FE00FFBFC3C0 C353090909FDCC00
0760: FF00FF0C00FF00FF 17170017F6D6D6D6 350000FE00BF6BBF 26FE282F271F60E0
0780: 21FF010001C800FF 0000FFCC00FF00FF 0800FF2F2FE3E4E4 E8E4090000FF03A3
07A0: A3A30162628062C5 000000FF00CC00FF 00FFCC00FF00FF00 00FF696969990000
07C0: FE00BF6BBF26FE28 077628FF1A4F881B FF0000FF00CC00FF 00FFCC00FF00FF00
07E0: 00FF0C0C0CF9DDDD E0DD13000000FF03 9D9D9D033A3A883A D40000FF00CC00FF
0800: 00FFCC00FF00FF00 00FF393939AC0000 FE00BF6B7F77FB26 3776205E89FF0000
0820: FF00CC00FF00FFCC 00FF00FF0000FF27 2727E4C3C3E8C302 0000FF03A4A4A403
0840: 5D5D805DC0000000 FF00CC00FF00FFCC 00FF00FF0000FF62 6262950000FE00BF
0860: 6B7F77FB262F2727 7682270B1F0CFF00 C800FF0000FFCC00 FF00FF8000FF9696
0880: 969500FE00FF3FB3 B380B358070707FD 00C800FF0000FF0C 00FF00FF14148014
08A0: F7D3D3D34000FE00 BF6BBF26FE28EF27 02263E7D3EFF3736 8838FF0000FF0008
08C0: 00FF0C0CFB787880 7898F2F2F21000FE 00FF3FDFDF00DF07 A9A9A9761B1B801B
08E0: F2000000FF000000 FF282828EDB1B180 B15EB9B9B90200FE 00BF6BFFFE287F78
0900: 3A2649C2C200C4FF CDCDCDCF8D8D008D 44CCCCCC28C6C6E0 C603000000FFFFFF
0920: 03E2E2E204EBEB00 EB238282823C9D9D 009D3DEEEEEE1E00 00FE00FF3F70A970
0940: 6FD7267777FE27FF 02264C8D4DFFD5D4 00D5FFF5F5F58600 00FE00FFFFFFFFFF
0960: FFFFFFFF3FA0D000 9FAC2B862CFF267B 8028FF287B27FF28 3F2980002AFF89B8
0980: 86FDF3F200F2ABEA EAEA0E0000FE00FF FFFFFFFFFFFFFFFF 3FDDEE00DC1BA0DB
09A0: A1A972C50071D267 C268C868C202686A C26BC799D40099C1 EDF7EC3C0000FE00
09C0: FFFFFFFFFFFFFFFF FFFF3F803FE0FFFF 003FFF7F00FE007F 3E000F0300380201
09E0: 0038E8000100026E 00023C0C02010603 003FE1FC0000007F 0F00FC3F0003F00F
0A00: 00038701E00F007F 037F0750F83F003F FF3F07FFFFFF2800 1000001800003000
0A20: 60000001002000A3 60090000FF3F92B0 009329DBE4DCC8C0 CC00C0FEB9C5B9FF
0A40: BCC500BCFFC9CBC9 FFE8E800E8C2A0AC A0220000FE00FFFF FFFFFFFF3FBCD500
0A60: BC7E6AA66BFB5597 0055FE539654FF5B 99005BFE8CAA8CFE D1D100D1ED9EAB9F
0A80: 5B0000FE00FFFFFF FFFFFF3F6EA5006D D3277928FE257818 27FE25FF267A0027
0AA0: FE4D8E4EFECBCB00 CBF39DAA9D670000 FE00FFFFFFFFFFFF 3F599B205AE22677
0AC0: 2724710425FF571D FF1C56801EFF3061 31FF950096F68888 88933F3F803F4833
0AE0: 33334833CC334833 48CC33483348CC33 483348CC33483348 CC334833480C3348
0B00: 3348474700474A5A 5A5A19599B032577 27FE21620021FE01 0000FF0000C000FE
0B20: 000000FECC00FF00 FECC00FE00FFCC00 FE00FFCC00FE00FE CC00FE00FFCC00FE
0B40: 00FECC00FF00FECC 00FE00FF0000FE6B 6B6B4C599B3F236D 0024FE164317FF16
0B60: 430016FE264B25FE 72720072F8646464 AC39390039733535 3573393900397341
0B80: 4141734C4C004C74 5757577649498049 743B3B3B73350C35 7339734343004373
0BA0: 4848487354540054 75454545733B3B08 3B73393920599B1B 26FF2677FA282602
0BC0: 27408641FFCBCB80 CCF39BAB9C67003E 005E69005E0DA5A7 A54D4E4E004EAC48
0BE0: 4848C08181008185 4444441700000200 5252520CA7A700A7 6F4C4C4CB14B4B00
0C00: 4BC07A7A7A685555 A855130000591B25 FE2576A1FE267728 251026FE4086FECB
0C20: CA80CCF398A89867 003E006E76006E51 333333E000000800 FE0000FE02020002
0C40: FD61616193595900 590C8888885C1313 8013F8000000FE00 0000FE141414F08E
0C60: 8E008E725C5C5C07 599BAF2725FB26FE 268394A394670002 0049584903464880
0C80: 467F060606FC00C8 00FE0000FE0000FE 2F2F2FD76E6E006E 30333333A400008C
0CA0: 00FF00FE000C00FE 00FE53530053B54E 4E4E1B599B8B2627 FF26FA2826DA2740
0CC0: FF8392A092670002 004B574B035050C0 5080060606FCCC00 FF00FF0000FF2B2B
0CE0: 2BD6666600662F30 3030A70000C800FF 0000FF0C00FF00FF 4C4C004CB5494949
0D00: 1A599B8B2527FE25 AB262825DE26FE83 93A2936700020047 5647017E81007E47
0D20: 2D2D2DDD00000800 FE0000FE01010001 FE5A5A5A98525200 520B8282825C1010
0D40: 8010F9000000FE00 0000FE111111F285 8500857657575708 599B8B2627FF26FA
0D60: 2826DA2740FF8395 A59567003E00535F 0053099193914C3D 3D003DB8252525C3
0D80: 7373007395464646 1D00000200535353 0C909000906A3737 37BA2B2B002BC277
0DA0: 7777785555A05516 000000590B2527FE 24730026FE206621 FF20650021FE3772
0DC0: 37FEAEAE00AFF482 8F837E354B003625 3545362539430039 253C413C253C3C00
0DE0: 3C25343434252F2F 002F252E2E2E252D 2D882D252D2D252E 002E253030302532
0E00: 3280322533333325 3400342754545411 599B3F21660023FE 0A1A09FF08190009
0E20: FE0E1C0FFE2C2C00 2CFC272727DF1515 8015CB121212CB12 CC12CB12CBCC12CB
0E40: 12CBCC12CB12CBCC 12CB12CBCC12CB12 CB0C12CB12CB1A1A 001ACD8080804159
0E60: 9B3F226705FE1B0B FF0A1B000AFE101F 10FE2D2D002EFC26 2626DE15158015CA
0E80: 141414CA14CC14CA 14CACC14CA14CACC 14CA14CACC14CA14 CACC14CA14CA0C14
0EA0: CA14CA1A1A001ACC 95959545599B9B26 FF26FE2802273E84 3FFFA09F00A1F88D
0EC0: 8D8DA8939300935F 4151411B0000FE00 FF035A5A5A0B7979 00793A7C7C7C647F
0EE0: 7F007F617878782E 3A3AE83A060000BF 599B25FE259B26FF 260226265A26FE17
0F00: 170817FF0000FE06 060006FC4A4C4AA7 4D56E04D21000000 FF03B8B8B8553838
0F20: 0038DD040404FC05 050005FC424242CF 7F7FE07F3F000000 BF599FFE25032677
0F40: 27FF236E8024FE0B 1F0BFE008800FF00 00FE000800FE1111 F17F81807F685B5F
0F60: 5B0100FE00035C5C 5CBE01018801FE00 00FE000800FF0202 FD6464E0649F0000
0F80: 00BF59BB26263628 7620648022FF0614 07FF00C800FF0000 FF0800FF0404FC62
0FA0: 6400628156595603 00003E002E2E002E 02323232DB0000C8 00FF0000FF0C00FF
0FC0: 00FF3232E032BC00 0000BF599B25FE25 03267627FF247081 FE0C260DFE00C800
0FE0: FF0000FE0800FE17 17EE494EE0495E00 0000BF2E002E0166 6666A801018C01FE
1000: 00FE000800FF0505 FC7676E0768E0000 00BF59BF2581FE26 7727FF260026FE2E
1020: 692EFE1E1E881FFF 0000FE060006FC7A 7A7A918A91E88B18 0000FF036464643A
1040: 4A4A004AC6050505 FC07070007FB5353 53BA6A6AE06A2E00 00003F5A9B7A5A26
1060: 77FF7826FF40CA01 EEA6ABA67799A280 99233955390100FE 00FF3F838300830E
1080: 8383832893930093 277F7F7F0B0000FE 003F70AD006FD127 7B28FE26780027FE
10A0: 277927FF277A0227 599859FEE7E600E6 B290A390240000FE 00FFFFFFFFFFFF3F
10C0: BBDE00BA5F70BC71 CD59B00059D758B0 58D56BB7006BD2BE DDBD856585806520
10E0: 4A6D4A0100FE00FF FFFFFFFFFF7FFFFC FF00F7007FC02881 0000000080330080
1100: 00806300C08100FF 073E0700001E4407 000E07000C440700 1C07001E073F0F00
1120: 00FFBF2891001000 00206900012000A3 40040000FF3FBDCF 00BE5FAFC6AFFEA5
1140: BD80A6FFBBC2BBFF E8E0E8AB000000FF FFFFFF3F619F1060 D9267AFF267A0348
1160: 8D48FFD7D7E0D7E7 000000FFFFFFFF3F 488F1049EB2470FF 143A0014FF1C3F1D
1180: FF69680069F33232 32852222C8228522 2285CC22852285CC 22852285CC228522
11A0: 850022855E5E5E4A 488F01EC236E25FF 0F2C000FFF163015 FF4F4F004FF62929
11C0: 29A223230023A22A 2A2AA236360036A3 333333A326260026 A2252525A22D2D08
11E0: 2DA23636A22C2C00 2CA233333354488F 2326772826770337 8138FFD7D6ECD7E7
1200: 00038E908E613232 0032CE4C4C4CB84B 4B004B205C5C5C11 66660066A6303030
1220: D660600060785D5D 5D02488FBF26FB37 2F004F5D804F0516 1616F3000000FF00
1240: 0000FF63630063A6 3939396600008800 FF0000FF020002FE 7373732D488FBF26
1260: FB372F00656D8065 06141414F3000800 FF0000FF5A5A005A A53636366A000008
1280: 00FF0000FF010180 01FE6A6A6A2D48BF 26FB37EF00037D80 7D5A22220022D43D
12A0: 3D3DC14B4B004B24 5C5C5C0F59590059 A71A1A1AD85C5C80 5C835C5C5C024813
12C0: 2473FF1B55001CFF 285C29FF9A9A009A ED3443344B313A00 314B3438344B3434
12E0: 00344B2C2C2C4B2B 2B882B4B2B2B4B2C 002C4B2E2E2E4B2F 2F002F4B61616130
1300: 488F03236B24FF07 120007FF091409FF 20200020FB0F0F0F DC0D0DC80DDC0D0D
1320: DCCC0DDC0DDCCC0D DC0DDCCC0DDC0DDC 000DDC5A5A5A7948 8FBB262603357E35
1340: FF76750076F55F5F 5F964855E8482600 003F808000802560 606091636300638B
1360: 565656190000BE00 48BF268227143E15 FF000800FF0000FF 2E2E802ED8656A65
1380: 02003E004B4B884B C50000FF008000FF 555555B000BE0048 6F287682280E2B0E
13A0: FF000800FF0000FF 0C0C800CF65F645F 05000A002E2E0125 258025E4000000FF
13C0: 000000FF262626CF 0000BE00483F2677 0227256225FF0D0D 000EFF030303FE80
13E0: 80E0808F0000003F 6868006874060606 FB0A0A000AFA7474 746500003E00498F
1400: B04AEB2677262338 8138D6D680D6D46F 816F1B00FE003F43 4300430178787817
1420: 7E7EE87E1600003F 92C700929B499F4A E6489E0048E38EC0 8DBE92A7E8922E00
1440: 00FFFFFFFF3F07FF BC0000003F060091 0004000004D90006 003F01C320000000
1460: C300008338000001 03C738000007
.enddata
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? No
.head 3 -  Allow Child Docking? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left: 2.025"
.head 4 -  Top: 2.506"
.head 4 -  Width:  15.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.0"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ActiveX: axCommandBars
.data CLASSPROPSSIZE
0000: 3901
.enddata
.data CLASSPROPS
0000: 4C69634B6579001A 0143006F006D006D 0061006E00640042 0061007200730020
0020: 0043006F006E0074 0072006F006C0020 0043006F00700079 0072006900670068
0040: 0074002000280063 0029002000320030 00300033002D0032 0030003000390020
0060: 0043006F00640065 006A006F0063006B 00200053006F0066 0074007700610072
0080: 0065000D000A0050 0052004F00440055 00430054002D0049 0044003A00200043
00A0: 006F00640065006A 006F0063006B002E 0043006F006D006D 0061006E00640042
00C0: 006100720073002E 0041006300740069 007600650058002E 007600310033002E
00E0: 0032000D000A0056 0041004C00490044 004100540045002D 0043004F00440045
0100: 003A002000510051 0053002D0050004E 0046002D004F004A 0056002D00560042
0120: 005800004C69634B 65794C656E000400 1A01000000000000 00
.enddata
.data RESOURCE 5 0 1 3759460269
0000: 000A000089020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000F627FCAD45 ED51460092246D9E
0100: 1B8702B9F8000000 0FD05BE589004A6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF01A0000 00FFFFFFFFFFFFFF FFAFFFFFFFFA0000 FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFAFFFFF FFFA0000FFFFFFFF FFF6FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0002000D00 7B020000EE7B006F
01C0: 0100FFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFF0F32
01E0: 002E000245004507 2A0F0010188C9C02 2AA20209004C6900 6200A27261007279
0200: 0100540049004600 884400545600500E 61730065003E4C00 008A546F70004C22
0220: 657600656C00EA43 6F6EAB6F6C6CAA65 7250720A69760000 5500824941007500
0240: 74A26F6D006174AA 696F6E43AA6C6965 6E82740000580074 AA72656D652A2044
0260: 6F6300286B00696E 6700AB50616EAE65 4163AA74697665AA 5820436FAA6E7472
0280: 6F0A6C2031003300 2A2E312E3000E800 005874BA656D20AE 44636B
.enddata
.head 4 -  Class Child Ref Key: 10
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axDockingPane
.data CLASSPROPSSIZE
0000: 3D01
.enddata
.data CLASSPROPS
0000: 4C69634B6579001E 0144006F0063006B 0069006E00670020 00500061006E0065
0020: 007300200043006F 006E00740072006F 006C00200043006F 0070007900720069
0040: 0067006800740020 0028006300290020 0032003000300033 002D003200300030
0060: 003900200043006F 00640065006A006F 0063006B00200053 006F006600740077
0080: 006100720065000D 000A00500052004F 0044005500430054 002D00490044003A
00A0: 00200043006F0064 0065006A006F0063 006B002E0044006F 0063006B0069006E
00C0: 006700500061006E 0065002E00410063 0074006900760065 0058002E00760031
00E0: 0033002E0032000D 000A00560041004C 0049004400410054 0045002D0043004F
0100: 00440045003A0020 005500430059002D 004B004D0053002D 004300490049002D
0120: 004F004300460000 4C69634B65794C65 6E0004001E010000 0000000000
.enddata
.data RESOURCE 5 0 1 2534580657
0000: 000A0000D4020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 0000006D8DC0A886 C48B4200ABA244A6
0100: 05B84FA2F8000000 0FE0155824004B6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF0180000 00FFFFFFFFFFFFFF FFAFFFFFFFFA0000 FFFFFFFFFFFFFFFF
0160: FFFFFFFFFFAFFFFF FFFA0000FFFFFFFF FFF6FEFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFF0002000D00 7B020000EE7B00F6
01C0: 0100206500730073 6900886200696C00 699A7479004A2061 007600615700AA65
01E0: 625374AA61727420 C031002E00300088 540079700065AA20 4C6962BA726179A0
0200: 00004700726FAA6F 766543226F6D006D 75008A6E69630061 AA74696F6EBA7353
0220: 612B75734100E26E 640043EB7472AA6C 536572AA76696365 AE736C7008680061
0240: 00006B002A69746C 5F00AA73657269AA 616C2031BF54AB70 6520EE4C622A6172
0260: 790000284E006574 4600B877005470FB 4CB80000476FAA6F 766520AA436C6965
0280: AE6E2031BF54BF20 AE4C62722E617900 00AE476F6FBE7643 AA6F6D706FAA6E65
02A0: 6E74EA732031EF54 AA7065204CBF618B 79000047AB6F6F76 BB5762AA466F726D
02C0: AA73546F6FBA6C53 72EA766963A00000 58007472AA656D65 20AA50726F70AB72
02E0: 7479BA204769
.enddata
.head 4 -  Class Child Ref Key: 11
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  ActiveX: axImageManager
.data RESOURCE 5 0 1 526195220
0000: 000A0000EA020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000AA6CCEFEDB E14C4500BB619591
0100: 8BE6DF65F8000000 0F703E2B8A004A6C CA0103000000F040 000000284A004545
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2160000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF F6FEFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFF0002000D007B 020000EE7B003402
01C0: 00009900D8000001 008203319E000000 D017800100008603 9D000000E005C000
01E0: 0000DB01000B0106 409F009846009900 016C0000039E8B00 088001FD00E00580
0200: 000000FFFFE0837F 0000000869000032 221F0000F0453C03 100DB803204F0070
0220: 007473000848006F 6C0064000331002E 003000A354007970 286500204C690088
0240: 6200726100728279 00004700728A6F6F 7600652B436F6D00 A26D75006E69A863
0260: 00617469AA6F6E73 20AA53657276AA69 636573A341006C70 A86800612054AB70
0280: 6520EE4C62AA6172 79203E310000A84D 006963722A6F736F 6600AA742048652E
02A0: 6C204400AA617461 20AE537276AF6573 FA2031BA205470EA 65204CAE62617222
02C0: 7900004F4900AA6E 666F20AA41637469 CA76655800AE436E 74AA726F6C20AA6D
02E0: 6F64758A6C650000 73AA63702031BF54 AB706520EE4C622E 61790000
.enddata
.head 4 -  Class Child Ref Key: 12
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjCommandBars
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Class Default
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classCreate
.head 4 -  Description: CommandBars und DockingPanes erzeugen

CommandBars mit Ribbon: "CjCreateRibbon", "CjLoadRibbon"
CommandBars mit Menü & Toolbars: "CjCreateBar", "CjCreateBarItem"

DockingPanes: "CjCreatePane"
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: fcWinSave
.head 5 -  Boolean: bVisible
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bClosed
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Window Handle: hWndTable
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Window Handle: hWndFilter
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Call CjHideClient( TRUE )
.head 5 -  Call SalCenterWindow( hWndForm )
.head 5 -  ! Recht wird bereits beim Button zum Öffnen des Dialogs abgefragt
.head 5 -  !
.head 5 -  Set hWndTable = SalCreateWindowEx( dlgAddArtikelLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, hWndForm)
.head 5 -  Call CjCreatePane( 1, ' ', 10, 5.5, DockingDirection.DockRightOf, 0, 0, hWndTable )
.head 5 -  Call CjSetPaneTitle( 1, wp_sAR_INTERN)
.head 5 -  Set hWndFilter = SalCreateWindowEx( cjArtikelZuordnungTaskPanel, hWndForm, 0, 0, 0, 0, CREATE_AsChild)
.head 5 -  Call CjCreatePane( 2, Translate( 'Lieferartikel zuordnen' ), 3, 5.5, DockingDirection.DockLeftOf, 1, 0, hWndFilter )
.head 5 -  Call oWinSave.GetInitWinEx( hWndForm )
.head 5 -  !
.head 5 -  Call oMenu.AddButton( FILE.Beenden, Translate('Beenden'), '', 'Esc', TRUE, TRUE )
.head 5 -  Call CjCreateRibbon( Translate( 'Menü' ), TRUE, TRUE, oMenu )
.head 5 -  !
.head 5 -  Call CjSetClient( hWndNULL )
.head 3 +  Function: classClose
.head 4 -  Description: Fenster soll geschlossen werden

Return TRUE, um zu schließen
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  FunctionalVar: oWinSave
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Class: fcWinSave
.head 4 +  Actions
.head 5 -  ! Window Status / Größe
.head 5 -  Call oWinSave.WriteInitWinEx( hWndForm, FALSE )
.head 5 -  !
.head 5 -  ! Call hWndArtikel.frmREZ_Artikel.CjCanClose ( )
.head 5 -  Return TRUE
.head 3 +  Function: classExecute
.head 4 -  Description: Button oder Menü wurde angeklickt
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case p_nId
.head 6 +  Case FILE.Beenden
.head 7 +  If classClose()
.head 8 -  Call SalDestroyWindow( hWndForm )
.head 7 -  Break
.head 6 +  Default
.head 7 -  Call ParamSetInt( PARAM.Execute, p_nId )
.head 7 -  Break
.head 3 +  ! Function: classCreateClient
.head 4 -  Description: ShortcutBar Wechsel, Eintrag wurde erstmalig gewählt.

neues Clientfenster (Hauptarbeitsbereich) erzeugen: "SalCreateWindowEx"

Ribbonbar Menü wird mitübergeben, Wechseln erfolgt dann automatisch
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nId
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nLeft
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nTop
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nWidth
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nHeight
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive Window Handle: r_hWndClient
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  FunctionalVar: r_oMenu
.data INHERITPROPS
0000: 0100
.enddata
.winattr class
.head 6 -  Class: CjMenuItem
.end
.head 6 -  ! Ribbonbar Menu
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! Set r_hWndClient = SalCreateWindowEx( frmREZ_Artikel, hWndForm, 0, 0, 0, 0, CREATE_AsChild , wp_nPARAM, hWndForm )
.head 5 -  ! Call CjCreatePane( 1, Translate( 'Artikel' ), 8.5, 4, DockingDirection.DockLeftOf, 0, 0, r_hWndClient )
.head 5 +  ! If bInhalt
.head 6 -  Call CjCreatePane( 2, Translate( 'Merkmale' ), 2.5, 4, DockingDirection.DockRightOf, 0, 0, SalCreateWindowEx( dlgArtikelMerkmale, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM ) )
.head 5 +  ! If Benutzer.HatModul( MODUL.LAGER )
.head 6 -  Call CjCreatePane( 3, Translate( 'Lieferanten' ), 7, 4, DockingDirection.DockBottomOf, 1, 0, SalCreateWindowEx( dlgArtLieferant, hWndForm, 0, 0, 0, 0, CREATE_AsChild, wp_nPARAM, hWndForm ) )
.head 5 -  Set r_oMenu = oRibbonArtikel
.head 2 +  Window Parameters
.head 3 -  ! Number: wp_nAR_NR
.head 3 -  String: wp_sAR_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oMenu
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class: CjMenuItem
.head 2 -  Message Actions
.head 1 +  Dialog Box: cjArtikelZuordnungTaskPanel 
.head 2 -  Class: CjTaskPanel
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Standard
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modeless
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description: für Wahl des Suchfilters im Zuordnungs-Dialog
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilterString
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.183"
.head 6 -  Top: 0.448"
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbArtikeltyp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboOutline
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call InitOutline( Translate( SC_ALLE ), 'at_nr', 'at_text', 'artikeltyp', '', 'at_text', 1 )
.head 6 -  Call AddLevel( 'ag_nr', 'ag_at_nr', 'ag_text', 'artikelgruppe', '', 'ag_text' )
.head 5 +  On SAM_AnyEdit
.head 6 +  If lParam != SAM_Create ! nicht in Verbindung mit Initialisierung
.head 7 -  Call ApplyFilter(   )
.head 3 +  Combo Box: cmbLieferant
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboKeyValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.917"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbKU_BEZEICHNUNG.GetKeyX () != NUMBER_Null
.head 7 -  Set sWhereLieferant = 'EXISTS(SELECT 1
			FROM lieferbereitstellung
			JOIN  lieferartikel on bs_la_nr = la_nr
			WHERE la_li_nr = li_nr
			AND bs_ku_nr = '|| NumberToStrX( cmbKU_BEZEICHNUNG.GetKeyX () ) ||' AND
			       NOT EXISTS( SELECT 1 
				             FROM    artikellieferart 
				             WHERE  al_la_nr = bs_la_nr) )'
.head 6 +  Else
.head 7 -  Set sWhereLieferant = 'EXISTS(SELECT 1
			FROM lieferbereitstellung
			JOIN  lieferartikel on bs_la_nr = la_nr
			WHERE la_li_nr = li_nr
			AND bs_ku_nr = '|| NumberToStrX( nUserKuecheNr ) ||' AND
                                                 NOT EXISTS( SELECT 1 
				             FROM    artikellieferart 
				             WHERE  al_la_nr = bs_la_nr) )'
.head 6 -  Call cmbLieferant.SetKeyValue( 'li_nr', 'li_lieferant', 'lieferant', sWhereLieferant, 'li_lieferant', TRUE )
.head 5 +  On SAM_Click
.head 6 -  Call ApplyFilter(  )
.head 3 +  Combo Box: cmbKU_BEZEICHNUNG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboKeyValue
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.867"
.head 5 -  Top: 0.094"
.head 5 -  Width:  2.917"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set sKuKstStr = BuildKuechenStr ()
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKeyValue( 'ku_nr', 'ku_bezeichnung', 'kueche', ' ku_nr IN ('|| sKuKstStr ||')', 'ku_kostenstelle', FALSE)
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKey( nUserKuecheNr)
.head 5 +  On SAM_Click
.head 6 -  Call ApplyFilter ()
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalSendMsg( cmbLieferant, SAM_Create, 0, 0 )
.head 3 +  ActiveX: axTaskPanel
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 4C69634B65790012 015400610073006B 00500061006E0065 006C00200043006F
0020: 006E00740072006F 006C00200043006F 0070007900720069 0067006800740020
0040: 0028006300290020 0032003000300033 002D003200300030 003900200043006F
0060: 00640065006A006F 0063006B00200053 006F006600740077 006100720065000D
0080: 000A00500052004F 0044005500430054 002D00490044003A 00200043006F0064
00A0: 0065006A006F0063 006B002E00540061 0073006B00500061 006E0065006C002E
00C0: 0041006300740069 007600650058002E 007600310033002E 0032000D000A0056
00E0: 0041004C00490044 004100540045002D 0043004F00440045 003A00200044004A
0100: 004E002D00540058 0041002D00530047 0058002D00450046 005900004C69634B
0120: 65794C656E000400 1201000000000000 00
.enddata
.data CLASSPROPSSIZE
0000: 3101
.enddata
.data RESOURCE 5 0 1 3753798604
0000: 000A000012020000 0000000000000000 020000D0CF11E0A1 B11AE1F8000000FF
0020: 003E000300FEFF09 00F0060000000F01 000000F601000110 0000020000002601
0040: 00FEFFFFF8000000 F8FFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0060: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0080: FF40FDFFFFFFFEFF FF66FEFFFEFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
00C0: FFFFFFFFFFFFFFFF FFFFFFFF2052006F 006F740081004500 6E0074C072007900
00E0: 0000FFFFFFFFFFA0 16000500FFFF4F01 000000456FBDEC05 73494E0087A1ABAE
0100: 1483BE7CF8000000 0F40047189004C6C CA0103000000F280 0000204A00450045
0120: 5000085300724300 4F00C24F4C000000 FFFFFFFFFF821602 01FFFFFFFFFA0000
0140: FFFFFFFFF2450000 FFFFFFFFFFFFFFFF AFFFFFFFFA0000FF FFFFFFFFFFFFFFFF
0160: FFFFFFFFAFFFFFFF FA0000FFFFFFFFFF 660100FEFFFFFFFF FFFFFFFFFFFFFFFF
0180: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
01A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF0002000D 0061020000084F03
01C0: 0040000000E80102 0000E90100002702 0000013300016400 FC0000FFFFFFFFFF
01E0: FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFFFFFFFFFF
0200: FFFFFFFFFFFFFFFF FFFFFFFFFFFF280C 00001A49000088FF A402684E9F02FA00
0220: 00FFFFFF
.enddata
.head 4 -  Class Child Ref Key: 6
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CjTaskPanel
.head 4 -  Property Template:
.head 4 -  License Key:
.head 4 -  Display Settings
.head 5 -  GUID:
.head 5 -  Type:
.head 5 -  Activation: Double Click
.head 5 -  Host Name:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.0"
.head 6 -  Top: 0.0"
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classCreate ! th 20180227 Bez. geändert: Kst der Zuordnung
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' )) , XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 11, Translate( 'Filter' ), '' )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 14, Translate( 'Lieferant der Produktdaten' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbLieferant )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Kostenstelle der Zuordnung'), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbKU_BEZEICHNUNG )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  ! Function: classCreate
.head 4 -  Description: Gruppen und Einträge im TaskPanel erzeugen

"CjAddGroup", "CjAddGroupItem"
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sCaption
.head 5 -  String: sColor
.head 4 +  Actions 
.head 5 -  Call CjEnableMarkup(  )
.head 5 -  !
.head 5 -  Set nFilterIndex = -1
.head 5 -  Set nIdFilterClear = 400
.head 5 -  Set nIdFilterString =  100
.head 5 -  !
.head 5 -  Call CjAddGroup( 1, '', '' )
.head 5 -  Call CjAddGroupItem( nIdFilterString, GetCaption( Translate( 'Suche (alle)' )) , XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 101, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', dfFilterString )
.head 5 -  Call CjAddGroupItem( nIdFilterClear, Translate( 'Filter aufheben' ), XTPTaskPanelItemType.xtpTaskItemTypeLink, '', hWndNULL )
.head 5 -  Call CjAddGroup( 11, Translate( 'Filter' ), '' )
.head 5 -  Call CjAddGroupItem( 12, Translate( 'Typ/Gruppe' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 13, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbArtikeltyp )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 14, Translate( 'Lieferant der Produktdaten' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 15, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbLieferant )
.head 5 -  !
.head 5 -  Call CjAddGroupItem( 16, Translate( 'Kostenstelle der Bereitstellung' ), XTPTaskPanelItemType.xtpTaskItemTypeText, '', hWndNULL )
.head 5 -  Call CjAddGroupItem( 17, '', XTPTaskPanelItemType.xtpTaskItemTypeControl, '', cmbKU_BEZEICHNUNG )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: classItemClick
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: p_nId
.head 5 -  String: p_sCaption
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: saName[*]
.head 5 -  String: saColumn[*]
.head 5 -  Number: naType[*]
.head 5 -  Number: nColumns
.head 5 -  Number: nColumn
.head 5 -  !
.head 5 -  FunctionalVar: oMenu = OBJ_Null
.head 6 -  Class: cObjMenu
.head 5 -  Number: n
.head 5 -  !
.head 5 -  Number: nOffset
.head 4 +  Actions
.head 5 +  If p_nId = nIdFilterString
.head 6 +  If NOT SalObjIsNull( oParamArtikelZuordnung ) AND oParamArtikelZuordnung.GetTable(  )
.head 7 +  If oParamArtikelZuordnung.GetTable(  ).TableClass..PopulateGetFilterItems( saName, saColumn, naType, nColumns )
.head 8 -  Set oMenu = new cObjMenu
.head 8 -  Call oMenu.AddItem( 'Suche (alle)' )
.head 8 -  Call oMenu.AddSeparator(  )
.head 8 -  Set nOffset =  2 ! Anzahl Menüeinträge vor den dynamischen Einträgen
.head 8 +  While nColumn < nColumns
.head 9 -  Call oMenu.AddItem( saName[nColumn] )
.head 9 -  Set nColumn = nColumn + 1
.head 8 -  !
.head 8 -  Set n = oMenu.Menu( hWndForm, FALSE )
.head 8 +  If n >= 0
.head 9 -  Call CjSetGroupItemText( p_nId, GetCaption( oMenu.GetItemTextX( n ) ), FALSE )
.head 9 +  If n < nOffset
.head 10 -  Set nFilterIndex = -1
.head 9 +  Else
.head 10 -  Set nFilterIndex = n - nOffset
.head 9 -  !
.head 9 -  Call ApplyFilter(  )
.head 5 +  Else If p_nId = nIdFilterClear
.head 6 -  Call ClearFilter(  )
.head 5 +  Else
.head 6 -  Call CjTaskPanel.classItemClick( p_nId, p_sCaption )
.head 3 +  Function: ApplyFilter
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call oParamArtikelZuordnung.ClearFilterStringEx(  )
.head 5 -  Call oParamArtikelZuordnung.SetFilterString( STRING_Null )
.head 5 +  If nFilterIndex >= 0
.head 6 -  Call oParamArtikelZuordnung.SetFilterStringEx( nFilterIndex, dfFilterString )
.head 5 +  Else
.head 6 -  Call oParamArtikelZuordnung.SetFilterString( dfFilterString )
.head 5 -  !
.head 5 -  Call oParamArtikelZuordnung.SetLA_AT_NR( cmbArtikeltyp.GetKeyX( 1  ) ) 
.head 5 -  Call oParamArtikelZuordnung.SetLA_AG_NR( cmbArtikeltyp.GetKeyX( 2 ) ) 
.head 5 -  Call oParamArtikelZuordnung.SetLA_LI_NR( cmbLieferant.GetKeyX(  ) )
.head 5 -  Call oParamArtikelZuordnung.SetKU_NR( cmbKU_BEZEICHNUNG.GetKeyX(  ) )
.head 5 -  !
.head 5 -  Call ParamSetData( PARAM.ChangedArtikelZuordnungFilter, oParamArtikelZuordnung )
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 -  Actions 
.head 3 +  Function: ClearFilter
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nFilterIndex = -1
.head 5 -  Call SalClearField( dfFilterString )
.head 5 -  Call CjSetGroupItemText( nIdFilterString, GetCaption( Translate( 'Suche (alle)' ) ), FALSE )
.head 5 -  !
.head 5 -  Call cmbArtikeltyp.ClearKey(  )
.head 5 -  Call cmbLieferant.ClearKey(  )
.head 5 -  Call cmbKU_BEZEICHNUNG.ClearKey(  )
.head 5 -  !
.head 5 -  Call ApplyFilter(  )
.head 3 +  Function: GetCaption
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: p_sCaption
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sXaml
.head 4 +  Actions
.head 5 -  Return p_sCaption || '...'
.head 3 -  ! th 20160907 jetzt globale Fkt
.head 3 +  ! Function: FindKuechenLevel
.head 4 -  Description: Findet das Küchen-Level :-D
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  String: p_sKSTID
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nLevel
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set nLevel = 1
.head 5 +  While nLevel < 5
.head 6 +  If SalStrMidX( p_sKSTID, 3*nLevel, 3) = '000'
.head 7 -  Return nLevel
.head 6 +  Else 
.head 7 -  Set nLevel = nLevel + 1
.head 5 -  Return 5
.head 3 +  ! Function: BuildKuechenStr
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sWhere = 'ku_kostenstelle = :sUserKst'
.head 5 +  Select Case FindKuechenLevel( sUserKst)
.head 6 +  Case 1
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 3)||'%\''
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 6)||'%\''
.head 7 -  Break 
.head 6 +  Case 3
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 9)||'%\''
.head 7 -  Break 
.head 6 +  Case 4
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 12)||'%\''
.head 7 -  Break 
.head 6 +  Case 5
.head 7 -  Break 
.head 6 +  Default 
.head 7 -  Break 
.head 5 -  Call Sql_ExecEx( hSql, 'SELECT ku_nr INTO :nGlobalTemp FROM kueche WHERE '|| sWhere ||' ORDER BY ku_kostenstelle', FALSE)
.head 5 +  While SqlFetchNext( hSql, nInd)
.head 6 -  Set sReturn = StrAppend( sReturn, ', ', NumberToStrX( nGlobalTemp))
.head 5 +  If sReturn = ''
.head 6 -  Set sReturn = '-1'
.head 5 -  Return sReturn
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oParamArtikelZuordnung
.head 4 -  Class: cObjParamArtikelZuordnung
.head 3 -  Number: nIdFilterString
.head 3 -  Number: nIdFilterClear
.head 3 -  !
.head 3 -  Number: nFilterIndex
.head 3 -  !
.head 3 -  String: sKuKstStr
.head 3 -  String: sWhereLieferant
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus( dfFilterString )
.head 1 -  !
.head 1 +  Form Window: frmREZ_Artikel
.head 2 -  Class: FormMainLight
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  Allow Child Docking? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 7.813"
.head 4 -  Top: 2.615"
.head 4 -  Width:  10.717"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.25"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? No
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 1
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 2
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If NOT Benutzer.HatRecht( REC_ARTIKEL )
.head 8 -  Call SalDisableWindow( hWndItem )
.head 7 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 3
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 4
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On AM_FETCH
.head 7 +  If SalSendMsg( hWndForm, AM_CAN_UPDATE, 0, 0 )
.head 8 -  Call SalSendClassMessage( AM_FETCH, 0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 7 +  If NOT Benutzer.HatRecht( REC_ARTIKEL )
.head 8 -  Call SalDisableWindow( hWndItem )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 5
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfAR_SB_NR
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 4 +  Data Field: dfAR_UPDATE
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: FormMainLight
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left: Class Default
.head 7 -  Top: Class Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Group Box: Artikel
.head 4 -  Resource Id: 36660
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 0.073"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.906"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 -  Background Text: Intern
.head 4 -  Resource Id: 36661
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.344"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldKey
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.988"
.head 6 -  Top: 0.281"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Quelle
.head 4 -  Resource Id: 36662
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.288"
.head 5 -  Top: 0.656"
.head 5 -  Width:  0.65"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_QUELLE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 20
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.988"
.head 6 -  Top: 0.594"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_FETCH	! wl 20120516 erweitertes disable
.head 6 +  If SalIsNull( dfAR_NR )  OR NOT FieldDisabled(  )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 6 +  Else If FieldDisabled(  )
.head 7 -  Call SalDisableWindow( hWndItem )
.head 6 +  If hWndItem = SalGetFocus(  )
.head 7 -  Call SalSetFocus( dfAR_MENGE)
.head 3 -  !
.head 3 -  Group Box: Kennzeichen
.head 4 -  Resource Id: 36663
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.717"
.head 5 -  Top: 0.073"
.head 5 -  Width:  1.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.125"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbAR_GESP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: gesperrt
.head 4 -  Window Location and Size
.head 5 -  Left: 7.9"
.head 5 -  Top: 0.313"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbAR_GEPRUEFT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: geprüft
.head 4 -  Window Location and Size
.head 5 -  Left: 7.9"
.head 5 -  Top: 0.563"
.head 5 -  Width:  0.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Group Box: Bezeichnung
.head 4 -  Resource Id: 36664
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 1.021"
.head 5 -  Width:  7.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.208"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Artikel
.head 4 -  Resource Id: 36665
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 0.338"
.head 5 -  Top: 1.26"
.head 5 -  Width:  1.15"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_INTERN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.683"
.head 6 -  Top: 1.24"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call SalSendClassMessage( SAM_AnyEdit, wParam, lParam )
.head 6 -  Call SalSendMsg( hWndItem, AM_FETCH, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 -  Call SalSetWindowText( SalParentWindow( hWndForm ), MyValue )
.head 3 -  Background Text: KurzBez
.head 4 -  Resource Id: 36666
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.383"
.head 5 -  Top: 1.552"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_KURZBEZ	! law 20071029 optional disablen
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 100
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.683"
.head 6 -  Top: 1.531"
.head 6 -  Width:  5.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On AM_FETCH	! wl 20120516 erweitertes disable
.head 6 +  If SalIsNull( dfAR_NR ) OR NOT FieldDisabled(  )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  Else If FieldDisabled(  )
.head 7 +  If hWndItem = SalGetFocus(  )
.head 8 -  Call SalSetFocus( dfAR_INTERN)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Gray )
.head 5 +  ! On AM_FETCH
.head 6 +  If SalIsNull( dfAR_NR )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  Else If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 +  If hWndItem = SalGetFocus(  )
.head 8 -  Call SalSetFocus( dfAR_INTERN)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Gray )
.head 5 +  On AM_NEW
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 -  Call SalSendClassMessage( AM_NEW, 0, 0 )
.head 3 -  !
.head 3 -  Group Box: Einheiten
.head 4 -  Resource Id: 36667
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 2.281"
.head 5 -  Width:  5.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.042"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Verbrauch
.head 4 -  Resource Id: 36668
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 0.317"
.head 5 -  Top: 2.677"
.head 5 -  Width:  0.967"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfVBAnzahl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.383"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.25"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Center
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = '1'
.head 3 +  Combo Box: cmAM_KURZBEZ	! law 20071029 optional disablen
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.683"
.head 5 -  Top: 2.615"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.042"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create	! th 20171121 order by am_sort usw
.head 6 -  Call cmAM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_AM_NR','(AM_TYP LIKE \'%L%\' OR EXISTS(SELECT * FROM artikel WHERE ar_am_nr = am_nr) OR AM_TYP IS NULL)', 'am_sort, am_kurzbez' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  ! On SAM_Create	! wl 2014 Filter
.head 6 -  Call cmAM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_AM_NR','(AM_TYP LIKE \'%L%\' OR EXISTS(SELECT * FROM artikel WHERE ar_am_nr = am_nr) OR AM_TYP IS NULL)','' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  ! On SAM_Create
.head 6 -  Call cmAM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_AM_NR','','' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  ! If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On AM_FETCH	! wl 20120516 erweitertes disable
.head 6 +  If SalIsNull( dfAR_AM_NR ) OR NOT Sql_FetchOne( hSql, 'Select AM_KURZBEZ into :frmREZ_Artikel.cmAM_KURZBEZ
FROM artikelme WHERE AM_NR = :frmREZ_Artikel.dfAR_AM_NR' )
.head 7 -  Call SalClearField( hWndItem)
.head 6 -  Set dfArtikelMenge = MyValue
.head 6 -  !
.head 6 +  If SalIsNull( dfAR_NR )  OR NOT FieldDisabled(  )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  Else If FieldDisabled(  )
.head 7 +  If hWndItem = SalGetFocus(  )
.head 8 -  Call SalSetFocus( dfAR_MENGE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_3DFace )
.head 5 +  ! On AM_FETCH
.head 6 +  If SalIsNull( dfAR_AM_NR ) OR NOT Sql_FetchOne( hSql, 'Select AM_KURZBEZ into :frmREZ_Artikel.cmAM_KURZBEZ
FROM artikelme WHERE AM_NR = :frmREZ_Artikel.dfAR_AM_NR' )
.head 7 -  Call SalClearField( hWndItem)
.head 6 -  Set dfArtikelMenge = MyValue
.head 6 -  !
.head 6 +  If SalIsNull( dfAR_NR )
.head 7 -  Call SalEnableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 +  Else If Benutzer.HatRecht( REC_ARTIKELME_DISABLE)
.head 7 +  If hWndItem = SalGetFocus(  )
.head 8 -  Call SalSetFocus( dfAR_MENGE)
.head 7 -  Call SalDisableWindow( hWndItem )
.head 7 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_3DFace )
.head 5 +  On AM_NEW
.head 6 -  Call SalEnableWindow( hWndItem )
.head 6 -  ! Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_SysWindow )
.head 6 -  Call SalSendClassMessage( AM_NEW, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  ! Call SalClearField( dfAR_AM_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Set dfArtikelMenge = MyValue
.head 3 -  Background Text: =
.head 4 -  Resource Id: 36669
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.1"
.head 5 -  Top: 2.677"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Center
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_MENGE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.433"
.head 6 -  Top: 2.615"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfGramm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.983"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = Translate( 'g' )
.head 3 -  Background Text: Lager
.head 4 -  Resource Id: 36670
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 0.317"
.head 5 -  Top: 2.927"
.head 5 -  Width:  0.967"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfLagerAnz
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.383"
.head 6 -  Top: 2.906"
.head 6 -  Width:  0.25"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Center
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = '1'
.head 3 +  Combo Box: c1AM_KURZBEZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.683"
.head 5 -  Top: 2.906"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.042"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create ! th 20171121 order by am_sort usw
.head 6 -  Call c1AM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_LE_AM_NR','(AM_TYP LIKE \'%L%\' OR EXISTS(SELECT * FROM artikel WHERE ar_am_nr = am_nr) OR AM_TYP IS NULL)', 'am_sort, am_kurzbez' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  ! On SAM_Create
.head 6 -  Call c1AM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_LE_AM_NR','(AM_TYP LIKE \'%L%\' OR EXISTS(SELECT * FROM artikel WHERE ar_am_nr = am_nr) OR AM_TYP IS NULL)','' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  ! On SAM_Create
.head 6 -  Call c1AM_KURZBEZ.SetKeyDataField( 'ARTIKELME','AM_NR',':dfAR_LE_AM_NR','','' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( dfAR_LE_AM_NR ) OR NOT Sql_FetchOne( hSql, 'Select AM_KURZBEZ into :frmREZ_Artikel.c1AM_KURZBEZ
FROM artikelme WHERE AM_NR = :frmREZ_Artikel.dfAR_LE_AM_NR' )
.head 7 -  Call SalClearField( hWndItem)
.head 5 +  On SAM_DropDown
.head 6 -  ! wl 20141006 wieder deaktiviert, damit man den Eintrag nicht löschen kann
.head 6 -  ! wl 20130306 wieder aktiviert, damit man den Eintrag löschen kann
.head 6 -  ! Call SalClearField( dfAR_LE_AM_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 3 -  Background Text: =
.head 4 -  Resource Id: 36671
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.1"
.head 5 -  Top: 2.927"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Center
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_LAGEREINHEIT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.433"
.head 6 -  Top: 2.906"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfArtikelMenge
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.983"
.head 6 -  Top: 2.906"
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Group Box: Warengruppe
.head 4 -  Resource Id: 36672
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.95"
.head 5 -  Top: 0.083"
.head 5 -  Width:  4.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.906"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Typ
.head 4 -  Resource Id: 36674
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 2.833"
.head 5 -  Top: 0.344"
.head 5 -  Width:  1.083"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmAT_TEXT ! ra 20150526 mit pflichten felder
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.183"
.head 5 -  Top: 0.313"
.head 5 -  Width:  3.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.667"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmAT_TEXT.SetKeyDataField( 'artikeltyp', 'at_nr',
':frmREZ_Artikel.dfAR_AT_NR',
'',  'at_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call SalClearField( dfAR_AG_NR )
.head 6 -  Call SalClearField( cmAG_TEXT )
.head 6 -  ! Call SalSendMsg( cmAG_TEXT, SAM_Create, 0, 0 )
.head 6 -  Call SalSendMsg( cmAG_TEXT, AM_POPULATE, 0, 0 )
.head 5 -  On SAM_DropDown
.head 3 +  ! ComboWithDataField: cmAT_TEXT
.winattr class Combo Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.183"
.head 5 -  Top: 0.323"
.head 5 -  Width:  2.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmAT_TEXT.SetKeyDataField( 'artikeltyp', 'at_nr',
':frmREZ_Artikel.dfAR_AT_NR',
'',  'at_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  Call SalClearField( dfAR_AT_NR )
.head 6 -  Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 -  ! ra 20150521 
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam )
.head 6 -  Call ListPopulate( cmAG_TEXT, hSql, 'SELECT ag_text FROM artikelgruppe
	WHERE ag_at_nr = ' || NumberToStrX( dfAR_AT_NR ) )
		
.head 3 +  Data Field: dfAR_AT_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.588"
.head 6 -  Top: 0.49"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( dfAR_AT_NR ) OR NOT Sql_FetchOne( hSql,'SELECT at_text  FROM artikeltyp
WHERE at_nr = :frmREZ_Artikel.dfAR_AT_NR
INTO :frmREZ_Artikel.cmAT_TEXT ')
.head 7 -  Call SalClearField( cmAT_TEXT )
.head 3 -  Background Text: Gruppe
.head 4 -  Resource Id: 57410
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundTextMuss
.head 4 -  Window Location and Size
.head 5 -  Left: 2.933"
.head 5 -  Top: 0.656"
.head 5 -  Width:  1.083"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmAG_TEXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.183"
.head 5 -  Top: 0.615"
.head 5 -  Width:  3.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.823"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'',  'ag_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown ! th 20160912 nur wenn typ geädert Liste neu
.head 6 +  If SalIsNull( dfAR_AG_NR)
.head 7 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'ag_at_nr = :frmREZ_Artikel.dfAR_AT_NR',  'ag_sort' )
.head 7 -  ! Call SalClearField( dfAR_AG_NR )
.head 7 -  Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  ! On SAM_DropDown
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'ag_at_nr = :frmREZ_Artikel.dfAR_AT_NR',  'ag_sort' )
.head 6 -  Call SalClearField( dfAR_AG_NR )
.head 6 -  Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  On AM_FETCH ! th 20160912 mit typ_nr im where füllen
.head 6 -  ! Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'',  'ag_sort' )
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'ag_at_nr = :frmREZ_Artikel.dfAR_AT_NR',  'ag_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  ! On AM_FETCH
.head 6 -  Call cmAG_TEXT.SetKeyDataField( 'artikelgruppe', 'ag_nr',
':frmREZ_Artikel.dfAR_AG_NR',
'',  'ag_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  Data Field: dfAR_AG_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.588"
.head 6 -  Top: 0.49"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( frmREZ_Artikel.dfAR_AG_NR ) OR NOT Sql_FetchOne( hSql,'SELECT ag_text  FROM artikelgruppe
WHERE ag_nr = :frmREZ_Artikel.dfAR_AG_NR
INTO :frmREZ_Artikel.cmAG_TEXT ')
.head 7 -  Call SalClearField( cmAG_TEXT )
.head 3 -  !
.head 3 -  Background Text: LagerOrt
.head 4 -  Resource Id: 36676
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.383"
.head 5 -  Top: 1.917"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Combo Box: cmLO_TEXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboWithDataField
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 1.683"
.head 5 -  Top: 1.854"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.51"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call cmLO_TEXT.SetKeyDataField( 'lagerort', 'lo_nr',
':frmREZ_Artikel.dfAR_LO_NR',
'',  'lo_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  ! Call SalClearField( dfAR_LO_NR )
.head 6 -  ! Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 3 +  Data Field: dfAR_LO_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.588"
.head 6 -  Top: 0.479"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( frmREZ_Artikel.dfAR_LO_NR ) OR NOT Sql_FetchOne( hSql,'SELECT lo_text  FROM lagerort
WHERE lo_nr = :frmREZ_Artikel.dfAR_LO_NR
INTO :frmREZ_Artikel.cmLO_TEXT ')
.head 7 -  Call SalClearField( cmLO_TEXT )
.head 3 -  ! BackGroundText: LagerPosition
.head 3 +  ! ComboWithDataField: cmLP_TEXT
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call cmLP_TEXT.SetKeyDataField( 'lagerpos', 'lp_nr',
':frmREZ_Artikel.dfAR_LP_NR',
'',  'lp_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 +  On SAM_DropDown
.head 6 -  Call cmLP_TEXT.SetKeyDataField( 'lagerpos', 'lp_nr',
':frmREZ_Artikel.dfAR_LP_NR',
'lp_lo_nr =  :frmREZ_Artikel.dfAR_LO_NR',  'lp_sort' )
.head 6 -  Call SalClearField( dfAR_LP_NR )
.head 6 -  Call SalSendClassMessage( SAM_DropDown, 0, 0 )
.head 5 +  On AM_FETCH
.head 6 -  Call cmLP_TEXT.SetKeyDataField( 'lagerpos', 'lp_nr',
':frmREZ_Artikel.dfAR_LP_NR',
'',  'lp_sort' )
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 3 +  ! DataFieldWithComboBox: dfAR_LP_NR
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If SalIsNull( frmREZ_Artikel.dfAR_LP_NR ) OR NOT Sql_FetchOne( hSql,'SELECT lp_text  FROM lagerpos
WHERE lp_nr = :frmREZ_Artikel.dfAR_LP_NR
INTO :frmREZ_Artikel.cmLP_TEXT ')
.head 7 -  Call SalClearField( cmLP_TEXT )
.head 3 +  Data Field: dfAR_AM_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.013"
.head 6 -  Top: -0.01"
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAR_LE_AM_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.013"
.head 6 -  Top: -0.01"
.head 6 -  Width:  0.538"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Group Box: Sortiment
.head 4 -  Resource Id: 36677
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.183"
.head 5 -  Top: 2.281"
.head 5 -  Width:  3.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.042"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbAR_PARAMETER1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Sortiment
.head 4 -  Window Location and Size
.head 5 -  Left: 7.9"
.head 5 -  Top: 0.813"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbAR_MILCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Milchküche
.head 4 -  Window Location and Size
.head 5 -  Left: 7.9"
.head 5 -  Top: 1.063"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: MaxMenge
.head 4 -  Resource Id: 36678
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 7.183"
.head 5 -  Top: 2.688"
.head 5 -  Width:  1.225"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_MAXMENGE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.533"
.head 6 -  Top: 2.615"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: #00
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Bestellschritte
.head 4 -  Resource Id: 36679
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 7.083"
.head 5 -  Top: 2.927"
.head 5 -  Width:  1.325"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_STEP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.533"
.head 6 -  Top: 2.906"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Group Box: Nährwerte
.head 4 -  Resource Id: 36680
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 3.365"
.head 5 -  Width:  7.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.458"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  ! th 20151023
.head 3 +  ! CheckUpdate: cbAR_CHECKSBLS
.winattr class Check Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Nährwerte aus BLS für Basisartikel anwenden
.head 4 -  Window Location and Size
.head 5 -  Left: 0.6"
.head 5 -  Top: 3.542"
.head 5 -  Width:  5.983"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 -  ! th: class überschr. damit nicht bei Suche(...)
.head 5 -  On SAM_Create
.head 5 -  On AM_FETCH
.head 5 -  On AM_FIELDS
.head 5 -  On AM_SEARCH
.head 5 -  On AM_SEARCH_KEY
.head 5 -  On AM_INSERT
.head 5 -  On AM_UPDATE
.head 5 -  !
.head 5 +  On SAM_Validate
.head 6 +  If MyValue = cbAR_CHECKSBLS1
.head 7 -  Set cbAR_CHECKSBLS1 = NOT MyValue
.head 7 -  ! AR_CHECKSBLS1 geändert -> update dh. wParam = 1
.head 7 -  Call SalSendMsg( cbAR_CHECKSBLS1, AM_ANY_EDIT, 1, 0 )
.head 6 +  If MyValue 
.head 7 -  Call SalEnableWindow( dfAR_SBLS )
.head 7 -  Call SalEnableWindow( pbBLS )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfAR_SBLS )
.head 7 -  Call SalDisableWindow( pbBLS )
.head 5 +  On AM_ANY_EDIT
.head 6 -  Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 6 -  Call SalSendMsg( cbAR_CHECKSBLS1, SAM_Validate, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0 )
.head 6 -  Call SalSendMsg( hWndItem, AM_ANY_EDIT, 0, 0 )
.head 3 -  ! th 20160304
.head 3 +  ! CheckUpdate: cbAR_CHECKSBLS1
.winattr class Check Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Nährwerte aus Lieferartikel für Basisartikel anwenden
.head 4 -  Window Location and Size
.head 5 -  Left: 0.6"
.head 5 -  Top: 4.135"
.head 5 -  Width:  5.983"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Call SalSendMsg( hWndItem, AM_ANY_EDIT, 0, 0 )
.head 5 +  On AM_ANY_EDIT
.head 6 -  Call SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 6 -  Call SalSendMsg( cbAR_CHECKSBLS, SAM_Validate, 0, 0 )
.head 6 -  ! wenn ANY_EDIT duch Click ausgelöst...
.head 6 +  If wParam
.head 7 -  ! Call CheckSBLS1AutomatischUpdaten ()
.head 7 -  ! th 20151125: doch nicht automatisch updaten und nach Speichern fragen ...
.head 7 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 5 +  On SAM_Validate ! rbs
.head 6 +  If MyValue = cbAR_CHECKSBLS
.head 7 -  Set cbAR_CHECKSBLS = NOT MyValue
.head 7 -  Call SalSendMsg( cbAR_CHECKSBLS, AM_ANY_EDIT, 0, 0 )
.head 6 +  If MyValue 
.head 7 -  Call SalEnableWindow( dfAR_SBLS1 )
.head 7 -  Call SalEnableWindow( pbBLS1 )
.head 7 -  ! so als hätte man auf raAR_CHECKSBLS1 geklickt
.head 7 -  Set rbAR_CHECKSBLS1 = 1
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfAR_SBLS1 )
.head 7 -  Call SalDisableWindow( pbBLS1 )
.head 7 -  ! so als hätte man auf raAR_CHECKSBLS geklickt
.head 7 -  Set rbAR_CHECKSBLS = 1
.head 5 +  ! On SAM_Validate
.head 6 +  If MyValue = cbAR_CHECKSBLS
.head 7 -  Set cbAR_CHECKSBLS = NOT MyValue
.head 7 -  Call SalSendMsg( cbAR_CHECKSBLS, AM_ANY_EDIT, 0, 0 )
.head 6 +  If MyValue 
.head 7 -  Call SalEnableWindow( dfAR_SBLS1 )
.head 7 -  Call SalEnableWindow( pbBLS1 )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfAR_SBLS1 )
.head 7 -  Call SalDisableWindow( pbBLS1 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0 )
.head 6 -  ! AR_CHECKSBLS1 geändert -> update dh. wParam = 1
.head 6 -  Call SalSendMsg( hWndItem, AM_ANY_EDIT, 1, 0 )
.head 3 +  Data Field: dfAR_CHECKSBLS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.2"
.head 6 -  Top: 3.75"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_FETCH	! wl 20160821 drei Möglichkeiten #238
.head 6 +  If MyValue = 1
.head 7 -  Set rbAR_CHECKSBLS1 = 1
.head 6 +  Else If MyValue = 2
.head 7 -  Set rbAR_CHECKSBLS2 = 1
.head 6 +  Else
.head 7 -  Set rbAR_CHECKSBLS = 1
.head 5 +  ! On AM_FETCH
.head 6 +  If MyValue
.head 7 -  Set rbAR_CHECKSBLS1 = 1
.head 6 +  Else If 
.head 7 -  Set rbAR_CHECKSBLS = 1
.head 5 +  On AM_UPDATE	! wl 20160821 drei Möglichkeiten #238
.head 6 +  If rbAR_CHECKSBLS2
.head 7 -  Set MyValue = 2
.head 6 +  Else If rbAR_CHECKSBLS1
.head 7 -  Set MyValue = 1
.head 6 +  Else
.head 7 -  Set MyValue = 0
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0)
.head 5 +  ! On AM_UPDATE
.head 6 -  Set MyValue = rbAR_CHECKSBLS1
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0)
.head 5 +  On AM_INSERT
.head 6 -  Set MyValue = rbAR_CHECKSBLS1
.head 6 -  Call SalSendClassMessage( AM_INSERT, 0, 0)
.head 3 +  Radio Button: rbAR_CHECKSBLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Nährwerte aus BLS für Basisartikel verwenden
.head 4 -  Window Location and Size
.head 5 -  Left: 0.6"
.head 5 -  Top: 3.583"
.head 5 -  Width:  4.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click ! th 20160915 direkt speichern und Merkmale aktualisieren wenn ar_nr nicht null
.head 6 +  If NOT SalIsNull( dfAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 7 -  Call RefreshDependent ()
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0)
.head 3 +  Radio Button: rbAR_CHECKSBLS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Nährwerte des zugeordneten Lieferartikels verwenden
.head 4 -  Window Location and Size
.head 5 -  Left: 0.6"
.head 5 -  Top: 4.198"
.head 5 -  Width:  6.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click ! th 20160915 direkt speichern und Merkmale aktualisieren wenn ar_nr nicht null
.head 6 +  If NOT SalIsNull( dfAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 7 -  Call RefreshDependent ()
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0)
.head 3 +  Radio Button: rbAR_CHECKSBLS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Kombination der Nährwerte verwenden
.head 4 -  Window Location and Size
.head 5 -  Left: 0.6"
.head 5 -  Top: 4.5"
.head 5 -  Width:  6.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click ! th 20160915 direkt speichern und Merkmale aktualisieren wenn ar_nr nicht null
.head 6 +  If NOT SalIsNull( dfAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 7 -  Call RefreshDependent ()
.head 5 +  ! On SAM_Click ! th 20160906 notify(..) des FromWnds
.head 6 -  Call frmREZ_Artikel.ParamSetEx( PARAM.Execute, NumberToStrX( ARTIKEL.Speichern ), TRUE )
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0)
.head 3 -  ! BackGroundText: BLS
.winattr class Background Text:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.933"
.head 5 -  Top: 3.896"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_SBLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.383"
.head 6 -  Top: 3.875"
.head 6 -  Width:  1.01"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit ! th 20160906 nur nach ST suchen wenn Feld nicht leer ist, sonst ST löschen
.head 6 +  If bInhalt AND NOT SalIsNull( hWndItem )
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT st FROM blsdat 
INTO :frmREZ_Artikel.dfST
WHERE sbls LIKE \'' || dfAR_SBLS || '%\' ORDER BY sbls' )
.head 6 +  Else If SalIsNull( hWndItem )
.head 7 -  Call SalClearField( dfST )
.head 6 -  ! th 20151125
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 5 +  ! On SAM_AnyEdit
.head 6 +  If bInhalt
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT st FROM blsdat 
INTO :frmREZ_Artikel.dfST
WHERE sbls LIKE \'' || dfAR_SBLS || '%\' ORDER BY sbls' )
.head 6 -  ! th 20151125
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 5 +  On SAM_Validate
.head 6 +  If bInhalt
.head 7 +  If NOT SalIsNull( hWndItem )
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT sbls FROM blsdat 
INTO :frmREZ_Artikel.dfAR_SBLS
WHERE st = \'' || dfST || '\'' )
.head 9 -  Call SalClearField( hWndItem )
.head 5 +  On AM_UPDATE	! th 20180313 re_inhaltneu in lokale funktion
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call oReInhNeu.SetDependent(dfAR_NR, FALSE)
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE	! th 20161108 re_inhaltneu in globale funktion
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call SetReInhaltNeu( frmREZ_Artikel.dfAR_NR )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE	! wl 20150213 Exist statt IN
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr  = rk_re_nr  AND rk_typ = \'R\' 
AND EXISTS(SELECT * FROM rezkomp WHERE rk_ar_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND (ar_sbls != :frmREZ_Artikel.dfAR_SBLS OR ar_sbls IS NULL)' )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR)')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 3 +  Data Field: dfAR_SBLS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.45"
.head 6 -  Top: 3.917"
.head 6 -  Width:  1.01"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 -  ! nicht visible
.head 5 +  ! On SAM_AnyEdit
.head 6 +  If bInhalt
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT st FROM blsdat 
INTO :frmREZ_Artikel.dfST
WHERE sbls LIKE \'' || dfAR_SBLS || '%\' ORDER BY sbls' )
.head 6 -  ! th 20151125
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 5 +  ! On SAM_Validate
.head 6 +  If bInhalt
.head 7 +  If NOT SalIsNull( hWndItem )
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT sbls FROM blsdat 
INTO :frmREZ_Artikel.dfAR_SBLS
WHERE st = \'' || dfST || '\'' )
.head 9 -  Call SalClearField( hWndItem )
.head 5 +  On AM_UPDATE	! th 20180313 re_inhaltneu in lokale funktion
.head 6 +  If ( SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 IS  NULL' ) )
.head 7 -  Call oReInhNeu.SetDependent(dfAR_NR, FALSE)
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE	! th 20161108 re_inhaltneu in globale funktion
.head 6 +  If ( SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 IS  NULL' ) )
.head 7 -  Call SetReInhaltNeu( frmREZ_Artikel.dfAR_NR )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE	! wl 20150213 Exist statt IN
.head 6 +  If ( SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls1 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls1 IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr  = rk_re_nr  AND rk_typ = \'R\' 
AND EXISTS(SELECT * FROM rezkomp WHERE rk_ar_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND (ar_sbls != :frmREZ_Artikel.dfAR_SBLS OR ar_sbls IS NULL)' )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR)')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 3 +  Data Field: dfAR_SBLS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.467"
.head 6 -  Top: 3.917"
.head 6 -  Width:  1.01"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_AnyEdit
.head 6 +  If bInhalt
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT st FROM blsdat 
INTO :frmREZ_Artikel.dfST
WHERE sbls LIKE \'' || dfAR_SBLS || '%\' ORDER BY sbls' )
.head 6 -  ! th 20151125
.head 6 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 5 +  ! On SAM_Validate
.head 6 +  If bInhalt
.head 7 +  If NOT SalIsNull( hWndItem )
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT sbls FROM blsdat 
INTO :frmREZ_Artikel.dfAR_SBLS
WHERE st = \'' || dfST || '\'' )
.head 9 -  Call SalClearField( hWndItem )
.head 5 +  On AM_UPDATE	! th 20180313 re_inhaltneu in lokale funktion
.head 6 +  If ( SalIsNull( dfAR_SBLS2 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls2 IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS2' )
OR
( NOT SalIsNull( dfAR_SBLS2 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls2 IS  NULL' ) )
.head 7 -  Call oReInhNeu.SetDependent(dfAR_NR, FALSE)
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE	! th 20161108 re_inhaltneu in globale funktion
.head 6 +  If ( SalIsNull( dfAR_SBLS2 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls2 IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS2' )
OR
( NOT SalIsNull( dfAR_SBLS2 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls2 IS  NULL' ) )
.head 7 -  Call SetReInhaltNeu( frmREZ_Artikel.dfAR_NR )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE	! wl 20150213 Exist statt IN
.head 6 +  If ( SalIsNull( dfAR_SBLS2 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls2 IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS2' )
OR
( NOT SalIsNull( dfAR_SBLS2 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls2 FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls2 IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr  = rk_re_nr  AND rk_typ = \'R\' 
AND EXISTS(SELECT * FROM rezkomp WHERE rk_ar_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND (ar_sbls != :frmREZ_Artikel.dfAR_SBLS OR ar_sbls IS NULL)' )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR)')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 3 +  Pushbutton: pbBLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarBLS
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.467"
.head 5 -  Top: 3.833"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click	! wl 20131109 mit Parameter
.head 6 -  Set sSBLS = dfAR_SBLS
.head 6 +  If SalModalDialog( dlgBLS, hWndForm, sSBLS, 0 )
.head 7 -  Set dfAR_SBLS = sSBLS
.head 7 +  If SalIsNull( dfAR_MENGE )
.head 8 -  Call Sql_FetchOne( hSql, 'SELECT gp FROM blsdat 
INTO :frmREZ_Artikel.dfAR_MENGE 
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS')
.head 7 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 7 -  Call SalSendMsg( dfAR_SBLS, SAM_AnyEdit, 0, 0 )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If NOT bInhalt
.head 7 -  Call SalDisableWindow( hWndItem )
.head 3 +  Data Field: dfST
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.017"
.head 6 -  Top: 3.875"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_FETCH
.head 6 +  If bInhalt
.head 7 +  If SalIsNull( frmREZ_Artikel.dfAR_SBLS ) OR NOT Sql_FetchOne( hSql, 'SELECT st FROM blsdat
INTO :frmREZ_Artikel.dfST 
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS')
.head 8 -  Call SalClearField( hWndItem )
.head 3 -  ! th 20151022
.head 3 -  ! BackGroundText: BLS
.winattr class Background Text:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.933"
.head 5 -  Top: 4.479"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  ! wl 20160821 kommt weg lt. #238 BEGIN
.head 3 +  ! DataFieldUpdate: dfAR_SBLS1
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.383"
.head 6 -  Top: 4.448"
.head 6 -  Width:  1.01"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_AnyEdit
.head 6 +  If bInhalt
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT st FROM blsdat 
INTO :frmREZ_Artikel.dfST1
WHERE sbls LIKE \'' || dfAR_SBLS1 || '%\' ORDER BY sbls' )
.head 7 -  ! th 20151125
.head 7 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 5 +  On SAM_Validate
.head 6 +  If bInhalt
.head 7 +  If NOT SalIsNull( hWndItem )
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT sbls FROM blsdat 
INTO :frmREZ_Artikel.dfAR_SBLS1
WHERE st = \'' || dfST1 || '\'' )
.head 9 -  Call SalClearField( hWndItem )
.head 5 +  On AM_UPDATE	! wl 20150213 Exist statt IN
.head 6 +  If ( SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS1' )
OR
( NOT SalIsNull( dfAR_SBLS1 ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE EXISTS (SELECT * FROM rezkomp WHERE re_nr  = rk_re_nr  AND rk_typ = \'R\' 
AND EXISTS(SELECT * FROM rezkomp WHERE rk_ar_nr = rk_re_nr AND rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If ( SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS NOT NULL' ) )
OR
Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls != :frmREZ_Artikel.dfAR_SBLS' )
OR
( NOT SalIsNull( dfAR_SBLS ) AND Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND ar_sbls IS  NULL' ) )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || ')')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = ' || NumberToStrX( frmREZ_Artikel.dfAR_NR) || '))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 5 +  ! On AM_UPDATE
.head 6 +  If Sql_FetchOne( hSql, 'SELECT ar_sbls FROM artikel
WHERE ar_nr = :frmREZ_Artikel.dfAR_NR AND (ar_sbls != :frmREZ_Artikel.dfAR_SBLS OR ar_sbls IS NULL)' )
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR)')
.head 7 -  ! abhängige
.head 7 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1 
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_typ = \'R\' 
AND rk_ar_nr IN (SELECT rk_re_nr FROM rezkomp WHERE rk_ar_nr = :frmREZ_Artikel.dfAR_NR))')
.head 7 -  Call Sql_Commit( hSql )
.head 6 -  Call SalSendClassMessage( AM_UPDATE, 0, 0 )
.head 3 +  ! ToolbarBLS: pbBLS1
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarBLS
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 2.467"
.head 5 -  Top: 4.417"
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: SAMM_NEU.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click	
.head 6 -  Set sSBLS = dfAR_SBLS1
.head 6 +  If SalModalDialog( dlgBLS, hWndForm, sSBLS, 0 )
.head 7 -  Set dfAR_SBLS1 = sSBLS
.head 7 +  If SalIsNull( dfAR_MENGE )
.head 8 -  Call Sql_FetchOne( hSql, 'SELECT gp FROM blsdat 
INTO :frmREZ_Artikel.dfAR_MENGE 
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS1')
.head 7 -  Call SalSendMsg( hWndForm, AM_ANY_EDIT, 0, 0 )
.head 7 -  Call SalSendMsg( dfAR_SBLS1, SAM_AnyEdit, 0, 0 )
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 +  If NOT bInhalt
.head 7 -  Call SalDisableWindow( hWndItem )
.head 3 +  ! DataFieldLabel: dfST1
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.017"
.head 6 -  Top: 4.448"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 +  If bInhalt
.head 7 +  If SalIsNull( frmREZ_Artikel.dfAR_SBLS1 ) OR NOT Sql_FetchOne( hSql, 'SELECT st FROM blsdat
INTO :frmREZ_Artikel.dfST1 
WHERE sbls = :frmREZ_Artikel.dfAR_SBLS1')
.head 8 -  Call SalClearField( hWndItem )
.head 3 -  ! wl 20160821 kommt weg lt. #238 END
.head 3 -  !
.head 3 -  Background Text: MWSt.
.head 4 -  Resource Id: 36682
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 7.6"
.head 5 -  Top: 4.521"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_TAX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 8
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.533"
.head 6 -  Top: 4.448"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  Group Box: Preise
.head 4 -  Resource Id: 36683
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.188"
.head 5 -  Top: 4.906"
.head 5 -  Width:  6.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfWHG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.488"
.head 6 -  Top: 5.302"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set MyValue = sWHG
.head 3 -  Background Text: EK
.head 4 -  Resource Id: 36684
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 1.488"
.head 5 -  Top: 5.115"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_EK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.438"
.head 6 -  Top: 5.302"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: DP
.head 4 -  Resource Id: 36685
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.088"
.head 5 -  Top: 5.115"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_DP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.038"
.head 6 -  Top: 5.302"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: VK
.head 4 -  Resource Id: 36686
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 4.638"
.head 5 -  Top: 5.115"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfAR_VK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.588"
.head 6 -  Top: 5.302"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###0000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  ! th 20151022
.head 3 +  ! DataFieldLabel: dfWHG2
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.488"
.head 6 -  Top: 4.51"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create ! ga 20130617: Kunde Mandant
.head 6 -  Call Sql_FetchOne( hSql, 'SELECT ku_kbez INTO :frmREZ_Artikel.dfWHG2 FROM kunde WHERE ' || GetWhereKunde(  ) )
.head 6 +  If SalIsNull( dfWHG2 )
.head 7 -  Set dfWHG2 = 'EUR'
.head 5 +  ! On SAM_Create
.head 6 -  Call Sql_FetchOne( hSql, 'SELECT ku_kbez FROM kunde INTO :frmREZ_Artikel.dfWHG2' )
.head 6 +  If SalIsNull( dfWHG2 )
.head 7 -  Set dfWHG2 = 'EUR'
.head 3 +  ! DataFieldShowOnly: dfAR_EK_EUR
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.438"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Set MyValue = dfAR_EK * nEURO
.head 5 -  On AM_FIELDS
.head 5 +  ! On AM_FIELDS
.head 6 +  If sFields != ''
.head 7 -  Set sFields = sFields || ','
.head 6 -  Set sFields = sFields || 'AR_EK * :nEURO'  
.head 6 +  If sResult != ''
.head 7 -  Set sResult = sResult || ','
.head 6 -  Set sResult = sResult || ':' || sItemName
.head 5 -  On AM_SEARCH
.head 3 +  ! DataFieldShowOnly: dfAR_DP_EUR
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.038"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Set MyValue = dfAR_DP * nEURO
.head 5 +  ! On AM_FIELDS
.head 6 +  If sFields != ''
.head 7 -  Set sFields = sFields || ','
.head 6 -  Set sFields = sFields || 'AR_DP * :nEURO' 
.head 6 +  If sResult != ''
.head 7 -  Set sResult = sResult || ','
.head 6 -  Set sResult = sResult || ':' || sItemName
.head 5 -  On AM_FIELDS
.head 5 -  On AM_SEARCH
.head 3 +  ! DataFieldShowOnly: dfAR_VK_EUR
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.588"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On AM_FETCH
.head 6 -  Set MyValue = dfAR_VK * nEURO
.head 5 +  ! On AM_FIELDS
.head 6 +  If sFields != ''
.head 7 -  Set sFields = sFields || ','
.head 6 -  Set sFields = sFields || 'AR_VK * :nEURO'
.head 6 +  If sResult != ''
.head 7 -  Set sResult = sResult || ','
.head 6 -  Set sResult = sResult || ':' || sItemName
.head 5 -  On AM_FIELDS
.head 5 -  On AM_SEARCH
.head 3 -  Group Box: Zusätze
.head 4 -  Resource Id: 36687
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.733"
.head 5 -  Top: 4.906"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAR_KENNZS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.083"
.head 6 -  Top: 5.302"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  ! DataFieldUpdate: dfAR_KENNZS2
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.483"
.head 6 -  Top: 4.49"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  Data Field: dfAR_KENNZN1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 8.283"
.head 6 -  Top: 5.302"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  ! DataFieldUpdate: dfAR_KENNZN2
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 5
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 7.638"
.head 6 -  Top: 4.49"
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  !
.head 3 +  Pushbutton: pbSearchKey
.head 4 -  Class Child Ref Key: 15
.head 4 -  Class ChildKey: 0
.head 4 -  Class: FormMainLight
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: Class Default
.head 5 -  Top: Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAR_KU_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.073"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Unformatted
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  On AM_INSERT
.head 6 -  Set MyValue = nUserKuecheNrMandant
.head 6 -  Call SalSendClassMessage( AM_INSERT, wParam, lParam )
.head 5 +  On AM_CLEAR
.head 6 -  Set MyValue = nUserKuecheNrMandant
.head 5 +  On AM_REFRESH
.head 6 -  Call EnableDisable(  )
.head 3 +  Data Field: dfAR_IMPORTIERT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 4.588"
.head 6 -  Top: 4.49"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Right
.head 5 -  Format: ###000
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classNotify		! th 20180614 .Neu anders
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  ! Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR, 'A' )
.head 9 -  Break
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call oReInhNeu.SetDependent(dfAR_NR, TRUE)
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog( dlgArtikelDatenübertrag, hWndForm, dfAR_NR, dfAR_INTERN )
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 10 -  ! Arbeitsbereich (sich selbst) aktualisieren
.head 10 -  Call ParamSetEx( wp_nPARAM, NumberToStrX(dfAR_NR), TRUE  )
.head 10 -  ! Call RefreshDependent(  )
.head 9 -  Break
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 20180312 RE_INHALTNEU bei Abhängigen
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR, 'A' )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call oReInhNeu.SetDependent(dfAR_NR, TRUE)
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog( dlgArtikelDatenübertrag, hWndForm, dfAR_NR, dfAR_INTERN )
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 10 -  ! Arbeitsbereich (sich selbst) aktualisieren
.head 10 -  Call ParamSetEx( wp_nPARAM, NumberToStrX(dfAR_NR), TRUE  )
.head 10 -  ! Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 20170928 nach Datenübertrag Felder befüllen
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR, 'A' )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call SetReInhaltNeuEx( dfAR_NR, TRUE, FALSE )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog( dlgArtikelDatenübertrag, hWndForm, dfAR_NR, dfAR_INTERN )
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 10 -  ! Arbeitsbereich (sich selbst) aktualisieren
.head 10 -  Call ParamSetEx( wp_nPARAM, NumberToStrX(dfAR_NR), TRUE  )
.head 10 -  ! Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! wl 20170726 in Sort ändern
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR, 'A' )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call SetReInhaltNeuEx( dfAR_NR, TRUE, FALSE )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog( dlgArtikelDatenübertrag, hWndForm, dfAR_NR, dfAR_INTERN )
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 10 -  ! Arbeitsbereich (sich selbst) aktualisieren
.head 10 -  Call ParamSetEx( PARAM.ChangedArtikelNrLeseModus, NumberToStrX(dfAR_NR), TRUE  )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 20161108 nach Datenübertrag tblArtikel und Arbeitsbereich aktualisieren; SetReInhaltNeuEx(..)
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call SetReInhaltNeuEx( dfAR_NR, TRUE, FALSE )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog( dlgArtikelDatenübertrag, hWndForm, dfAR_NR, dfAR_INTERN )
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 10 -  ! Arbeitsbereich (sich selbst) aktualisieren
.head 10 -  Call ParamSetEx( PARAM.ChangedArtikelNrLeseModus, NumberToStrX(dfAR_NR), TRUE  )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 2016512: Datenübertrag mit ar_intern als param aufrufen
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog( dlgArtikelDatenübertrag, hWndForm, dfAR_NR, dfAR_INTERN )
.head 10 -  ! Call SalMessageBox( 'Daten aus Lieferartikel wurden erfolgreich übertragen.', 'Daten aus Lieferartikel', MB_IconInformation | MB_Ok )
.head 10 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 20160129: Dialog bei CASE ARTIKEL.UpdateLieferTax aufrufen; ARTIKEL.Protokoll; RefreshDependent() nach Speichern
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Call RefreshDependent ()
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If SalModalDialog(dlgArtikelDatenübertrag, hWndForm, dfAR_NR)
.head 10 -  ! Call SalMessageBox( 'Daten aus Lieferartikel wurden erfolgreich übertragen.', 'Daten aus Lieferartikel', MB_IconInformation | MB_Ok )
.head 10 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Protokoll
.head 9 +  If SalModalDialog( dlgArtLog, hWndForm, dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 20151120: Case "ARTIKEL.UpdateLieferTax"
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If GetLieferartikelDaten( dfAR_NR )
.head 10 -  Call SalMessageBox( 'Daten aus Lieferartikel wurden erfolgreich übertragen.', 'Daten aus Lieferartikel', MB_IconInformation | MB_Ok )
.head 10 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! th 20151005: case Herkunft + Zutaten
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 -  !
.head 8 +  Case ARTIKEL.Herkunft 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 1 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Zutaten 
.head 9 -  ! th: "Deklaration" = Herkunft + Zutaten
.head 9 +  If SalModalDialog( dlgART_Deklaration, hWndForm, 1, dfAR_NR , 2 )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If GetLieferartikelDaten( dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! wl 20140119 Parentabfrage wieder rein, weil sonst bei neu und Tax falsches Fenster geprüft wird
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! wl 20150213 Exists statt IN
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE EXISTS (SELECT * FROM rezkomp WHERE  re_nr  = rk_re_nr  AND rk_typ = \'A\' 
AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || ')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.UpdateLieferTax ! wl 20150217 LieferTax
.head 9 +  If UpdateLieferTax( dfAR_NR )
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 8 +  ! Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify		! wl 20131223 mit Lieferanten, neuer Panel
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 -  ! If p_hWndParent = SalParentWindow( hWndForm )
.head 6 +  Select Case ParamGetInt( p_nKey )
.head 7 +  Case ARTIKEL.Neu
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 8 -  Break 
.head 7 +  Case ARTIKEL.Speichern
.head 8 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 8 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 9 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 9 -  !
.head 9 -  ! Tabelle aktualisieren
.head 9 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 8 -  Break 
.head 7 +  Case ARTIKEL.Kopieren
.head 8 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 9 -  Call CopyArtikel( )
.head 8 -  Break 
.head 7 +  Case ARTIKEL.Delete
.head 8 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 8 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 9 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 10 -  Set nAR_NR = dfAR_NR
.head 10 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 10 -  !
.head 10 -  Call SalDestroyWindow( wp_hWndParent )
.head 8 -  Break 
.head 7 +  Case ARTIKEL.KommtVor
.head 8 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 8 -  Break 
.head 7 +  Case ARTIKEL.Ersetzen
.head 8 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 8 -  Break 
.head 7 +  Case ARTIKEL.Taxierung ! ga 20110523
.head 8 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 9 -  Call Sql_Exec( hSql, 'UPDATE rezept SET RE_INHALTNEU = 1
WHERE re_nr IN (SELECT rk_re_nr FROM rezkomp WHERE  rk_typ = \'A\' AND @NULLVALUE(RE_KEINARTIKELTAX,0) = 0 AND rk_ar_nr = ' || NumberToStrX( dfAR_NR) || ' AND ' || GetWhereRezept( TRUE ) || 
')')
.head 9 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 9 -  !
.head 9 -  ! ga 20090722: abh. Fenster aktualisieren
.head 9 -  Call RefreshDependent(  )
.head 8 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = SalParentWindow( hWndForm )
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Neu
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0)
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0)
.head 10 -  !
.head 10 -  ! Tabelle aktualisieren
.head 10 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Kopieren
.head 9 +  If IDYES = MessageBox( 'Wollen Sie den Artikel kopieren?', 'Artikel kopieren', MB_YesNo )
.head 10 -  Call CopyArtikel( )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Delete
.head 9 -  ! ga 20100706: Mandant - hier nur sicherheitshalber, button sollte eh deaktiv sein
.head 9 +  If dfAR_KU_NR = nUserKuecheNrMandant
.head 10 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 11 -  Set nAR_NR = dfAR_NR
.head 11 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 11 -  !
.head 11 -  ! Tabelle aktualisieren
.head 11 -  Call ParamSetInt( ARTIKEL.SpeichernDone, nAR_NR )
.head 11 -  !
.head 11 -  Call SalDestroyWindow( wp_hWndParent )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.KommtVor
.head 9 -  Call SalModalDialog( dlgART_InREZ, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Ersetzen
.head 9 -  Call SalModalDialog( dlgART_InSort, hWndForm, dfAR_NR )
.head 9 -  Break 
.head 8 +  Case ARTIKEL.Taxierung ! ga 20110523
.head 9 +  If SalModalDialog( dlgART_Taxierung, hWndForm, dfAR_NR )
.head 10 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_update = SYSDATETIME
	WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 10 -  !
.head 10 -  ! ga 20090722: abh. Fenster aktualisieren
.head 10 -  Call RefreshDependent(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 -  ! ga 20100421: Speicherabfrage, Key Datenfeld nicht überschreiben
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If IsOk(  )
.head 8 +  If ( ParamGetInt( wp_nPARAM ) != NUMBER_Null )
.head 9 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( ParamGetInt( wp_nPARAM ) ), '', 2 )
.head 8 +  Else 
.head 9 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 +  ! If IsParam( wp_nPARAM )
.head 7 -  Set dfAR_NR = ParamGetInt( wp_nPARAM )
.head 7 +  If NOT SalIsNull( dfAR_NR )
.head 8 -  Call SalSendMsg( hWndForm, AM_SEARCH, 0, 0 )
.head 7 +  Else 
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_CLEAR, 0, 0 )
.head 6 -  !
.head 6 -  ! ga 20100706: "EnableDisable" erst nach PostMsg, weil's sonst beim Ersten Aufruf nicht geht
.head 6 -  ! Call EnableDisable(  )
.head 6 -  Call SalPostMsg( dfAR_KU_NR, AM_REFRESH, 0, 0 )
.head 3 +  Function: EnableDisable ! sja 20160629 'in Sortiment' Ribbon auch ohne Recht 'Wartung Artikel'
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bDarfEditieren
.head 5 -  Boolean: bDarfQuelleEditieren
.head 4 +  Actions
.head 5 -  !
.head 5 -  ! ga 20100706: Mandant - Rezept ist nur editierbar, wenn es von der eigenen Küche stammt
.head 5 -  Set bDarfEditieren = ( dfAR_KU_NR = nUserKuecheNrMandant ) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If bDarfEditieren
.head 6 -  ! REC_ARTIKELQUELLE_EXTERN -> Quelle, ME, Kurzbez editierbar, obwohl sie importiert wurde
.head 6 -  ! REC_ARTIKELME_DISABLE (Einstellung) -> Quelle, ME, Kurzbez nicht editierbar
.head 6 +  If Benutzer.HatRecht( REC_ARTIKELQUELLE_EXTERN ) OR NOT ( dfAR_IMPORTIERT OR Benutzer.HatRecht( REC_ARTIKELME_DISABLE ) )
.head 7 -  Set bDarfQuelleEditieren = TRUE
.head 5 -  !
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Speichern, bDarfEditieren )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Delete, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, TRUE)
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Taxierung, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Herkunft, bDarfEditieren AND Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION)  )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Zutaten, bDarfEditieren AND Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION) )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.UpdateLieferTax, bDarfEditieren AND Benutzer.HatRecht( REC_ARTIKEL) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Protokoll, bDarfEditieren AND Benutzer.HatRecht( REC_ARTIKEL) )
.head 6 -  Call DisableAll( hWndNULL, hWndaDisabled, NOT bDarfEditieren )
.head 6 +  If bDarfQuelleEditieren
.head 7 -  Call SalEnableWindow( dfAR_QUELLE )
.head 7 -  Call SalEnableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalEnableWindow( dfAR_AM_NR )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( dfAR_QUELLE )
.head 7 -  Call SalDisableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalDisableWindow( dfAR_AM_NR )
.head 3 +  ! Function: EnableDisable ! th 20151217: ARTIKEL.UpdateLiefertax; ARTIKEL.Protokoll
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bDarfEditieren
.head 5 -  Boolean: bDarfQuelleEditieren
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! ga 20100706: Mandant - Rezept ist nur editierbar, wenn es von der eigenen Küche stammt
.head 5 -  Set bDarfEditieren = ( dfAR_KU_NR = nUserKuecheNrMandant ) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If bDarfEditieren
.head 6 -  ! REC_ARTIKELQUELLE_EXTERN -> Quelle, ME, Kurzbez editierbar, obwohl sie importiert wurde
.head 6 -  ! REC_ARTIKELME_DISABLE (Einstellung) -> Quelle, ME, Kurzbez nicht editierbar
.head 6 +  If Benutzer.HatRecht( REC_ARTIKELQUELLE_EXTERN ) OR NOT ( dfAR_IMPORTIERT OR Benutzer.HatRecht( REC_ARTIKELME_DISABLE ) )
.head 7 -  Set bDarfQuelleEditieren = TRUE
.head 5 -  !
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Speichern, bDarfEditieren )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Delete, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Taxierung, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Herkunft, bDarfEditieren AND Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION)  )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Zutaten, bDarfEditieren AND Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION) )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.UpdateLieferTax, bDarfEditieren AND Benutzer.HatRecht( REC_ARTIKEL) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Protokoll, bDarfEditieren AND Benutzer.HatRecht( REC_ARTIKEL) )
.head 6 -  Call DisableAll( hWndNULL, hWndaDisabled, NOT bDarfEditieren )
.head 6 +  If bDarfQuelleEditieren
.head 7 -  Call SalEnableWindow( dfAR_QUELLE )
.head 7 -  Call SalEnableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalEnableWindow( dfAR_AM_NR )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfAR_QUELLE )
.head 7 -  Call SalDisableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalDisableWindow( dfAR_AM_NR )
.head 3 +  ! Function: EnableDisable ! th 20151005: Enable ARTIKEL.Herkunft/Zutaten
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bDarfEditieren
.head 5 -  Boolean: bDarfQuelleEditieren
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! ga 20100706: Mandant - Rezept ist nur editierbar, wenn es von der eigenen Küche stammt
.head 5 -  Set bDarfEditieren = ( dfAR_KU_NR = nUserKuecheNrMandant ) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If bDarfEditieren
.head 6 -  ! REC_ARTIKELQUELLE_EXTERN -> Quelle, ME, Kurzbez editierbar, obwohl sie importiert wurde
.head 6 -  ! REC_ARTIKELME_DISABLE (Einstellung) -> Quelle, ME, Kurzbez nicht editierbar
.head 6 +  If Benutzer.HatRecht( REC_ARTIKELQUELLE_EXTERN ) OR NOT ( dfAR_IMPORTIERT OR Benutzer.HatRecht( REC_ARTIKELME_DISABLE ) )
.head 7 -  Set bDarfQuelleEditieren = TRUE
.head 5 -  !
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Speichern, bDarfEditieren )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Delete, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Taxierung, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Herkunft, bDarfEditieren AND Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION)  )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Zutaten, bDarfEditieren AND Benutzer.HatRecht( REC_STAMMDATEN_DEKLARATION) )
.head 6 -  !
.head 6 -  Call DisableAll( hWndNULL, hWndaDisabled, NOT bDarfEditieren )
.head 6 +  If bDarfQuelleEditieren
.head 7 -  Call SalEnableWindow( dfAR_QUELLE )
.head 7 -  Call SalEnableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalEnableWindow( dfAR_AM_NR )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfAR_QUELLE )
.head 7 -  Call SalDisableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalDisableWindow( dfAR_AM_NR )
.head 3 +  ! Function: EnableDisable ! ga 20120516: abh. v. Recht Quelle usw. sperren
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bDarfEditieren
.head 5 -  Boolean: bDarfQuelleEditieren
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! ga 20100706: Mandant - Rezept ist nur editierbar, wenn es von der eigenen Küche stammt
.head 5 -  Set bDarfEditieren = ( dfAR_KU_NR = nUserKuecheNrMandant ) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If bDarfEditieren
.head 6 -  ! REC_ARTIKELQUELLE_EXTERN -> Quelle, ME, Kurzbez editierbar, obwohl sie importiert wurde
.head 6 -  ! REC_ARTIKELME_DISABLE (Einstellung) -> Quelle, ME, Kurzbez nicht editierbar
.head 6 +  If Benutzer.HatRecht( REC_ARTIKELQUELLE_EXTERN ) OR NOT ( dfAR_IMPORTIERT OR Benutzer.HatRecht( REC_ARTIKELME_DISABLE ) )
.head 7 -  Set bDarfQuelleEditieren = TRUE
.head 5 -  !
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Speichern, bDarfEditieren )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Delete, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Taxierung, bDarfEditieren )
.head 6 -  !
.head 6 -  Call DisableAll( hWndNULL, hWndaDisabled, NOT bDarfEditieren )
.head 6 +  If bDarfQuelleEditieren
.head 7 -  Call SalEnableWindow( dfAR_QUELLE )
.head 7 -  Call SalEnableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalEnableWindow( dfAR_AM_NR )
.head 6 +  Else 
.head 7 -  Call SalDisableWindow( dfAR_QUELLE )
.head 7 -  Call SalDisableWindow( dfAR_KURZBEZ )
.head 7 -  Call SalDisableWindow( dfAR_AM_NR )
.head 3 +  ! Function: EnableDisable ! ga 20101004: Artikel nur ansehen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bDarfEditieren
.head 4 +  Actions 
.head 5 -  !
.head 5 -  ! ga 20100706: Mandant - Rezept ist nur editierbar, wenn es von der eigenen Küche stammt
.head 5 -  Set bDarfEditieren = ( dfAR_KU_NR = nUserKuecheNrMandant ) AND Benutzer.HatRecht( REC_ARTIKEL )
.head 5 -  !
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Speichern, bDarfEditieren )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Delete, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, Benutzer.HatRecht( REC_ARTIKEL ) )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Taxierung, bDarfEditieren )
.head 6 -  !
.head 6 -  Call DisableAll( hWndNULL, hWndaDisabled, NOT bDarfEditieren )
.head 5 -  !
.head 3 +  ! Function: EnableDisable
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bDarfEditieren
.head 4 +  Actions 
.head 5 -  ! ga 20100706: Mandant - Rezept ist nur editierbar, wenn es von der eigenen Küche stammt
.head 5 -  Set bDarfEditieren = ( dfAR_KU_NR = nUserKuecheNrMandant )
.head 5 -  !
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Speichern, bDarfEditieren )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Delete, bDarfEditieren )
.head 6 -  !
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Kopieren, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.KommtVor, TRUE )
.head 6 -  Call CjSetItemEnabled( ARTIKEL.Ersetzen, TRUE )
.head 6 -  !
.head 6 -  Call DisableAll( hWndNULL, hWndaDisabled, NOT bDarfEditieren )
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Sql Handle: p_hSql
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SqlVarSetup( p_hSql )
.head 3 +  Function: CopyArtikel ! ga 20150907: auch im "Param" aktualisieren, damit die abh. Fenster nach Kopie aktualisiert werden (Taxierungen)
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStmt
.head 5 -  Number: nPrevAR_NR
.head 4 +  Actions
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Set sGlobalTemp = dfAR_INTERN || ' (copy)'
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_intern = :sGlobalTemp')
.head 7 -  Call MessageBox( 'Name schon vorhanden!
Bitte ändern Sie den internen Namen.', 'Artikel kopieren...' ,MB_Ok )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set nPrevAR_NR = dfAR_NR
.head 6 -  Call Sql_GetKeyCounter( 'AR_NR', dfAR_NR, hSql )
.head 6 -  Set dfAR_INTERN = dfAR_INTERN || ' (copy)'
.head 6 -  Set dfAR_QUELLE = ''
.head 6 -  Set sFields = ''
.head 6 -  Set sResult = ''
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_INSERT, 0, 0 )
.head 6 -  Set sStmt = 'INSERT INTO artikel (
		' || sFields || '
	) VALUES (
		' || sResult || ')'
.head 6 +  If Sql_Exec( hSql, sStmt )
.head 7 -  Call Sql_Exec( hSql, 'insert into ARTIKELTAXIERUNG (AT_AR_NR, AT_ART, AT_TU_NR)
select ' || NumberToStrX( dfAR_NR ) || ', AT_ART, AT_TU_NR
from ARTIKELTAXIERUNG where AT_AR_NR = ' || NumberToStrX( nPrevAR_NR ) )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  !
.head 6 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( dfAR_NR ), '', 2 )
.head 6 -  !
.head 6 -  ! ga 20150907: auch im "Param" aktualisieren, damit die abh. Fenster nach Kopie aktualisiert werden (Taxierungen)
.head 6 +  If ParamGetInt( PARAM.ChangedArtikelNr ) = nPrevAR_NR
.head 7 -  Call ParamSetInt( PARAM.ChangedArtikelNr, dfAR_NR )
.head 6 +  If ParamGetInt( PARAM.ChangedArtikelNrLeseModus ) = nPrevAR_NR
.head 7 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, dfAR_NR )
.head 6 -  !
.head 6 -  ! ga 20091005: Tabelle aktualisieren
.head 6 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 6 -  !
.head 6 -  ! ga 20100708: könnte sich geändert haben
.head 6 -  Call EnableDisable(  )
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else
.head 6 -  Call MessageBox( 'Sie müssen den Artikel zuerst speichern!', 'Achtung', MB_IconStop | MB_Ok )
.head 3 +  ! Function: CopyArtikel	! wl 20141123 mit Tax
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sInsert
.head 5 -  String: sAbgeleitetVon
.head 5 -  String: sAbgeleitetNach
.head 5 -  Number: nAbgeleitetNach
.head 5 -  Number: nAbgelietetVon
.head 4 +  Actions 
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Set sGlobalTemp = dfAR_INTERN || ' (copy)'
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_intern = :sGlobalTemp')
.head 7 -  Call MessageBox( 'Name schon vorhanden!
Bitte ändern Sie den internen Namen.', 'Artikel kopieren...' ,MB_Ok )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set sAbgeleitetVon = SalNumberToStrX( dfAR_NR, 0 )
.head 6 -  Call Sql_GetKeyCounter( 'AR_NR', dfAR_NR, hSql )
.head 6 -  Set sAbgeleitetNach = SalNumberToStrX( dfAR_NR, 0 )
.head 6 -  Set dfAR_INTERN = dfAR_INTERN || ' (copy)'
.head 6 -  Set dfAR_QUELLE = ''
.head 6 -  Set sFields = ''
.head 6 -  Set sResult = ''
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_INSERT, 0, 0 )
.head 6 -  Set sInsert = 'INSERT INTO artikel (
		' || sFields || '
	) VALUES (
		' || sResult || ')'
.head 6 +  If Sql_Exec( hSql, sInsert )
.head 7 -  Call Sql_Exec( hSql, 'insert into ARTIKELTAXIERUNG (AT_AR_NR, AT_ART, AT_TU_NR)
select ' || sAbgeleitetNach || ', AT_ART, AT_TU_NR
from ARTIKELTAXIERUNG where AT_AR_NR = ' || sAbgeleitetVon )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  !
.head 6 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( dfAR_NR ), '', 2 )
.head 6 -  !
.head 6 -  ! ga 20091005: Tabelle aktualisieren
.head 6 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 6 -  !
.head 6 -  ! ga 20100708: könnte sich geändert haben
.head 6 -  Call EnableDisable(  )
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Sie müssen den Artikel zuerst speichern!', 'Achtung', MB_IconStop | MB_Ok )
.head 3 +  ! Function: CopyArtikel	! wl 20131112 Quelle nicht kopieren
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sInsert
.head 5 -  String: sAbgeleitetVon
.head 5 -  String: sAbgeleitetNach
.head 5 -  Number: nAbgeleitetNach
.head 5 -  Number: nAbgelietetVon
.head 4 +  Actions 
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Set sGlobalTemp = dfAR_INTERN || ' (copy)'
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_intern = :sGlobalTemp')
.head 7 -  Call MessageBox( 'Name schon vorhanden!
Bitte ändern Sie den internen Namen.', 'Artikel kopieren...' ,MB_Ok )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set sAbgeleitetVon = SalNumberToStrX( dfAR_NR, 0 )
.head 6 -  Call Sql_GetKeyCounter( 'AR_NR', dfAR_NR, hSql )
.head 6 -  Set dfAR_INTERN = dfAR_INTERN || ' (copy)'
.head 6 -  Set dfAR_QUELLE = ''
.head 6 -  Set sFields = ''
.head 6 -  Set sResult = ''
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_INSERT, 0, 0 )
.head 6 -  Set sInsert = 'INSERT INTO artikel (
		' || sFields || '
	) VALUES (
		' || sResult || ')'
.head 6 -  Call Sql_Exec( hSql, sInsert )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  !
.head 6 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( dfAR_NR ), '', 2 )
.head 6 -  !
.head 6 -  ! ga 20091005: Tabelle aktualisieren
.head 6 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 6 -  !
.head 6 -  ! ga 20100708: könnte sich geändert haben
.head 6 -  Call EnableDisable(  )
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Sie müssen den Artikel zuerst speichern!', 'Achtung', MB_IconStop | MB_Ok )
.head 3 +  ! Function: CopyArtikel
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sInsert
.head 5 -  String: sAbgeleitetVon
.head 5 -  String: sAbgeleitetNach
.head 5 -  Number: nAbgeleitetNach
.head 5 -  Number: nAbgelietetVon
.head 4 +  Actions 
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 -  Set sGlobalTemp = dfAR_INTERN || ' (copy)'
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_intern = :sGlobalTemp')
.head 7 -  Call MessageBox( 'Name schon vorhanden!
Bitte ändern Sie den internen Namen.', 'Artikel kopieren...' ,MB_Ok )
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Set sAbgeleitetVon = SalNumberToStrX( dfAR_NR, 0 )
.head 6 -  Call Sql_GetKeyCounter( 'AR_NR', dfAR_NR, hSql )
.head 6 -  Set dfAR_INTERN = dfAR_INTERN || ' (copy)'
.head 6 -  Set sFields = ''
.head 6 -  Set sResult = ''
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_INSERT, 0, 0 )
.head 6 -  Set sInsert = 'INSERT INTO artikel (
		' || sFields || '
	) VALUES (
		' || sResult || ')'
.head 6 -  Call Sql_Exec( hSql, sInsert )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  !
.head 6 -  Call Suchen( 'artikel', 'ar_nr = ' || NumberToStrX( dfAR_NR ), '', 2 )
.head 6 -  !
.head 6 -  ! ga 20091005: Tabelle aktualisieren
.head 6 -  Call ParamSetInt( ARTIKEL.SpeichernDone, dfAR_NR )
.head 6 -  !
.head 6 -  ! ga 20100708: könnte sich geändert haben
.head 6 -  Call EnableDisable(  )
.head 6 -  !
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Sie müssen den Artikel zuerst speichern!', 'Achtung', MB_IconStop | MB_Ok )
.head 3 +  Function: RefreshDependent
.head 4 -  Description: alle abhängigen Fenster für die aktuelle RE_NR aktualisieren
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SalIsNull( dfAR_NR )
.head 6 +  If ParamGetInt( PARAM.ChangedArtikelNr ) = dfAR_NR
.head 7 -  Call ParamSetInt( PARAM.ChangedArtikelNr, dfAR_NR )
.head 6 +  If ParamGetInt( PARAM.ChangedArtikelNrLeseModus ) = dfAR_NR
.head 7 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, dfAR_NR )
.head 3 +  Function: FieldDisabled
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return NOT Benutzer.HatRecht( REC_ARTIKELQUELLE_EXTERN ) AND ( Benutzer.HatRecht( REC_ARTIKELME_DISABLE ) OR dfAR_IMPORTIERT )
.head 3 -  ! th 20151216: GetLieferartikel usw. in dlgArtikelDatenübertrag ausgelagert
.head 3 +  ! Function: GetLieferartikelDaten ! th20151120: GetLieferartikelBLS Parameter; Return bOk
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Number: nCount
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT al_la_nr, al_std, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1
	        INTO :nAL_LA_NR, :bAL_STD, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1
	      FROM ARTIKELLIEFERART join KUECHE on ku_nr = al_ku_nr 
				JOIN lieferartikel ON la_nr = al_la_nr
	    where al_ar_nr = ' || NumberToStrX( p_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 -  Set nCount= 0
.head 5 -  Set bTaxDeleted = FALSE
.head 5 +  While SqlFetchNext( oSql.Sql(  ), nFetch )
.head 6 +  If nCount= 0
.head 7 -  Set sStmt = 'UPDATE artikel SET ar_zutaten = \'' || lsLA_ZUTATEN || '\', ar_herkunft = \'' || sLA_HERKUNFT || '\'
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 7 -  ! wieder zurücksetzen weil nachher benutzt und konkateniert
.head 7 -  Set sStmt = ''
.head 6 +  If bAL_BLS
.head 7 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 8 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt )
.head 7 +  Else If bLA_CHECKBLS
.head 8 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 7 +  Else If bLA_CHECKBLS1
.head 8 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 7 +  If sStmt != ''
.head 8 -  Set sStmt = 'UPDATE artikel SET ' ||  sStmt || '
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 6 +  If bAL_TAX
.head 7 -  ! nur einmal löschen
.head 7 +  If bTaxDeleted = FALSE
.head 8 -  Set sStmt = 'delete FROM ARTIKELTAXIERUNG
where AT_ART = 2 AND AT_AR_NR = ' || NumberToStrX( p_nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_Exec( hSql, sStmt )
.head 8 -  Set bTaxDeleted = TRUE
.head 7 -  Set bOk = bOk AND GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelTAX
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 4 +  Actions 
.head 5 -  Set dtGlobalTemp = DateOnly( SalDateCurrent(  ) )
.head 5 -  Set sStmt = 'insert into ARTIKELTAXIERUNG(AT_AR_NR,AT_ART,AT_TU_NR)
		select DISTINCT ' || NumberToStrX( p_nAR_NR ) || ' ,LT_ART,LT_TU_NR
		FROM LIEFERARTIKELTAXIERUNG WHERE LT_LA_NR =  ' || NumberToStrX( p_nLA_NR ) || '
		AND NOT EXISTS (SELECT 1 FROM ARTIKELTAXIERUNG WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' AND AT_ART = 2 AND  at_tu_nr = LT_TU_NR)'
.head 5 -  Return Sql_Exec( hSql, sStmt )
.head 3 -  ! th 20151120
.head 3 +  ! Function: GetLieferartikelBLS
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: r_sStatement
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6
INTO
:sDummy,
:sBLSDATArrayLoad[0],
:sBLSDATArrayLoad[1],
:sBLSDATArrayLoad[2],
:sBLSDATArrayLoad[3],
:sBLSDATArrayLoad[4],
:sBLSDATArrayLoad[5],
:sBLSDATArrayLoad[6],
:sBLSDATArrayLoad[7],
:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],
:sBLSDATArrayLoad[10],
:sBLSDATArrayLoad[11],
:sBLSDATArrayLoad[12],
:sBLSDATArrayLoad[13],
:sBLSDATArrayLoad[14],
:sBLSDATArrayLoad[15],
:sBLSDATArrayLoad[16],
:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],
:sBLSDATArrayLoad[19],
:sBLSDATArrayLoad[20],
:sBLSDATArrayLoad[21],
:sBLSDATArrayLoad[22],
:sBLSDATArrayLoad[23],
:sBLSDATArrayLoad[24],
:sBLSDATArrayLoad[25],
:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],
:sBLSDATArrayLoad[28],
:sBLSDATArrayLoad[29],
:sBLSDATArrayLoad[30],
:sBLSDATArrayLoad[31],
:sBLSDATArrayLoad[32],
:sBLSDATArrayLoad[33],
:sBLSDATArrayLoad[34],
:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],
:sBLSDATArrayLoad[37],
:sBLSDATArrayLoad[38],
:sBLSDATArrayLoad[39],
:sBLSDATArrayLoad[40],
:sBLSDATArrayLoad[41],
:sBLSDATArrayLoad[42],
:sBLSDATArrayLoad[43],
:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],
:sBLSDATArrayLoad[46],
:sBLSDATArrayLoad[47],
:sBLSDATArrayLoad[48],
:sBLSDATArrayLoad[49],
:sBLSDATArrayLoad[50],
:sBLSDATArrayLoad[51],
:sBLSDATArrayLoad[52],
:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],
:sBLSDATArrayLoad[55],
:sBLSDATArrayLoad[56],
:sBLSDATArrayLoad[57],
:sBLSDATArrayLoad[58],
:sBLSDATArrayLoad[59],
:sBLSDATArrayLoad[60],
:sBLSDATArrayLoad[61],
:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],
:sBLSDATArrayLoad[64],
:sBLSDATArrayLoad[65],
:sBLSDATArrayLoad[66],
:sBLSDATArrayLoad[67],
:sBLSDATArrayLoad[68],
:sBLSDATArrayLoad[69],
:sBLSDATArrayLoad[70],
:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],
:sBLSDATArrayLoad[73],
:sBLSDATArrayLoad[74],
:sBLSDATArrayLoad[75],
:sBLSDATArrayLoad[76],
:sBLSDATArrayLoad[77],
:sBLSDATArrayLoad[78],
:sBLSDATArrayLoad[79],
:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],
:sBLSDATArrayLoad[82],
:sBLSDATArrayLoad[83],
:sBLSDATArrayLoad[84],
:sBLSDATArrayLoad[85],
:sBLSDATArrayLoad[86],
:sBLSDATArrayLoad[87],
:sBLSDATArrayLoad[88],
:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],
:sBLSDATArrayLoad[91],
:sBLSDATArrayLoad[92],
:sBLSDATArrayLoad[93],
:sBLSDATArrayLoad[94],
:sBLSDATArrayLoad[95],
:sBLSDATArrayLoad[96],
:sBLSDATArrayLoad[97],
:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],
:sBLSDATArrayLoad[100],
:sBLSDATArrayLoad[101],
:sBLSDATArrayLoad[102],
:sBLSDATArrayLoad[103],
:sBLSDATArrayLoad[104],
:sBLSDATArrayLoad[105],
:sBLSDATArrayLoad[106],
:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],
:sBLSDATArrayLoad[109],
:sBLSDATArrayLoad[110],
:sBLSDATArrayLoad[111],
:sBLSDATArrayLoad[112],
:sBLSDATArrayLoad[113],
:sBLSDATArrayLoad[114],
:sBLSDATArrayLoad[115],
:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],
:sBLSDATArrayLoad[118],
:sBLSDATArrayLoad[119],
:sBLSDATArrayLoad[120],
:sBLSDATArrayLoad[121],
:sBLSDATArrayLoad[122],
:sBLSDATArrayLoad[123],
:sBLSDATArrayLoad[124],
:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],
:sBLSDATArrayLoad[127],
:sBLSDATArrayLoad[128],
:sBLSDATArrayLoad[129],
:sBLSDATArrayLoad[130],
:sBLSDATArrayLoad[131],
:sBLSDATArrayLoad[132],
:sBLSDATArrayLoad[133],
:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],
:sBLSDATArrayLoad[136],
:sBLSDATArrayLoad[137],
:sBLSDATArrayLoad[138],
:sBLSDATArrayLoad[139],
:sBLSDATArrayLoad[140],
:sBLSDATArrayLoad[141],
:sBLSDATArrayLoad[142],
:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],
:sBLSDATArrayLoad[145],
:sBLSDATArrayLoad[146],
:sBLSDATArrayLoad[147],
:sBLSDATArrayLoad[148]



































































































































































































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\' OR SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY SBLS' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set nArrayIndex = 0
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set frmREZ_Artikel.saAR_SBLS_InsertDaten[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( p_nLA_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT (
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6 )
VALUES (
:sGlobalTemp,
:frmREZ_Artikel.saAR_SBLS_InsertDaten[0],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[1],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[2],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[3],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[4],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[5],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[6],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[7],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[8],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[9],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[10],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[11],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[12],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[13],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[14],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[15],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[16],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[17],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[18],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[19],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[20],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[21],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[22],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[23],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[24],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[25],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[26],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[27],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[28],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[29],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[30],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[31],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[32],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[33],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[34],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[35],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[36],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[37],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[38],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[39],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[40],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[41],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[42],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[43],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[44],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[45],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[46],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[47],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[48],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[49],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[50],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[51],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[52],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[53],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[54],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[55],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[56],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[57],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[58],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[59],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[60],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[61],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[62],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[63],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[64],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[65],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[66],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[67],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[68],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[69],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[70],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[71],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[72],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[73],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[74],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[75],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[76],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[77],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[78],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[79],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[80],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[81],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[82],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[83],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[84],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[85],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[86],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[87],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[88],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[89],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[90],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[91],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[92],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[93],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[94],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[95],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[96],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[97],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[98],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[99],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[100],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[101],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[102],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[103],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[104],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[105],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[106],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[107],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[108],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[109],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[110],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[111],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[112],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[113],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[114],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[115],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[116],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[117],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[118],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[119],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[120],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[121],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[122],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[123],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[124],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[125],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[126],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[127],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[128],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[129],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[130],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[131],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[132],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[133],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[134],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[135],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[136],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[137],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[138],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[139],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[140],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[141],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[142],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[143],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[144],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[145],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[146],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[147],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[148] )'
.head 5 +  If NOT Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 6 -  Set r_sStatement = STRING_Null
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 6 -  Set r_sStatement = 'ar_sbls1 = \'ZB'|| NumberToStrX( p_nLA_NR ) ||'\''
.head 5 -  Return bOk
.head 3 +  ! Function: UpdateLieferTax
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  String: sSelect
.head 4 +  Actions 
.head 5 -  Set sSelect = 'select * from ARTIKELLIEFERART
JOIN LIEFERARTIKELTAXIERUNG ON LT_LA_NR = AL_LA_NR AND LT_ART = 2
WHERE AL_STD = 1 AND AL_AR_NR = '  || NumberToStrX( p_nAR_NR )
.head 5 +  If Sql_FetchOne( hSql, sSelect )
.head 6 -  Set bOk = TRUE
.head 6 -  Set sSelect = 'delete FROM ARTIKELTAXIERUNG
where AT_ART = 2 AND AT_AR_NR = ' || NumberToStrX( p_nAR_NR )
.head 6 -  Set bOk = bOk AND Sql_Exec( hSql, sSelect )
.head 6 -  ! !
.head 6 -  ! wegen distinct
.head 6 -  Set dtGlobalTemp = DateOnly( SalDateCurrent(  ) )
.head 6 -  Set sSelect = 'insert into ARTIKELTAXIERUNG(AT_AR_NR,AT_ART,AT_TU_NR,AT_SB_NR,AT_UPDATE)
select DISTINCT AL_AR_NR,LT_ART,LT_TU_NR, :nUserNr, :dtGlobalTemp from ARTIKELLIEFERART
JOIN LIEFERARTIKELTAXIERUNG ON LT_LA_NR = AL_LA_NR AND LT_ART = 2
WHERE AL_STD = 1 AND AL_AR_NR = '  || NumberToStrX( p_nAR_NR )
.head 6 -  Set bOk = bOk AND Sql_Exec( hSqlSub, sSelect )
.head 6 -  ! !
.head 6 -  Set bOk = bOk AND Sql_Commit( hSqlSub )
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Es sind keine Taxierungen vorhanden. Prüfen sie, ob
- ein als Standard markierter Lieferartikel mit dem Artikel verknüpft ist und
- der Lieferartikel Taxierungen hat', 'Taxierungen', MB_Ok )
.head 5 -  Return bOk
.head 3 -  ! th 20151117 
.head 3 +  ! Function: CheckSBLS1AutomatischUpdaten
.head 4 -  Description: Datet DB-Eintrag bei Klick auf CheckBox automatisch ab
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bIstGechecktJetzt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bIstGechecktVorher
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sWndFormName
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set bIstGechecktJetzt = SalIsButtonChecked( hWndItem ) 
.head 5 +  If Sql_FetchOne( hSql, 'SELECT ar_checksbls1 INTO :nGlobalTemp FROM artikel WHERE ar_nr = :frmREZ_Artikel.dfAR_NR' )
.head 6 -  Set bIstGechecktVorher = nGlobalTemp
.head 6 +  If bIstGechecktVorher != bIstGechecktJetzt
.head 7 -  Set nGlobalTemp = bIstGechecktJetzt
.head 7 -  Call Sql_ExecEx( hSql, 'UPDATE artikel SET ar_checksbls1 = :nGlobalTemp WHERE ar_nr = :dfAR_NR' , TRUE)
.head 5 -  Call Sql_Commit( hSql )
.head 5 -  ! damit Dialog "...Änderungen speichern?" nicht kommt
.head 5 -  Set frmREZ_Artikel.bAnyEdit = FALSE
.head 5 -  ! th 20151123: "Arbeitsbereich" aktualisieren wegen "Nährwete..."
.head 5 -  Call RefreshDependent ()
.head 2 +  Window Parameters
.head 3 -  Number: wp_nPARAM
.data INHERITPROPS
0000: 0100
.enddata
.head 3 +  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! Ribbon Container
.head 2 +  Window Variables
.head 3 -  String: sSBLS
.head 3 -  !
.head 3 -  Window Handle: hWndaDisabled[*]
.head 3 -  ! th 20151120
.head 3 -  ! String: saAR_SBLS_InsertDaten[149]
.head 3 -  FunctionalVar: oReInhNeu
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class: fcReInhaltNeu
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetTableName( 'artikel' )
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 3 +  On AM_SAVE	! th 20180517 Verbrauchs-Menge muss > 0 sein
.head 4 +  If Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If ( SalIsNull( dfAR_MENGE ) OR SalIsNull( dfAR_AM_NR )  
OR SalIsNull( dfAR_AT_NR) OR SalIsNull( dfAR_AG_NR)  OR SalIsNull( dfAR_INTERN) )
.head 6 -  Call MessageBox( 'Bitte alle roten Felder ausfüllen!', 'Speichern', MB_IconExclamation | MB_Ok )
.head 5 +  Else If (dfAR_MENGE <= 0)
.head 6 -  Call MessageBox('Bitte tragen sie eine' ||VisStrChoose(dfAR_MENGE < 0, ' positive', '')||' Verbrauchsmenge ein.', 'Speichern', MB_IconExclamation | MB_Ok)
.head 6 -  Call SalSetFocus(dfAR_MENGE)
.head 5 +  Else
.head 6 +  If SalIsNull( dfAR_LE_AM_NR ) OR SalIsNull( dfAR_LAGEREINHEIT )
.head 7 -  Set dfAR_LE_AM_NR = dfAR_AM_NR
.head 7 -  Set dfAR_LAGEREINHEIT = dfAR_MENGE
.head 6 -  Call SalSendClassMessage( AM_SAVE, 0, 0 )
.head 3 +  ! On AM_SAVE	! wl 20140121 mit LagerMenge
.head 4 +  If Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If ( SalIsNull( dfAR_MENGE ) OR SalIsNull( dfAR_AM_NR )  
OR SalIsNull( dfAR_AT_NR) OR SalIsNull( dfAR_AG_NR)  OR SalIsNull( dfAR_INTERN) )
.head 6 -  Call MessageBox( 'Bitte alle roten Felder ausfüllen!', 'Speichern', MB_IconExclamation | MB_Ok )
.head 5 +  Else 
.head 6 +  If SalIsNull( dfAR_LE_AM_NR ) OR SalIsNull( dfAR_LAGEREINHEIT )
.head 7 -  Set dfAR_LE_AM_NR = dfAR_AM_NR
.head 7 -  Set dfAR_LAGEREINHEIT = dfAR_MENGE
.head 6 -  Call SalSendClassMessage( AM_SAVE, 0, 0 )
.head 3 +  ! On AM_SAVE
.head 4 +  If Benutzer.HatRecht( REC_ARTIKEL )
.head 5 +  If ( SalIsNull( dfAR_MENGE ) OR SalIsNull( dfAR_AM_NR )  
OR SalIsNull( dfAR_AT_NR) OR SalIsNull( dfAR_AG_NR)  OR SalIsNull( dfAR_INTERN) )
.head 6 -  Call MessageBox( 'Bitte alle roten Felder ausfüllen!', 'Speichern', MB_IconExclamation | MB_Ok )
.head 5 +  Else 
.head 6 -  Call SalSendClassMessage( AM_SAVE, 0, 0 )
.head 3 +  ! On SAM_Destroy
.head 4 -  Set hWndArtikel = hWndNULL
.head 3 +  On AM_DELETE
.head 4 +  If SalModalDialog( dlgART_Loeschen, hWndForm, dfAR_NR )
.head 5 -  Call SalSendClassMessage( AM_DELETE, 0, 0 )
.head 3 +  On AM_ANY_EDIT
.head 4 +  If Benutzer.HatRecht( REC_ARTIKEL )
.head 5 -  Call SalSendClassMessage( AM_ANY_EDIT, 0, 0 )
.head 3 +  On AM_CAN_UPDATE
.head 4 -  Return Benutzer.HatRecht( REC_ARTIKEL )
.head 1 +  Dialog Box: dlgART_Taxierung
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Taxierung auf Artikel-Ebene
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 9.175"
.head 4 -  Top: 2.063"
.head 4 -  Width:  8.933"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.083"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalEndDialog( hWndForm, bSaved )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Standard
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 -  Group Box: Artikel
.head 4 -  Resource Id: 4495
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.088"
.head 5 -  Top: 0.073"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.542"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfArtikel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldLabel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.238"
.head 6 -  Top: 0.281"
.head 6 -  Width:  8.35"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Set dfRezept=frmSD_Rezept.dfRE_SPKARTBEZ
.head 3 -  ! Group Box: Taxierungsgruppe
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.338"
.head 5 -  Top: 0.073"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.542"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.end
.head 3 +  ! Combo Box: cmTH
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 3.438"
.head 5 -  Top: 0.281"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.427"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create ! ga 20100419: automatisches Disconnect
.head 6 -  Call ListPopulate( hWndItem, hSql, 'SELECT th_bezeichnung FROM taxierungshauptgr' )
.head 6 -  Call SalListAdd( hWndItem, '(Alle)' )
.head 6 -  Call SalListSetSelect( hWndItem, 0 )
.head 5 +  ! On SAM_Create ! ga 20100208: doch wieder mit "alle", wie bei den Anderen
.head 6 -  Call SalListPopulate( hWndItem, hSql, 'Select TH_BEZEICHNUNG
from TAXIERUNGSHAUPTGR' )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  Call SalListAdd( hWndItem, '(Alle)' )
.head 6 -  Call SalListSetSelect( hWndItem,0 )
.head 5 +  ! On SAM_Create	! wl 200911110 ohne alle
.head 6 -  Call SalListPopulate( hWndItem, hSql, 'Select TH_BEZEICHNUNG
from TAXIERUNGSHAUPTGR' )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalListAdd( hWndItem, '(Alle)' )
.head 6 -  Call SalListSetSelect( hWndItem,0 )
.head 5 +  ! On SAM_Create
.head 6 -  Call SalListPopulate( hWndItem, hSql, 'Select TH_BEZEICHNUNG
from TAXIERUNGSHAUPTGR' )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  Call SalListAdd( hWndItem, '(Alle)' )
.head 6 -  ! Set cmTH='(Alle)'
.head 6 -  Call SalListSetSelect( hWndItem,1 )
.head 6 -  ! Call SalSendMsg( cmKüchen, SAM_Click,0,0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( lbMöglTax, AM_POPULATE, 0, 0 )
.head 3 -  Background Text: hat ..... (+), reich an
.head 4 -  Resource Id: 4497
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.25"
.head 5 -  Top: 1.167"
.head 5 -  Width:  2.45"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  List Box: lbTaxReich
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: Selections3
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.183"
.head 5 -  Top: 1.406"
.head 5 -  Width:  3.967"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.281"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SetTableName( 'artikeltaxierung' )
.head 6 -  Call SetWhereForUpdate( 'at_ar_nr = :dlgART_Taxierung.wp_nAR_NR and at_art = 1' )
.head 6 -  Call SetForeignKey( 'at_ar_nr', ':dlgART_Taxierung.wp_nAR_NR' )
.head 6 -  Call SetSelectForeignKey2( 'tu_nr', 'taxierungsuntergr', 'tu_bezeichnung' )
.head 6 -  Call SetForeignKey2( 'at_tu_nr' )
.head 6 -  Call SetInsertValue( '1' )
.head 5 +  On AM_POPULATE ! th 20171121 Order By tu_sort...
.head 6 -  Call PopulateArmReichColorEx( wp_nAR_NR, 1, cbAR_KEINLATAX, 1, 'tu_sort, tu_bezeichnung')
.head 5 +  ! On AM_POPULATE ! th 20160630 Klassenfunktion für Farben
.head 6 -  Call PopulateArmReichColor( wp_nAR_NR, 1, cbAR_KEINLATAX, 1)
.head 5 +  ! On AM_POPULATE ! ga 20100419: automatisches Disconnect
.head 6 -  Call ListPopulate( hWndItem, hSql, 'SELECT tu_bezeichnung FROM artikeltaxierung, taxierungsuntergr
	WHERE
		at_tu_nr = tu_nr AND
		at_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || ' AND
		at_art = 1' )
.head 5 +  ! On AM_POPULATE
.head 6 -  Call SalListPopulate( hWndItem, hSql, 'select TU_BEZEICHNUNG
from REZTAXIERUNG,TAXIERUNGSUNTERGR
where RT_TU_NR=TU_NR and RT_RE_NR=:dlgREZ_Taxierung.wp_nRE_NR and RT_ART = 1' )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalSendMsg( lbMöglTax, AM_POPULATE,0,0 )
.head 5 +  On AM_UPDATE
.head 6 -  Call lbTaxReich.GoToPossibleSelections( lbMöglTax )
.head 6 -  Call SalSendMsg( lbMöglTax, AM_POPULATE,0,0 )
.head 5 -  !
.head 5 +  On AM_INSERT ! th 20160729 at_art abhängig von ar_keinelatax
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If Sql_Exec( hSql, 'DELETE FROM ' || sTableName || '
	WHERE
		' || sForeignKey || ' = ' ||sForeignKeyField || ' AND
		at_art IN ( ' || VisStrChoose( cbAR_KEINLATAX,  '1, 2', ' 1') || ' ) ')
.head 7 -  Set nRows = SalListQueryCount( hWndItem )
.head 7 -  Set nCount = 0
.head 7 +  While nCount < nRows
.head 8 -  Set strListText = SalListQueryTextX(hWndItem, nCount )
.head 8 -  ! Call Sql_FetchOne( hSql, sSelectForeignKey2 || ' :strListText INTO :nKey' )
.head 8 -  Call Sql_FetchOne( hSql, 'SELECT tu_nr, tu_zusatz INTO :nKey, :nGlobalTemp FROM taxierungsuntergr WHERE tu_bezeichnung = :strListText')
.head 8 -  Call SetInsertValue( NumberToStrX( nGlobalTemp ) )
.head 8 -  Call Sql_Exec( hSql, 'INSERT INTO ' || sTableName ||
' (' || sForeignKey || ', ' || sForeignKey2 ||', at_art)
 VALUES (' || sForeignKeyField || ', :nKey,' || sInsertValue || ' ) ' )
.head 8 -  Set nCount = nCount + 1
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalEndDialog( hWndForm, TRUE )
.head 5 +  ! On AM_INSERT ! th 20160704 ar_art differenziert behandeln: "InsertValue" kann 1 oder 2 sein
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If Sql_Exec(hSql, 'DELETE FROM ' || sTableName || '
	WHERE
		' || sForeignKey || ' = ' ||sForeignKeyField || ' AND
		at_art IN ( 1, 2)' )
.head 7 -  Set nRows = SalListQueryCount( hWndItem )
.head 7 -  Set nCount = 0
.head 7 +  While nCount < nRows
.head 8 -  Set strListText = SalListQueryTextX(hWndItem, nCount )
.head 8 -  ! Call Sql_FetchOne( hSql, sSelectForeignKey2 || ' :strListText INTO :nKey' )
.head 8 -  Call Sql_FetchOne( hSql, 'SELECT tu_nr, tu_zusatz INTO :nKey, :nGlobalTemp FROM taxierungsuntergr WHERE tu_bezeichnung = :strListText')
.head 8 -  Call SetInsertValue( NumberToStrX( nGlobalTemp ) )
.head 8 -  Call Sql_Exec( hSql, 'INSERT INTO ' || sTableName ||
' (' || sForeignKey || ', ' || sForeignKey2 ||', at_art)
 VALUES (' || sForeignKeyField || ', :nKey,' || sInsertValue || ' ) ' )
.head 8 -  Set nCount = nCount + 1
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalEndDialog( hWndForm, TRUE )
.head 5 +  ! On AM_INSERT ! ga 20110523: von Class überschrieben wg. Spaltennamen
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If Sql_Exec(hSql, 'DELETE FROM ' || sTableName || '
	WHERE
		' || sForeignKey || ' = ' ||sForeignKeyField || ' AND
		at_art = 1' )
.head 7 -  Set nRows = SalListQueryCount( hWndItem )
.head 7 -  Set nCount = 0
.head 7 +  While nCount < nRows
.head 8 -  Set strListText = SalListQueryTextX(hWndItem, nCount )
.head 8 -  Call Sql_FetchOne( hSql, sSelectForeignKey2 || ' :strListText INTO :nKey' )
.head 8 -  Call Sql_Exec( hSql, 'INSERT INTO ' || sTableName ||
' (' || sForeignKey || ', ' || sForeignKey2 ||', at_art)
 VALUES (' || sForeignKeyField || ', :nKey,' || sInsertValue || ' ) ' )
.head 8 -  Set nCount = nCount + 1
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: TaxReichNach
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarPrev
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.233"
.head 5 -  Top: 2.073"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( lbMöglTax, AM_UPDATE, 1, 0 )
.head 6 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0 )
.head 3 +  Pushbutton: pbTaxReichVon
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarNext
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.233"
.head 5 -  Top: 2.615"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( lbTaxReich, AM_UPDATE, 1, 0 )
.head 6 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0 )
.head 3 -  Background Text: Taxierungen (Diätmerkmale)
.head 4 -  Resource Id: 4498
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 4.783"
.head 5 -  Top: 1.177"
.head 5 -  Width:  2.85"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  List Box: lbMöglTax
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: PossibleSelections3
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.733"
.head 5 -  Top: 1.448"
.head 5 -  Width:  3.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.281"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Horizontal Scroll? Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On AM_UPDATE
.head 6 +  If wParam = 1
.head 7 -  Call GoToSelections(lbTaxReich)
.head 6 +  ! Else
.head 7 -  Call GoToSelections(lbTaxArm)
.head 5 +  On AM_POPULATE ! th 20171121 order by tu_sort
.head 6 -  Call setnALL( 0 )
.head 6 -  ! Call setsWhereCmb( '1' )
.head 6 -  Call PopulatesMöglTaxColorExEx( 'tu_bezeichnung, tu_zusatz', '', 'taxierungsuntergr, taxierungshauptgr', 'th_nr = tu_th_nr AND tu_aktiv = 1 ' , hWndNULL, lbTaxReich, cbAR_KEINLATAX, 1, TRUE, 'tu_sort, tu_bezeichnung' )
.head 5 +  ! On AM_POPULATE ! th 20160630 Klassenfunktion für Farben
.head 6 -  Call setnALL( 0 )
.head 6 -  ! Call setsWhereCmb( '1' )
.head 6 -  Call PopulatesMöglTaxColor( 'tu_bezeichnung, tu_zusatz', '', 'taxierungsuntergr, taxierungshauptgr', 'th_nr = tu_th_nr AND tu_aktiv = 1 ' , hWndNULL, lbTaxReich, cbAR_KEINLATAX, 1 )
.head 5 +  ! On AM_POPULATE ! ga 20120510: Mandant
.head 6 -  Call setnALL( 0 )
.head 6 -  Call setsWhereCmb( '1' )
.head 6 -  Call Populates( 'tu_bezeichnung', '', 'taxierungsuntergr, taxierungshauptgr', 'th_nr = tu_th_nr AND ' || GetWhereTaxierung( 1 ) || ' AND tu_zusatz', hWndNULL, lbTaxReich )
.head 5 +  ! On AM_POPULATE	! wl 20091110 mit aktiv
.head 6 -  Call setnALL( 0 )
.head 6 -  Call setsWhereCmb( '1' )
.head 6 -  Call Populates( 'tu_bezeichnung', '', 'taxierungsuntergr, taxierungshauptgr', 'th_nr = tu_th_nr AND tu_aktiv = 1 AND tu_zusatz', hWndNULL, lbTaxReich )
.head 5 +  ! On AM_POPULATE
.head 6 +  If cmTH='(Alle)'
.head 7 -  Call lbMöglTax.setsWhereCmb(cmTH)
.head 7 -  Call lbMöglTax.setnALL( 1 )
.head 6 +  Else
.head 7 -  Call lbMöglTax.setsWhereCmb(cmTH)
.head 7 -  Call lbMöglTax.setnALL( 0 )
.head 6 -  Call lbMöglTax.Populates( 'TU_BEZEICHNUNG','TAXIERUNGSUNTERGR',
'TAXIERUNGSUNTERGR,TAXIERUNGSHAUPTGR','TH_NR=TU_TH_NR and TH_BEZEICHNUNG',
 lbTaxArm,lbTaxReich)
.head 3 +  ! ToolbarNext: pbTaxArmNach
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarNext
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.883"
.head 5 -  Top: 1.74"
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: next.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( lbMöglTax, AM_UPDATE, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0 )
.head 3 +  ! ToolbarPrev: pbTaxArmVon
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarPrev
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 6.883"
.head 5 -  Top: 2.281"
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: prev.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( lbTaxArm, AM_UPDATE, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, AM_SAVE, 0, 0 )
.head 3 -  ! BackGroundText: arm an (-), nicht geeignet für
.winattr class Background Text:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 7.483"
.head 5 -  Top: 0.823"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! Selections3: lbTaxArm
.winattr class List Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: Selections3
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 7.383"
.head 5 -  Top: 1.115"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 3.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SetTableName( 'artikeltaxierung' )
.head 6 -  Call SetWhereForUpdate( 'at_ar_nr = :dlgART_Taxierung.wp_nAR_NR AND at_art = 0' )
.head 6 -  Call SetForeignKey( 'at_ar_nr', ':dlgART_Taxierung.wp_nAR_NR' )
.head 6 -  Call SetSelectForeignKey2( 'tu_nr', 'taxierungsuntergr', 'tu_bezeichnung' )
.head 6 -  Call SetForeignKey2( 'at_tu_nr' )
.head 6 -  Call SetInsertValue( '0' )
.head 5 +  On AM_POPULATE ! ga 20100419: automatisches Disconnect
.head 6 -  Call ListPopulate( hWndItem, hSql, 'SELECT tu_bezeichnung FROM artikeltaxierung, taxierungsuntergr
	WHERE
		at_tu_nr = tu_nr AND
		at_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || ' AND
		at_art = 0' )
.head 5 +  ! On AM_POPULATE
.head 6 -  Call SalListPopulate( hWndItem, hSql, 'select TU_BEZEICHNUNG
from REZTAXIERUNG,TAXIERUNGSUNTERGR
where RT_TU_NR=TU_NR and RT_RE_NR=:dlgREZ_Taxierung.wp_nRE_NR and RT_ART = 0' )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalSendMsg( lbMöglTax, AM_POPULATE,0,0 )
.head 5 +  On AM_UPDATE
.head 6 -  Call lbTaxArm.GoToPossibleSelections( lbMöglTax )
.head 6 -  Call SalSendMsg( lbMöglTax, AM_POPULATE,0,0 )
.head 5 -  !
.head 5 +  On AM_INSERT ! ga 20110523: von Class überschrieben wg. Spaltennamen
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 +  If Sql_Exec(hSql, 'DELETE FROM ' || sTableName || '
	WHERE
		' || sForeignKey || ' = ' ||sForeignKeyField || ' AND
		at_art = 0' )
.head 7 -  Set nRows = SalListQueryCount( hWndItem )
.head 7 -  Set nCount = 0
.head 7 +  While nCount < nRows
.head 8 -  Set strListText = SalListQueryTextX(hWndItem, nCount )
.head 8 -  Call Sql_FetchOne( hSql, sSelectForeignKey2 || ' :strListText INTO :nKey' )
.head 8 -  Call Sql_Exec( hSql, 'INSERT INTO ' || sTableName ||
' (' || sForeignKey || ', ' || sForeignKey2 ||', at_art)
 VALUES (' || sForeignKeyField || ', :nKey,' || sInsertValue || ' ) ' )
.head 8 -  Set nCount = nCount + 1
.head 6 -  Call SalWaitCursor( FALSE )
.head 6 -  Call Sql_Commit( hSql )
.head 6 -  ! Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Check Box: cbAR_KEINLATAX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Taxierungen von zugeordneten Lieferartikeln NICHT übernehmen
.head 4 -  Window Location and Size
.head 5 -  Left: 0.283"
.head 5 -  Top: 0.781"
.head 5 -  Width:  8.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click ! th 20161107 AR_ZUORDNUNGNEU ggf setzen
.head 6 +  If dfAL_AR_NR != NUMBER_Null AND NOT cbAR_ZUORDNUNGNEU
.head 7 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel
SET ar_keinlatax = :dlgART_Taxierung.cbAR_KEINLATAX,
ar_sb_nr = :nUserNr, ar_update = SYSDATETIME,
ar_zuordnungneu = 1
WHERE ar_nr = :dlgART_Taxierung.wp_nAR_NR' )
.head 6 +  Else
.head 7 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel
SET ar_keinlatax = :dlgART_Taxierung.cbAR_KEINLATAX,
ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
WHERE ar_nr = :dlgART_Taxierung.wp_nAR_NR' )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_POPULATE, wParam, lParam)
.head 5 +  ! On SAM_Click
.head 6 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel
SET ar_keinlatax = :dlgART_Taxierung.cbAR_KEINLATAX,
ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
WHERE ar_nr = :dlgART_Taxierung.wp_nAR_NR' )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_POPULATE, wParam, lParam)
.head 3 -  !
.head 3 +  Check Box: cbAR_ZUORDNUNGNEU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: Default
.head 5 -  Top: Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAL_AR_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: wp_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 -  Boolean: bSaved
.head 2 +  Message Actions
.head 3 +  On SAM_Create ! th 20161107 al_ar_nr und ar_zuordnungneu ggf. mit fetchen
.head 4 -  Call SalSendClassMessage( SAM_Create,0,0 )
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern, ar_keinlatax, 
	al_ar_nr, ar_zuordnungneu
INTO :dlgART_Taxierung.dfArtikel, :dlgART_Taxierung.cbAR_KEINLATAX, 
        :dlgART_Taxierung.dfAL_AR_NR, :dlgART_Taxierung.cbAR_ZUORDNUNGNEU
FROM artikel
LEFT JOIN artikellieferart ON al_ar_nr = ar_nr
WHERE ar_nr = :dlgART_Taxierung.wp_nAR_NR' )
.head 3 +  ! On SAM_Create ! th 20160701 ar_keinlatax mit fetchen
.head 4 -  Call SalSendClassMessage( SAM_Create,0,0 )
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern, ar_keinlatax
INTO :dlgART_Taxierung.dfArtikel, :dlgART_Taxierung.cbAR_KEINLATAX
FROM artikel
WHERE ar_nr = :dlgART_Taxierung.wp_nAR_NR' )
.head 3 +  ! On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create,0,0 )
.head 4 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern
INTO :dlgART_Taxierung.dfArtikel
FROM artikel
WHERE ar_nr = :dlgART_Taxierung.wp_nAR_NR' )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsgToChildren( hWndForm, AM_POPULATE, 0, 0 )
.head 3 +  On SAM_Close
.head 4 -  Call SalEndDialog( hWndForm, bSaved )
.head 3 +  On AM_SAVE	! wl 20110408 mit Update auf Rezept -> besser nach dem Dialog wie Komp
.head 4 -  Set bSaved = TRUE
.head 4 -  Call SalSendClassMessage( AM_SAVE, wParam, lParam )
.head 4 -  ! Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_sb_nr = :nUserNr, ar_update = SYSDATETIME WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 3 +  ! On AM_SAVE
.head 4 -  Set bSaved = TRUE
.head 4 -  Call SalSendClassMessage( AM_SAVE, wParam, lParam )
.head 1 +  Dialog Box: dlgART_Deklaration
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 30.888"
.head 4 -  Top: 4.073"
.head 4 -  Width:  6.667"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 2.135"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Class Default
.head 3 -  Horizontal Scroll? Class Default
.head 2 -  Description: für Artikel: 1st Param = 1, für Lieferartikel 2
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlDeklaration
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MultilineUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  String Type: Long String
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Border? Class Default
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Window Location and Size
.head 6 -  Left: 0.3"
.head 6 -  Top: 0.15"
.head 6 -  Width:  5.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.469"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Speichern
.head 4 -  Window Location and Size
.head 5 -  Left: 2.1"
.head 5 -  Top: 1.729"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click ! th 20161019 bei Lieferartikel ggf zuordnungneu setzen; la_herkunft/zutatenupdate setzen
.head 6 +  If sTable != '' AND sPrefix != ''
.head 7 -  Set sSaveStmt = 'UPDATE '|| sTable ||' 
	SET  '|| sPrefix ||'_'|| dlgART_Deklaration.sDeklarationCol ||' =  :dlgART_Deklaration.mlDeklaration , 
	'|| sPrefix ||'_update = SYSDATETIME'
.head 7 +  If wp_nPrefMode = 2
.head 8 -  ! la_zutaten/herkunftupdate setzen
.head 8 -  Set sSaveStmt = sSaveStmt || ',' || CR || TAB || sPrefix ||'_'|| dlgART_Deklaration.sDeklarationCol ||'update = SYSDATETIME'
.head 7 -  Set sSaveStmt = sSaveStmt || CR || TAB || 'WHERE '|| sPrefix ||'_nr = ' || NumberToStrX(dlgART_Deklaration.wp_nPref_NR)
.head 7 -  !
.head 7 -  Call Sql_ExecAndCommit( hSql, sSaveStmt )
.head 6 +  If wp_nPrefMode = 2
.head 7 -  Call ArZuordnungNeuSetzen( wp_nPref_NR )
.head 6 -  Call SalEndDialog(hWndForm,TRUE)
.head 5 +  ! On SAM_Click ! th 20160722 long als bind wegen sqlbase
.head 6 +  If sTable != '' AND sPrefix != ''
.head 7 -  Call Sql_ExecAndCommit( hSql, 'UPDATE '|| sTable ||' SET  '|| sPrefix ||'_'|| dlgART_Deklaration.sDeklarationCol ||' =  :dlgART_Deklaration.mlDeklaration , '|| sPrefix ||'_update = SYSDATETIME
	WHERE '|| sPrefix ||'_nr = ' || NumberToStrX(dlgART_Deklaration.wp_nPref_NR) )
.head 6 -  Call SalEndDialog(hWndForm,TRUE)
.head 5 +  ! On SAM_Click
.head 6 -  If sTable != '' AND sPrefix != ''
.head 6 -  Call Sql_ExecAndCommit( hSql, 'UPDATE '|| sTable ||' SET  '|| sPrefix ||'_'|| dlgART_Deklaration.sDeklarationCol ||' =  \'' || dlgART_Deklaration.mlDeklaration || '\'  , '|| sPrefix ||'_update = SYSDATETIME
	WHERE '|| sPrefix ||'_nr = ' || NumberToStrX(dlgART_Deklaration.wp_nPref_NR) )
.head 6 -  Call SalEndDialog(hWndForm,TRUE)
.head 3 +  Pushbutton: pbEsc
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Abbrechen
.head 4 -  Window Location and Size
.head 5 -  Left: 3.4"
.head 5 -  Top: 1.729"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: LoadDeklaration ! th 20180124 SetMaxDataLength(..)
.head 4 -  Description: th 20151021: auch für Lieferartikel
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDeklHerkunft
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Long String: lsDeklZutaten
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sInto
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 -  Set bOk = TRUE
.head 5 +  Select Case wp_nPrefMode
.head 6 +  Case 1
.head 7 -  Set sTable = 'artikel'
.head 7 -  Set sPrefix = 'ar'
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sTable = 'lieferartikel'
.head 7 -  Set sPrefix = 'la' 
.head 7 -  Break
.head 5 +  Select Case wp_nDekMode
.head 6 +  Case 1
.head 7 -  Set sDeklarationCol = 'herkunft'
.head 7 -  Set sTitle = 'Herkunft'
.head 7 -  Set sInto = ':sDeklHerkunft'
.head 7 -  Call SalSetMaxDataLength( mlDeklaration, 250 )
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sDeklarationCol = 'zutaten'
.head 7 -  Set sTitle = 'Zutaten'
.head 7 -  Set sInto = ':lsDeklZutaten'
.head 7 -  Call SalSetMaxDataLength( mlDeklaration, 1000 )
.head 7 -  Break
.head 5 -  Call SalSetWindowText( dlgART_Deklaration , sTitle )
.head 5 -  Set sStmt = 'SELECT
		'|| sPrefix || '_' ||sDeklarationCol || '
	FROM
		'|| sTable ||' 
	WHERE
		'|| sPrefix ||'_nr = ' || NumberToStrX( dlgART_Deklaration.wp_nPref_NR ) ||'
	INTO 	'|| sInto
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  If bOk AND SqlFetchNext(hSql, nInd)
.head 6 +  If sDeklHerkunft != '' AND lsDeklZutaten = ''
.head 7 -  Set dlgART_Deklaration.mlDeklaration = StrAppend( dlgART_Deklaration.mlDeklaration, ',' , sDeklHerkunft)
.head 6 +  Else If sDeklHerkunft = '' AND lsDeklZutaten != ''
.head 7 -  Set dlgART_Deklaration.mlDeklaration = StrAppend( dlgART_Deklaration.mlDeklaration,  ',' , lsDeklZutaten )
.head 3 +  ! Function: LoadDeklaration
.head 4 -  Description: th 20151021: auch für Lieferartikel
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sDeklHerkunft
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Long String: lsDeklZutaten
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sInto
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.head 5 -  Number: nInd
.head 4 +  Actions 
.head 5 -  Set bOk = TRUE
.head 5 +  Select Case wp_nPrefMode
.head 6 +  Case 1
.head 7 -  Set sTable = 'artikel'
.head 7 -  Set sPrefix = 'ar'
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sTable = 'lieferartikel'
.head 7 -  Set sPrefix = 'la' 
.head 7 -  Break 
.head 5 +  Select Case wp_nDekMode
.head 6 +  Case 1
.head 7 -  Set sDeklarationCol = 'herkunft'
.head 7 -  Set sTitle = 'Herkunft'
.head 7 -  Set sInto = ':sDeklHerkunft'
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sDeklarationCol = 'zutaten'
.head 7 -  Set sTitle = 'Zutaten'
.head 7 -  Set sInto = ':lsDeklZutaten'
.head 7 -  Break 
.head 5 -  Call SalSetWindowText( dlgART_Deklaration , sTitle )
.head 5 -  Set sStmt = 'SELECT
		'|| sPrefix || '_' ||sDeklarationCol || '
	FROM
		'|| sTable ||' 
	WHERE
		'|| sPrefix ||'_nr = ' || NumberToStrX( dlgART_Deklaration.wp_nPref_NR ) ||'
	INTO 	'|| sInto
.head 5 -  Set bOk = bOk AND Sql_ExecEx( hSql, sStmt, FALSE )
.head 5 +  If bOk AND SqlFetchNext(hSql, nInd)
.head 6 +  If sDeklHerkunft != '' AND lsDeklZutaten = ''
.head 7 -  Set dlgART_Deklaration.mlDeklaration = StrAppend( dlgART_Deklaration.mlDeklaration, ',' , sDeklHerkunft)
.head 6 +  Else If sDeklHerkunft = '' AND lsDeklZutaten != ''
.head 7 -  Set dlgART_Deklaration.mlDeklaration = StrAppend( dlgART_Deklaration.mlDeklaration,  ',' , lsDeklZutaten )
.head 2 +  Window Parameters
.head 3 -  Number: wp_nPrefMode
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: wp_nPref_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: wp_nDekMode
.head 2 +  Window Variables
.head 3 -  String: sDeklarationCol
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: sTitle
.head 3 -  ! th 20151021: auch für Lieferartikel
.head 3 -  String: sTable
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: sPrefix
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: sSaveStmt
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call LoadDeklaration ()
.head 1 +  ! InsertBox: dlgLieferartikelLieferantenpreis
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferanten
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  11.25"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.656"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Combo Box: cmArtikel
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ComboLookupArtikel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.083"
.head 5 -  Top: 0.073"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call tblLieferantenpreis.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  Child Table: tblLieferantenpreis
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.017"
.head 6 -  Top: 0.323"
.head 6 -  Width:  7.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colAR_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdateKeyX
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Intern
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLI_KURZBEZ
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_QUELLE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_DATUMVON
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: gültig von
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_DATUMBIS
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: gültig bis
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAR_EK
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: EK
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 5 +  Function: UpdateArtikel
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bDelete
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 -  Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_nr = :dlgLieferartikelLieferantenpreis.nAR_NR AND ar_li_nr IS NULL' )
.head 7 -  Set bLieferant = FALSE
.head 7 -  Call SalSetWindowText( hWndForm, 'Lieferanten' )
.head 7 -  Call PopulateAndCount( hSql, 'artikel LEFT JOIN lieferant ON li_nr = ar_li_nr', 'ar_ar_nr = :nAR_NR', 'ar_intern', TBL_FillAll, nGlobalTemp )
.head 6 +  Else 
.head 7 -  Set bLieferant = TRUE
.head 7 -  Call SalSetWindowText( hWndForm, 'Preise' )
.head 7 -  Call PopulateAndCount( hSql, 'artikel LEFT JOIN lieferant ON li_nr = ar_li_nr', 'ar_ar_nr = :nAR_NR', 'ar_intern', TBL_FillAll, nGlobalTemp )
.head 3 +  Pushbutton: pbRowNew
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarNew
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: -0.017"
.head 5 -  Top: -0.01"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: new.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 +  If bLieferant
.head 7 -  Call SalSendClassMessage( SAM_Click, 0, 0)
.head 6 +  Else 
.head 7 -  Call SalSetFocus( cmArtikel )
.head 7 -  Call SalPostMsg( cmArtikel, SAM_DropDown, 0, 0 )
.head 3 +  Pushbutton: pbRowDelete
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.583"
.head 5 -  Top: -0.01"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: delete.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call tblLieferantenpreis.UpdateArtikel( tblLieferantenpreis.colAR_NR, TRUE )
.head 2 +  Functions 
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Sql Handle: p_hSql
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Return SqlVarSetup( p_hSql )
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else 
.head 8 -  Call OnPopulate( TRUE )
.head 7 +  ! If oParamArtikel.GetLieferant(  )	! xxx wieso geht das nicht?
.head 8 -  Call SalSetWindowText( hWndForm, 'Preise' )
.head 7 +  ! Else
.head 8 -  Call SalSetWindowText( hWndForm, 'Lieferanten' )
.head 3 +  Function: OnPopulate
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Boolean: p_bRefresh
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! ga 20090806: ungültigen Artikel nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT p_bRefresh
.head 6 -  Call SalSendMsg( tblLieferantenpreis, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 2 +  Window Parameters 
.head 3 -  Number: wp_nPARAM
.head 3 -  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables 
.head 3 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  !
.head 3 -  FunctionalVar: oResizables
.winattr class
.head 4 -  Class: cObjResizables
.end
.head 3 -  ! cObjParamArtikel: oParamArtikel
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Boolean: bLieferant
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( tblLieferantenpreis, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 4 -  ! Call oResizables.Resize( SalNumberLow( lParam ), SalNumberHigh( lParam ) )
.head 1 +  Dialog Box: dlgArtikelLieferant
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel -Zuordnung
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 11.988"
.head 4 -  Top: 1.51"
.head 4 -  Width:  11.25"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.656"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Class Default
.head 3 -  Horizontal Scroll? Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? No
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  ! ComboLookupLieferArtikel: cmArtikel
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SetWhere( GetWhereLieferArtikel( TRUE)  )
.head 5 +  On SAM_Validate
.head 6 -  Call tblArtLieferant.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  ! ComboLookupLieferArtikel2: cmArtikel
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SetWhere( GetWhereLieferArtikel( TRUE)  )
.head 5 +  On SAM_Validate
.head 6 -  Call tblArtLieferant.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  ! ComboLookupArtikel: cmArtikel
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call tblArtLieferant.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  Pushbutton: pbRowNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarNew
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: -0.017"
.head 5 -  Top: -0.01"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: new.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 7 -  Call SalHideWindow( hWndItem )
.head 5 -  ! ra 20141105 neue
.head 5 +  On SAM_Click ! th 20160701 set handle
.head 6 +  If nUserKuecheNr != NUMBER_Null
.head 7 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 8 -  ! Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = :dlgArtikelLieferant.nAR_NR')
.head 8 -  Set hWndZuordnungNeu = SalCreateWindow( cjArtikelZuordnung, hWndForm, sAR_INTERN )
.head 6 +  Else
.head 7 +  If SalMessageBox( Translate('Der Benutzer hat keine Kostenstelle, Zuordnung ist nicht möglich!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 +  ! On SAM_Click ! wl 20160624 Referenz auf tblArtikel weg
.head 6 +  If nUserKuecheNr != NUMBER_Null
.head 7 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 8 -  ! Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = :dlgArtikelLieferant.nAR_NR')
.head 8 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm, sAR_INTERN )
.head 6 +  Else
.head 7 +  If SalMessageBox( Translate('Der Benutzer hat keine Kostenstelle, Zuordnung ist nicht möglich!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 +  ! On SAM_Click ! th 20160606: nur öffnene wenn nUserKuechenNr vorhanden
.head 6 +  If nUserKuecheNr != NUMBER_Null
.head 7 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 8 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm, tblArtikel.colAR_INTERN )
.head 6 +  Else
.head 7 +  If SalMessageBox( Translate('Der Benutzer hat keine Kostenstelle, Zuordnung ist nicht möglich!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 +  ! On SAM_Click ! th 20160427: AR_INTERN übergeben zwecks Titel
.head 6 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 7 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm, tblArtikel.colAR_INTERN )
.head 5 +  ! On SAM_Click ! th 20160322: cjArtikelZuordnung
.head 6 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 7 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm)
.head 5 +  ! On SAM_Click ! th 20160302: funk InsertArtikel; neuer wp
.head 6 -  ! If dfLA_NR
.head 6 +  If nAR_NR
.head 7 +  If SalModalDialog( dlgAddArtikelLieferant, hWndForm, nAR_NR,nLA_NR2, nAL_KU_NR)
.head 8 -  Call tblArtLieferant.InsertArtikel( nLA_NR2, nAL_KU_NR, FALSE )
.head 5 +  ! On SAM_Click
.head 6 -  ! If dfLA_NR
.head 6 +  If nAR_NR
.head 7 +  If SalModalDialog(dlgAddArtikelLieferant, hWndForm, nAR_NR,nLA_NR2)
.head 8 -  Call tblArtLieferant.UpdateArtikel( nLA_NR2, FALSE )
.head 3 +  Pushbutton: pbRowDelete
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.583"
.head 5 -  Top: -0.01"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: delete.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.head 4 +  Message Actions
.head 5 +  On SAM_Click ! th20160628: paramSetInt für aktualisieren der Merkmale
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If IDOK = MessageBox( 'Zuordnung löschen ?', 'Lieferartikel-Zuordnung', MB_OkCancel )
.head 8 -  Call tblArtLieferant.InsertArtikel( tblArtLieferant.colLA_NR, tblArtLieferant.colKU_NR, TRUE )
.head 8 -  Call RefreshDependent ()
.head 5 +  ! On SAM_Click ! th20151106: Insert statt Update
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If IDOK = MessageBox( 'Zuordnung löschen ?', 'Lieferartikel-Zuordnung', MB_OkCancel )
.head 8 -  Call tblArtLieferant.InsertArtikel( tblArtLieferant.colLA_NR, tblArtLieferant.colKU_NR, TRUE )
.head 5 +  ! On SAM_Click
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If IDOK = MessageBox( 'Zuordnung löschen ?', 'Lieferartikel-Zuordnung', MB_OkCancel )
.head 8 -  Call tblArtLieferant.UpdateArtikel( tblArtLieferant.colLA_NR, TRUE )
.head 3 -  ! th 20151023
.head 3 +  Check Box: cbAlleKst
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Lieferartikel-Zuordnung für alle Kostenstellen anzeigen
.head 4 -  Window Location and Size
.head 5 -  Left: 1.4"
.head 5 -  Top: 0.031"
.head 5 -  Width:  5.6"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 7 -  Set MyValue = 1
.head 6 +  Else
.head 7 -  Call SalHideWindow( hWndItem )
.head 5 -  ! On AM_INSERT
.head 5 -  ! On AM_UPDATE
.head 5 +  On SAM_Click
.head 6 -  Call dlgArtikelLieferant.OnPopulate( FALSE )
.head 3 +  Child Table: tblArtLieferant
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.017"
.head 6 -  Top: 0.323"
.head 6 -  Width:  10.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Yes
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colROWID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'artikellieferart.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  Column: colAL_STD ! th 20160302: ShowOnly
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Std
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  Column: colAL_DEKLARATION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ZH
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  Column: colAL_BLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NW
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  Column: colAL_TAX
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tax
.head 6 -  Visible? Class Default
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 -  ! th 20151023
.head 5 +  Column: colKU_KOSTENSTELLE ! für ORDER BY
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KU_KOSTENSTELLE
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKU_BEZEICHNUNG ! wird angezeigt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Kst. der Zuordnung
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.117"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! th 20151118: (bs_)ku_nr Hilfsspalte für Färbung-> siehe On Sam_FetchRowDone
.head 5 +  Column: colKU_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AL_KU_NR
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLI_LIEFERANT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Lieferant
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: LA_NR
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_LIEFID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Art.Nr.Lief.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_INTERN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikelname Lieferant
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.317"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPreis
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Preis
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000;'($'###000')'
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 -  ! wird On SAM_FetchRowDone gesetzt
.head 5 +  Column: colAR_MENGE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! th 20151105: verschiedene Lieferantenpreise pro lieferartikle möglich, daher Gebindepreis,
	        Geb.Einheit, Geb.inhalt Anzeige sinnvoll
.head 5 -  ! th 20160302 zunächst keine Infos aus Lieferantenpreis
.head 5 +  ! ColShowOnly: colLP_GEBINDEPREIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colPreis
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Preis pro GE
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  ! On SAM_RowFetchDonecolLP_GEBINDEPREIS reinschreiben
.head 5 +  ! ColShowOnly: colLP_GEBINDEEINHEIT
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLP_GEBINDEINHALT
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_AUSLAUF
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLP_KEIN_EINKAUF
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLP_KUNDENPREIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLP_PREISLISTE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! th 20151028
.head 5 +  Column: colSB_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert von
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Date
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAL_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am Datum/Uhrzeit
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colEK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: EK
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 -  ! th 20151104
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Sql Handle: p_hSql
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SqlVarSetup( p_hSql )
.head 5 +  Function: InsertArtikel ! th 20160909 Flag ar_zuodnungneu setzen bei löschen UND insert setzen
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 7 -  Number: naAL_KU_NR[*]
.head 7 -  Number: naAL_LA_NR[*]
.head 7 -  Number: nInd
.head 7 -  Number: n
.head 7 +  Boolean: baCheckBox[4]
.head 8 -  ! Std; ZH; NW; Tax
.head 7 -  Boolean: bErsteZuordnung
.head 7 -  Boolean: bErsteZuordnungProKst
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  ! Set sStmt = 'DELETE FROM
			artikeltaxierung
		WHERE
			at_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND
			at_tu_nr IN (SELECT lt_tu_nr FROM lieferartikeltaxierung
				    WHERE  lt_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND
				    lt_la_nr NOT IN (SELECT al_la_nr
						  FROM  artikellieferart
						WHERE  al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_la_nr != ' || NumberToStrX( p_nLA_NR ) || ' ))'
.head 8 -  ! Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 +  Else
.head 8 -  ! alle ku_nr laden für unterscheidung ob erster Eintrag überhaupt oder erster pro küche ..., la_nrs zur Sicherheit mit
.head 8 +  If Sql_ExecEx( hSql, 'SELECT al_ku_nr, al_la_nr INTO :naAL_KU_NR[n], :naAL_LA_NR[n] FROM artikellieferart WHERE al_ar_nr = ' || NumberToStrX( nAR_NR ), FALSE )
.head 9 +  While SqlFetchNext( hSql, nInd )
.head 10 -  Set n = n + 1
.head 8 -  Set bErsteZuordnung = SalArrayIsEmpty( naAL_KU_NR)
.head 8 -  Set bErsteZuordnungProKst = ( VisArrayFindNumber( naAL_KU_NR, p_nAL_KU_NR) = -1 )
.head 8 -  ! CBs setzen:
.head 8 -  ! - bei allererster Z. alle trut; bei erster pro Kst Std true
.head 8 -  ! Tax immer true
.head 8 -  Set baCheckBox[0] = bErsteZuordnung OR bErsteZuordnungProKst
.head 8 -  Set baCheckBox[1] = bErsteZuordnung
.head 8 -  Set baCheckBox[2] = bErsteZuordnung
.head 8 -  Set baCheckBox[3] = TRUE
.head 8 -  ! vor INSERT prüfen ob die Z. nicht schon existiert
.head 8 +  If ( -1 = VisArrayFindNumber( naAL_LA_NR, p_nLA_NR ))
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_deklaration, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( baCheckBox[0]) ||
		' , ' || NumberToStrX( baCheckBox[1] ) || ' , ' || NumberToStrX( baCheckBox[2]) || ' , ' || NumberToStrX( baCheckBox[3]) ||' )'
.head 9 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 +  Else
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 8 -  ! wl 20160820 Typ/Gruppe optional übernehmen	
.head 8 +  If bOk
.head 9 +  If NOT Sql_FetchOne( hSql, 'SELECT 1 FROM artikel, lieferartikel 
where ar_nr = ' || NumberToStrX( nAR_NR  ) || ' and la_nr =  ' || NumberToStrX( p_nLA_NR ) || '
and AR_AT_NR = la_at_nr AND ar_ag_nr = la_ag_nr' )
.head 10 +  If Benutzer.HatRecht( REC_LIEFERARTIKEL_UPDATE_TYP_GRUPPE ) AND SalModalDialog( dlgArtikelTypGruppeZuordnung, hWndForm, nAR_NR, p_nLA_NR )
.head 11 +  If dlgArtikelLieferant.ParamGetInt( PARAM.ChangedLieferartikelNr ) = p_nLA_NR
.head 12 -  Call dlgArtikelLieferant.ParamSetInt( PARAM.ChangedLieferartikelNr, p_nLA_NR )
.head 11 +  If dlgArtikelLieferant.ParamGetInt( PARAM.ChangedLieferartikelNrLeseModus ) = p_nLA_NR
.head 12 -  Call dlgArtikelLieferant.ParamSetInt( PARAM.ChangedLieferartikelNrLeseModus, p_nLA_NR )
.head 7 -  !
.head 7 -  ! ar_zuordnungneu setzen
.head 7 +  If bOk
.head 8 -  Set sStmt = 'UPDATE artikel SET ar_update = SYSDATETIME, ar_zuordnungneu = 1 WHERE ar_nr = ' || NumberToStrX( nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  ! Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, nAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! wl 20160820 Typ/Gruppe optional übernehmen
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 7 -  Number: naAL_KU_NR[*]
.head 7 -  Number: naAL_LA_NR[*]
.head 7 -  Number: nInd
.head 7 -  Number: n
.head 7 +  Boolean: baCheckBox[4]
.head 8 -  ! Std; ZH; NW; Tax
.head 7 -  Boolean: bErsteZuordnung
.head 7 -  Boolean: bErsteZuordnungProKst
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  ! Set sStmt = 'DELETE FROM
			artikeltaxierung
		WHERE
			at_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND
			at_tu_nr IN (SELECT lt_tu_nr FROM lieferartikeltaxierung
				    WHERE  lt_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND
				    lt_la_nr NOT IN (SELECT al_la_nr
						  FROM  artikellieferart
						WHERE  al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_la_nr != ' || NumberToStrX( p_nLA_NR ) || ' ))'
.head 8 -  ! Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'UPDATE artikel SET ar_update = SYSDATETIME WHERE ar_nr = ' || NumberToStrX( nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 +  Else 
.head 8 -  ! alle ku_nr laden für unterscheidung ob erster Eintrag überhaupt oder erster pro küche ..., la_nrs zur Sicherheit mit
.head 8 +  If Sql_ExecEx( hSql, 'SELECT al_ku_nr, al_la_nr INTO :naAL_KU_NR[n], :naAL_LA_NR[n] FROM artikellieferart WHERE al_ar_nr = ' || NumberToStrX( nAR_NR ), FALSE )
.head 9 +  While SqlFetchNext( hSql, nInd )
.head 10 -  Set n = n + 1
.head 8 -  Set bErsteZuordnung = SalArrayIsEmpty( naAL_KU_NR)
.head 8 -  Set bErsteZuordnungProKst = ( VisArrayFindNumber( naAL_KU_NR, p_nAL_KU_NR) = -1 )
.head 8 -  ! CBs setzen:
.head 8 -  ! - bei allererster Z. alle trut; bei erster pro Kst Std true
.head 8 -  ! Tax immer true
.head 8 -  Set baCheckBox[0] = bErsteZuordnung OR bErsteZuordnungProKst
.head 8 -  Set baCheckBox[1] = bErsteZuordnung
.head 8 -  Set baCheckBox[2] = bErsteZuordnung
.head 8 -  Set baCheckBox[3] = TRUE
.head 8 -  ! vor INSERT prüfen ob die Z. nicht schon existiert
.head 8 +  If ( -1 = VisArrayFindNumber( naAL_LA_NR, p_nLA_NR ))
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_deklaration, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( baCheckBox[0]) ||
		' , ' || NumberToStrX( baCheckBox[1] ) || ' , ' || NumberToStrX( baCheckBox[2]) || ' , ' || NumberToStrX( baCheckBox[3]) ||' )'
.head 8 +  Else 
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  ! wl 20160820 Typ/Gruppe optional übernehmen	
.head 8 +  If bOk
.head 9 +  If NOT Sql_FetchOne( hSql, 'SELECT 1 FROM artikel, lieferartikel 
where ar_nr = ' || NumberToStrX( nAR_NR  ) || ' and la_nr =  ' || NumberToStrX( p_nLA_NR ) || '
and AR_AT_NR = la_at_nr AND ar_ag_nr = la_ag_nr' )
.head 10 +  If Benutzer.HatRecht( REC_LIEFERARTIKEL_UPDATE_TYP_GRUPPE ) AND SalModalDialog( dlgArtikelTypGruppeZuordnung, hWndForm, nAR_NR, p_nLA_NR )
.head 11 +  If dlgArtikelLieferant.ParamGetInt( PARAM.ChangedLieferartikelNr ) = p_nLA_NR
.head 12 -  Call dlgArtikelLieferant.ParamSetInt( PARAM.ChangedLieferartikelNr, p_nLA_NR )
.head 11 +  If dlgArtikelLieferant.ParamGetInt( PARAM.ChangedLieferartikelNrLeseModus ) = p_nLA_NR
.head 12 -  Call dlgArtikelLieferant.ParamSetInt( PARAM.ChangedLieferartikelNrLeseModus, p_nLA_NR )
.head 7 -  !
.head 7 -  ! Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, nAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20160628 bei delete taxierungen mitlöschen und ar_update setzen
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 7 -  Number: naAL_KU_NR[*]
.head 7 -  Number: naAL_LA_NR[*]
.head 7 -  Number: nInd
.head 7 -  Number: n
.head 7 +  Boolean: baCheckBox[4]
.head 8 -  ! Std; ZH; NW; Tax
.head 7 -  Boolean: bErsteZuordnung
.head 7 -  Boolean: bErsteZuordnungProKst
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  ! Set sStmt = 'DELETE FROM
			artikeltaxierung
		WHERE
			at_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND
			at_tu_nr IN (SELECT lt_tu_nr FROM lieferartikeltaxierung
				    WHERE  lt_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND
				    lt_la_nr NOT IN (SELECT al_la_nr
						  FROM  artikellieferart
						WHERE  al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_la_nr != ' || NumberToStrX( p_nLA_NR ) || ' ))'
.head 8 -  ! Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'UPDATE artikel SET ar_update = SYSDATETIME WHERE ar_nr = ' || NumberToStrX( nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 +  Else 
.head 8 -  ! alle ku_nr laden für unterscheidung ob erster Eintrag überhaupt oder erster pro küche ..., la_nrs zur Sicherheit mit
.head 8 +  If Sql_ExecEx( hSql, 'SELECT al_ku_nr, al_la_nr INTO :naAL_KU_NR[n], :naAL_LA_NR[n] FROM artikellieferart WHERE al_ar_nr = ' || NumberToStrX( nAR_NR ), FALSE )
.head 9 +  While SqlFetchNext( hSql, nInd )
.head 10 -  Set n = n + 1
.head 8 -  Set bErsteZuordnung = SalArrayIsEmpty( naAL_KU_NR)
.head 8 -  Set bErsteZuordnungProKst = ( VisArrayFindNumber( naAL_KU_NR, p_nAL_KU_NR) = -1 )
.head 8 -  ! CBs setzen:
.head 8 -  ! - bei allererster Z. alle trut; bei erster pro Kst Std true
.head 8 -  ! Tax immer true
.head 8 -  Set baCheckBox[0] = bErsteZuordnung OR bErsteZuordnungProKst
.head 8 -  Set baCheckBox[1] = bErsteZuordnung
.head 8 -  Set baCheckBox[2] = bErsteZuordnung
.head 8 -  Set baCheckBox[3] = TRUE
.head 8 -  ! vor INSERT prüfen ob die Z. nicht schon existiert
.head 8 +  If ( -1 = VisArrayFindNumber( naAL_LA_NR, p_nLA_NR ))
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_deklaration, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( baCheckBox[0]) ||
		' , ' || NumberToStrX( baCheckBox[1] ) || ' , ' || NumberToStrX( baCheckBox[2]) || ' , ' || NumberToStrX( baCheckBox[3]) ||' )'
.head 8 +  Else 
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  ! Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, nAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20160609: cbs setzen
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 7 -  Number: naAL_KU_NR[*]
.head 7 -  Number: naAL_LA_NR[*]
.head 7 -  Number: nInd
.head 7 -  Number: n
.head 7 +  Boolean: baCheckBox[4]
.head 8 -  ! Std; ZH; NW; Tax
.head 7 -  Boolean: bErsteZuordnung
.head 7 -  Boolean: bErsteZuordnungProKst
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 7 +  Else
.head 8 -  ! alle ku_nr laden für unterscheidung ob erster Eintrag überhaupt oder erster pro küche ..., la_nrs zur Sicherheit mit
.head 8 +  If Sql_ExecEx( hSql, 'SELECT al_ku_nr, al_la_nr INTO :naAL_KU_NR[n], :naAL_LA_NR[n] FROM artikellieferart WHERE al_ar_nr = ' || NumberToStrX( nAR_NR ), FALSE )
.head 9 +  While SqlFetchNext( hSql, nInd )
.head 10 -  Set n = n + 1
.head 8 -  Set bErsteZuordnung = SalArrayIsEmpty( naAL_KU_NR)
.head 8 -  Set bErsteZuordnungProKst = ( VisArrayFindNumber( naAL_KU_NR, p_nAL_KU_NR) = -1 )
.head 8 -  ! CBs setzen:
.head 8 -  ! - bei allererster Z. alle trut; bei erster pro Kst Std true
.head 8 -  ! Tax immer true
.head 8 -  Set baCheckBox[0] = bErsteZuordnung OR bErsteZuordnungProKst
.head 8 -  Set baCheckBox[1] = bErsteZuordnung
.head 8 -  Set baCheckBox[2] = bErsteZuordnung
.head 8 -  Set baCheckBox[3] = TRUE
.head 8 -  ! vor INSERT prüfen ob die Z. nicht schon existiert
.head 8 +  If ( -1 = VisArrayFindNumber( naAL_LA_NR, p_nLA_NR ))
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_deklaration, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( baCheckBox[0]) ||
		' , ' || NumberToStrX( baCheckBox[1] ) || ' , ' || NumberToStrX( baCheckBox[2]) || ' , ' || NumberToStrX( baCheckBox[3]) ||' )'
.head 8 +  Else
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20160308: mit al_ku_nr
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 7 +  Else
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT 1 FROM artikellieferart WHERE al_la_nr = '|| NumberToStrX( p_nLA_NR )|| ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR ) )
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( 0) ||
		' , ' || NumberToStrX(0) || ' , ' || NumberToStrX( 0) || ' )'
.head 8 +  Else
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20151215:La kann nur einem Ar zugeordnet werden
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR )
.head 7 +  Else
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT 1 FROM artikellieferart WHERE al_la_nr = '|| NumberToStrX( p_nLA_NR ) )
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( nUserKuecheNr ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( 0) ||
		' , ' || NumberToStrX(0) || ' , ' || NumberToStrX( 0) || ' )'
.head 8 +  Else
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20151030: nAR_NR statt nLA_NR weil es die AR_NR IST; umbernannt weil INSERT!; al_ku_nr korrigiert
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR )
.head 7 +  Else
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_bls, al_tax )
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( nUserKuecheNr ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( 0) ||
		' , ' || NumberToStrX(0) || ' , ' || NumberToStrX( 0) || ' )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel ! th 20151030: nAR_NR statt nLA_NR weil es die AR_NR IST;
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND ' || GetKU_KU_NRWhere( 'al_ku_nr' )
.head 7 +  Else
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART ( al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update )
		VALUES ( ' || NumberToStrX(nAR_NR  ) || ', ' || NumberToStrX( p_nLA_NR ) || ', :nUserKuecheNrMandant, :nUserNr, SYSDATETIME )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel ! ra 20141105 delete fixed
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nLA_NR ) || ' AND ' || GetKU_KU_NRWhere( 'al_ku_nr' )
.head 7 +  Else
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART ( al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update )
		VALUES ( ' || NumberToStrX(nLA_NR  ) || ', ' || NumberToStrX( p_nLA_NR ) || ', :nUserKuecheNrMandant, :nUserNr, SYSDATETIME )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel	! wl 20140829 Lieferartikel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_ar_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_la_nr = ' || NumberToStrX( nLA_NR ) || ' AND ' || GetKU_KU_NRWhere( 'al_ku_nr' )
.head 7 +  Else
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART ( al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update )
		VALUES ( ' || NumberToStrX(nLA_NR  ) || ', ' || NumberToStrX( p_nLA_NR ) || ', :nUserKuecheNrMandant, :nUserNr, SYSDATETIME )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bDelete
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 -  Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  Function: EditableColumnsUpdaten ! wl 20160821 auch Artikel updaten
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col'
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 )
.head 8 +  If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr das Flag al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 8 +  Else If sDBColumnName = 'AL_DEKLARATION'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_deklaration = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_deklaration = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_deklaration = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_deklaration = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_deklaration = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  ! soll auf obersten Eintrag springen wenn kein NW bei keiner anderen Zuordnung ausgewählt, d.h. wegen order by der Tabelle auf std =1 und MAX(ku_kostenstelle)
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart
	        	  SET al_deklaration = 1, al_update = SYSDATETIME
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1
	        	  AND al_ku_nr = (SELECT ku_nr
	                	             FROM kueche
		                           WHERE ku_kostenstelle = (SELECT MIN(k.ku_kostenstelle)
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          )
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_deklaration = 0, al_update = SYSDATETIME  WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  ! soll auf obersten Eintrag springen wenn kein NW bei keiner anderen Zuordnung ausgewählt, d.h. wegen order by der Tabelle auf std =1 und MAX(ku_kostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE rowid = :colROWID' )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart
	        	  SET al_bls = 1, al_update = SYSDATETIME
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1
	        	  AND al_ku_nr = (SELECT ku_nr
	                	             FROM kueche
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle)
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          )
			             )')
.head 8 +  Else If sDBColumnName = 'AL_TAX'
.head 9 -  ! kann man neuerdings auch anderen Küchen weg nehmen
.head 9 -  ! If colKU_NR = nUserKuecheNr
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 -  ! Artikel updaten
.head 8 -  ! th 20160909 und Flag setzen
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikel  SET ar_update = SYSDATETIME, ar_zuordnungneu = 1 WHERE ar_nr = :nAR_NR')
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160608: mit Deklaration (ZH)
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col'
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 )
.head 8 +  If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr das Flag al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else 
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 8 +  Else If sDBColumnName = 'AL_DEKLARATION'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_deklaration = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_deklaration = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_deklaration = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_deklaration = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_deklaration = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  ! soll auf obersten Eintrag springen wenn kein NW bei keiner anderen Zuordnung ausgewählt, d.h. wegen order by der Tabelle auf std =1 und MAX(ku_kostenstelle)
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart
	        	  SET al_deklaration = 1, al_update = SYSDATETIME
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1
	        	  AND al_ku_nr = (SELECT ku_nr
	                	             FROM kueche
		                           WHERE ku_kostenstelle = (SELECT MIN(k.ku_kostenstelle)
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          )
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_deklaration = 0, al_update = SYSDATETIME  WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  ! soll auf obersten Eintrag springen wenn kein NW bei keiner anderen Zuordnung ausgewählt, d.h. wegen order by der Tabelle auf std =1 und MAX(ku_kostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE rowid = :colROWID' )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart
	        	  SET al_bls = 1, al_update = SYSDATETIME
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1
	        	  AND al_ku_nr = (SELECT ku_nr
	                	             FROM kueche
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle)
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          )
			             )')
.head 8 +  Else If sDBColumnName = 'AL_TAX'
.head 9 -  ! kann man neuerdings auch anderen Küchen weg nehmen
.head 9 -  ! If colKU_NR = nUserKuecheNr
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 7 +  Else 
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160310: wenn Kst. der Zuordnung die eigene ist darf Tax immer ausgewählt werden
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col'
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 )
.head 8 +  If sDBColumnName = 'AL_TAX'
.head 9 -  ! bei eigener Küche immer checkbar, sonst nicht;
.head 9 +  If colKU_NR = nUserKuecheNr
.head 10 +  If p_bIsChecked
.head 11 -  ! dann den markierten setzen
.head 11 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 11 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 11 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 10 +  Else
.head 11 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  ! Reihenfolge wichtig!!!
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  ! soll auf obersten Eintrag springen d.h. wegen order by der Tabelle auf std =1 und MAX(kukostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart
	        	  SET al_bls = 1, al_update = GetDate()
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1
	        	  AND al_ku_nr = (SELECT ku_nr
	                	             FROM kueche
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle)
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          )
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160303: neue Regeln hier rein!
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col'
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 )
.head 8 +  If sDBColumnName = 'AL_TAX'
.head 9 -  ! tax je Ar-Zuordnung nur einmal setzbar
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  ! Reihenfolge wichtig!!!
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  ! soll auf obersten Eintrag springen d.h. wegen order by der Tabelle auf std =1 und MAX(kukostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart
	        	  SET al_bls = 1, al_update = GetDate()
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1
	        	  AND al_ku_nr = (SELECT ku_nr
	                	             FROM kueche
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle)
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          )
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160223: al_update updaten und RefreshDependent() raus weil läd zu lange
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  ! th: Fall von mehrfachen Lieferantenpreisen (nach wie vor) ungeklärt
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col'
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 )
.head 8 +  If sDBColumnName = 'AL_BLS'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 +  Else
.head 9 +  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET '|| sDBColumnName ||' = :tblArtLieferant.' || sItemName ||', al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 10 -  ! tax oder std
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20151119
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 -  ! th: Fall von mehrfachen Lieferantenpreisen (nach wie vor) ungeklärt
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col'
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 )
.head 8 +  If sDBColumnName = 'AL_BLS'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0 WHERE al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1 WHERE al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0 WHERE rowid = :colROWID' )
.head 8 +  Else
.head 9 +  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET '|| sDBColumnName ||' = :tblArtLieferant.' || sItemName ||' WHERE rowid = :colROWID' )
.head 10 -  ! tax oder std
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  Call RefreshDependent(  )
.head 5 +  ! Function: SetStandard ! th20151023: ohne colLA_MENGE usw.
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If p_bIsChecked
.head 8 -  ! dann den markierten setzen
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 2 WHERE rowid = :colROWID' )
.head 8 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE al_std = 1 AND al_ar_nr = :nAR_NR' )
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1 WHERE al_std = 2 AND al_ar_nr = :nAR_NR' )
.head 8 -  ! dann den Lieferartikel updaten
.head 8 +  ! If colLA_MENGE
.head 9 -  Call Sql_Exec( hSql, 'UPDATE artikel  SET ar_ek = (:tblArtLieferant.colEK / :tblArtLieferant.colLA_MENGE) * ar_menge WHERE ar_nr = :nLA_NR' )
.head 7 +  Else
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE rowid = :colROWID' )
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  Call RefreshDependent(  )
.head 5 +  ! Function: SetStandard
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If p_bIsChecked
.head 8 -  ! dann den markierten setzen
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 2 WHERE rowid = :colROWID' )
.head 8 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE al_std = 1 AND al_ar_nr = :nLA_NR' )
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1 WHERE al_std = 2 AND al_ar_nr = :nLA_NR' )
.head 8 -  ! dann den Lieferartikel updaten
.head 8 +  If colLA_MENGE
.head 9 -  Call Sql_Exec( hSql, 'UPDATE artikel  SET ar_ek = (:tblArtLieferant.colEK / :tblArtLieferant.colLA_MENGE) * ar_menge WHERE ar_nr = :nLA_NR' )
.head 7 +  Else
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE rowid = :colROWID' )
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  Call RefreshDependent(  )
.head 5 +  Function: GetPreis
.head 6 -  Description: th 20180216 läd Preis aus colLP_PREIS oder Lieferantenpreis, wenn vorhanden
.head 6 +  Returns
.head 7 -  Number:
.head 6 +  Parameters
.head 7 -  Number: p_nLaNr
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: p_nKuNr
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  FunctionalVar: oCalc
.head 8 -  Class: fcLpPreisCalculator
.head 6 +  Actions
.head 7 -  Return colAR_MENGE * oCalc.CalLpPreisFromLaAndKuNr( p_nLaNr, p_nKuNr ) 
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On AM_POPULATE 	! th 20160311: Bereitstellung wird bei Neuanlage einer Zuordnung kontrolliert, hier unnötig; order by al_update desc; nicht bei std ordnen, nur bei kst.
.head 6 -  ! sWhereKuKst legt die Küchen fest, deren Zuordnungen man sehen darf (von der CheckBox beeinflusst..)
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart JOIN lieferartikel           ON al_la_nr = la_nr
                                                                JOIN kueche 	               ON al_ku_nr = ku_nr
			          	LEFT JOIN benutzer 	 ON sb_nr = al_sb_nr
			          	LEFT JOIN lieferant 	 ON li_nr = la_li_nr
			          	LEFT JOIN artikelme v 	 ON v.am_nr = LA_AM_NR
                                                    	LEFT JOIN artikelme l            ON l.am_nr = LA_LE_AM_NR
                                                 	LEFT JOIN artikelme g 	 ON g.am_nr = LA_GE_AM_NR
				        JOIN artikel ON al_ar_nr = ar_nr',
	    	                ' al_ar_nr = :nAR_NR' || sWhereKuKst,
	                              ' ku_kostenstelle', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! th 20160201: ku_kostenstelle von bereitstellung anzeigen da al_ku_nr eh immer die UserKuNr ist; join kueche on al_ku_nr!!!; bs_ps_nr <=6 damit selbstverwaltete angezeigt werden; OR bs_datum IS NULL
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Call PopulateAndCount( hSql, 'artikellieferart JOIN lieferartikel           ON al_la_nr = la_nr
				        JOIN lieferbereitstellung ON la_nr = bs_la_nr AND bs_update = ( SELECT MAX( z.bs_update )
								                      		   FROM lieferbereitstellung z
									                  	   WHERE         ( z.bs_ps_nr < 6 AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL))
												OR    ( z.bs_ps_nr = 6 AND ( z.bs_datumvon   > SYSDATETIME OR z.bs_datumvon IS NULL))
												AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
												ANd z.bs_la_nr = al_la_nr
											     )
                                                                JOIN kueche 	               ON al_ku_nr = ku_nr
			          	LEFT JOIN benutzer 	 ON sb_nr = al_sb_nr
			          	LEFT JOIN lieferant 	 ON li_nr = la_li_nr
			          	LEFT JOIN artikelme v 	 ON v.am_nr = LA_AM_NR
                                                    	LEFT JOIN artikelme l            ON l.am_nr = LA_LE_AM_NR
                                                 	LEFT JOIN artikelme g 	 ON g.am_nr = LA_GE_AM_NR
			              LEFT JOIN lieferantenpreis     ON lp_la_nr =  la_nr',
	    	                ' al_ar_nr = :nAR_NR' || sWhereKuKst,
	                              ' al_std DESC, ku_kostenstelle DESC', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! th 20151104: sWhereKuKst ; lieferbereitstellung weg
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart JOIN lieferartikel           ON al_la_nr = la_nr
                                                                JOIN kueche 	               ON al_ku_nr = ku_nr
			          	LEFT JOIN benutzer 	 ON sb_nr = al_sb_nr
			          	LEFT JOIN lieferant 	 ON li_nr = la_li_nr
			          	LEFT JOIN artikelme v 	 ON v.am_nr = LA_AM_NR
                                                    	LEFT JOIN artikelme l            ON l.am_nr = LA_LE_AM_NR
                                                 	LEFT JOIN artikelme g 	 ON g.am_nr = LA_GE_AM_NR
			              LEFT JOIN lieferantenpreis     ON lp_la_nr =  la_nr',
	    	                ' al_ar_nr = :nAR_NR' || sWhereKuKst,
	                              ' al_std DESC, ku_kostenstelle DESC', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! wl 20150131 auch Benutzer mit LEFT JOIN || sWhereLiKst
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart LEFT JOIN benutzer on sb_nr = al_sb_nr,
		lieferartikel
		LEFT JOIN lieferant ON li_nr = la_li_nr
		LEFT JOIN artikelme v on v.am_nr = LA_AM_NR
		LEFT JOIN artikelme l on l.am_nr = LA_LE_AM_NR
		LEFT JOIN artikelme g on g.am_nr = LA_GE_AM_NR',
		'al_la_nr = la_nr AND al_ar_nr = :nLA_NR', 'la_intern', TBL_FillAll, nGlobalTemp )
.head 5 +  On SAM_FetchRowDone ! th 20180219 bei lieferantenpreis Preis setzen
.head 6 +  If colKU_NR != nUserKuecheNr
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 7 -  Call MTblDisableCell(tblArtLieferant.colAL_TAX, lParam, TRUE)
.head 6 -  Set colPreis = GetPreis( colLA_NR, colKU_NR )
.head 5 +  ! On SAM_FetchRowDone ! th 20160310: Spalte std, nw, tax rechtabh.; disable cell Tax wenn nicht eigenen küche
.head 6 +  If colKU_NR != nUserKuecheNr
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 7 -  Call MTblDisableCell(tblArtLieferant.colAL_TAX, lParam, TRUE)
.head 5 +  ! On SAM_FetchRowDone ! th 20151204
.head 6 -  Set colPreis = StrAppend( NumberToStr( colLP_GEBINDEPREIS, 2 ), ' ' , '' )
.head 5 +  ! On SAM_FetchRowDone ! th 20151118: Zeile blau färben wenn die (BS_)KU_NR != UserKuNr
.head 6 +  If colKU_NR != nUserKuecheNr
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 5 +  ! On SAM_FetchRowDone
.head 6 +  If colLA_GEBINDEINHALT * colLA_LAGEREINHEIT > 0
.head 7 -  Set colEK = colLA_GEBINDEPREIS/colLA_GEBINDEINHALT/colLA_LAGEREINHEIT
.head 5 +  ! On AM_POPULATE
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart
		JOIN benutzer on sb_nr = al_sb_nr,
		lieferartikel
		LEFT JOIN lieferant ON li_nr = la_li_nr
		LEFT JOIN artikelme v on v.am_nr = LA_AM_NR
		LEFT JOIN artikelme l on l.am_nr = LA_LE_AM_NR
		LEFT JOIN artikelme g on g.am_nr = LA_GE_AM_NR',
	'al_la_nr = la_nr AND al_ar_nr = :nLA_NR', 'la_intern', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! wl 20140829 Lieferartikel
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_nr = :dlgArtikelLieferant.nLA_NR AND ar_li_nr IS NULL' )
.head 7 -  Set bLieferant = FALSE
.head 7 -  Call SalSetWindowText( hWndForm, 'Lieferanten' )
.head 7 -  Call PopulateAndCount( hSql, 'artikellieferart,lieferartikel LEFT JOIN lieferant ON li_nr = la_li_nr', 'al_la_nr = la_nr AND la_nr = :nLA_NR', 'la_intern', TBL_FillAll, nGlobalTemp )
.head 6 +  Else
.head 7 -  Set bLieferant = TRUE
.head 7 -  Call SalSetWindowText( hWndForm, 'Preise' )
.head 7 -  Call PopulateAndCount( hSql, 'artikel LEFT JOIN lieferant ON li_nr = ar_li_nr', 'ar_ar_nr = :nLA_NR', 'ar_intern', TBL_FillAll, nGlobalTemp )
.head 6 -  Set nUserKuecheNrMandant
.head 5 +  On AM_INSERT
.head 6 -  ! Wird von dlgAddArtikelLieferart mit w/lParam geschickt!
.head 6 +  If wParam != NUMBER_Null AND lParam != NUMBER_Null
.head 7 -  Call InsertArtikel( wParam, lParam, FALSE )
.head 2 +  Functions
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Sql Handle: p_hSql
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SqlVarSetup( p_hSql )
.head 3 +  Function: classNotify		! th 20160701 bei PARAM.Zuordnung erst hWndZuordnungNeu vergleichen, dann AM_INSERT an Children
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 +  String: saZuordnung[3]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! Elemente: 0-AL_LA_NR; 1-AL_KU_NR; 2-Handle des Zuordnung-Fensters (damit es in bei Richtigem Artikel eingetragen wird)
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else
.head 8 -  Call OnPopulate( TRUE )
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT ar_ku_nr, ar_intern INTO :nGlobalTemp, :dlgArtikelLieferant.sAR_INTERN FROM artikel WHERE ar_nr = :nAR_NR')
.head 7 +  If nGlobalTemp != nUserKuecheNrMandant
.head 8 -  ! Artikel "blau"
.head 8 -  Call SalDisableWindow( pbRowNew)
.head 7 +  Else
.head 8 -  ! Artikel "schwarz"
.head 8 -  Call SalEnableWindow( pbRowNew)
.head 5 +  Else If p_nKey = PARAM.Zuordnung
.head 6 +  If ParamGetArray( p_nKey, saZuordnung) AND
	NOT SalArrayIsEmpty( saZuordnung )
.head 7 -  ! kommt Zuordnung von dem Fenster, dass von hier aus geöffnet wurde?
.head 7 +  If SalWindowHandleToNumber( hWndZuordnungNeu ) = SalStrToNumber( saZuordnung[2] )
.head 8 -  Call SalSendMsgToChildren( hWndForm, AM_INSERT, SalStrToNumber( saZuordnung[0]), SalStrToNumber( saZuordnung[1]) )
.head 3 +  ! Function: classNotify		! wl 20160624 mit AR_INTERN
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else
.head 8 -  Call OnPopulate( TRUE )
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT ar_ku_nr, ar_intern INTO :nGlobalTemp, :dlgArtikelLieferant.sAR_INTERN FROM artikel WHERE ar_nr = :nAR_NR')
.head 7 +  If nGlobalTemp != nUserKuecheNrMandant
.head 8 -  ! Artikel "blau"
.head 8 -  Call SalDisableWindow( pbRowNew)
.head 7 +  Else
.head 8 -  ! Artikel "schwarz"
.head 8 -  Call SalEnableWindow( pbRowNew)
.head 3 +  ! Function: classNotify		! th 20160302: Enable/Disable von Neuanlage
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else
.head 8 -  Call OnPopulate( TRUE )
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT ar_ku_nr INTO :nGlobalTemp FROM artikel WHERE ar_nr = :nAR_NR')
.head 7 +  If nGlobalTemp != nUserKuecheNrMandant
.head 8 -  ! Artikel "blau"
.head 8 -  Call SalDisableWindow( pbRowNew)
.head 7 +  Else
.head 8 -  ! Artikel "schwarz"
.head 8 -  Call SalEnableWindow( pbRowNew)
.head 3 +  ! Function: classNotify		! wl 20131223 mit Lieferant
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else
.head 8 -  Call OnPopulate( TRUE )
.head 7 +  ! If oParamArtikel.GetLieferant(  )	! xxx wieso geht das nicht?
.head 8 -  Call SalSetWindowText( hWndForm, 'Preise' )
.head 7 +  ! Else
.head 8 -  Call SalSetWindowText( hWndForm, 'Lieferanten' )
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else
.head 8 -  Call OnPopulate( TRUE )
.head 3 +  Function: OnPopulate ! th 20160302: Zuordungs-Ku-Kst's hierarchisch nach oben, wen cb checked auch nach unten
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  Set nColorDisabled = COLOR_Blue
.head 6 -  ! für LA bei der die bereitstellungs-küche nicht die User-Küche ist
.head 5 +  If NOT p_bRefresh
.head 6 +  If sUserKst != STRING_Null
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellenEx( 'ku_kostenstelle', sUserKst, TRUE))
.head 7 +  Else
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellenEx( 'ku_kostenstelle', sUserKst, FALSE))
.head 6 +  Else
.head 7 +  Set sWhereKuKst = ''
.head 8 -  ! UserKüche hat keine Kostenstelle ?!
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate ! th 20151118: globale Variable nUserKst
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  Set nColorDisabled = COLOR_Blue
.head 6 -  ! für LA bei der die bereitstellungs-küche nicht die User-Küche ist
.head 5 +  If NOT p_bRefresh
.head 6 +  If sUserKst != STRING_Null
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = ''
.head 7 +  Else
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) )
.head 6 +  Else
.head 7 +  Set sWhereKuKst = ''
.head 8 -  ! UserKüche hat keine Kostenstelle ?!
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate ! th 20151105: nColorDisabled nach Vorbild tblArtikel; cbAlleKst: 0-> nach Kst-Logik, 1-> alle
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  Set nColorDisabled = COLOR_Blue
.head 6 -  ! für lieferartikel die nicht der User-Küche zugeordnet sind
.head 5 +  If NOT p_bRefresh
.head 6 -  Call Sql_Exec( hSql, 'SELECT ku_kostenstelle INTO :dlgArtikelLieferant.sKU_KOSTENSTELLE FROM kueche WHERE ku_nr = ' || NumberToStrX ( GetKU_NR () ) )
.head 6 +  If SqlFetchNext( hSql , nInd ) AND sKU_KOSTENSTELLE != ''
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = ''
.head 7 +  Else
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellen( 'ku_kostenstelle', sKU_KOSTENSTELLE ) )
.head 6 +  Else
.head 7 +  Set sWhereKuKst = ''
.head 8 -  ! UserKüche hat keine Kostenstelle ?!
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate ! th 20151027 mit sWhereKuKst abh. von cbAlleKst
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nInd
.head 4 +  Actions
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT p_bRefresh
.head 6 -  Call Sql_Exec( hSql, 'SELECT ku_kostenstelle INTO :dlgArtikelLieferant.sKU_KOSTENSTELLE FROM kueche WHERE ku_nr = ' || NumberToStrX ( GetKU_NR () ) )
.head 6 +  If SqlFetchNext( hSql , nInd ) AND sKU_KOSTENSTELLE != ''
.head 7 -  Set sWhereKuKst = ' AND '
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = StrAppend( sWhereKuKst , ' ' ,  GetWhereKostenstellen( 'ku_kostenstelle', sKU_KOSTENSTELLE ) )
.head 7 +  Else
.head 8 -  Set sWhereKuKst = sWhereKuKst || ' ku_kostenstelle = ' || sKU_KOSTENSTELLE
.head 6 +  Else
.head 7 -  Set sWhereKuKst = ''
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nLA_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT p_bRefresh
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  Function: RefreshDependent
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call ParamSetInt( PARAM.ChangedArtikelNr, nAR_NR )
.head 5 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, nAR_NR )
.head 2 +  Window Parameters
.head 3 -  Number: wp_nPARAM
.head 3 -  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 +  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! th 20151030: Artikel der in Tabelle angeklickt wurde
.head 3 +  Number: nLA_NR2
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! th 20151030 neu zugeordneter Lieferartikel
.head 3 -  !
.head 3 -  FunctionalVar: oResizables
.head 4 -  Class: cObjResizables
.head 3 -  ! cObjParamArtikel: oParamArtikel
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Boolean: bLieferant
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! th 20151023
.head 3 -  String: sKU_KOSTENSTELLE
.head 3 -  String: sKuKstHiererchieString
.head 3 -  String: sWhereKuKst
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! th 20151105
.head 3 -  Number: nColorDisabled
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: nAL_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: sAR_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 3 +  Window Handle: hWndZuordnungNeu
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! zum Vergleich mit Handle das bei PARAM.Zuordnung mitgeschickt wird
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call SalSetWindowText( hWndForm, 'Lieferartikel-Zuordnung' )
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( tblArtLieferant, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 4 -  ! Call cmAR_INTERN.SetKey( NumberToStrX( wr_nAR_NR ), TRUE )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 4 -  ! Call oResizables.Resize( SalNumberLow( lParam ), SalNumberHigh( lParam ) )
.head 1 +  ! InsertBox: dlgArtikelLieferant
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel -Zuordnung
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 11.988"
.head 4 -  Top: 1.51"
.head 4 -  Width:  11.25"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.656"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  ! ComboLookupLieferArtikel: cmArtikel
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SetWhere( GetWhereLieferArtikel( TRUE)  )
.head 5 +  On SAM_Validate
.head 6 -  Call tblArtLieferant.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  ! ComboLookupLieferArtikel2: cmArtikel
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  Call SetWhere( GetWhereLieferArtikel( TRUE)  )
.head 5 +  On SAM_Validate
.head 6 -  Call tblArtLieferant.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  ! ComboLookupArtikel: cmArtikel
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call tblArtLieferant.UpdateArtikel( SalStrToNumber( GetKey(  ) ), FALSE )
.head 6 -  Call SetKey( STRING_Null, FALSE )
.head 3 +  Pushbutton: pbRowNew
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarNew
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: -0.017"
.head 5 -  Top: -0.01"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: new.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 7 -  Call SalHideWindow( hWndItem )
.head 5 -  ! ra 20141105 neue
.head 5 +  On SAM_Click ! wl 20160624 Referenz auf tblArtikel weg
.head 6 +  If nUserKuecheNr != NUMBER_Null
.head 7 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 8 -  ! Call Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr = :dlgArtikelLieferant.nAR_NR')
.head 8 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm, sAR_INTERN )
.head 6 +  Else 
.head 7 +  If SalMessageBox( Translate('Der Benutzer hat keine Kostenstelle, Zuordnung ist nicht möglich!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 +  ! On SAM_Click ! th 20160606: nur öffnene wenn nUserKuechenNr vorhanden
.head 6 +  If nUserKuecheNr != NUMBER_Null
.head 7 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 8 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm, tblArtikel.colAR_INTERN )
.head 6 +  Else 
.head 7 +  If SalMessageBox( Translate('Der Benutzer hat keine Kostenstelle, Zuordnung ist nicht möglich!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Return FALSE
.head 5 +  ! On SAM_Click ! th 20160427: AR_INTERN übergeben zwecks Titel
.head 6 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 7 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm, tblArtikel.colAR_INTERN )
.head 5 +  ! On SAM_Click ! th 20160322: cjArtikelZuordnung
.head 6 +  If NOT SalFindWindow( hWndForm, 'cjArtikelZuordnung' )
.head 7 -  Call SalCreateWindow( cjArtikelZuordnung, hWndForm)
.head 5 +  ! On SAM_Click ! th 20160302: funk InsertArtikel; neuer wp
.head 6 -  ! If dfLA_NR
.head 6 +  If nAR_NR
.head 7 +  If SalModalDialog( dlgAddArtikelLieferant, hWndForm, nAR_NR,nLA_NR2, nAL_KU_NR)
.head 8 -  Call tblArtLieferant.InsertArtikel( nLA_NR2, nAL_KU_NR, FALSE )
.head 5 +  ! On SAM_Click
.head 6 -  ! If dfLA_NR
.head 6 +  If nAR_NR
.head 7 +  If SalModalDialog(dlgAddArtikelLieferant, hWndForm, nAR_NR,nLA_NR2)
.head 8 -  Call tblArtLieferant.UpdateArtikel( nLA_NR2, FALSE )
.head 3 +  Pushbutton: pbRowDelete
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 0.583"
.head 5 -  Top: -0.01"
.head 5 -  Width:  0.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: delete.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click ! th20160628: paramSetInt für aktualisieren der Merkmale
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If IDOK = MessageBox( 'Zuordnung löschen ?', 'Lieferartikel-Zuordnung', MB_OkCancel )
.head 8 -  Call tblArtLieferant.InsertArtikel( tblArtLieferant.colLA_NR, tblArtLieferant.colKU_NR, TRUE )
.head 8 -  Call RefreshDependent ()
.head 5 +  ! On SAM_Click ! th20151106: Insert statt Update
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If IDOK = MessageBox( 'Zuordnung löschen ?', 'Lieferartikel-Zuordnung', MB_OkCancel )
.head 8 -  Call tblArtLieferant.InsertArtikel( tblArtLieferant.colLA_NR, tblArtLieferant.colKU_NR, TRUE )
.head 5 +  ! On SAM_Click
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If IDOK = MessageBox( 'Zuordnung löschen ?', 'Lieferartikel-Zuordnung', MB_OkCancel )
.head 8 -  Call tblArtLieferant.UpdateArtikel( tblArtLieferant.colLA_NR, TRUE )
.head 3 -  ! th 20151023
.head 3 +  Check Box: cbAlleKst
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: CheckUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Lieferartikel-Zuordnung für alle Kostenstellen anzeigen
.head 4 -  Window Location and Size
.head 5 -  Left: 1.4"
.head 5 -  Top: 0.031"
.head 5 -  Width:  5.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 +  If Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 7 -  Set MyValue = 1
.head 6 +  Else 
.head 7 -  Call SalHideWindow( hWndItem )
.head 5 -  ! On AM_INSERT
.head 5 -  ! On AM_UPDATE
.head 5 +  On SAM_Click
.head 6 -  Call dlgArtikelLieferant.OnPopulate( FALSE )
.head 3 +  Child Table: tblArtLieferant
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: -0.017"
.head 6 -  Top: 0.323"
.head 6 -  Width:  10.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? Yes
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colROWID
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'artikellieferart.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  Column: colAL_STD ! th 20160302: ShowOnly
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Std
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  Column: colAL_DEKLARATION
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ZH
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  Column: colAL_BLS
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: NW
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 +  Column: colAL_TAX
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Tax
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Create
.head 8 +  If NOT Benutzer.HatRecht(REC_LIEFERARTIKEL_ZUORDNUNG_ALL)
.head 9 -  Call SalDisableWindow( hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call EditableColumnsUpdaten( MyValue  )
.head 5 -  ! th 20151023
.head 5 +  Column: colKU_KOSTENSTELLE ! für ORDER BY
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KU_KOSTENSTELLE
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colKU_BEZEICHNUNG ! wird angezeigt
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Kst. der Zuordnung
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151118: (bs_)ku_nr Hilfsspalte für Färbung-> siehe On Sam_FetchRowDone
.head 5 +  Column: colKU_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AL_KU_NR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLI_LIEFERANT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Art.Nr.Lief.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikelname Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.317"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151105: verschiedene Lieferantenpreise pro lieferartikle möglich, daher Gebindepreis, 
	        Geb.Einheit, Geb.inhalt Anzeige sinnvoll
.head 5 -  ! th 20160302 zunächst keine Infos aus Lieferantenpreis
.head 5 +  ! ColShowOnly: colLP_GEBINDEPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colPreis 
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Preis pro GE
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE 
.head 8 -  ! On SAM_RowFetchDonecolLP_GEBINDEPREIS reinschreiben
.head 5 +  ! ColShowOnly: colLP_GEBINDEEINHEIT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLP_GEBINDEINHALT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_AUSLAUF
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLP_KEIN_EINKAUF
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLP_KUNDENPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLP_PREISLISTE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151028
.head 5 +  Column: colSB_NAME
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert von
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colAL_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am Datum/Uhrzeit
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colEK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: EK
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 -  ! th 20151104
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: classVarSetup
.head 6 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Sql Handle: p_hSql
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Return SqlVarSetup( p_hSql )
.head 5 +  Function: InsertArtikel ! th 20160628 bei delete taxierungen mitlöschen und ar_update setzen
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 7 -  Number: naAL_KU_NR[*]
.head 7 -  Number: naAL_LA_NR[*]
.head 7 -  Number: nInd
.head 7 -  Number: n
.head 7 +  Boolean: baCheckBox[4]
.head 8 -  ! Std; ZH; NW; Tax
.head 7 -  Boolean: bErsteZuordnung
.head 7 -  Boolean: bErsteZuordnungProKst
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  ! Set sStmt = 'DELETE FROM 
			artikeltaxierung
		WHERE
			at_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND 
			at_tu_nr IN (SELECT lt_tu_nr FROM lieferartikeltaxierung
				    WHERE  lt_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND
				    lt_la_nr NOT IN (SELECT al_la_nr
						  FROM  artikellieferart
						WHERE  al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_la_nr != ' || NumberToStrX( p_nLA_NR ) || ' ))'
.head 8 -  ! Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 8 -  Set sStmt = 'UPDATE artikel SET ar_update = SYSDATETIME WHERE ar_nr = ' || NumberToStrX( nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 +  Else 
.head 8 -  ! alle ku_nr laden für unterscheidung ob erster Eintrag überhaupt oder erster pro küche ..., la_nrs zur Sicherheit mit
.head 8 +  If Sql_ExecEx( hSql, 'SELECT al_ku_nr, al_la_nr INTO :naAL_KU_NR[n], :naAL_LA_NR[n] FROM artikellieferart WHERE al_ar_nr = ' || NumberToStrX( nAR_NR ), FALSE )
.head 9 +  While SqlFetchNext( hSql, nInd )
.head 10 -  Set n = n + 1
.head 8 -  Set bErsteZuordnung = SalArrayIsEmpty( naAL_KU_NR) 
.head 8 -  Set bErsteZuordnungProKst = ( VisArrayFindNumber( naAL_KU_NR, p_nAL_KU_NR) = -1 )
.head 8 -  ! CBs setzen: 
.head 8 -  ! - bei allererster Z. alle trut; bei erster pro Kst Std true
.head 8 -  ! Tax immer true
.head 8 -  Set baCheckBox[0] = bErsteZuordnung OR bErsteZuordnungProKst
.head 8 -  Set baCheckBox[1] = bErsteZuordnung
.head 8 -  Set baCheckBox[2] = bErsteZuordnung
.head 8 -  Set baCheckBox[3] = TRUE
.head 8 -  ! vor INSERT prüfen ob die Z. nicht schon existiert
.head 8 +  If ( -1 = VisArrayFindNumber( naAL_LA_NR, p_nLA_NR ))
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_deklaration, al_bls, al_tax ) 
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( baCheckBox[0]) || 
		' , ' || NumberToStrX( baCheckBox[1] ) || ' , ' || NumberToStrX( baCheckBox[2]) || ' , ' || NumberToStrX( baCheckBox[3]) ||' )'
.head 8 +  Else 
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 8 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  ! Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, nAR_NR )
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20160609: cbs setzen
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 7 -  Number: naAL_KU_NR[*]
.head 7 -  Number: naAL_LA_NR[*]
.head 7 -  Number: nInd
.head 7 -  Number: n
.head 7 +  Boolean: baCheckBox[4]
.head 8 -  ! Std; ZH; NW; Tax
.head 7 -  Boolean: bErsteZuordnung
.head 7 -  Boolean: bErsteZuordnungProKst
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 7 +  Else 
.head 8 -  ! alle ku_nr laden für unterscheidung ob erster Eintrag überhaupt oder erster pro küche ..., la_nrs zur Sicherheit mit
.head 8 +  If Sql_ExecEx( hSql, 'SELECT al_ku_nr, al_la_nr INTO :naAL_KU_NR[n], :naAL_LA_NR[n] FROM artikellieferart WHERE al_ar_nr = ' || NumberToStrX( nAR_NR ), FALSE )
.head 9 +  While SqlFetchNext( hSql, nInd )
.head 10 -  Set n = n + 1
.head 8 -  Set bErsteZuordnung = SalArrayIsEmpty( naAL_KU_NR) 
.head 8 -  Set bErsteZuordnungProKst = ( VisArrayFindNumber( naAL_KU_NR, p_nAL_KU_NR) = -1 )
.head 8 -  ! CBs setzen: 
.head 8 -  ! - bei allererster Z. alle trut; bei erster pro Kst Std true
.head 8 -  ! Tax immer true
.head 8 -  Set baCheckBox[0] = bErsteZuordnung OR bErsteZuordnungProKst
.head 8 -  Set baCheckBox[1] = bErsteZuordnung
.head 8 -  Set baCheckBox[2] = bErsteZuordnung
.head 8 -  Set baCheckBox[3] = TRUE
.head 8 -  ! vor INSERT prüfen ob die Z. nicht schon existiert
.head 8 +  If ( -1 = VisArrayFindNumber( naAL_LA_NR, p_nLA_NR ))
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_deklaration, al_bls, al_tax ) 
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( baCheckBox[0]) || 
		' , ' || NumberToStrX( baCheckBox[1] ) || ' , ' || NumberToStrX( baCheckBox[2]) || ' , ' || NumberToStrX( baCheckBox[3]) ||' )'
.head 8 +  Else 
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20160308: mit al_ku_nr
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Number: p_nAL_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR )
.head 7 +  Else 
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT 1 FROM artikellieferart WHERE al_la_nr = '|| NumberToStrX( p_nLA_NR )|| ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND al_ku_nr = ' || NumberToStrX( p_nAL_KU_NR ) )
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_bls, al_tax ) 
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( p_nAL_KU_NR ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( 0) || 
		' , ' || NumberToStrX(0) || ' , ' || NumberToStrX( 0) || ' )'
.head 8 +  Else 
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20151215:La kann nur einem Ar zugeordnet werden
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR )
.head 7 +  Else 
.head 8 +  If NOT Sql_FetchOne( hSql, 'SELECT 1 FROM artikellieferart WHERE al_la_nr = '|| NumberToStrX( p_nLA_NR ) )
.head 9 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_bls, al_tax ) 
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( nUserKuecheNr ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( 0) || 
		' , ' || NumberToStrX(0) || ' , ' || NumberToStrX( 0) || ' )'
.head 8 +  Else 
.head 9 -  Set bOk = NOT SalMessageBox('Der Lieferartikel ist bereits einem Basisartikel zugeordnet.', 'Zuordnung unzulässig', MB_IconExclamation|MB_Ok  )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: InsertArtikel ! th 20151030: nAR_NR statt nLA_NR weil es die AR_NR IST; umbernannt weil INSERT!; al_ku_nr korrigiert
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR )
.head 7 +  Else 
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART (al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update, al_std, al_bls, al_tax ) 
		VALUES ( ' || NumberToStrX( nAR_NR  ) || ' , ' || NumberToStrX( p_nLA_NR ) || ', ' || NumberToStrX( nUserKuecheNr ) || ' , ' || NumberToStrX( nUserNr ) || ' , SYSDATETIME, ' || NumberToStrX( 0) || 
		' , ' || NumberToStrX(0) || ' , ' || NumberToStrX( 0) || ' )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel ! th 20151030: nAR_NR statt nLA_NR weil es die AR_NR IST;
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nAR_NR ) || ' AND ' || GetKU_KU_NRWhere( 'al_ku_nr' )
.head 7 +  Else 
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART ( al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update ) 
		VALUES ( ' || NumberToStrX(nAR_NR  ) || ', ' || NumberToStrX( p_nLA_NR ) || ', :nUserKuecheNrMandant, :nUserNr, SYSDATETIME )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel ! ra 20141105 delete fixed
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_la_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_ar_nr = ' || NumberToStrX( nLA_NR ) || ' AND ' || GetKU_KU_NRWhere( 'al_ku_nr' )
.head 7 +  Else 
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART ( al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update ) 
		VALUES ( ' || NumberToStrX(nLA_NR  ) || ', ' || NumberToStrX( p_nLA_NR ) || ', :nUserKuecheNrMandant, :nUserNr, SYSDATETIME )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel	! wl 20140829 Lieferartikel
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nLA_NR
.head 7 -  Boolean: p_bDelete
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 +  If p_bDelete
.head 8 -  Set sStmt = 'DELETE FROM ARTIKELLIEFERART WHERE al_ar_nr = ' || NumberToStrX( p_nLA_NR ) || ' AND al_la_nr = ' || NumberToStrX( nLA_NR ) || ' AND ' || GetKU_KU_NRWhere( 'al_ku_nr' )
.head 7 +  Else 
.head 8 -  Set sStmt = 'INSERT INTO ARTIKELLIEFERART ( al_ar_nr, al_la_nr, al_ku_nr, al_sb_nr, al_update ) 
		VALUES ( ' || NumberToStrX(nLA_NR  ) || ', ' || NumberToStrX( p_nLA_NR ) || ', :nUserKuecheNrMandant, :nUserNr, SYSDATETIME )'
.head 8 -  ! Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  ! Function: UpdateArtikel
.head 6 -  Description: 
.head 6 +  Returns 
.head 7 -  Boolean: 
.head 6 +  Parameters 
.head 7 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Boolean: p_bDelete
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  !
.head 7 -  String: sStmt
.head 6 +  Actions 
.head 7 -  Set bOk = TRUE
.head 7 -  !
.head 7 -  Set sStmt = 'UPDATE artikel SET
		ar_ar_nr = ' || VisStrChoose( p_bDelete, 'NULL', NumberToStrX( nAR_NR ) ) || ',
		ar_sb_nr = :nUserNr, ar_update = SYSDATETIME
	WHERE
		ar_nr = ' || NumberToStrX( p_nAR_NR )
.head 7 -  Set bOk = bOk AND Sql_ExecAndCommit( hSql, sStmt )
.head 7 -  !
.head 7 -  Call SalSendMsg( hWndForm, AM_POPULATE, 0, 0 )
.head 7 -  !
.head 7 -  Return bOk
.head 5 +  Function: EditableColumnsUpdaten ! th20160608: mit Deklaration (ZH)
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col' 
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 ) 
.head 8 +  If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr das Flag al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else 
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME 
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 8 +  Else If sDBColumnName = 'AL_DEKLARATION'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_deklaration = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_deklaration = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_deklaration = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_deklaration = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_deklaration = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  ! soll auf obersten Eintrag springen wenn kein NW bei keiner anderen Zuordnung ausgewählt, d.h. wegen order by der Tabelle auf std =1 und MAX(ku_kostenstelle)
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart 
	        	  SET al_deklaration = 1, al_update = SYSDATETIME
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1 
	        	  AND al_ku_nr = (SELECT ku_nr 
	                	             FROM kueche 
		                           WHERE ku_kostenstelle = (SELECT MIN(k.ku_kostenstelle) 
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          ) 
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_deklaration = 0, al_update = SYSDATETIME  WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  ! soll auf obersten Eintrag springen wenn kein NW bei keiner anderen Zuordnung ausgewählt, d.h. wegen order by der Tabelle auf std =1 und MAX(ku_kostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE rowid = :colROWID' )
.head 10 -  ! Call Sql_Exec( hSql, 'UPDATE artikellieferart 
	        	  SET al_bls = 1, al_update = SYSDATETIME
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1 
	        	  AND al_ku_nr = (SELECT ku_nr 
	                	             FROM kueche 
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle) 
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          ) 
			             )')
.head 8 +  Else If sDBColumnName = 'AL_TAX'
.head 9 -  ! kann man neuerdings auch anderen Küchen weg nehmen
.head 9 -  ! If colKU_NR = nUserKuecheNr
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 7 +  Else 
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160310: wenn Kst. der Zuordnung die eigene ist darf Tax immer ausgewählt werden
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col' 
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 ) 
.head 8 +  If sDBColumnName = 'AL_TAX'
.head 9 -  ! bei eigener Küche immer checkbar, sonst nicht;
.head 9 +  If colKU_NR = nUserKuecheNr
.head 10 +  If p_bIsChecked
.head 11 -  ! dann den markierten setzen
.head 11 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 11 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 11 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 10 +  Else 
.head 11 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else 
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  ! Reihenfolge wichtig!!!
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME 
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  ! soll auf obersten Eintrag springen d.h. wegen order by der Tabelle auf std =1 und MAX(kukostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart 
	        	  SET al_bls = 1, al_update = GetDate()
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1 
	        	  AND al_ku_nr = (SELECT ku_nr 
	                	             FROM kueche 
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle) 
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          ) 
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 7 +  Else 
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160303: neue Regeln hier rein!
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: nRow
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: naKU_NR[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col' 
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 ) 
.head 8 +  If sDBColumnName = 'AL_TAX'
.head 9 -  ! tax je Ar-Zuordnung nur einmal setzbar
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_tax = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_tax = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_tax = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 +  Else If sDBColumnName = 'AL_STD'
.head 9 +  If p_bIsChecked
.head 10 -  ! in aktuelle Zeile al_std = 1 setzen und bei allen anderen Zeile mit gleicher al_ku_nr al_std = 0 setzen
.head 10 -  ! den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 1 AND al_la_nr != :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_std = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 9 +  Else 
.head 10 -  ! da ein eintrag std = 1 habe muss beim de-checken automatisch setzen
.head 10 -  ! Reihenfolge wichtig!!!
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 1, al_update = SYSDATETIME 
		  WHERE al_update = (SELECT MAX(x.al_update) FROM artikellieferart x WHERE x.al_ar_nr = :nAR_NR AND x.al_ku_nr = :tblArtLieferant.colKU_NR AND x.al_std = 0)')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_std = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 8 +  Else If sDBColumnName = 'AL_BLS'
.head 9 -  ! wird bei erster Zuordnung gesetzt, darf und muss je Artikel nur einmal vorkommen
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  ! soll auf obersten Eintrag springen d.h. wegen order by der Tabelle auf std =1 und MAX(kukostenstelle)
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart 
	        	  SET al_bls = 1, al_update = GetDate()
	                WHERE al_ar_nr = :nAR_NR AND al_std = 1 
	        	  AND al_ku_nr = (SELECT ku_nr 
	                	             FROM kueche 
		                           WHERE ku_kostenstelle = (SELECT MAX(k.ku_kostenstelle) 
					                        FROM kueche k
						          JOIN artikellieferart x ON x.al_ku_nr = k.ku_nr AND x.al_ar_nr = :nAR_NR
						          ) 
			             )')
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 0, al_update = SYSDATETIME  WHERE al_ar_nr = :nAR_NR AND al_la_nr  = :tblArtLieferant.colLA_NR AND al_ku_nr = :tblArtLieferant.colKU_NR' )
.head 7 +  Else 
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20160223: al_update updaten und RefreshDependent() raus weil läd zu lange
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  ! th: Fall von mehrfachen Lieferantenpreisen (nach wie vor) ungeklärt
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col' 
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 ) 
.head 8 +  If sDBColumnName = 'AL_BLS'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1, al_update = SYSDATETIME WHERE al_ar_nr = :nAR_NR AND al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0, al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 8 +  Else 
.head 9 +  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET '|| sDBColumnName ||' = :tblArtLieferant.' || sItemName ||', al_update = SYSDATETIME WHERE rowid = :colROWID' )
.head 10 -  ! tax oder std
.head 7 +  Else 
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  ! Call RefreshDependent(  )
.head 5 +  ! Function: EditableColumnsUpdaten ! th20151119 
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sItemName
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sDBColumnName
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 -  ! th: Fall von mehrfachen Lieferantenpreisen (nach wie vor) ungeklärt
.head 7 -  Call SalGetItemName( hWndItem, sItemName )
.head 7 +  If SalStrLeftX( sItemName, 3) = 'col' 
.head 8 -  Set sDBColumnName = SalStrMidX( sItemName, 3, SalStrLength( sItemName ) - 3 ) 
.head 8 +  If sDBColumnName = 'AL_BLS'
.head 9 +  If p_bIsChecked
.head 10 -  ! dann den markierten setzen
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET al_bls = 2 WHERE rowid = :colROWID' )
.head 10 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0 WHERE al_bls = 1 AND al_la_nr != :tblArtLieferant.colLA_NR' )
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 1 WHERE al_bls = 2 AND al_la_nr  = :tblArtLieferant.colLA_NR' )
.head 9 +  Else 
.head 10 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_bls = 0 WHERE rowid = :colROWID' )
.head 8 +  Else 
.head 9 +  Call Sql_Exec( hSql, 'UPDATE artikellieferart SET '|| sDBColumnName ||' = :tblArtLieferant.' || sItemName ||' WHERE rowid = :colROWID' )
.head 10 -  ! tax oder std
.head 7 +  Else 
.head 8 -  Return FALSE
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  Call RefreshDependent(  )
.head 5 +  ! Function: SetStandard ! th20151023: ohne colLA_MENGE usw.
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 +  If p_bIsChecked
.head 8 -  ! dann den markierten setzen
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 2 WHERE rowid = :colROWID' )
.head 8 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE al_std = 1 AND al_ar_nr = :nAR_NR' )
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1 WHERE al_std = 2 AND al_ar_nr = :nAR_NR' )
.head 8 -  ! dann den Lieferartikel updaten
.head 8 +  ! If colLA_MENGE
.head 9 -  Call Sql_Exec( hSql, 'UPDATE artikel  SET ar_ek = (:tblArtLieferant.colEK / :tblArtLieferant.colLA_MENGE) * ar_menge WHERE ar_nr = :nLA_NR' )
.head 7 +  Else 
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE rowid = :colROWID' )
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  Call RefreshDependent(  )
.head 5 +  ! Function: SetStandard
.head 6 -  Description: 
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Boolean: p_bIsChecked
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 +  If p_bIsChecked
.head 8 -  ! dann den markierten setzen
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 2 WHERE rowid = :colROWID' )
.head 8 -  ! dann alle wegnehmen, weil bei Gupta sich die ROWID ändert
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE al_std = 1 AND al_ar_nr = :nLA_NR' )
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 1 WHERE al_std = 2 AND al_ar_nr = :nLA_NR' )
.head 8 -  ! dann den Lieferartikel updaten
.head 8 +  If colLA_MENGE
.head 9 -  Call Sql_Exec( hSql, 'UPDATE artikel  SET ar_ek = (:tblArtLieferant.colEK / :tblArtLieferant.colLA_MENGE) * ar_menge WHERE ar_nr = :nLA_NR' )
.head 7 +  Else 
.head 8 -  Call Sql_Exec( hSql, 'UPDATE artikellieferart  SET al_std = 0 WHERE rowid = :colROWID' )
.head 7 -  Call Sql_Commit( hSql )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0,0)
.head 7 -  Call RefreshDependent(  )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE 	! th 20160311: Bereitstellung wird bei Neuanlage einer Zuordnung kontrolliert, hier unnötig; order by al_update desc; nicht bei std ordnen, nur bei kst.
.head 6 -  ! sWhereKuKst legt die Küchen fest, deren Zuordnungen man sehen darf (von der CheckBox beeinflusst..)
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart JOIN lieferartikel           ON al_la_nr = la_nr
                                                                JOIN kueche 	               ON al_ku_nr = ku_nr
			          	LEFT JOIN benutzer 	 ON sb_nr = al_sb_nr
			          	LEFT JOIN lieferant 	 ON li_nr = la_li_nr
			          	LEFT JOIN artikelme v 	 ON v.am_nr = LA_AM_NR
                                                    	LEFT JOIN artikelme l            ON l.am_nr = LA_LE_AM_NR
                                                 	LEFT JOIN artikelme g 	 ON g.am_nr = LA_GE_AM_NR', 
	    	                ' al_ar_nr = :nAR_NR' || sWhereKuKst, 
	                              ' ku_kostenstelle', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! th 20160201: ku_kostenstelle von bereitstellung anzeigen da al_ku_nr eh immer die UserKuNr ist; join kueche on al_ku_nr!!!; bs_ps_nr <=6 damit selbstverwaltete angezeigt werden; OR bs_datum IS NULL
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Call PopulateAndCount( hSql, 'artikellieferart JOIN lieferartikel           ON al_la_nr = la_nr
				        JOIN lieferbereitstellung ON la_nr = bs_la_nr AND bs_update = ( SELECT MAX( z.bs_update ) 
								                      		   FROM lieferbereitstellung z 
									                  	   WHERE         ( z.bs_ps_nr < 6 AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL))
												OR    ( z.bs_ps_nr = 6 AND ( z.bs_datumvon   > SYSDATETIME OR z.bs_datumvon IS NULL))
												AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
												ANd z.bs_la_nr = al_la_nr
											     )
                                                                JOIN kueche 	               ON al_ku_nr = ku_nr
			          	LEFT JOIN benutzer 	 ON sb_nr = al_sb_nr
			          	LEFT JOIN lieferant 	 ON li_nr = la_li_nr
			          	LEFT JOIN artikelme v 	 ON v.am_nr = LA_AM_NR
                                                    	LEFT JOIN artikelme l            ON l.am_nr = LA_LE_AM_NR
                                                 	LEFT JOIN artikelme g 	 ON g.am_nr = LA_GE_AM_NR
			              LEFT JOIN lieferantenpreis     ON lp_la_nr =  la_nr', 
	    	                ' al_ar_nr = :nAR_NR' || sWhereKuKst, 
	                              ' al_std DESC, ku_kostenstelle DESC', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! th 20151104: sWhereKuKst ; lieferbereitstellung weg
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart JOIN lieferartikel           ON al_la_nr = la_nr
                                                                JOIN kueche 	               ON al_ku_nr = ku_nr
			          	LEFT JOIN benutzer 	 ON sb_nr = al_sb_nr
			          	LEFT JOIN lieferant 	 ON li_nr = la_li_nr
			          	LEFT JOIN artikelme v 	 ON v.am_nr = LA_AM_NR
                                                    	LEFT JOIN artikelme l            ON l.am_nr = LA_LE_AM_NR
                                                 	LEFT JOIN artikelme g 	 ON g.am_nr = LA_GE_AM_NR
			              LEFT JOIN lieferantenpreis     ON lp_la_nr =  la_nr', 
	    	                ' al_ar_nr = :nAR_NR' || sWhereKuKst, 
	                              ' al_std DESC, ku_kostenstelle DESC', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! wl 20150131 auch Benutzer mit LEFT JOIN || sWhereLiKst
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart LEFT JOIN benutzer on sb_nr = al_sb_nr,
		lieferartikel
		LEFT JOIN lieferant ON li_nr = la_li_nr
		LEFT JOIN artikelme v on v.am_nr = LA_AM_NR
		LEFT JOIN artikelme l on l.am_nr = LA_LE_AM_NR
		LEFT JOIN artikelme g on g.am_nr = LA_GE_AM_NR', 
		'al_la_nr = la_nr AND al_ar_nr = :nLA_NR', 'la_intern', TBL_FillAll, nGlobalTemp )
.head 5 +  On SAM_FetchRowDone ! th 20160310: Spalte std, nw, tax rechtabh.; disable cell Tax wenn nicht eigenen küche
.head 6 +  If colKU_NR != nUserKuecheNr
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 7 -  Call MTblDisableCell(tblArtLieferant.colAL_TAX, lParam, TRUE) 
.head 5 +  ! On SAM_FetchRowDone ! th 20151204
.head 6 -  Set colPreis = StrAppend( NumberToStr( colLP_GEBINDEPREIS, 2 ), ' ' , '' )
.head 5 +  ! On SAM_FetchRowDone ! th 20151118: Zeile blau färben wenn die (BS_)KU_NR != UserKuNr
.head 6 +  If colKU_NR != nUserKuecheNr
.head 7 -  Call MTblSetRowTextColor( hWndForm, lParam, nColorDisabled, 0 )
.head 5 +  ! On SAM_FetchRowDone
.head 6 +  If colLA_GEBINDEINHALT * colLA_LAGEREINHEIT > 0
.head 7 -  Set colEK = colLA_GEBINDEPREIS/colLA_GEBINDEINHALT/colLA_LAGEREINHEIT
.head 5 +  ! On AM_POPULATE 
.head 6 -  Call PopulateAndCount( hSql, 'artikellieferart
		JOIN benutzer on sb_nr = al_sb_nr,
		lieferartikel
		LEFT JOIN lieferant ON li_nr = la_li_nr
		LEFT JOIN artikelme v on v.am_nr = LA_AM_NR
		LEFT JOIN artikelme l on l.am_nr = LA_LE_AM_NR
		LEFT JOIN artikelme g on g.am_nr = LA_GE_AM_NR', 
	'al_la_nr = la_nr AND al_ar_nr = :nLA_NR', 'la_intern', TBL_FillAll, nGlobalTemp )
.head 5 +  ! On AM_POPULATE 	! wl 20140829 Lieferartikel
.head 6 +  If Sql_FetchOne( hSql, 'SELECT * FROM artikel WHERE ar_nr = :dlgArtikelLieferant.nLA_NR AND ar_li_nr IS NULL' )
.head 7 -  Set bLieferant = FALSE
.head 7 -  Call SalSetWindowText( hWndForm, 'Lieferanten' )
.head 7 -  Call PopulateAndCount( hSql, 'artikellieferart,lieferartikel LEFT JOIN lieferant ON li_nr = la_li_nr', 'al_la_nr = la_nr AND la_nr = :nLA_NR', 'la_intern', TBL_FillAll, nGlobalTemp )
.head 6 +  Else 
.head 7 -  Set bLieferant = TRUE
.head 7 -  Call SalSetWindowText( hWndForm, 'Preise' )
.head 7 -  Call PopulateAndCount( hSql, 'artikel LEFT JOIN lieferant ON li_nr = ar_li_nr', 'ar_ar_nr = :nLA_NR', 'ar_intern', TBL_FillAll, nGlobalTemp )
.head 6 -  Set nUserKuecheNrMandant
.head 5 +  On AM_INSERT
.head 6 -  ! Wird von dlgAddArtikelLieferart mit w/lParam geschickt!
.head 6 +  If wParam AND lParam
.head 7 -  Call InsertArtikel( wParam, lParam, FALSE )
.head 2 +  Functions 
.head 3 +  Function: classVarSetup
.head 4 -  Description: Bindet Variablen an Fenster, wg. Bezügen

Implementieren: "Return SqlVarSetup( p_hSql )"
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Sql Handle: p_hSql
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Return SqlVarSetup( p_hSql )
.head 3 +  Function: classNotify		! wl 20160624 mit AR_INTERN
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else 
.head 8 -  Call OnPopulate( TRUE )
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT ar_ku_nr, ar_intern INTO :nGlobalTemp, :dlgArtikelLieferant.sAR_INTERN FROM artikel WHERE ar_nr = :nAR_NR')
.head 7 +  If nGlobalTemp != nUserKuecheNrMandant
.head 8 -  ! Artikel "blau"
.head 8 -  Call SalDisableWindow( pbRowNew)
.head 7 +  Else 
.head 8 -  ! Artikel "schwarz"
.head 8 -  Call SalEnableWindow( pbRowNew)
.head 3 +  ! Function: classNotify		! th 20160302: Enable/Disable von Neuanlage
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else 
.head 8 -  Call OnPopulate( TRUE )
.head 7 -  Call Sql_FetchOne( hSql, 'SELECT ar_ku_nr INTO :nGlobalTemp FROM artikel WHERE ar_nr = :nAR_NR')
.head 7 +  If nGlobalTemp != nUserKuecheNrMandant
.head 8 -  ! Artikel "blau"
.head 8 -  Call SalDisableWindow( pbRowNew)
.head 7 +  Else 
.head 8 -  ! Artikel "schwarz"
.head 8 -  Call SalEnableWindow( pbRowNew)
.head 3 +  ! Function: classNotify		! wl 20131223 mit Lieferant
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else 
.head 8 -  Call OnPopulate( TRUE )
.head 7 +  ! If oParamArtikel.GetLieferant(  )	! xxx wieso geht das nicht?
.head 8 -  Call SalSetWindowText( hWndForm, 'Preise' )
.head 7 +  ! Else
.head 8 -  Call SalSetWindowText( hWndForm, 'Lieferanten' )
.head 3 +  ! Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.Execute
.head 6 +  If p_hWndParent = wp_hWndParent
.head 7 +  Select Case ParamGetInt( p_nKey )
.head 8 +  Case ARTIKEL.Speichern
.head 9 -  ! Call Save(  )
.head 9 -  Break 
.head 5 +  Else If p_nKey = wp_nPARAM
.head 6 +  If IsParam( wp_nPARAM )
.head 7 +  If nAR_NR != ParamGetInt ( wp_nPARAM )
.head 8 -  Set nAR_NR = ParamGetInt ( wp_nPARAM )
.head 8 -  Call OnPopulate( FALSE )
.head 7 +  Else 
.head 8 -  Call OnPopulate( TRUE )
.head 3 +  Function: OnPopulate ! th 20160302: Zuordungs-Ku-Kst's hierarchisch nach oben, wen cb checked auch nach unten 
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nInd
.head 4 +  Actions 
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  Set nColorDisabled = COLOR_Blue
.head 6 -  ! für LA bei der die bereitstellungs-küche nicht die User-Küche ist
.head 5 +  If NOT p_bRefresh
.head 6 +  If sUserKst != STRING_Null
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellenEx( 'ku_kostenstelle', sUserKst, TRUE))
.head 7 +  Else 
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellenEx( 'ku_kostenstelle', sUserKst, FALSE))
.head 6 +  Else 
.head 7 +  Set sWhereKuKst = ''
.head 8 -  ! UserKüche hat keine Kostenstelle ?!
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate ! th 20151118: globale Variable nUserKst
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nInd
.head 4 +  Actions 
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  Set nColorDisabled = COLOR_Blue
.head 6 -  ! für LA bei der die bereitstellungs-küche nicht die User-Küche ist
.head 5 +  If NOT p_bRefresh
.head 6 +  If sUserKst != STRING_Null
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = '' 
.head 7 +  Else 
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) )
.head 6 +  Else 
.head 7 +  Set sWhereKuKst = ''
.head 8 -  ! UserKüche hat keine Kostenstelle ?!
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate ! th 20151105: nColorDisabled nach Vorbild tblArtikel; cbAlleKst: 0-> nach Kst-Logik, 1-> alle
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nInd
.head 4 +  Actions 
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  Set nColorDisabled = COLOR_Blue
.head 6 -  ! für lieferartikel die nicht der User-Küche zugeordnet sind
.head 5 +  If NOT p_bRefresh
.head 6 -  Call Sql_Exec( hSql, 'SELECT ku_kostenstelle INTO :dlgArtikelLieferant.sKU_KOSTENSTELLE FROM kueche WHERE ku_nr = ' || NumberToStrX ( GetKU_NR () ) )
.head 6 +  If SqlFetchNext( hSql , nInd ) AND sKU_KOSTENSTELLE != ''
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = '' 
.head 7 +  Else 
.head 8 -  Set sWhereKuKst = StrAppend( ' AND' , ' ' ,  GetWhereKostenstellen( 'ku_kostenstelle', sKU_KOSTENSTELLE ) )
.head 6 +  Else 
.head 7 +  Set sWhereKuKst = ''
.head 8 -  ! UserKüche hat keine Kostenstelle ?!
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate ! th 20151027 mit sWhereKuKst abh. von cbAlleKst
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nInd
.head 4 +  Actions 
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nAR_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT p_bRefresh
.head 6 -  Call Sql_Exec( hSql, 'SELECT ku_kostenstelle INTO :dlgArtikelLieferant.sKU_KOSTENSTELLE FROM kueche WHERE ku_nr = ' || NumberToStrX ( GetKU_NR () ) )
.head 6 +  If SqlFetchNext( hSql , nInd ) AND sKU_KOSTENSTELLE != ''
.head 7 -  Set sWhereKuKst = ' AND '
.head 7 +  If cbAlleKst
.head 8 -  Set sWhereKuKst = StrAppend( sWhereKuKst , ' ' ,  GetWhereKostenstellen( 'ku_kostenstelle', sKU_KOSTENSTELLE ) )
.head 7 +  Else 
.head 8 -  Set sWhereKuKst = sWhereKuKst || ' ku_kostenstelle = ' || sKU_KOSTENSTELLE
.head 6 +  Else 
.head 7 -  Set sWhereKuKst = ''
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  ! Function: OnPopulate
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Boolean: p_bRefresh
.head 6 -  ! nur Refresh (TRUE) oder anderer Artikel (FALSE)
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  ! ga 20090806: ungültiges Rezept nicht laden
.head 5 +  If nLA_NR = NUMBER_Null
.head 6 -  Return FALSE
.head 5 -  !
.head 5 +  If NOT p_bRefresh
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 6 -  Call SalSendMsgToChildren( hWndForm, AM_FETCH, 0, 0 )
.head 3 +  Function: RefreshDependent
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call ParamSetInt( PARAM.ChangedArtikelNr, nAR_NR )
.head 5 -  Call ParamSetInt( PARAM.ChangedArtikelNrLeseModus, nAR_NR )
.head 2 +  Window Parameters 
.head 3 -  Number: wp_nPARAM
.head 3 -  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables 
.head 3 +  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! th 20151030: Artikel der in Tabelle angeklickt wurde
.head 3 +  Number: nLA_NR2
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! th 20151030 neu zugeordneter Lieferartikel
.head 3 -  !
.head 3 -  FunctionalVar: oResizables
.winattr class
.head 4 -  Class: cObjResizables
.end
.head 3 -  ! cObjParamArtikel: oParamArtikel
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Boolean: bLieferant
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! th 20151023
.head 3 -  String: sKU_KOSTENSTELLE
.head 3 -  String: sKuKstHiererchieString
.head 3 -  String: sWhereKuKst
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! th 20151105
.head 3 -  Number: nColorDisabled
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: nAL_KU_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: sAR_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  ! Call SalSetWindowText( hWndForm, 'Lieferartikel-Zuordnung' )
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( tblArtLieferant, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 4 -  ! Call cmAR_INTERN.SetKey( NumberToStrX( wr_nAR_NR ), TRUE )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 4 -  ! Call oResizables.Resize( SalNumberLow( lParam ), SalNumberHigh( lParam ) )
.head 1 +  Dialog Box: _LieferArtikelLookup2
.head 2 -  Class: DialogLookup
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Class Default
.head 3 -  Horizontal Scroll? Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfFilterString
.head 4 -  Class Child Ref Key: 4
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogLookup
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Child Table: tblLookup
.head 4 -  Class Child Ref Key: 3
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogLookup
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colLA_INTERN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.175"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_KURZBEZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KurzBez
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.388"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_MENGE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Menge
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.713"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: #0
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_QUELLE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.525"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAM_KURZBEZ
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ME
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.775"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_SBLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BLS
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nr
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.763"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: Populate
.head 6 -  Description:
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sWhere
.head 6 +  Actions
.head 7 -  Set sWhere = PopulateGetFilter( dfFilterString )
.head 7 +  If sWhere
.head 8 -  Call SetNoData( FALSE, '', hWndNULL )
.head 8 -  !
.head 8 -  Set sWhere = StrAppend( sWhere, ' AND ', wp_sWhere ) || ' AND la_am_nr = am_nr AND ' || GetWhereArtikel( TRUE )
.head 8 -  Call PopulateTable( 'lieferartikel, artikelme', sWhere, 'la_intern' )
.head 7 +  Else
.head 8 -  Call SetNoData( TRUE, '', hWndNULL )
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On AM_POPULATE
.head 6 -  Call Populate(  )
.head 6 -  Call SalTblSetContext( hWndForm, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalTblSetRowFlags( hWndForm, SalTblQueryContext( hWndForm ), ROW_Selected, TRUE )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogLookup
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: Class Default
.head 5 -  Top: Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbEsc
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogLookup
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: Class Default
.head 5 -  Top: Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: classGetKey
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return NumberToStrX( tblLookup.colLA_NR )
.head 3 +  Function: classGetValue
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return tblLookup.colLA_INTERN
.head 2 +  Window Parameters
.head 3 -  Window Handle: wp_hWndComboLookup
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: wp_sKey
.head 3 -  String: wp_sValue
.head 3 -  String: wp_sChar
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: wp_sWhere
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call InitLookup( wp_hWndComboLookup, wp_sKey, wp_sValue, wp_sChar )
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 1 +  ! DialogOkEsc: dlgAddArtikelLieferant ! ra 20141105 neue
.winattr class Dialog Box:
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  8.525"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.573"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 -  ! ga 20080218: neue Klasse für Suchfelder
.head 3 +  Data Field: dfLA_INTERN
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.183"
.head 6 -  Top: 0.031"
.head 6 -  Width:  3.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 +  Pushbutton: pbOk
.winattr
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left: 5.488"
.head 5 -  Top: 4.115"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  ! ra 20141111 only if item selected
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 -  Set nLA_NR = tblArtLieferant.colLA_NR
.head 7 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbEsc
.winattr
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Abbrechen
.head 4 -  Window Location and Size
.head 5 -  Left: 6.788"
.head 5 -  Top: 4.115"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 -  Message Actions 
.head 3 +  Child Table: tblArtLieferant
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableAsListBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.15"
.head 6 -  Top: 0.375"
.head 6 -  Width:  8.188"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.531"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  ! ColShowOnly: colLA_STD
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_ANBRUCH
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_QUELLE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Quelle
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_DATUMVON
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: gültig von
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_DATUMBIS
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: gültig bis
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_EK
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_MENGE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Menge
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Intern
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE	! ra 20141111
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 
'la_nr' )
.head 5 +  ! On AM_POPULATE	! wl 20100311 mit cleanstring wegen umlaute
.head 6 +  If NOT (SalIsNull( dfLA_NR) AND SalIsNull( dfLA_INTERN)   )
.head 7 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 'la_nr LIKE \'' || SalNumberToStrX(dlgAddArtikelLieferant.dfLA_NR, 0) || '%\'
AND @UPPER(la_intern) LIKE \'' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'la_nr' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  Pushbutton: pbSuche
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ToolbarSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left: 4.588"
.head 5 -  Top: 0.031"
.head 5 -  Width:  0.457"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: search.bmp
.head 4 -  Picture Transparent Color: Magenta
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Flat Look
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  ! ga 20080218: neue Klasse für Suchfelder
.head 6 -  Call SalSendMsg( dfLA_INTERN, SAM_Validate, 0, 0 )
.head 6 -  ! Call SalSendMsg( tblBLS_Komponenten, AM_POPULATE, 0, 0 )
.head 2 +  Functions 
.head 3 +  Function: UpdateColumnTitles
.head 4 -  Description: ga 20130507: Spaltentitel gegen Inhaltskurzbez tauschen
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sStmt
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: hWndCol
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Actions 
.head 2 +  Window Parameters 
.head 3 -  Receive Number: nLA_NR
.head 2 -  Window Variables 
.head 2 +  Message Actions 
.head 3 +  On SAM_CreateComplete ! wl 20131109 im Header unterscheiden
.head 4 -  ! Set dfLA_NR = nLA_NR
.head 4 -  ! If nLA_NR != NUMBER_Null
.head 4 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 1 +  Dialog Box: dlgAddArtikelLieferant
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel zuordnen
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 14.688"
.head 4 -  Top: 1.552"
.head 4 -  Width:  11.783"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.938"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.1"
.head 6 -  Top: 0.042"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click ! th 20160512 AM_SAVE an tblArtLieferant
.head 7 -  Call SalSendMsg( dlgAddArtikelLieferant.tblArtLieferant, AM_SAVE, 0, 0)
.head 6 +  ! On SAM_Click
.head 7 +  If SalTblFindNextRow( dlgAddArtikelLieferant.blArtLieferant, nSelectedRow, ROW_Selected, 0) AND
	SalTblSetContext( tblArtLieferant, nSelectedRow)
.head 8 -  Call SalSendMsg( dlgArtikelLieferant.tblArtLieferant, AM_INSERT, tblArtLieferant.colLA_NR, oParamArtikelZuordnung.m_nKU_NR)
.head 7 -  Call SalDestroyWindow( wp_hWndParent )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.883"
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: Class Default
.head 6 -  Top: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Button Appearance: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblArtLieferant ! th 20151029 g'scheide Class + nur max(bs_update) bei vers. bereitst. eines lieferartikels
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.042"
.head 6 -  Width:  11.533"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.469"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colROWID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'lieferartikel.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  Column: colKU_BEZEICHNUNG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Kst. der Bereitstellung
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLI_LIEFERANT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Lieferant
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_LIEFID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Art.Nr.Lief.
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 50
.head 6 -  Data Type: String
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_INTERN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikelname Lieferant
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.617"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_ANBRUCH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: A
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBS_UPDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am Datum/Uhrzeit
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBS_KU_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BS_KU_NR
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: LA_NR
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Class Default
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 -  ! If MB_Ok = MessageBox( 'Diesen Preissatz als Standard für den Lieferartikel definieren?', 'Lieferartikel', MB_OkCancel )
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call SetStandard( MyValue  )
.head 5 +  ! ColShowOnly: colKU_KOSTENSTELLE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colPreis
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Preis pro LE
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE ! th 20151023: preis pro Einheit
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':tblArtLieferant.colPreis' )
.head 8 -  Set MyValue = StrAppend( MyValue , ' ' , '' )
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colSB_NAME
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! th 20151027 ohne am_populate da spalten noch nicht in DB ex.
.head 5 +  ! ColShowOnly: colNW_uebern
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colTAX_uebern
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colEK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: EK
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  ! Function: OnPopulate ! th 20160310: ku_hierarchie nur nach UNTEN!!!; nUserKuecheNr != NUMBER_Null; KU_BEZ != NULL
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sBereitstUndZuordnungsKuNr
.head 7 -  String: sWarnhinweis
.head 6 +  Actions
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr != NUMBER_Null
.head 9 +  If cmbKU_BEZEICHNUNG.GetKeyX () = NUMBER_Null
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  ! spezielle BS_KU ausgewählt
.head 10 -  Set sBereitstUndZuordnungsKuNr = NumberToStrX( cmbKU_BEZEICHNUNG.GetKeyX ())
.head 9 -  ! ku_nr aus kst-Hierarchie nach unten
.head 9 +  If sBereitstUndZuordnungsKuNr
.head 10 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
				             AND bs_update =  (SELECT MAX( x.bs_update)
							FROM lieferbereitstellung x
							WHERE x.bs_la_nr = la_nr
							AND ( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) )
							   OR  x.bs_ps_nr  = 6 ))
		        JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr = '||sBereitstUndZuordnungsKuNr || '
		LEFT JOIN lieferant ON la_li_nr = li_nr',
		  '(@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\')
		AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 9 +  Else
.head 10 -  Set sWarnhinweis = 'Keine Bereitstellungsküche ausgewählt!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 5 +  ! Function: OnPopulate ! th 20160201: bereits zugeordnete LA garnicht erst anzeigen; bs_ps_nr <= 6 dh. selbstverwaltete auch anzeigen
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sHierarchiePfadKuNrString
.head 7 -  String: sWarnhinweis
.head 6 +  Actions
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr
.head 9 -  Set sHierarchiePfadKuNrString = GetKstString( nUserKuecheNr, 'ku' )
.head 9 +  If sHierarchiePfadKuNrString
.head 10 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
				             AND bs_update =  (SELECT MAX( x.bs_update)
							FROM lieferbereitstellung x
							WHERE x.bs_la_nr = la_nr
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 6)
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| sHierarchiePfadKuNrString || ' )
		JOIN lieferant ON la_li_nr = li_nr',
		  '(@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\')
		AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 9 +  Else
.head 10 -  Set sWarnhinweis = 'Die Struktur der Küchen-Kostenstellen konnte nicht aufgelöst werden!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 5 -  ! th 20151116
.head 5 +  ! Function: OnPopulate
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sHierarchiePfadKuNrString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWarnhinweis
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr
.head 9 -  Set sHierarchiePfadKuNrString = GetKstString( nUserKuecheNr, 'ku' )
.head 9 +  If sHierarchiePfadKuNrString
.head 10 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
				             AND bs_update =  (SELECT MAX( x.bs_update)
							FROM lieferbereitstellung x
							WHERE x.bs_la_nr = la_nr
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 5)
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| sHierarchiePfadKuNrString || ' )    JOIN lieferant ON la_li_nr = li_nr',
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 9 +  Else
.head 10 -  Set sWarnhinweis = 'Die Struktur der Küchen-Kostenstellen konnte nicht aufgelöst werden!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 4 +  Window Variables
.head 5 -  Number: nSelectedRow
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Message Actions
.head 5 +  On AM_POPULATE	! th 20160615: stornierte jetzt doch anzeigen und hierarchiesch nach oben
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm ) ||'
	AND
		 NOT EXISTS (SELECT al_la_nr
			       FROM    artikellieferart
			       WHERE  al_la_nr = bs_la_nr )
	AND
		SYSDATETIME - bs_datumvon = (SELECT MIN(SYSDATETIME - x.bs_datumvon)
					      FROM     lieferbereitstellung x
					      WHERE    x.bs_la_nr = la_nr  AND
						       x.bs_ku_nr IN ( '|| GetKstStringEx( oParamArtikelZuordnung.m_nKU_NR, 'ku', FALSE ) ||') AND
						       SYSDATETIME - x.bs_datumvon >= 0 ) '
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
		 JOIN kueche ON bs_ku_nr = ku_nr
	       LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere, 'ku_kostenstelle' )
.head 6 -  Call MTblAutoSizeColumn( tblArtLieferant, hWndNULL, MTASC_ALLROWS)
.head 5 +  ! On AM_POPULATE	! th 20160610: la nicht anzeigen wenn auf höherer Kst aktuell storniert
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm ) ||'
	AND
		 NOT EXISTS (SELECT al_la_nr
			       FROM    artikellieferart
			       WHERE  al_la_nr = bs_la_nr )
	AND
		SYSDATETIME - bs_datumvon = (SELECT MIN(SYSDATETIME - x.bs_datumvon)
					      FROM     lieferbereitstellung x
					      WHERE    x.bs_la_nr = la_nr  AND
						       x.bs_ku_nr IN ( '|| GetKstStringEx( oParamArtikelZuordnung.m_nKU_NR, 'ku', FALSE ) ||') AND
						       SYSDATETIME - x.bs_datumvon >= 0 )
	AND
		bs_ps_nr != 9'
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
		 JOIN kueche ON bs_ku_nr = ku_nr
	       LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere, 'ku_kostenstelle' )
.head 6 -  Call MTblAutoSizeColumn( tblArtLieferant, hWndNULL, MTASC_ALLROWS)
.head 5 +  ! On AM_POPULATE	! th 20160427: where verschönert; Tbl autosize
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm ) ||' AND
		 NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr ) AND
		 bs_update =  (SELECT MAX( x.bs_update) FROM lieferbereitstellung x WHERE x.bs_la_nr = la_nr AND
				( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) ) OR
				x.bs_ps_nr = 6 ) AND x.bs_ku_nr = ku_nr ) '
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
		 JOIN kueche ON bs_ku_nr = ku_nr
	       LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere, 'ku_kostenstelle' )
.head 6 -  Call MTblAutoSizeColumn( tblArtLieferant, hWndNULL, MTASC_ALLROWS)
.head 5 +  ! On AM_POPULATE	! th 20160408: bei max( bs_update ) auch ku_nr ...
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm )
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
		JOIN kueche ON bs_ku_nr = ku_nr
	        LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere ||' AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr ) AND
					          bs_update =  (SELECT MAX( x.bs_update)
						      	   FROM lieferbereitstellung x
						                 WHERE x.bs_la_nr = la_nr AND
						             ( ( x.bs_ps_nr < 6 AND
							 ( x.bs_datumvon <= SYSDATETIME OR
							   x.bs_datumvon IS NULL) ) OR
							   x.bs_ps_nr = 6 ) AND
							   x.bs_ku_nr = ku_nr ) ', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE	! th 20160322: aus notify von WndForm
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm )
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr AND
				             bs_update =  (SELECT MAX( x.bs_update)
						      FROM lieferbereitstellung x
						      WHERE x.bs_la_nr = la_nr
						      AND ( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) )
						           OR  x.bs_ps_nr  = 6 ))
		  JOIN kueche ON bs_ku_nr = ku_nr
	        LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere ||' AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE	! wl 20151112 weniger Einschränkungen !?
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  ! If Benutzer.HatRecht( REC_KUECHE )
.head 8 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
				             AND bs_update =  (SELECT MAX( x.bs_update)
							FROM lieferbereitstellung x
							WHERE x.bs_la_nr = la_nr
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 5)
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr',
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 8 -  ! Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
				             AND bs_update =  (SELECT MAX( x.bs_update)
							FROM lieferbereitstellung x
							WHERE x.bs_la_nr = la_nr
							AND x.bs_datumvon <= SYSDATETIME
							AND x.bs_ps_nr <= 5)
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr',
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 +  If Benutzer.HatRecht( REC_KUECHE )
.head 9 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr
				             AND bs_update =  (SELECT MAX( x.bs_update)
							FROM lieferbereitstellung x
							WHERE x.bs_la_nr = la_nr
							AND x.bs_datumvon <= SYSDATETIME
							AND x.bs_ps_nr <= 5)
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr',
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  Call PopulateTable( 'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update =  (SELECT MAX( x.bs_update) FROM lieferbereitstellung x WHERE x.bs_la_nr = la_nr AND x.bs_datumvon <= SYSDATETIME AND x.bs_ps_nr <= 5)
JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr',
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  On SAM_DoubleClick ! th 20160701 Save beim WndForm
.head 6 -  Call SalSendMsg( hWndForm, AM_SAVE, SalWindowHandleToNumber( hWndItem ), 0 )
.head 5 +  ! On SAM_DoubleClick ! th 20160512: am_save an sich selbst
.head 6 -  Call SalSendMsg( hWndItem, AM_SAVE, 0, 0 )
.head 5 +  ! On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbSave, SAM_Click, 0, 0 )
.head 5 +  On AM_SAVE ! th 20160701 neue Konstanten nutzen; insert an parent
.head 6 -  Set nSelectedRow = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndItem, nSelectedRow, ROW_Selected, 0) AND
	SalTblSetContext( hWndItem, nSelectedRow)
.head 7 -  Call SalSendMsg( SalParentWindow( hWndItem), AM_INSERT, colLA_NR, oParamArtikelZuordnung.m_nKU_NR)
.head 5 +  ! On AM_SAVE
.head 6 -  Set nSelectedRow = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndItem, nSelectedRow, ROW_Selected, 0) AND
	SalTblSetContext( tblArtLieferant, nSelectedRow)
.head 7 -  Call SalSendMsg( dlgArtikelLieferant.tblArtLieferant, AM_INSERT, colLA_NR, oParamArtikelZuordnung.m_nKU_NR)
.head 6 -  Call SalDestroyWindow( wp_hWndParent )
.head 3 -  ! ga 20080218: neue Klasse für Suchfelder
.head 3 -  ! BackGroundText: Suche:
.head 3 +  ! DataFieldSearch: dfLA_INTERN
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 -  ! BackGroundText: Kst. der Bereitstellung:
.head 3 +  ! ComboKeyValue: cmbKU_BEZEICHNUNG
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! nur Küchen von nUserKuecheNr aus hierarchisch abwärts
.head 6 -  Set sKuKstStrHierarchischNurNachUnten = BuildKuechenStr ()
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKeyValue( 'ku_nr', 'ku_bezeichnung', 'kueche', ' ku_nr IN ('|| sKuKstStrHierarchischNurNachUnten ||')', 'ku_kostenstelle', FALSE)
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKey( nUserKuecheNr)
.head 5 +  ! On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 -  ! th 20151106: cmb+df für Auswahl der Zuordnungs-Küchen-Kostenstelle und automatischem füllen der al_ku_nr
.head 3 -  ! th 20160302: GetWhereKostenstellen nachempfunden
.head 3 +  ! TableAsListBox: tblArtLieferant ! th 20151028 gemäß gui...
.head 4 +  Contents
.head 5 +  Column: colROWID
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'lieferartikel.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 -  ! If MB_Ok = MessageBox( 'Diesen Preissatz als Standard für den Lieferartikel definieren?', 'Lieferartikel', MB_OkCancel )
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call SetStandard( MyValue  )
.head 5 +  Column: colKU_KOSTENSTELLE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLI_LIEFERANT
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_NR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_INTERN
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colPreis
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE ! th 20151023: preis pro Einheit
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':tblArtLieferant.colPreis' )
.head 8 -  Set MyValue = StrAppend( MyValue , ' ' , '' )
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_ANBRUCH
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colSB_NAME
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBS_UPDATE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 -  ! th 20151027 ohne am_populate da spalten noch nicht in DB ex.
.head 5 +  ! ColShowOnly: colNW_uebern
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colTAX_uebern
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colEK
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  Call PopulateTable( 'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_ps_nr  <=  5
			    JOIN kueche 	           ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )
			     JOIN lieferant 	            ON la_li_nr = li_nr',
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		 AND bs_datumvon <= SYSDATETIME AND bs_ps_nr <= 5
	 	 AND bs_update = ( SELECT MAX(bs_update) FROM  lieferartikel  JOIN lieferbereitstellung ON bs_la_nr = la_nr
		 					                         JOIN kueche ON ku_nr = bs_ku_nr
					 WHERE la_nr = al_la_nr AND BS_DATUMVON <= SYSDATETIME )', 'ku_kostenstelle' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! TableAsListBox: tblArtLieferant
.head 4 +  Contents
.head 5 +  ! ColShowOnly: colLA_STD
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_ANBRUCH
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_QUELLE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_INTERN
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_DATUMVON
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_DATUMBIS
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! ColShowOnly: colLA_EK
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_MENGE
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colLA_NR
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On AM_POPULATE	! ra 20141111
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 -  ! th: join auf Lieferbereitstellung mit Berücksichtigung des KU_Kstincl. Hierarchie und PS_NR >= 5
.head 7 +  If nUserKuecheNr
.head 8 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND
				  bs_ku_nr IN ( ' || GetKstString( nUserKuecheNr , 'ku' ) || ' ) AND
				  bs_ps_nr  >=  5 ',
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'',
'la_nr' )
.head 7 -  ! Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL',
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'',
'la_nr' )
.head 5 +  ! On AM_POPULATE	! wl 20100311 mit cleanstring wegen umlaute
.head 6 +  If NOT (SalIsNull( dfLA_NR) AND SalIsNull( dfLA_INTERN)   )
.head 7 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 'la_nr LIKE \'' || SalNumberToStrX(dlgAddArtikelLieferant.dfLA_NR, 0) || '%\'
AND @UPPER(la_intern) LIKE \'' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'la_nr' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! ToolbarSearch: pbSuche
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ga 20080218: neue Klasse für Suchfelder
.head 6 -  Call SalSendMsg( dfLA_INTERN, SAM_Validate, 0, 0 )
.head 6 -  ! Call SalSendMsg( tblBLS_Komponenten, AM_POPULATE, 0, 0 )
.head 2 +  Functions
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns
.head 4 +  Parameters
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmpSBLS
.head 5 -  Number: nTmpAR_NR
.head 4 +  Actions
.head 5 +  If p_nKey = PARAM.ChangedArtikelZuordnungFilter
.head 6 +  If ParamGetData( p_nKey, oParamArtikelZuordnung ) AND oParamArtikelZuordnung.m_nKU_NR != NUMBER_Null
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0)
.head 3 +  ! Function: UpdateColumnTitles
.head 4 -  Description: ga 20130507: Spaltentitel gegen Inhaltskurzbez tauschen
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sStmt
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: hWndCol
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Actions
.head 3 +  ! Function: FindKuechenLevel
.head 4 -  Description: Findet das Küchen-Level :-D
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: p_sKSTID
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLevel
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Set nLevel = 1
.head 5 +  While nLevel < 5
.head 6 +  If SalStrMidX( p_sKSTID, 3*nLevel, 3) = '000'
.head 7 -  Return nLevel
.head 6 +  Else
.head 7 -  Set nLevel = nLevel + 1
.head 5 -  Return 5
.head 3 +  ! Function: BuildKuechenStr
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sWhere
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions
.head 5 -  Set sWhere = 'ku_kostenstelle = :sUserKst'
.head 5 +  Select Case FindKuechenLevel( sUserKst)
.head 6 +  Case 1
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 3)||'%\''
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 6)||'%\''
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 9)||'%\''
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 12)||'%\''
.head 7 -  Break
.head 6 +  Case 5
.head 7 -  Break
.head 6 +  Default
.head 7 +  If SalMessageBox( Translate('Küchen-Kostenstelle fehlerhaft!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Break
.head 5 -  Call Sql_ExecEx( hSql, 'SELECT ku_nr INTO :nGlobalTemp FROM kueche WHERE '|| sWhere ||' ORDER BY ku_kostenstelle', FALSE)
.head 5 +  While SqlFetchNext( hSql, nInd)
.head 6 -  Set sReturn = StrAppend( sReturn, ', ', NumberToStrX( nGlobalTemp))
.head 5 -  Return sReturn
.head 2 +  Window Parameters
.head 3 -  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! Number: wp_nAR_NR
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oParamArtikelZuordnung = OBJ_Null
.head 4 -  Class: cObjParamArtikelZuordnung
.head 3 -  String: sWhere
.head 3 -  FunctionalVar: oResizables
.head 4 -  Class: cObjResizables
.head 3 +  String: saZuordnung[3]
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! Elemente: 0-AL_LA_NR; 1-AL_KU_NR; 2-Handle des Zuordnung-Fensters (damit es in bei Richtigem Artikel eingetragen wird)
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( tblArtLieferant, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 3 +  ! On SAM_CreateComplete ! wl 20131109 im Header unterscheiden
.head 4 -  ! Set dfLA_NR = nLA_NR
.head 4 -  ! If nLA_NR != NUMBER_Null
.head 4 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 +  On AM_INSERT
.head 4 -  Set saZuordnung[0] = NumberToStrX( wParam )
.head 4 -  Set saZuordnung[1] = NumberToStrX( lParam )
.head 4 -  Set saZuordnung[2] = NumberToStrX( SalWindowHandleToNumber( wp_hWndParent) )
.head 4 -  Call ParamSetArray( PARAM.Zuordnung, saZuordnung)
.head 4 -  Call SalDestroyWindow( wp_hWndParent )
.head 1 +  ! InsertBox: dlgAddArtikelLieferant 
.winattr class Dialog Box:
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel zuordnen
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 14.688"
.head 4 -  Top: 1.552"
.head 4 -  Width:  11.783"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.938"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.365"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 +  Contents 
.head 4 +  Pushbutton: pbNew
.winattr
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbSave
.winattr
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.1"
.head 6 -  Top: 0.042"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 +  Message Actions 
.head 6 +  On SAM_Click ! th 20160512 AM_SAVE an tblArtLieferant
.head 7 -  Call SalSendMsg( dlgAddArtikelLieferant.tblArtLieferant, AM_SAVE, 0, 0)
.head 6 +  ! On SAM_Click
.head 7 +  If SalTblFindNextRow( dlgAddArtikelLieferant.blArtLieferant, nSelectedRow, ROW_Selected, 0) AND
	SalTblSetContext( tblArtLieferant, nSelectedRow)
.head 8 -  Call SalSendMsg( dlgArtikelLieferant.tblArtLieferant, AM_INSERT, tblArtLieferant.colLA_NR, oParamArtikelZuordnung.m_nKU_NR)  
.head 7 -  Call SalDestroyWindow( wp_hWndParent )
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbDelete
.winattr
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.883"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.end
.head 5 -  Message Actions 
.head 2 +  Contents 
.head 3 +  Child Table: tblArtLieferant ! th 20151029 g'scheide Class + nur max(bs_update) bei vers. bereitst. eines lieferartikels
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.042"
.head 6 -  Width:  11.533"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.469"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colROWID
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'lieferartikel.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  Column: colKU_BEZEICHNUNG
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Kst. der Bereitstellung
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLI_LIEFERANT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_LIEFID
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Art.Nr.Lief.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 50
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikelname Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_ANBRUCH
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: A
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colBS_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am Datum/Uhrzeit
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colBS_KU_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BS_KU_NR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: LA_NR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Click
.head 8 -  ! If MB_Ok = MessageBox( 'Diesen Preissatz als Standard für den Lieferartikel definieren?', 'Lieferartikel', MB_OkCancel )
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call SetStandard( MyValue  )
.head 5 +  ! ColShowOnly: colKU_KOSTENSTELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colPreis 
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Preis pro LE
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE ! th 20151023: preis pro Einheit
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':tblArtLieferant.colPreis' )
.head 8 -  Set MyValue = StrAppend( MyValue , ' ' , '' )
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colSB_NAME
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151027 ohne am_populate da spalten noch nicht in DB ex. 
.head 5 +  ! ColShowOnly: colNW_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colTAX_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colEK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: EK
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  ! Function: OnPopulate ! th 20160310: ku_hierarchie nur nach UNTEN!!!; nUserKuecheNr != NUMBER_Null; KU_BEZ != NULL
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sBereitstUndZuordnungsKuNr
.head 7 -  String: sWarnhinweis
.head 6 +  Actions 
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr != NUMBER_Null
.head 9 +  If cmbKU_BEZEICHNUNG.GetKeyX () = NUMBER_Null
.head 10 -  Return FALSE
.head 9 +  Else 
.head 10 -  ! spezielle BS_KU ausgewählt
.head 10 -  Set sBereitstUndZuordnungsKuNr = NumberToStrX( cmbKU_BEZEICHNUNG.GetKeyX ())
.head 9 -  ! ku_nr aus kst-Hierarchie nach unten
.head 9 +  If sBereitstUndZuordnungsKuNr
.head 10 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) )
							   OR  x.bs_ps_nr  = 6 )) 
		        JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr = '||sBereitstUndZuordnungsKuNr || '    
		LEFT JOIN lieferant ON la_li_nr = li_nr', 
		  '(@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\')
		AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 9 +  Else 
.head 10 -  Set sWarnhinweis = 'Keine Bereitstellungsküche ausgewählt!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 5 +  ! Function: OnPopulate ! th 20160201: bereits zugeordnete LA garnicht erst anzeigen; bs_ps_nr <= 6 dh. selbstverwaltete auch anzeigen
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sHierarchiePfadKuNrString
.head 7 -  String: sWarnhinweis
.head 6 +  Actions 
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr
.head 9 -  Set sHierarchiePfadKuNrString = GetKstString( nUserKuecheNr, 'ku' )
.head 9 +  If sHierarchiePfadKuNrString
.head 10 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 6)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| sHierarchiePfadKuNrString || ' )    
		JOIN lieferant ON la_li_nr = li_nr', 
		  '(@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\')
		AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 9 +  Else 
.head 10 -  Set sWarnhinweis = 'Die Struktur der Küchen-Kostenstellen konnte nicht aufgelöst werden!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 5 -  ! th 20151116
.head 5 +  ! Function: OnPopulate
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sHierarchiePfadKuNrString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWarnhinweis
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr
.head 9 -  Set sHierarchiePfadKuNrString = GetKstString( nUserKuecheNr, 'ku' )
.head 9 +  If sHierarchiePfadKuNrString
.head 10 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| sHierarchiePfadKuNrString || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 9 +  Else 
.head 10 -  Set sWarnhinweis = 'Die Struktur der Küchen-Kostenstellen konnte nicht aufgelöst werden!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 4 +  Window Variables 
.head 5 -  Number: nSelectedRow
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE	! th 20160615: stornierte jetzt doch anzeigen und hierarchiesch nach oben
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm ) ||' 
	AND
		 NOT EXISTS (SELECT al_la_nr 
			       FROM    artikellieferart 
			       WHERE  al_la_nr = bs_la_nr ) 
	AND
		SYSDATETIME - bs_datumvon = (SELECT MIN(SYSDATETIME - x.bs_datumvon) 
					      FROM     lieferbereitstellung x
					      WHERE    x.bs_la_nr = la_nr  AND
						       x.bs_ku_nr IN ( '|| GetKstStringEx( oParamArtikelZuordnung.m_nKU_NR, 'ku', FALSE ) ||') AND
						       SYSDATETIME - x.bs_datumvon >= 0 ) '
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr     
		 JOIN kueche ON bs_ku_nr = ku_nr
	       LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere, 'ku_kostenstelle' )
.head 6 -  Call MTblAutoSizeColumn( tblArtLieferant, hWndNULL, MTASC_ALLROWS) 
.head 5 +  ! On AM_POPULATE	! th 20160610: la nicht anzeigen wenn auf höherer Kst aktuell storniert
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm ) ||' 
	AND
		 NOT EXISTS (SELECT al_la_nr 
			       FROM    artikellieferart 
			       WHERE  al_la_nr = bs_la_nr ) 
	AND
		SYSDATETIME - bs_datumvon = (SELECT MIN(SYSDATETIME - x.bs_datumvon) 
					      FROM     lieferbereitstellung x
					      WHERE    x.bs_la_nr = la_nr  AND
						       x.bs_ku_nr IN ( '|| GetKstStringEx( oParamArtikelZuordnung.m_nKU_NR, 'ku', FALSE ) ||') AND
						       SYSDATETIME - x.bs_datumvon >= 0 ) 
	AND
		bs_ps_nr != 9'
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr     
		 JOIN kueche ON bs_ku_nr = ku_nr
	       LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere, 'ku_kostenstelle' )
.head 6 -  Call MTblAutoSizeColumn( tblArtLieferant, hWndNULL, MTASC_ALLROWS) 
.head 5 +  ! On AM_POPULATE	! th 20160427: where verschönert; Tbl autosize
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm ) ||' AND
		 NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr ) AND
		 bs_update =  (SELECT MAX( x.bs_update) FROM lieferbereitstellung x WHERE x.bs_la_nr = la_nr AND 
				( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) ) OR  
				x.bs_ps_nr = 6 ) AND x.bs_ku_nr = ku_nr ) '
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr     
		 JOIN kueche ON bs_ku_nr = ku_nr
	       LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere, 'ku_kostenstelle' )
.head 6 -  Call MTblAutoSizeColumn( tblArtLieferant, hWndNULL, MTASC_ALLROWS) 
.head 5 +  ! On AM_POPULATE	! th 20160408: bei max( bs_update ) auch ku_nr ...
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm )
.head 6 -  Call PopulateTable( 'lieferartikel
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr     
		JOIN kueche ON bs_ku_nr = ku_nr
	        LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere ||' AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr ) AND
					          bs_update =  (SELECT MAX( x.bs_update) 
						      	   FROM lieferbereitstellung x 
						                 WHERE x.bs_la_nr = la_nr AND 
						             ( ( x.bs_ps_nr < 6 AND 
							 ( x.bs_datumvon <= SYSDATETIME OR 
							   x.bs_datumvon IS NULL) ) OR  
							   x.bs_ps_nr = 6 ) AND
							   x.bs_ku_nr = ku_nr ) ', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE	! th 20160322: aus notify von WndForm
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm )
.head 6 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr AND
				             bs_update =  (SELECT MAX( x.bs_update) 
						      FROM lieferbereitstellung x 
						      WHERE x.bs_la_nr = la_nr 
						      AND ( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) )
						           OR  x.bs_ps_nr  = 6 )) 
		  JOIN kueche ON bs_ku_nr = ku_nr    
	        LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere ||' AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE	! wl 20151112 weniger Einschränkungen !?
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  ! If Benutzer.HatRecht( REC_KUECHE )
.head 8 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 8 -  ! Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND x.bs_datumvon <= SYSDATETIME 
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 +  If Benutzer.HatRecht( REC_KUECHE )
.head 9 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND x.bs_datumvon <= SYSDATETIME 
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  Call PopulateTable( 'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update =  (SELECT MAX( x.bs_update) FROM lieferbereitstellung x WHERE x.bs_la_nr = la_nr AND x.bs_datumvon <= SYSDATETIME AND x.bs_ps_nr <= 5)  
JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  On SAM_DoubleClick ! th 20160512: am_save an sich selbst
.head 6 -  Call SalSendMsg( hWndItem, AM_SAVE, 0, 0 )
.head 5 +  ! On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbSave, SAM_Click, 0, 0 )
.head 5 +  On AM_SAVE
.head 6 -  Set nSelectedRow = TBL_MinRow
.head 6 +  If SalTblFindNextRow( hWndItem, nSelectedRow, ROW_Selected, 0) AND
	SalTblSetContext( tblArtLieferant, nSelectedRow)
.head 7 -  Call SalSendMsg( dlgArtikelLieferant.tblArtLieferant, AM_INSERT, colLA_NR, oParamArtikelZuordnung.m_nKU_NR)  
.head 6 -  Call SalDestroyWindow( wp_hWndParent )
.head 3 -  ! ga 20080218: neue Klasse für Suchfelder
.head 3 -  ! BackGroundText: Suche:
.head 3 +  ! DataFieldSearch: dfLA_INTERN
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 -  ! BackGroundText: Kst. der Bereitstellung: 
.head 3 +  ! ComboKeyValue: cmbKU_BEZEICHNUNG
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! nur Küchen von nUserKuecheNr aus hierarchisch abwärts
.head 6 -  Set sKuKstStrHierarchischNurNachUnten = BuildKuechenStr ()
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKeyValue( 'ku_nr', 'ku_bezeichnung', 'kueche', ' ku_nr IN ('|| sKuKstStrHierarchischNurNachUnten ||')', 'ku_kostenstelle', FALSE)  
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKey( nUserKuecheNr)
.head 5 +  ! On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 -  ! th 20151106: cmb+df für Auswahl der Zuordnungs-Küchen-Kostenstelle und automatischem füllen der al_ku_nr
.head 3 -  ! th 20160302: GetWhereKostenstellen nachempfunden
.head 3 +  ! TableAsListBox: tblArtLieferant ! th 20151028 gemäß gui...
.head 4 +  Contents 
.head 5 +  Column: colROWID
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'lieferartikel.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Click
.head 8 -  ! If MB_Ok = MessageBox( 'Diesen Preissatz als Standard für den Lieferartikel definieren?', 'Lieferartikel', MB_OkCancel )
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call SetStandard( MyValue  )
.head 5 +  Column: colKU_KOSTENSTELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLI_LIEFERANT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colPreis 
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE ! th 20151023: preis pro Einheit
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':tblArtLieferant.colPreis' )
.head 8 -  Set MyValue = StrAppend( MyValue , ' ' , '' )
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_ANBRUCH
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colSB_NAME
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colBS_UPDATE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151027 ohne am_populate da spalten noch nicht in DB ex. 
.head 5 +  ! ColShowOnly: colNW_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colTAX_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colEK
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  Call PopulateTable( 'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_ps_nr  <=  5 
			    JOIN kueche 	           ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' ) 
			     JOIN lieferant 	            ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		 AND bs_datumvon <= SYSDATETIME AND bs_ps_nr <= 5
	 	 AND bs_update = ( SELECT MAX(bs_update) FROM  lieferartikel  JOIN lieferbereitstellung ON bs_la_nr = la_nr 
		 					                         JOIN kueche ON ku_nr = bs_ku_nr
					 WHERE la_nr = al_la_nr AND BS_DATUMVON <= SYSDATETIME )', 'ku_kostenstelle' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! TableAsListBox: tblArtLieferant
.head 4 +  Contents 
.head 5 +  ! ColShowOnly: colLA_STD
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_ANBRUCH
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_EK
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE	! ra 20141111
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 -  ! th: join auf Lieferbereitstellung mit Berücksichtigung des KU_Kstincl. Hierarchie und PS_NR >= 5 
.head 7 +  If nUserKuecheNr
.head 8 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND
				  bs_ku_nr IN ( ' || GetKstString( nUserKuecheNr , 'ku' ) || ' ) AND 
				  bs_ps_nr  >=  5 ', 
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 
'la_nr' )
.head 7 -  ! Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 
'la_nr' )
.head 5 +  ! On AM_POPULATE	! wl 20100311 mit cleanstring wegen umlaute
.head 6 +  If NOT (SalIsNull( dfLA_NR) AND SalIsNull( dfLA_INTERN)   )
.head 7 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 'la_nr LIKE \'' || SalNumberToStrX(dlgAddArtikelLieferant.dfLA_NR, 0) || '%\'
AND @UPPER(la_intern) LIKE \'' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'la_nr' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! ToolbarSearch: pbSuche
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  ! ga 20080218: neue Klasse für Suchfelder
.head 6 -  Call SalSendMsg( dfLA_INTERN, SAM_Validate, 0, 0 )
.head 6 -  ! Call SalSendMsg( tblBLS_Komponenten, AM_POPULATE, 0, 0 )
.head 2 +  Functions 
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmpSBLS
.head 5 -  Number: nTmpAR_NR
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.ChangedArtikelZuordnungFilter
.head 6 +  If ParamGetData( p_nKey, oParamArtikelZuordnung )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0)
.head 3 +  ! Function: UpdateColumnTitles
.head 4 -  Description: ga 20130507: Spaltentitel gegen Inhaltskurzbez tauschen
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sStmt
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: hWndCol
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Actions 
.head 3 +  ! Function: FindKuechenLevel
.head 4 -  Description: Findet das Küchen-Level :-D
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  String: p_sKSTID
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nLevel
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set nLevel = 1
.head 5 +  While nLevel < 5
.head 6 +  If SalStrMidX( p_sKSTID, 3*nLevel, 3) = '000'
.head 7 -  Return nLevel
.head 6 +  Else 
.head 7 -  Set nLevel = nLevel + 1
.head 5 -  Return 5
.head 3 +  ! Function: BuildKuechenStr
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sWhere = 'ku_kostenstelle = :sUserKst'
.head 5 +  Select Case FindKuechenLevel( sUserKst)
.head 6 +  Case 1
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 3)||'%\''   
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 6)||'%\''   
.head 7 -  Break 
.head 6 +  Case 3
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 9)||'%\''   
.head 7 -  Break 
.head 6 +  Case 4
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 12)||'%\''   
.head 7 -  Break 
.head 6 +  Case 5
.head 7 -  Break 
.head 6 +  Default 
.head 7 +  If SalMessageBox( Translate('Küchen-Kostenstelle fehlerhaft!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Break 
.head 5 -  Call Sql_ExecEx( hSql, 'SELECT ku_nr INTO :nGlobalTemp FROM kueche WHERE '|| sWhere ||' ORDER BY ku_kostenstelle', FALSE)
.head 5 +  While SqlFetchNext( hSql, nInd) 
.head 6 -  Set sReturn = StrAppend( sReturn, ', ', NumberToStrX( nGlobalTemp))
.head 5 -  Return sReturn
.head 2 +  Window Parameters 
.head 3 -  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! Number: wp_nAR_NR
.head 2 +  Window Variables 
.head 3 -  FunctionalVar: oParamArtikelZuordnung = OBJ_Null
.winattr class
.head 4 -  Class: cObjParamArtikelZuordnung
.end
.head 3 -  String: sWhere
.head 3 -  FunctionalVar: oResizables
.winattr class
.head 4 -  Class: cObjResizables
.end
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( tblArtLieferant, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 3 +  ! On SAM_CreateComplete ! wl 20131109 im Header unterscheiden
.head 4 -  ! Set dfLA_NR = nLA_NR
.head 4 -  ! If nLA_NR != NUMBER_Null
.head 4 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 1 +  ! DialogOkEsc: dlgAddArtikelLieferant 
.winattr class Dialog Box:
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Lieferartikel zuordnen
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: 14.688"
.head 4 -  Top: 1.552"
.head 4 -  Width:  11.817"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.0"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Pushbutton: pbOk
.winattr
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left: 0.117"
.head 5 -  Top: 0.042"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 -  Call SalSendMsg( dlgArtikelLieferant.tblArtLieferant, AM_INSERT, tblArtLieferant.colLA_NR, oParamArtikelZuordnung.m_nKU_NR)  
.head 6 -  Call SalDestroyWindow( wp_hWndParent )
.head 5 +  ! On SAM_Click ! th 20160309: al_ku_nr setzen
.head 6 -  ! ra 20141111 only if item selected
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If Sql_FetchOne( hSql, 'SELECT 1 
		      FROM    artikellieferart 
		      WHERE            al_ar_nr = :dlgAddArtikelLieferant.wp_nAR_NR 
			    AND    al_la_nr = :dlgAddArtikelLieferant.tblArtLieferant.colLA_NR
			    AND ( al_ku_nr = '||NumberToStrX( cmbKU_BEZEICHNUNG.GetKeyX () )||')' )
.head 8 -  Call MessageBox( Translate('Zuordnung existiert bereits!'), Translate('Lieferartikel zuordnen'), MB_Ok )
.head 7 +  Else 
.head 8 -  Set nLA_NR = tblArtLieferant.colLA_NR
.head 8 -  Set wr_nAL_KU_NR = cmbKU_BEZEICHNUNG.GetKeyX ()
.head 8 -  Call SalEndDialog( hWndForm, TRUE )
.head 5 +  ! On SAM_Click ! th 20151118: Abfrage für MessageBox auf al_ku_nr 
.head 6 -  ! ra 20141111 only if item selected
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If Sql_FetchOne( hSql, 'SELECT 1 
		      FROM    artikellieferart 
		      WHERE            al_ar_nr = :dlgAddArtikelLieferant.wp_nAR_NR 
			    AND    al_la_nr = :dlgAddArtikelLieferant.tblArtLieferant.colLA_NR
			    AND ( al_ku_nr = :dlgAddArtikelLieferant.tblArtLieferant.colBS_KU_NR )' )
.head 8 -  Call MessageBox( Translate('Zuordnung existiert bereits!'), Translate('Lieferartikel zuordnen'), MB_Ok )
.head 7 +  Else 
.head 8 -  Set nLA_NR = tblArtLieferant.colLA_NR
.head 8 -  Set wr_nAL_KU_NR = tblArtLieferant.colBS_KU_NR
.head 8 -  Call SalEndDialog( hWndForm, TRUE )
.head 5 +  ! On SAM_Click ! th 20151030: Dialog nur schließen wenn Zuornung noch nicht ex. erfolgreich! 
.head 6 -  ! ra 20141111 only if item selected
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 +  If Sql_FetchOne( hSql, 'SELECT 1 FROM artikellieferart WHERE  al_ar_nr = :dlgAddArtikelLieferant.wp_nAR_NR AND al_la_nr = :dlgAddArtikelLieferant.tblArtLieferant.colLA_NR' )
.head 8 -  Call MessageBox( Translate('Zuordnung existiert bereits!'), Translate('Lieferartikel zuordnen'), MB_Ok )
.head 7 +  Else 
.head 8 -  Set nLA_NR = tblArtLieferant.colLA_NR
.head 8 -  ! Set nAL_KU_NR = tblArtLieferant.
.head 8 -  Call SalEndDialog( hWndForm, TRUE )
.head 5 +  ! On SAM_Click
.head 6 -  ! ra 20141111 only if item selected
.head 6 +  If SalTblAnyRows(tblArtLieferant, ROW_Selected, 0)
.head 7 -  Set nLA_NR = tblArtLieferant.colLA_NR
.head 7 -  Call SalEndDialog( hWndForm, TRUE )
.head 3 +  Pushbutton: pbEsc
.winattr
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Abbrechen
.head 4 -  Window Location and Size
.head 5 -  Left: 1.367"
.head 5 -  Top: 0.042"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( wp_hWndParent )
.head 3 +  Child Table: tblArtLieferant ! th 20151029 g'scheide Class + nur max(bs_update) bei vers. bereitst. eines lieferartikels
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.1"
.head 6 -  Top: 0.417"
.head 6 -  Width:  11.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.469"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colROWID
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'lieferartikel.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Click
.head 8 -  ! If MB_Ok = MessageBox( 'Diesen Preissatz als Standard für den Lieferartikel definieren?', 'Lieferartikel', MB_OkCancel )
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call SetStandard( MyValue  )
.head 5 +  Column: colKU_BEZEICHNUNG
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Kst. der Bereitstellung
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colKU_KOSTENSTELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLI_LIEFERANT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Art.Nr.Lief.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikelname Lieferant
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.617"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colPreis 
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Preis pro LE
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE ! th 20151023: preis pro Einheit
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':tblArtLieferant.colPreis' )
.head 8 -  Set MyValue = StrAppend( MyValue , ' ' , '' )
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_ANBRUCH
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: A
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colSB_NAME
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colBS_UPDATE
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am Datum/Uhrzeit
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colBS_KU_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BS_KU_NR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  2.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151027 ohne am_populate da spalten noch nicht in DB ex. 
.head 5 +  ! ColShowOnly: colNW_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colTAX_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colEK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: EK
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  ! Function: OnPopulate ! th 20160310: ku_hierarchie nur nach UNTEN!!!; nUserKuecheNr != NUMBER_Null; KU_BEZ != NULL
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sBereitstUndZuordnungsKuNr
.head 7 -  String: sWarnhinweis
.head 6 +  Actions 
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr != NUMBER_Null
.head 9 +  If cmbKU_BEZEICHNUNG.GetKeyX () = NUMBER_Null
.head 10 -  Return FALSE
.head 9 +  Else 
.head 10 -  ! spezielle BS_KU ausgewählt
.head 10 -  Set sBereitstUndZuordnungsKuNr = NumberToStrX( cmbKU_BEZEICHNUNG.GetKeyX ())
.head 9 -  ! ku_nr aus kst-Hierarchie nach unten
.head 9 +  If sBereitstUndZuordnungsKuNr
.head 10 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) )
							   OR  x.bs_ps_nr  = 6 )) 
		        JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr = '||sBereitstUndZuordnungsKuNr || '    
		LEFT JOIN lieferant ON la_li_nr = li_nr', 
		  '(@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\')
		AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 9 +  Else 
.head 10 -  Set sWarnhinweis = 'Keine Bereitstellungsküche ausgewählt!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 5 +  ! Function: OnPopulate ! th 20160201: bereits zugeordnete LA garnicht erst anzeigen; bs_ps_nr <= 6 dh. selbstverwaltete auch anzeigen
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sHierarchiePfadKuNrString
.head 7 -  String: sWarnhinweis
.head 6 +  Actions 
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr
.head 9 -  Set sHierarchiePfadKuNrString = GetKstString( nUserKuecheNr, 'ku' )
.head 9 +  If sHierarchiePfadKuNrString
.head 10 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 6)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| sHierarchiePfadKuNrString || ' )    
		JOIN lieferant ON la_li_nr = li_nr', 
		  '(@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\')
		AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 9 +  Else 
.head 10 -  Set sWarnhinweis = 'Die Struktur der Küchen-Kostenstellen konnte nicht aufgelöst werden!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 5 -  ! th 20151116
.head 5 +  ! Function: OnPopulate
.head 6 -  Description: Füllt den Table und vermeidet SQL_Fehler bei mangelhafter Küchen-Kostenstellen-Struktur
.head 6 -  Returns 
.head 6 -  Parameters 
.head 6 -  Static Variables 
.head 6 +  Local variables 
.head 7 -  String: sHierarchiePfadKuNrString
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: sWarnhinweis
.data INHERITPROPS
0000: 0100
.enddata
.head 6 +  Actions 
.head 7 +  If NOT SalIsNull ( dfLA_INTERN )
.head 8 +  If nUserKuecheNr
.head 9 -  Set sHierarchiePfadKuNrString = GetKstString( nUserKuecheNr, 'ku' )
.head 9 +  If sHierarchiePfadKuNrString
.head 10 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| sHierarchiePfadKuNrString || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 9 +  Else 
.head 10 -  Set sWarnhinweis = 'Die Struktur der Küchen-Kostenstellen konnte nicht aufgelöst werden!'
.head 10 -  Call SalMessageBox( Translate( sWarnhinweis ), Translate( 'Kostenstellen' ), MB_IconExclamation | MB_Ok )
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE	! th 20160322: aus notify von WndForm
.head 6 +  If SalObjIsNull( dlgAddArtikelLieferant.oParamArtikelZuordnung) OR ( NOT dlgAddArtikelLieferant.oParamArtikelZuordnung.IsFilter(  ) )
.head 7 -  Call SetNoData( TRUE, '', hWndNULL )
.head 7 -  Return FALSE
.head 6 +  Else 
.head 7 -  Call SetNoData( FALSE, '', hWndNULL )
.head 6 -  Set sWhere = dlgAddArtikelLieferant.oParamArtikelZuordnung.GetWhere( hWndForm )
.head 6 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr AND
				             bs_update =  (SELECT MAX( x.bs_update) 
						      FROM lieferbereitstellung x 
						      WHERE x.bs_la_nr = la_nr 
						      AND ( ( x.bs_ps_nr < 6 AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL) )
						           OR  x.bs_ps_nr  = 6 )) 
		  JOIN kueche ON bs_ku_nr = ku_nr    
	        LEFT JOIN lieferant ON la_li_nr = li_nr', sWhere ||' AND NOT EXISTS (SELECT al_la_nr FROM artikellieferart WHERE al_la_nr = bs_la_nr )', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE	! wl 20151112 weniger Einschränkungen !?
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  ! If Benutzer.HatRecht( REC_KUECHE )
.head 8 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND ( x.bs_datumvon <= SYSDATETIME OR x.bs_datumvon IS NULL)
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 8 -  ! Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND x.bs_datumvon <= SYSDATETIME 
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 +  If Benutzer.HatRecht( REC_KUECHE )
.head 9 -  Call PopulateTable( 'lieferartikel 
		 JOIN lieferbereitstellung ON la_nr = bs_la_nr  
				             AND bs_update =  (SELECT MAX( x.bs_update) 
							FROM lieferbereitstellung x 
							WHERE x.bs_la_nr = la_nr 
							AND x.bs_datumvon <= SYSDATETIME 
							AND x.bs_ps_nr <= 5)  
		JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  ! On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  Call PopulateTable( 'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update =  (SELECT MAX( x.bs_update) FROM lieferbereitstellung x WHERE x.bs_la_nr = la_nr AND x.bs_datumvon <= SYSDATETIME AND x.bs_ps_nr <= 5)  
JOIN kueche ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' )    JOIN lieferant ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'ku_kostenstelle' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 -  ! ga 20080218: neue Klasse für Suchfelder
.head 3 -  ! BackGroundText: Suche:
.head 3 +  ! DataFieldSearch: dfLA_INTERN
.head 4 +  Message Actions 
.head 5 +  On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 -  ! BackGroundText: Kst. der Bereitstellung: 
.head 3 +  ! ComboKeyValue: cmbKU_BEZEICHNUNG
.head 4 -  List Initialization 
.head 4 +  Message Actions 
.head 5 +  On SAM_Create
.head 6 -  ! nur Küchen von nUserKuecheNr aus hierarchisch abwärts
.head 6 -  Set sKuKstStrHierarchischNurNachUnten = BuildKuechenStr ()
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKeyValue( 'ku_nr', 'ku_bezeichnung', 'kueche', ' ku_nr IN ('|| sKuKstStrHierarchischNurNachUnten ||')', 'ku_kostenstelle', FALSE)  
.head 6 -  Call cmbKU_BEZEICHNUNG.SetKey( nUserKuecheNr)
.head 5 +  ! On SAM_Validate
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 3 -  ! th 20151106: cmb+df für Auswahl der Zuordnungs-Küchen-Kostenstelle und automatischem füllen der al_ku_nr
.head 3 -  ! th 20160302: GetWhereKostenstellen nachempfunden
.head 3 +  ! TableAsListBox: tblArtLieferant ! th 20151028 gemäß gui...
.head 4 +  Contents 
.head 5 +  Column: colROWID
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', 'lieferartikel.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColUpdate: colAL_STD
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On SAM_Click
.head 8 -  ! If MB_Ok = MessageBox( 'Diesen Preissatz als Standard für den Lieferartikel definieren?', 'Lieferartikel', MB_OkCancel )
.head 8 -  Set MyValue = NOT MyValue
.head 8 -  Call SetStandard( MyValue  )
.head 5 +  Column: colKU_KOSTENSTELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLI_LIEFERANT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colPreis 
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE ! th 20151023: preis pro Einheit
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':tblArtLieferant.colPreis' )
.head 8 -  Set MyValue = StrAppend( MyValue , ' ' , '' )
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_ANBRUCH
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colSB_NAME
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colBS_UPDATE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 -  ! th 20151027 ohne am_populate da spalten noch nicht in DB ex. 
.head 5 +  ! ColShowOnly: colNW_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colTAX_uebern
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_POPULATE
.head 8 -  ! mach nix
.head 5 +  ! ColShowOnly: colAL_AR_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! Column: colEK
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  ! On AM_POPULATE ! wl 20100601 ohne Leerzeichen, weil sonst die Order By Auflösung nicht funktioniert
.head 8 -  Set strFields = StrAppend( strFields, ',', 'LA_GEBINDEPREIS/LA_GEBINDEINHALT/lLA_LAGEREINHEIT')
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  ! ColShowOnly: colLA_GEBINDEPREIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_GEBINDEINHALT
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colAM_KURZBEZ
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 +  If nUserKuecheNr
.head 8 -  Call PopulateTable( 'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_ps_nr  <=  5 
			    JOIN kueche 	           ON bs_ku_nr = ku_nr AND ku_nr in ( '|| GetKstString( nUserKuecheNr, 'ku' ) || ' ) 
			     JOIN lieferant 	            ON la_li_nr = li_nr', 
		  '@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		  OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
		 AND bs_datumvon <= SYSDATETIME AND bs_ps_nr <= 5
	 	 AND bs_update = ( SELECT MAX(bs_update) FROM  lieferartikel  JOIN lieferbereitstellung ON bs_la_nr = la_nr 
		 					                         JOIN kueche ON ku_nr = bs_ku_nr
					 WHERE la_nr = al_la_nr AND BS_DATUMVON <= SYSDATETIME )', 'ku_kostenstelle' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! TableAsListBox: tblArtLieferant
.head 4 +  Contents 
.head 5 +  ! ColShowOnly: colLA_STD
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_BESTELLBAR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_ANBRUCH
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_QUELLE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_INTERN
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_DATUMVON
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_DATUMBIS
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  ! ColShowOnly: colLA_EK
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_MENGE
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLA_NR
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 -  Functions 
.head 4 -  Window Variables 
.head 4 +  Message Actions 
.head 5 +  On AM_POPULATE	! ra 20141111
.head 6 +  If NOT SalIsNull ( dfLA_INTERN )
.head 7 -  ! th: join auf Lieferbereitstellung mit Berücksichtigung des KU_Kstincl. Hierarchie und PS_NR >= 5 
.head 7 +  If nUserKuecheNr
.head 8 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'lieferartikel JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND
				  bs_ku_nr IN ( ' || GetKstString( nUserKuecheNr , 'ku' ) || ' ) AND 
				  bs_ps_nr  >=  5 ', 
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 
'la_nr' )
.head 7 -  ! Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 
'@UPPER(la_intern) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_nr) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_quelle) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'
OR @UPPER(la_menge) LIKE \'' || '%' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 
'la_nr' )
.head 5 +  ! On AM_POPULATE	! wl 20100311 mit cleanstring wegen umlaute
.head 6 +  If NOT (SalIsNull( dfLA_NR) AND SalIsNull( dfLA_INTERN)   )
.head 7 -  Call dlgAddArtikelLieferant.tblArtLieferant.PopulateTable(
'LIEFERARTIKEL', 'la_nr LIKE \'' || SalNumberToStrX(dlgAddArtikelLieferant.dfLA_NR, 0) || '%\'
AND @UPPER(la_intern) LIKE \'' || CleanSearchString( dlgAddArtikelLieferant.dfLA_INTERN) || '%\'', 'la_nr' )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! ToolbarSearch: pbSuche
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  ! ga 20080218: neue Klasse für Suchfelder
.head 6 -  Call SalSendMsg( dfLA_INTERN, SAM_Validate, 0, 0 )
.head 6 -  ! Call SalSendMsg( tblBLS_Komponenten, AM_POPULATE, 0, 0 )
.head 2 +  Functions 
.head 3 +  Function: classNotify
.head 4 -  Description: Wert wurde geändert ("ParamSet..." wurde aufgerufen)
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 +  Window Handle: p_hWndParent
.head 6 -  ! Form, das den Wert geändert hat
.head 5 +  Number: p_nKey
.head 6 -  ! Eintrag, der geändert wurde
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmpSBLS
.head 5 -  Number: nTmpAR_NR
.head 4 +  Actions 
.head 5 +  If p_nKey = PARAM.ChangedArtikelZuordnungFilter
.head 6 +  If ParamGetData( p_nKey, oParamArtikelZuordnung )
.head 7 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0)
.head 3 +  ! Function: UpdateColumnTitles
.head 4 -  Description: ga 20130507: Spaltentitel gegen Inhaltskurzbez tauschen
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  String: sStmt
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  !
.head 5 -  Window Handle: hWndCol
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Actions 
.head 3 +  ! Function: FindKuechenLevel
.head 4 -  Description: Findet das Küchen-Level :-D
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  String: p_sKSTID
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nLevel
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set nLevel = 1
.head 5 +  While nLevel < 5
.head 6 +  If SalStrMidX( p_sKSTID, 3*nLevel, 3) = '000'
.head 7 -  Return nLevel
.head 6 +  Else 
.head 7 -  Set nLevel = nLevel + 1
.head 5 -  Return 5
.head 3 +  ! Function: BuildKuechenStr
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sWhere
.head 5 -  Number: nInd
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sWhere = 'ku_kostenstelle = :sUserKst'
.head 5 +  Select Case FindKuechenLevel( sUserKst)
.head 6 +  Case 1
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 3)||'%\''   
.head 7 -  Break 
.head 6 +  Case 2
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 6)||'%\''   
.head 7 -  Break 
.head 6 +  Case 3
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 9)||'%\''   
.head 7 -  Break 
.head 6 +  Case 4
.head 7 -  Set sWhere = sWhere || ' OR ku_kostenstelle LIKE \''||SalStrLeftX( sUserKst, 12)||'%\''   
.head 7 -  Break 
.head 6 +  Case 5
.head 7 -  Break 
.head 6 +  Default 
.head 7 +  If SalMessageBox( Translate('Küchen-Kostenstelle fehlerhaft!'), Translate('Zuordnung'), MB_IconExclamation | MB_Ok)
.head 8 -  Break 
.head 5 -  Call Sql_ExecEx( hSql, 'SELECT ku_nr INTO :nGlobalTemp FROM kueche WHERE '|| sWhere ||' ORDER BY ku_kostenstelle', FALSE)
.head 5 +  While SqlFetchNext( hSql, nInd) 
.head 6 -  Set sReturn = StrAppend( sReturn, ', ', NumberToStrX( nGlobalTemp))
.head 5 -  Return sReturn
.head 2 +  Window Parameters 
.head 3 -  Window Handle: wp_hWndParent
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! Number: wp_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables 
.head 3 -  FunctionalVar: oParamArtikelZuordnung = OBJ_Null
.winattr class
.head 4 -  Class: cObjParamArtikelZuordnung
.end
.head 3 -  String: sWhere
.head 3 -  FunctionalVar: oResizables
.winattr class
.head 4 -  Class: cObjResizables
.end
.head 2 +  Message Actions 
.head 3 +  On SAM_Create
.head 4 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 4 -  Call oResizables.AddResizable( tblArtLieferant, RESIZE_NoBorder, 0, RESIZE_NoBorder, RESIZE_NoBorder )
.head 4 -  Call oResizables.SetResizables( hWndForm )
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbOk, SAM_Click, 0, 0 )
.head 3 +  ! On SAM_CreateComplete ! wl 20131109 im Header unterscheiden
.head 4 -  ! Set dfLA_NR = nLA_NR
.head 4 -  ! If nLA_NR != NUMBER_Null
.head 4 -  Call SalSendMsg( tblArtLieferant, AM_POPULATE, 0, 0 )
.head 1 -  ! th 20151215: demnächst für PH ZAP Datenabgleich 2015-12-10
.head 1 +  Dialog Box: dlgArtLog
.head 2 -  Class: InsertBox
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Artikel-Protokoll
.head 2 -  Accessories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  14.817"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.354"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? Yes
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.323"
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.head 3 +  Contents
.head 4 +  Pushbutton: pbNew
.head 5 -  Class Child Ref Key: 7
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.05"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: new.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 8
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.45"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: save.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 0.85"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: print.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDelete
.head 5 -  Class Child Ref Key: 9
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.25"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: delete.bmp
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If nUserLevel < 5
.head 8 -  Call SalHideWindow( hWndItem )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: InsertBox
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left: 1.65"
.head 6 -  Top: 0.0"
.head 6 -  Width:  0.457"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Magenta
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Button Appearance: Flat Look
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Child Table: tblArtLog
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  14.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.698"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colROWID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AR_NR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On AM_POPULATE
.head 8 -  Set strFields = StrAppend( strFields, ',', ' artlog.ROWID' )
.head 8 -  Set strResult = StrAppend( strResult, ',', ':' || GetItemName( hWndItem ) )
.head 5 +  Column: colAL_AR_NR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AR_NR
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAR_INTERN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  2.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAL_INPUT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ->
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAL_AKTION
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Aktion
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAL_EK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AL_EK
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSB_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert von
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAL_DATUM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColShowOnly
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yyyy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: sTableForPop
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Message Actions
.head 5 +  On SAM_Create ! th 20161102 TableName usw umschreiben wegen SQL-Fehler beim Löschen
.head 6 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 6 -  Call tblArtLog.SetTableName( 'artlog')
.head 6 -  Call tblArtLog.SetTablesForPopulate( 'artlog JOIN artikel ON al_ar_nr = ar_nr 
	JOIN benutzer ON al_sb_nr = sb_nr' )
.head 6 -  Call tblArtLog.SetWhereForPopulate ('al_ar_nr = :dlgArtLog.wp_nAR_NR')
.head 6 -  ! Call tblArtLog.SetWhereForUpdate( ' AL_AR_NR = :dlgArtLog.tblArtLog.colAL_AR_NR AND
	AL_AKTION = :dlgArtLog.tblArtLog.colAL_AKTION AND 
	AL_DATUM = :dlgArtLog.tblArtLog.colAL_DATUM')
.head 6 -  Call tblArtLog.SetWhereForUpdate( ' ROWID = :dlgArtLog.tblArtLog.colROWID')
.head 6 -  Call tblArtLog.SetOrderForPopulate ('AL_DATUM DESC')
.head 5 +  On SAM_CreateComplete
.head 6 -  Call tblArtLog.PopulateTable( sTableForPop, 'al_ar_nr = :dlgArtLog.wp_nAR_NR', '')
.head 5 +  ! On SAM_CreateComplete
.head 6 -  Call tblArtLog.SetTableName('artlog JOIN artikel ON al_ar_nr = ar_nr 
			          JOIN benutzer ON al_sb_nr = sb_nr')
.head 6 -  Call tblArtLog.SetWhereForPopulate ('al_ar_nr = :dlgArtLog.wp_nAR_NR')
.head 6 -  Call tblArtLog.SetOrderForPopulate ('al_datum desc')
.head 6 -  Call tblArtLog.PopulateTable('','','')
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: wp_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 -  FunctionalVar: oResizables
.head 4 -  Class: cObjResizables
.head 2 +  Message Actions
.head 3 +  On WM_SIZE
.head 4 -  Call oResizables.Resize( 0, 0 )
.head 3 +  On SAM_Create
.head 4 -  Call oResizables.AddResizable( SalGetFirstChild( hWndForm, TYPE_ChildTable ), 0, 0, 1, 1 )
.head 4 -  Call oResizables.SetResizables (hWndForm)
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 1 +  ! DialogOkEsc: dlgArtikelDatenübertrag
.winattr class Dialog Box:
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Daten aus Lieferartikel
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Allow Dock to Parent? No
.head 3 -  Docking Orientation: All
.head 3 -  Window Location and Size
.head 4 -  Left: Default
.head 4 -  Top: Default
.head 4 -  Width:  12.767"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.917"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  Resizable? No
.head 3 -  Vertical Scroll? Yes
.head 3 -  Horizontal Scroll? Yes
.end
.head 2 -  Description: 
.head 2 +  Tool Bar 
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Resizable? No
.end
.head 3 -  Contents 
.head 2 +  Contents 
.head 3 +  Data Field: dfAR_INTERN
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 1.183"
.head 6 -  Top: 0.156"
.head 6 -  Width:  4.75"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.2"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: Nr.:
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 6.05"
.head 5 -  Top: 0.156"
.head 5 -  Width:  0.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.2"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAR_NR
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 6.567"
.head 6 -  Top: 0.156"
.head 6 -  Width:  2.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.2"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: Protokolleinträge:
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.433"
.head 5 -  Top: 0.448"
.head 5 -  Width:  2.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.198"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Child Table: tblArtikelDatenübertrag
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: TableInFormOrDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.083"
.head 6 -  Top: 0.74"
.head 6 -  Width:  12.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.end
.head 4 +  Contents 
.head 5 +  Column: colAL_AR_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AR_NR
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_INSERT
.head 8 -  Set sItemName = 'dlgArtikelDatenübertrag.tblArtikelDatenübertrag.colAL_AR_NR'
.head 8 -  Call SalSendClassMessage( AM_INSERT, wParam, lParam)
.head 8 -  ! Set strFields = StrAppend( strFields, ',', sFieldName )
.head 8 -  ! Set strResult = StrAppend( strResult, ', ', sItemName )
.head 5 +  Column: colAR_INTERN
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Artikel
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 -  On AM_INSERT
.head 7 -  ! NIX
.head 5 +  Column: colAL_EK
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: AL_EK
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.363"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_INSERT
.head 8 -  Set sItemName = 'dlgArtikelDatenübertrag.tblArtikelDatenübertrag.colAL_EK'
.head 8 -  Call SalSendClassMessage( AM_INSERT, wParam, lParam)
.head 5 +  Column: colAL_INPUT
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ->
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_INSERT
.head 8 -  Set sItemName = 'dlgArtikelDatenübertrag.tblArtikelDatenübertrag.colAL_INPUT'
.head 8 -  Call SalSendClassMessage( AM_INSERT, wParam, lParam)
.head 5 +  Column: colAL_AKTION
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Aktion
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_INSERT
.head 8 -  Set sItemName = 'dlgArtikelDatenübertrag.tblArtikelDatenübertrag.colAL_AKTION'
.head 8 -  Call SalSendClassMessage( AM_INSERT, wParam, lParam)
.head 5 +  Column: colSB_NAME
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert von
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_INSERT
.head 8 -  ! NIX
.head 5 +  Column: colAL_SB_NR
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert von
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 +  Message Actions 
.head 7 +  On AM_INSERT
.head 8 -  Set sItemName = 'dlgArtikelDatenübertrag.tblArtikelDatenübertrag.colAL_SB_NR'
.head 8 -  Call SalSendClassMessage( AM_INSERT, wParam, lParam)
.head 5 +  Column: colAL_DATUM
.winattr class
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: ColUpdate_UPDATE
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: geändert am
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: dd.MM.yy hhhh:mm
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 4 +  Functions 
.head 5 +  Function: NeuerArtLogEintrag ! wl 20160821 geänderter Update #238
.head 6 -  Description: Macht ArtLog-Eintrag anhängig vom Parameter
1er Param - Modus 1: Deklaration; Modus 2: Nährwerte; Modus 3: Taxierungen
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nMode
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  ! Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sLA_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag1
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag2
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTblZeilenanzahl = SalTblInsertRow( tblArtikelDatenübertrag, nTblZeilenanzahl + 1 )
.head 7 -  Set colAL_AR_NR = wp_nAR_NR
.head 7 -  Set colAR_INTERN = dfAR_INTERN
.head 7 -  Set colAL_INPUT = 'X' 
.head 7 -  Set colAL_DATUM = SalDateCurrent ()
.head 7 -  Set colSB_NAME = sUser
.head 7 -  Set colAL_SB_NR = nUserNr
.head 7 -  ! ek und input ???
.head 7 +  Select Case p_nMode
.head 8 +  Case 1
.head 9 +  If p_sEintrag1 != ''
.head 10 -  Set colAL_AKTION = 'Zutaten' 
.head 10 +  If p_sEintrag2 != '' 
.head 11 -  Set colAL_AKTION = colAL_AKTION || ' und Herkunft' 
.head 9 +  Else If p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'Herkunft' 
.head 9 -  Set colAL_AKTION = colAL_AKTION || ' von \" '|| p_sLA_INTERN ||'\" übernommen.'
.head 9 -  Break 
.head 8 +  Case 2
.head 9 -  Set colAL_AKTION = 'Nährwerte von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS1 = '|| p_sEintrag1 || ', AR_SBLS2 = ' || p_sEintrag2 
.head 9 -  Break 
.head 8 +  Case 3
.head 9 -  Set colAL_AKTION = 'Taxierungen von \"'|| p_sLA_INTERN ||'\" übernommen.'
.head 9 -  Break 
.head 8 +  Case 4
.head 9 -  Set colAL_AKTION = 'Keine Zuordnung ausgewählt: Lieferartikel-Taxierungen am Basisartikel werden gelöscht.'
.head 9 -  Break 
.head 8 +  Case 5
.head 9 -  Set colAL_AKTION = 'Keine Daten übernommen: Artikel ist auf dem neuesten Stand.'
.head 9 -  Break 
.head 5 +  ! Function: NeuerArtLogEintrag ! th 20160802 "Nährwerte" statt "BLS-Schlüssel"
.head 6 -  Description: Macht ArtLog-Eintrag anhängig vom Parameter
1er Param - Modus 1: Deklaration; Modus 2: Nährwerte; Modus 3: Taxierungen
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nMode
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  ! Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sLA_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag1
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag2
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTblZeilenanzahl = SalTblInsertRow( tblArtikelDatenübertrag, nTblZeilenanzahl + 1 )
.head 7 -  Set colAL_AR_NR = wp_nAR_NR
.head 7 -  Set colAR_INTERN = dfAR_INTERN
.head 7 -  Set colAL_INPUT = 'X' 
.head 7 -  Set colAL_DATUM = SalDateCurrent ()
.head 7 -  Set colSB_NAME = sUser
.head 7 -  Set colAL_SB_NR = nUserNr
.head 7 -  ! ek und input ???
.head 7 +  Select Case p_nMode
.head 8 +  Case 1
.head 9 +  If p_sEintrag1 != ''
.head 10 -  Set colAL_AKTION = 'Zutaten' 
.head 10 +  If p_sEintrag2 != '' 
.head 11 -  Set colAL_AKTION = colAL_AKTION || ' und Herkunft' 
.head 9 +  Else If p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'Herkunft' 
.head 9 -  Set colAL_AKTION = colAL_AKTION || ' von \" '|| p_sLA_INTERN ||'\" übernommen.'
.head 9 -  Break 
.head 8 +  Case 2
.head 9 +  If p_sEintrag1 != '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'Nährwerte von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else If p_sEintrag1 != '' AND p_sEintrag2 = ''
.head 10 -  Set colAL_AKTION = 'Nährwerte von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS = '|| p_sEintrag1
.head 9 +  Else If p_sEintrag1 = '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'Nährwerte von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else 
.head 10 -  Set colAL_AKTION = 'Nährwerte von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS = '|| p_sEintrag1 ||'; AR_SBLS1 = '|| p_sEintrag2
.head 9 -  Break 
.head 8 +  Case 3
.head 9 -  Set colAL_AKTION = 'Taxierungen von \"'|| p_sLA_INTERN ||'\" übernommen.'
.head 9 -  Break 
.head 8 +  Case 4
.head 9 -  Set colAL_AKTION = 'Keine Zuordnung ausgewählt: Lieferartikel-Taxierungen am Basisartikel werden gelöscht.'
.head 9 -  Break 
.head 8 +  Case 5
.head 9 -  Set colAL_AKTION = 'Keine Daten übernommen: Artikel ist auf dem neuesten Stand.'
.head 9 -  Break 
.head 5 +  ! Function: NeuerArtLogEintrag ! th 20160701 Case 5 und la_intern statt la_nr; Tax löschen
.head 6 -  Description: Macht ArtLog-Eintrag anhängig vom Parameter
1er Param - Modus 1: Deklaration; Modus 2: Nährwerte; Modus 3: Taxierungen
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nMode
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  ! Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sLA_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag1
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag2
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTblZeilenanzahl = SalTblInsertRow( tblArtikelDatenübertrag, nTblZeilenanzahl + 1 )
.head 7 -  Set colAL_AR_NR = wp_nAR_NR
.head 7 -  Set colAR_INTERN = dfAR_INTERN
.head 7 -  Set colAL_INPUT = 'X' 
.head 7 -  Set colAL_DATUM = SalDateCurrent ()
.head 7 -  Set colSB_NAME = sUser
.head 7 -  Set colAL_SB_NR = nUserNr
.head 7 -  ! ek und input ???
.head 7 +  Select Case p_nMode
.head 8 +  Case 1
.head 9 +  If p_sEintrag1 != ''
.head 10 -  Set colAL_AKTION = 'Zutaten' 
.head 10 +  If p_sEintrag2 != '' 
.head 11 -  Set colAL_AKTION = colAL_AKTION || ' und Herkunft' 
.head 9 +  Else If p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'Herkunft' 
.head 9 -  Set colAL_AKTION = colAL_AKTION || ' von \" '|| p_sLA_INTERN ||'\" übernommen.'
.head 9 -  Break 
.head 8 +  Case 2
.head 9 +  If p_sEintrag1 != '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else If p_sEintrag1 != '' AND p_sEintrag2 = ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS = '|| p_sEintrag1
.head 9 +  Else If p_sEintrag1 = '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else 
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von \"'|| p_sLA_INTERN ||'\" übernommen: AR_SBLS = '|| p_sEintrag1 ||'; AR_SBLS1 = '|| p_sEintrag2
.head 9 -  Break 
.head 8 +  Case 3
.head 9 -  Set colAL_AKTION = 'Taxierungen von \"'|| p_sLA_INTERN ||'\" übernommen.'
.head 9 -  Break 
.head 8 +  Case 4
.head 9 -  Set colAL_AKTION = 'Keine Zuordnung ausgewählt: Lieferartikel-Taxierungen am Basisartikel werden gelöscht.'
.head 9 -  Break 
.head 8 +  Case 5
.head 9 -  Set colAL_AKTION = 'Keine Daten übernommen: Artikel ist auf dem neuesten Stand.'
.head 9 -  Break 
.head 5 +  ! Function: NeuerArtLogEintrag ! th 20160318: neuer Modus: Daten sind aktuell!;nur Deklaration übernommen ..; Deklarationen differentieren
.head 6 -  Description: Macht ArtLog-Eintrag anhängig vom Parameter
1er Param - Modus 1: Deklaration; Modus 2: Nährwerte; Modus 3: Taxierungen
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nMode
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag1
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag2
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTblZeilenanzahl = SalTblInsertRow( tblArtikelDatenübertrag, nTblZeilenanzahl + 1 )
.head 7 -  Set colAL_AR_NR = wp_nAR_NR
.head 7 -  Set colAR_INTERN = dfAR_INTERN
.head 7 -  Set colAL_INPUT = 'X' 
.head 7 -  Set colAL_DATUM = SalDateCurrent ()
.head 7 -  Set colSB_NAME = sUser
.head 7 -  Set colAL_SB_NR = nUserNr
.head 7 -  ! ek und input ???
.head 7 +  Select Case p_nMode
.head 8 +  Case 1
.head 9 +  If p_sEintrag1 != ''
.head 10 -  Set colAL_AKTION = 'Zutaten' 
.head 10 +  If p_sEintrag2 != '' 
.head 11 -  Set colAL_AKTION = colAL_AKTION || ' und Herkunft' 
.head 9 +  Else If p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'Herkunft' 
.head 9 -  Set colAL_AKTION = colAL_AKTION || ' von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen.'
.head 9 -  Break 
.head 8 +  Case 2
.head 9 +  If p_sEintrag1 != '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else If p_sEintrag1 != '' AND p_sEintrag2 = ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS = '|| p_sEintrag1
.head 9 +  Else If p_sEintrag1 = '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else 
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS = '|| p_sEintrag1 ||'; AR_SBLS1 = '|| p_sEintrag2
.head 9 -  Break 
.head 8 +  Case 3
.head 9 -  Set colAL_AKTION = 'Taxierungen von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen.'
.head 9 -  Break 
.head 8 +  Case 4
.head 9 -  Set colAL_AKTION = 'Keine Daten übernommen: Artikel ist auf dem neuesten Stand.'
.head 9 -  Break 
.head 5 +  ! Function: NeuerArtLogEintrag
.head 6 -  Description: Macht ArtLog-Eintrag anhängig vom Parameter
1er Param - Modus 1: Deklaration; Modus 2: Nährwerte; Modus 3: Taxierungen
.head 6 -  Returns 
.head 6 +  Parameters 
.head 7 -  Number: p_nMode
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag1
.data INHERITPROPS
0000: 0100
.enddata
.head 7 -  String: p_sEintrag2
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  Static Variables 
.head 6 -  Local variables 
.head 6 +  Actions 
.head 7 -  Set nTblZeilenanzahl = SalTblInsertRow( tblArtikelDatenübertrag, nTblZeilenanzahl + 1 )
.head 7 -  Set colAL_AR_NR = dlgArtikelDatenübertrag.wp_nAR_NR
.head 7 -  Set colAR_INTERN = dlgArtikelDatenübertrag.dfAR_INTERN
.head 7 -  Set colAL_INPUT = 'X' 
.head 7 -  Set colAL_DATUM = SalDateCurrent ()
.head 7 -  Set colSB_NAME = sUser
.head 7 -  Set colAL_SB_NR = nUserNr
.head 7 -  ! ek und input ???
.head 7 +  Select Case p_nMode
.head 8 +  Case 1
.head 9 -  Set colAL_AKTION = 'Deklaration von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen : AR_ZUTATEN = '|| p_sEintrag1 ||'..; AR_HERKUNFT = '|| p_sEintrag2 ||'..'
.head 9 -  Break 
.head 8 +  Case 2
.head 9 +  If p_sEintrag1 != '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else If p_sEintrag1 != '' AND p_sEintrag2 = ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS = '|| p_sEintrag1
.head 9 +  Else If p_sEintrag1 = '' AND p_sEintrag2 != ''
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS1 = '|| p_sEintrag2
.head 9 +  Else 
.head 10 -  Set colAL_AKTION = 'BSL-Schlüssel von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen: AR_SBLS = '|| p_sEintrag1 ||'; AR_SBLS1 = '|| p_sEintrag2
.head 9 -  Break 
.head 8 +  Case 3
.head 9 -  Set colAL_AKTION = 'Taxierungen von LA-Nr. '|| NumberToStrX( p_nLA_NR) ||' übernommen.'
.head 9 -  Break 
.head 4 +  Window Variables 
.head 5 -  Number: nTblZeilenanzahl
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Message Actions 
.head 3 +  Pushbutton: pbOk
.winattr
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left: 4.8"
.head 5 -  Top: 2.479"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click ! th 20160930 neue parameter
.head 6 -  Call ÄnderungenÜbernehmen( wp_nAR_NR, sLA_SBLS1, sAR_SBLS, saStmt ) 
.head 5 +  ! On SAM_Click ! th 20160719: Fkt ausführen
.head 6 -  ! Call Sql_Commit(oSql2.Sql ())
.head 6 -  Call ÄnderungenÜbernehmen ()
.head 5 +  ! On SAM_Click ! th 20160418: StmtGlobal ausführen
.head 6 -  ! Call Sql_Commit(oSql2.Sql ())
.head 6 -  Call Sql_ExecAndCommit( oSql2.Sql (), sStmtGlobal )
.head 6 -  Set tblArtikelDatenübertrag.sTableName = 'artlog'
.head 6 -  Call tblArtikelDatenübertrag.InsertRow ()
.head 6 -  Call SalEndDialog(hWndForm,TRUE)
.head 6 -  Call dlgArtikelDatenübertrag.ParamSetInt( ARTIKEL.Refresh, wp_nAR_NR)
.head 5 +  ! On SAM_Click ! th 20160204: ARTIKEL.Refresh setzen
.head 6 -  Call Sql_Commit(oSql2.Sql ())
.head 6 -  Set tblArtikelDatenübertrag.sTableName = 'artlog'
.head 6 -  Call tblArtikelDatenübertrag.InsertRow ()
.head 6 -  Call SalEndDialog(hWndForm,TRUE)
.head 6 -  Call dlgArtikelDatenübertrag.ParamSetInt( ARTIKEL.Refresh, wp_nAR_NR)
.head 5 +  ! On SAM_Click
.head 6 -  Call Sql_Commit(oSql2.Sql ())
.head 6 -  Set tblArtikelDatenübertrag.sTableName = 'artlog'
.head 6 -  Call tblArtikelDatenübertrag.InsertRow ()
.head 6 -  Call SalEndDialog(hWndForm,TRUE)
.head 3 +  Pushbutton: pbEsc
.winattr
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Abbrechen
.head 4 -  Window Location and Size
.head 5 -  Left: 6.1"
.head 5 -  Top: 2.479"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.end
.head 4 +  Message Actions 
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm,FALSE)
.head 2 +  Functions 
.head 3 +  Function: AlleArUebertragen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 +  String: saStatements[*]
.head 6 -  ! Statements, die pro Artikel ausgeführt werden müssen
.head 5 +  String: sLaSbls1FuerMerge
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! bei Einem Artikel muss der AR_SBLS mit dem LA_SBLS1 zu einem AR_SBLS2 gemerged werden
.head 5 -  String: sKuKstHiererchieString
.head 4 +  Actions 
.head 5 -  ! Daten für ALLE Artikel mit geänderter Zuordnung übertragen
.head 5 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 5 +  If sKuKstHiererchieString != STRING_Null
.head 6 -  Set sStmt = 'SELECT DISTINCT
	         	 ar_nr
	FROM 
	         	 artikel
	          	LEFT JOIN artikellieferart ON ar_nr = al_ar_nr AND al_ku_nr IN ( '|| sKuKstHiererchieString || ')
	INTO 
		:nAR_NR
	WHERE 
		(ar_gesp = 0 OR ar_gesp IS NULL) AND
		ar_zuordnungneu = 1 AND ar_nr > 0
	ORDER BY 1'
.head 6 -  Call Sql_ExecEx( oSql.Sql (), sStmt, FALSE)
.head 6 +  While SqlFetchNext( oSql.Sql (), nFetch)
.head 7 -  ! Statement-Array und Tabelle löschen
.head 7 -  Call SalArraySetUpperBound( saStmt, 1, -1 ) 
.head 7 -  Call SalTblReset( tblArtikelDatenübertrag )
.head 7 -  Call EinzelnenArUebertragen( nAR_NR, saStatements, sLaSbls1FuerMerge, sAR_SBLS )
.head 7 -  ! hier analog zum Klick auf Ok
.head 7 -  Call ÄnderungenÜbernehmen( nAR_NR, sLaSbls1FuerMerge, sAR_SBLS, saStatements )
.head 6 -  Call SalEndDialog( hWndForm, 1)
.head 3 +  Function: EinzelnenArUebertragen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 5 -  Receive String: r_sStmts[*]
.head 5 -  Receive String: r_sLaSbls1FuerMerge
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: r_sArSblsFuerMerge
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bAL_BLS
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  Long String: lsAR_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  String: sAR_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  Date/Time: dtLA_TAXUPDATE
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Date/Time: dtLA_BLSUPDATE
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  ! String: sAR_SBLS
.head 5 -  String: sLA_INTERN
.head 5 -  String: sLA_SBLS1
.head 5 -  String: sAR_SBLS1
.head 5 -  Number: nAL_LA_NR
.head 5 +  Number: nCountStmts
.head 6 -  ! Index für Array aus SQL-Statements
.head 5 -  Boolean: bTaxDeleted
.head 5 -  Boolean: bOk
.head 5 -  String: sLogParam1
.head 5 -  String: sLogParam2
.head 5 -  ! String: sReturn[*]
.head 5 +  ! Boolean: bFlag
.head 6 -  ! zur Kontrolle ob der AR überhaupt eine Zuordnung hat und mind. ein Falg gesetzt ist
.head 5 -  Boolean: bAr_KeinLaTax
.head 5 -  Number: nMoeglicheArtikel[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: n
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  FunctionalVar: oSql1
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  Boolean: bAlDatumFetched
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT 
		    ar_keinlatax, al_la_nr, al_std, al_deklaration, 
		    al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, ar_herkunft, ar_zutaten,
		    la_checksbls, ar_sbls, ar_sbls1, la_sbls1, la_intern, la_blsupdate, la_taxupdate
	     INTO    
		   :bAr_KeinLaTax, :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, 
		  :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :sAR_HERKUNFT, :lsAR_ZUTATEN,
		  :bLA_CHECKBLS, :sAR_SBLS, :sAR_SBLS1, :sLA_SBLS1, :sLA_INTERN, :dtLA_BLSUPDATE, :dtLA_TAXUPDATE
	     FROM           
		           artikel
		 LEFT JOIN artikellieferart      ON al_ar_nr = ar_nr
		 LEFT JOIN lieferartikel           ON la_nr = al_la_nr
	    WHERE           
		   ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' 
	    ORDER BY 
		    ar_keinlatax, al_std'
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 -  Set nFetch = 0
.head 5 -  Set nCountStmts= 0
.head 5 -  Set bTaxDeleted = FALSE
.head 5 +  While SqlFetchNext( oSql.Sql(  ), nFetch ) 
.head 6 -  Set sStmt = ''
.head 6 +  If bAL_DEKLARATION
.head 7 -  Set sLogParam1 = ''
.head 7 -  Set sLogParam2 = ''
.head 7 -  ! nur Zutaten/Herkunft übertragen wenn sie sich wirklich geändert haben
.head 7 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 8 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 8 -  Set sLogParam1 = 'Zutaten'
.head 7 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 8 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 8 -  Set sLogParam2 = 'Herkunft'
.head 7 +  If sStmt != ''
.head 8 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 8 -  Set nCountStmts = nCountStmts + 1
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 1, sLA_INTERN, sLogParam1, sLogParam2)
.head 7 +  ! If NOT bFlag
.head 8 -  Set bFlag = TRUE
.head 6 +  If bAL_BLS
.head 7 -  Set sStmt = ''
.head 7 -  ! der sbls1 hat sich geändert, oder die werte des sbls1 oder nichts
.head 7 -  ! wenn al_datum hier null ist wurde noch nie für den AR übertragen; 
.head 7 +  If sLA_SBLS1 != ''
.head 8 -  Call Sql_FetchOne( oSql1.Sql (), 'SELECT MAX(al_datum) FROM artlog INTO :dlgArtikelDatenübertrag.dtAL_DATUM WHERE al_ar_nr = '||NumberToStrX( wp_nAR_NR ) )
.head 8 -  Set bAlDatumFetched = TRUE
.head 8 +  If sAR_SBLS1 != sLA_SBLS1 OR
	( sAR_SBLS1 = sLA_SBLS1 AND dtLA_BLSUPDATE != DATETIME_Null AND 
		(dtLA_BLSUPDATE > dtAL_DATUM OR dtAL_DATUM = DATETIME_Null))
.head 9 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 9 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_sbls2 = \'ZB'|| NumberToStrX( p_nAR_NR ) ||'\'')
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS1, 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 -  ! es muss nachher neu gemerged werden!
.head 9 -  Set r_sLaSbls1FuerMerge = sLA_SBLS1
.head 9 -  Set r_sArSblsFuerMerge = sAR_SBLS
.head 7 +  If sStmt != ''
.head 8 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET ' ||  sStmt || ' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 8 -  Set nCountStmts = nCountStmts + 1
.head 6 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 6 -  ! wenn nicht aktiv: immer alle Tax löschen
.head 6 +  If NOT bAr_KeinLaTax
.head 7 +  If bAL_TAX
.head 8 +  If NOT bAlDatumFetched
.head 9 -  Call Sql_FetchOne( oSql1.Sql (), 'SELECT MAX(al_datum) FROM artlog INTO :dlgArtikelDatenübertrag.dtAL_DATUM WHERE al_ar_nr = '||NumberToStrX( wp_nAR_NR ) )
.head 8 +  If dtLA_TAXUPDATE != DATETIME_Null AND 
	(dtLA_TAXUPDATE > dtAL_DATUM OR dtAL_DATUM = DATETIME_Null)
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  Set bTaxDeleted = TRUE
.head 9 -  Set r_sStmts[ nCountStmts ] = GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 9 -  Set nCountStmts = nCountStmts + 1
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 6 +  Else 
.head 7 +  If bTaxDeleted = FALSE
.head 8 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 8 -  Set nCountStmts = nCountStmts + 1
.head 8 -  Set bTaxDeleted = TRUE
.head 5 -  !
.head 5 -  ! AR hat keine keine Zuordnung
.head 5 +  If nAL_LA_NR = NUMBER_Null
.head 6 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 6 -  ! => LA-Taxierungen am AR werden gelöscht
.head 6 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 6 -  Set nCountStmts = nCountStmts + 1
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 5 +  ! Else
.head 6 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 6 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If SalArrayIsEmpty( r_sStmts )
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  ! Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th 20160915 nur ar_zuordnungneu als kriterium
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 5 -  Receive String: r_sStmts[*]
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  ! String: sAR_SBLS
.head 5 -  String: sLA_INTERN
.head 5 -  Number: nAL_LA_NR
.head 5 +  Number: nCountStmts
.head 6 -  ! Index für Array aus SQL-Statements
.head 5 -  Boolean: bTaxDeleted
.head 5 -  Boolean: bOk
.head 5 -  String: sLogParam1
.head 5 -  String: sLogParam2
.head 5 -  ! String: sReturn[*]
.head 5 -  Boolean: bFlag
.head 5 -  Boolean: bAr_KeinLaTax
.head 5 -  Number: nMoeglicheArtikel[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: n
.head 4 +  Actions 
.head 5 +  ! If TRUE
.head 6 +  Set sStmt = ' SELECT 
			@NULLVALUE( ar_keinlatax, 0)
	        INTO 
			:nGlobalTemp
	       FROM
	             		artikel 
	       WHERE
	  	   	(EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
		      OR
			ar_update > (SELECT  max(z.al_datum) 
				        FROM   artlog z 
	   			      WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||') )
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 7 -  ! ar_update > al_datum  ohne join auf artikellieferart für den Fall, dass Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen
.head 5 -  Set bAr_KeinLaTax = nGlobalTemp
.head 5 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 5 +  If sKuKstHiererchieString != STRING_Null
.head 6 -  Set sStmt = 'SELECT DISTINCT
	         	 ar_nr
	FROM 
	         	 artikel
	          	LEFT JOIN artikellieferart a ON ar_nr = a.al_ar_nr AND a.al_ku_nr IN ( '|| sKuKstHiererchieString || ')
	          	LEFT JOIN lieferartikel     ON a.al_la_nr = la_nr
	INTO 
		:nMoeglicheArtikel[n]
	WHERE 
		(ar_gesp = 0 OR ar_gesp IS NULL) AND
		ar_zuordnungneu = 1 AND ar_nr > 0
	ORDER BY 1'
.head 6 -  ! Set sStmt = 'SELECT DISTINCT
	         	 ar_nr
	FROM 
	         	 artikel
	          	LEFT JOIN artikellieferart a ON ar_nr = a.al_ar_nr AND a.al_ku_nr IN ( '|| sKuKstHiererchieString || ')
	          	LEFT JOIN lieferartikel     ON a.al_la_nr = la_nr
	INTO 
		:nMoeglicheArtikel[n]
	WHERE 
		(ar_gesp = 0 OR ar_gesp IS NULL) AND
		(( a.al_ar_nr IS NOT NULL AND
		NOT EXISTS(SELECT 1 FROM artlog x WHERE x.al_ar_nr = ar_nr AND ( x.al_datum > a.al_update OR x.al_datum > la_update))) OR
		(EXISTS(SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr) AND 
		NOT EXISTS(SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr AND al_datum > ar_update)) OR ar_zuordnungneu = 1) AND
		ar_nr > 0
	ORDER BY 1'
.head 6 -  Call Sql_ExecEx( oSql1.Sql (), sStmt, FALSE)
.head 6 +  While SqlFetchNext( oSql1.Sql (), nFetch)
.head 7 -  Set n = n + 1
.head 6 +  If VisArrayFindNumber( nMoeglicheArtikel, p_nAR_NR ) > -1
.head 7 -  Set sStmt = 'SELECT 
		   ar_keinlatax, al_la_nr, al_std, al_deklaration, 
		    al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, 
		    la_checksbls, ar_sbls, la_sbls1, la_intern
	     INTO    :bAr_KeinLaTax, :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, 
		  :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, 
		  :bLA_CHECKBLS, :sAR_SBLS, :sLA_SBLS1_temp, :sLA_INTERN
	     FROM           
		           artikel
		 LEFT  JOIN artikellieferart     a ON a.al_ar_nr = ar_nr
		 LEFT  JOIN lieferartikel           ON la_nr = al_la_nr
	    WHERE           
		   ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' 
	    ORDER BY 
		    ar_keinlatax, al_std'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nFetch = 0
.head 7 -  Set nCountStmts= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 -  Set sLA_SBLS1 = ''
.head 7 -  Set nLA_NR = NUMBER_Null
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch ) 
.head 8 -  Set sStmt = ''
.head 8 +  If bAL_DEKLARATION
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 -  ! wl 20160821 immer alle drei befüllen #238
.head 9 -  ! Merge
.head 9 -  ! Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sAR_SBLS, sLA_SBLS1)
.head 9 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 -  ! der bleibt beim Arikel, wird nicht mehr im LA gewartet
.head 9 -  ! Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 9 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 9 -  !
.head 9 +  If sLA_SBLS1_temp != ''
.head 10 -  Set sLA_SBLS1 = sLA_SBLS1_temp
.head 10 -  Set nLA_NR = nAL_LA_NR
.head 10 -  Set sStmt = 'ar_sbls2 = \'ZB'|| NumberToStrX( wp_nAR_NR ) ||'\''
.head 10 -  Set sStmt = StrAppend( sStmt, ',', 'ar_sbls1 = \'' || sLA_SBLS1 || '\'')
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS1, 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  If sStmt != ''
.head 10 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET ' ||  sStmt || ' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 8 -  ! wenn nicht aktiv immer alle Tax löschen und die gesetzten einfügen,
.head 8 -  ! d.h. wenn keis ausgewählt werden die Tax am AR mit tu_zusatz = 2 vollständig gelöscht
.head 8 +  If bAr_KeinLaTax = NUMBER_Null OR bAr_KeinLaTax = 0
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  ! Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 8 +  If bAL_TAX
.head 9 +  If NOT bAr_KeinLaTax
.head 10 -  Set r_sStmts[ nCountStmts ] = GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 7 +  If NOT bFlag
.head 8 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 8 -  ! => LA-Taxierungen am AR werden gelöscht
.head 8 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 8 -  Set nCountStmts = nCountStmts + 1
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 5 +  Else 
.head 6 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 6 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If SalArrayIsEmpty( r_sStmts )
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  ! Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! wl 20160821 nur mehr SBLS1 von LA #238
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 5 -  Receive String: r_sStmts[*]
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  ! String: sAR_SBLS
.head 5 -  String: sLA_INTERN
.head 5 -  Number: nAL_LA_NR
.head 5 +  Number: nCountStmts
.head 6 -  ! Index für Array aus SQL-Statements
.head 5 -  Boolean: bTaxDeleted
.head 5 -  Boolean: bOk
.head 5 -  String: sLogParam1
.head 5 -  String: sLogParam2
.head 5 -  ! String: sReturn[*]
.head 5 -  Boolean: bFlag
.head 5 -  Boolean: bAr_KeinLaTax
.head 5 -  Number: nMoeglicheArtikel[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: n
.head 4 +  Actions 
.head 5 +  ! If TRUE
.head 6 +  Set sStmt = ' SELECT 
			@NULLVALUE( ar_keinlatax, 0)
	        INTO 
			:nGlobalTemp
	       FROM
	             		artikel 
	       WHERE
	  	   	(EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
		      OR
			ar_update > (SELECT  max(z.al_datum) 
				        FROM   artlog z 
	   			      WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||') )
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 7 -  ! ar_update > al_datum  ohne join auf artikellieferart für den Fall, dass Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen
.head 5 -  Set bAr_KeinLaTax = nGlobalTemp
.head 5 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 5 +  If sKuKstHiererchieString != STRING_Null
.head 6 -  Set sStmt = 'SELECT DISTINCT
	         	 ar_nr
	FROM 
	         	 artikel
	          	LEFT JOIN artikellieferart a ON ar_nr = a.al_ar_nr AND a.al_ku_nr IN ( '|| sKuKstHiererchieString || ')
	          	LEFT JOIN lieferartikel     ON a.al_la_nr = la_nr
	INTO 
		:nMoeglicheArtikel[n]
	WHERE 
		(ar_gesp = 0 OR ar_gesp IS NULL) AND
		(( a.al_ar_nr IS NOT NULL AND
		NOT EXISTS(SELECT 1 FROM artlog x WHERE x.al_ar_nr = ar_nr AND ( x.al_datum > a.al_update OR x.al_datum > la_update))) OR
		(EXISTS(SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr) AND 
		NOT EXISTS(SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr AND al_datum > ar_update)) OR ar_zuordnungneu = 1) AND
		ar_nr > 0
	ORDER BY 1'
.head 6 -  Call Sql_ExecEx( oSql1.Sql (), sStmt, FALSE)
.head 6 +  While SqlFetchNext( oSql1.Sql (), nFetch)
.head 7 -  Set n = n + 1
.head 6 +  If VisArrayFindNumber( nMoeglicheArtikel, p_nAR_NR ) > -1
.head 7 -  Set sStmt = 'SELECT 
		   ar_keinlatax, al_la_nr, al_std, al_deklaration, 
		    al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, 
		    la_checksbls, ar_sbls, la_sbls1, la_intern
	     INTO    :bAr_KeinLaTax, :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, 
		  :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, 
		  :bLA_CHECKBLS, :sAR_SBLS, :sLA_SBLS1_temp, :sLA_INTERN
	     FROM           
		           artikel
		 LEFT  JOIN artikellieferart     a ON a.al_ar_nr = ar_nr
		 LEFT  JOIN lieferartikel           ON la_nr = al_la_nr
	    WHERE           
		   ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' 
	    ORDER BY 
		    ar_keinlatax, al_std'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nFetch = 0
.head 7 -  Set nCountStmts= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 -  Set sLA_SBLS1 = ''
.head 7 -  Set nLA_NR = NUMBER_Null
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch ) 
.head 8 -  Set sStmt = ''
.head 8 +  If bAL_DEKLARATION
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 -  ! wl 20160821 immer alle drei befüllen #238
.head 9 -  ! Merge
.head 9 -  ! Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sAR_SBLS, sLA_SBLS1)
.head 9 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 -  ! der bleibt beim Arikel, wird nicht mehr im LA gewartet
.head 9 -  ! Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 9 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 9 -  !
.head 9 +  If sLA_SBLS1_temp != ''
.head 10 -  Set sLA_SBLS1 = sLA_SBLS1_temp
.head 10 -  Set nLA_NR = nAL_LA_NR
.head 10 -  Set sStmt = 'ar_sbls2 = \'ZB'|| NumberToStrX( wp_nAR_NR ) ||'\''
.head 10 -  Set sStmt = StrAppend( sStmt, ',', 'ar_sbls1 = \'' || sLA_SBLS1 || '\'')
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS1, 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  If sStmt != ''
.head 10 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET ' ||  sStmt || ' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 8 -  ! wenn nicht aktiv immer alle Tax löschen und die gesetzten einfügen,
.head 8 -  ! d.h. wenn keis ausgewählt werden die Tax am AR mit tu_zusatz = 2 vollständig gelöscht
.head 8 +  If bAr_KeinLaTax = NUMBER_Null OR bAr_KeinLaTax = 0
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  ! Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 8 +  If bAL_TAX
.head 9 +  If NOT bAr_KeinLaTax
.head 10 -  Set r_sStmts[ nCountStmts ] = GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 7 +  If NOT bFlag
.head 8 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 8 -  ! => LA-Taxierungen am AR werden gelöscht
.head 8 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 8 -  Set nCountStmts = nCountStmts + 1
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 5 +  Else 
.head 6 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 6 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If SalArrayIsEmpty( r_sStmts )
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  ! Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160802 stsm umstrukturiert für SQLBase
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 5 -  Receive String: r_sStmts[*]
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  String: sLA_INTERN
.head 5 +  Number: nCountStmts
.head 6 -  ! Index für Array aus SQL-Statements
.head 5 -  Boolean: bTaxDeleted
.head 5 -  Boolean: bOk
.head 5 -  String: sLogParam1
.head 5 -  String: sLogParam2
.head 5 -  ! String: sReturn[*]
.head 5 -  Boolean: bFlag
.head 5 -  Boolean: bAr_KeinLaTax
.head 5 -  Number: nMoeglicheArtikel[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: n
.head 4 +  Actions 
.head 5 +  ! If TRUE
.head 6 +  Set sStmt = ' SELECT 
			@NULLVALUE( ar_keinlatax, 0)
	        INTO 
			:nGlobalTemp
	       FROM
	             		artikel 
	       WHERE
	  	   	(EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
		      OR
			ar_update > (SELECT  max(z.al_datum) 
				        FROM   artlog z 
	   			      WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||') )
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 7 -  ! ar_update > al_datum  ohne join auf artikellieferart für den Fall, dass Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen
.head 5 -  Set bAr_KeinLaTax = nGlobalTemp
.head 5 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 5 +  If sKuKstHiererchieString != STRING_Null
.head 6 -  Set sStmt = 'SELECT DISTINCT
	         	 ar_nr
	FROM 
	         	 artikel
	          	LEFT JOIN artikellieferart a ON ar_nr = a.al_ar_nr AND a.al_ku_nr IN ( '|| sKuKstHiererchieString || ')
	          	LEFT JOIN lieferartikel     ON a.al_la_nr = la_nr
	INTO 
		:nMoeglicheArtikel[n]
	WHERE 
		(ar_gesp = 0 OR ar_gesp IS NULL) AND
		(( a.al_ar_nr IS NOT NULL AND
		NOT EXISTS(SELECT 1 FROM artlog x WHERE x.al_ar_nr = ar_nr AND ( x.al_datum > a.al_update OR x.al_datum > la_update))) OR
		(EXISTS(SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr) AND 
		NOT EXISTS(SELECT 1 FROM artlog WHERE al_ar_nr = ar_nr AND al_datum > ar_update))) AND
		ar_nr > 0
	ORDER BY 1'
.head 6 -  Call Sql_ExecEx( oSql1.Sql (), sStmt, FALSE)
.head 6 +  While SqlFetchNext( oSql1.Sql (), nFetch)
.head 7 -  Set n = n + 1
.head 6 +  If VisArrayFindNumber( nMoeglicheArtikel, p_nAR_NR ) > -1
.head 7 -  Set sStmt = 'SELECT 
		   ar_keinlatax, al_la_nr, al_std, al_deklaration, 
		    al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, 
		    la_checksbls, la_sbls, la_checksbls1, la_sbls1, 
		    la_intern
	     INTO    :bAr_KeinLaTax, :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, 
		  :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, 
		  :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1, 
		  :sLA_INTERN
	     FROM           
		           artikel
		 LEFT  JOIN artikellieferart     a ON a.al_ar_nr = ar_nr
		 LEFT  JOIN lieferartikel           ON la_nr = al_la_nr
	    WHERE           
		   ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' 
	    ORDER BY 
		    ar_keinlatax, al_std'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nFetch = 0
.head 7 -  Set nCountStmts= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch ) 
.head 8 -  Set sStmt = ''
.head 8 +  If bAL_DEKLARATION
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET ' ||  sStmt || ' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 8 -  ! wenn nicht aktiv immer alle Tax löschen und die gesetzten einfügen,
.head 8 -  ! d.h. wenn keis ausgewählt werden die Tax am AR mit tu_zusatz = 2 vollständig gelöscht
.head 8 +  If bAr_KeinLaTax = NUMBER_Null OR bAr_KeinLaTax = 0
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  ! Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 8 +  If bAL_TAX
.head 9 +  If NOT bAr_KeinLaTax
.head 10 -  Set r_sStmts[ nCountStmts ] = GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 10 -  Set nCountStmts = nCountStmts + 1
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 7 +  If NOT bFlag
.head 8 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 8 -  ! => LA-Taxierungen am AR werden gelöscht
.head 8 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 8 -  Set nCountStmts = nCountStmts + 1
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 5 +  Else 
.head 6 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 6 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If SalArrayIsEmpty( r_sStmts )
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  ! Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160721 Select innerhalb NULLVALUE bei SQLBase nicht möglich
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 5 -  Receive String: r_sStmts[*]
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  String: sLA_INTERN
.head 5 +  Number: nCountStmts
.head 6 -  ! Index für Array aus SQL-Statements
.head 5 -  Boolean: bTaxDeleted
.head 5 -  Boolean: bOk
.head 5 -  String: sLogParam1
.head 5 -  String: sLogParam2
.head 5 -  ! String: sReturn[*]
.head 5 -  Boolean: bFlag
.head 5 -  Boolean: bAr_KeinLaTax
.head 4 +  Actions 
.head 5 +  ! If TRUE
.head 6 +  Set sStmt = ' SELECT 
			@NULLVALUE( ar_keinlatax, 0)
	        INTO 
			:nGlobalTemp
	       FROM
	             		artikel 
	       WHERE
	  	   	(EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
		      OR
			ar_update > (SELECT  max(z.al_datum) 
				        FROM   artlog z 
	   			      WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||') )
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 7 -  ! ar_update > al_datum  ohne join auf artikellieferart für den Fall, dass Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen
.head 5 -  Set bAr_KeinLaTax = nGlobalTemp
.head 5 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 5 +  If sKuKstHiererchieString != STRING_Null
.head 6 +  If TRUE
.head 7 -  Set sStmt = 'SELECT 
		   ar_keinlatax, al_la_nr, al_std, al_deklaration, 
		    al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, 
		    la_checksbls, la_sbls, la_checksbls1, la_sbls1, 
		    la_intern
	     INTO    :bAr_KeinLaTax, :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, 
		  :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, 
		  :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1, 
		  :sLA_INTERN
	     FROM           
		           artikel
		 LEFT  JOIN artikellieferart     a ON a.al_ar_nr = ar_nr
 		 LEFT JOIN artlog		b ON b.al_ar_nr = ar_nr
		 LEFT  JOIN kueche                 ON ku_nr = al_ku_nr 
		 LEFT  JOIN lieferartikel           ON la_nr = al_la_nr
		 LEFT  JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									       FROM lieferbereitstellung z 
    									       WHERE     z.bs_ps_nr <=6 
									               AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                             AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                     AND z.bs_la_nr = al_la_nr )
	    WHERE           
		          ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND (( a.al_ar_nr IS NOT NULL 
		    AND '|| GetWhereKostenstellen( 'ku_kostenstelle', sUserKst )||' AND (b.al_datum IS NULL OR ( b.al_datum < a.al_update OR b.al_datum < la_update OR b.al_datum < ar_update)))
		      OR ( a.al_ar_nr IS NULL AND b.al_datum IS NOT NULL AND b.al_datum < ar_update)) 
	ORDER BY ar_keinlatax, al_std'
.head 6 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 6 -  Set nCountStmts= 0
.head 6 -  Set bTaxDeleted = FALSE
.head 6 +  While SqlFetchNext( oSql1.Sql(  ), nFetch ) 
.head 7 -  Set sStmt = ''
.head 7 +  If bAL_DEKLARATION
.head 8 -  Set sLogParam1 = ''
.head 8 -  Set sLogParam2 = ''
.head 8 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 8 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 9 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 9 -  Set sLogParam1 = 'Zutaten'
.head 8 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 9 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 9 -  Set sLogParam2 = 'Herkunft'
.head 8 +  If sStmt != ''
.head 9 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 9 -  Set nCountStmts = nCountStmts + 1
.head 9 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 8 +  If NOT bFlag
.head 9 -  Set bFlag = TRUE
.head 7 +  If bAL_BLS
.head 8 -  Set sStmt = ''
.head 8 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 9 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 8 +  Else If bLA_CHECKBLS
.head 9 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 8 +  Else If bLA_CHECKBLS1
.head 9 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, '', sLA_SBLS1 )
.head 8 +  If sStmt != ''
.head 9 -  Set r_sStmts[ nCountStmts ] = 'UPDATE artikel SET ' ||  sStmt || ' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 9 -  Set nCountStmts = nCountStmts + 1
.head 9 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 8 +  If NOT bFlag
.head 9 -  Set bFlag = TRUE
.head 7 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 7 -  ! wenn nicht aktiv immer alle Tax löschen und die gesetzten einfügen,
.head 7 -  ! d.h. wenn keis ausgewählt werden die Tax am AR mit tu_zusatz = 2 vollständig gelöscht
.head 7 +  If bAr_KeinLaTax = NUMBER_Null OR bAr_KeinLaTax = 0
.head 8 -  ! nur einmal löschen
.head 8 +  If bTaxDeleted = FALSE
.head 9 -  ! Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 9 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 9 -  Set nCountStmts = nCountStmts + 1
.head 9 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 9 -  Set bTaxDeleted = TRUE
.head 7 +  If bAL_TAX
.head 8 +  If NOT bAr_KeinLaTax
.head 9 -  Set r_sStmts[ nCountStmts ] = GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 9 -  Set nCountStmts = nCountStmts + 1
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 8 +  If NOT bFlag
.head 9 -  Set bFlag = TRUE
.head 6 +  If NOT bFlag
.head 7 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 7 -  ! => LA-Taxierungen am AR werden gelöscht
.head 7 -  Set r_sStmts[ nCountStmts ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 7 -  Set nCountStmts = nCountStmts + 1
.head 7 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 5 +  Else 
.head 6 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 6 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If SalArrayIsEmpty( r_sStmts )
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  ! Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160719: array returnen weil oracle mehrere stmts in einem bei oracle so nicht funktioniert
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 5 -  Receive String: r_sStmts[*]
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  String: sLA_INTERN
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.head 5 -  Boolean: bOk
.head 5 -  String: sLogParam1
.head 5 -  String: sLogParam2
.head 5 -  ! String: sReturn[*]
.head 5 -  Boolean: bFlag
.head 5 -  Boolean: bAr_KeinLaTax
.head 5 +  Number: nAL_LA_NR_Old
.head 6 +  ! wenn Bereitstellungen mit vers. PS mit gleichem Datum vorliegen wird der selbe LA mehrfach gefetcht
.head 7 -  ! deshalb mit vorherigem Wert vergleichen und nur bei neuem LA Übertrag durchführen
.head 4 +  Actions 
.head 5 +  If TRUE
.head 6 +  Set sStmt = ' SELECT 
			@NULLVALUE( ar_keinlatax, 0)
	        INTO 
			:nGlobalTemp
	       FROM
	             		artikel 
	       WHERE
	  	   	(EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
		      OR
			ar_update > (SELECT  max(z.al_datum) 
				        FROM   artlog z 
	   			      WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||') )
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 7 -  ! ar_update > al_datum  ohne join auf artikellieferart für den Fall, dass Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen
.head 5 +  If Sql_FetchOne( hSql, sStmt )
.head 6 -  Set bAr_KeinLaTax = nGlobalTemp
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_deklaration, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1, la_intern
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1, :sLA_INTERN
	     FROM           artikellieferart 
		   JOIN kueche                 ON ku_nr = al_ku_nr 
		   JOIN lieferartikel           ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch ) 
.head 8 +  If nAL_LA_NR != nAL_LA_NR_Old 
.head 9 -  Set sStmt = ''
.head 9 +  If bAL_DEKLARATION
.head 10 -  Set sLogParam1 = ''
.head 10 -  Set sLogParam2 = ''
.head 10 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 10 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 11 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 11 -  Set sLogParam1 = 'Zutaten'
.head 10 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 11 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 11 -  Set sLogParam2 = 'Herkunft'
.head 10 +  If sStmt != ''
.head 11 -  Set r_sStmts[ nCount ] = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 11 -  Set nCount = nCount + 1
.head 11 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 11 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 10 +  If NOT bFlag
.head 11 -  Set bFlag = TRUE
.head 9 +  If bAL_BLS
.head 10 -  Set sStmt = ''
.head 10 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 11 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 11 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 10 +  Else If bLA_CHECKBLS
.head 11 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 11 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 10 +  Else If bLA_CHECKBLS1
.head 11 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 11 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, '', sLA_SBLS1 )
.head 10 +  If sStmt != ''
.head 11 -  Set r_sStmts[ nCount ] = 'UPDATE artikel SET ' ||  sStmt || ' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 11 -  Set nCount = nCount + 1
.head 11 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 +  If NOT bFlag
.head 11 -  Set bFlag = TRUE
.head 9 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 9 -  ! wenn nicht aktiv immer alle Tax löschen und die gesetzten einfügen,
.head 9 -  ! d.h. wenn keis ausgewählt werden die Tax am AR mit tu_zusatz = 2 vollständig gelöscht
.head 9 +  If NOT bAr_KeinLaTax
.head 10 -  ! nur einmal löschen
.head 10 +  If bTaxDeleted = FALSE
.head 11 -  ! Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 11 -  Set r_sStmts[ nCount ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 11 -  Set nCount = nCount + 1
.head 11 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 11 -  Set bTaxDeleted = TRUE
.head 9 +  If bAL_TAX
.head 10 +  If NOT bAr_KeinLaTax
.head 11 -  Set r_sStmts[ nCount ] = GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 11 -  Set nCount = nCount + 1
.head 11 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 10 +  If NOT bFlag
.head 11 -  Set bFlag = TRUE
.head 9 -  Set nAL_LA_NR_Old = nAL_LA_NR
.head 7 +  If NOT bFlag
.head 8 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 8 -  ! => LA-Taxierungen am AR werden gelöscht
.head 8 -  Set r_sStmts[ nCount ] = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 8 -  Set nCount = nCount + 1
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 6 +  Else 
.head 7 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 7 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 8 -  Call SalDestroyWindow( hWndForm )
.head 7 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If SalArrayIsEmpty( r_sStmts )
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  ! Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160630 Fall behandeln, dass alle Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen; ar_keinelatax
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  String: sLA_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam2
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bFlag
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bAr_KeinLaTax
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If TRUE
.head 6 +  Set sStmt = ' SELECT 
			@NULLVALUE( ar_keinlatax, 0)
	        INTO 
			:nGlobalTemp
	       FROM
	             		artikel 
	       WHERE
	  	   	(EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(z.al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
		      OR
			ar_update > (SELECT  max(z.al_datum) 
				        FROM   artlog z 
	   			      WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||') )
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 7 -  ! ar_update > al_datum  ohne join auf artikellieferart für den Fall, dass Zuordnungen gelöscht und jetzt die LA-Taxierungen am AR gelöscht werden sollen
.head 5 +  If Sql_FetchOne( hSql, sStmt )
.head 6 -  Set bAr_KeinLaTax = nGlobalTemp
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_deklaration, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1, la_intern
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1, :sLA_INTERN
	     FROM           artikellieferart 
		   JOIN kueche                 ON ku_nr = al_ku_nr 
		   JOIN lieferartikel           ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 8 -  Set sStmt = ''
.head 8 +  If bAL_DEKLARATION
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'UPDATE artikel SET ' ||  sStmt || 'WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 -  ! wenn AR_KEINLA_TAX aktiv dürfen keine Taxierungen übertragen werden
.head 8 -  ! wenn nicht aktiv immer alle Tax löschen und die gesetzten einfügen,
.head 8 -  ! d.h. wenn keis ausgewählt werden die Tax am AR mit tu_zusatz = 2 vollständig gelöscht
.head 8 +  If NOT bAr_KeinLaTax
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  ! Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 
	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)')
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 8 +  If bAL_TAX
.head 9 +  If NOT bAr_KeinLaTax
.head 10 -  Set sReturn = StrAppend( sReturn, CR, GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR))
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 -  Set nCount = nCount + 1
.head 7 +  If NOT bFlag
.head 8 -  ! keine Flags gesetzt ODER alle Zuordnungen gelöscht
.head 8 -  ! => LA-Taxierungen am AR werden gelöscht
.head 8 -  Set sReturn = 'DELETE FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) ||' AND 	at_tu_nr IN (SELECT tu_nr FROM taxierungsuntergr WHERE tu_zusatz = 2)'
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 6 +  Else 
.head 7 -  ! Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 7 +  If SalMessageBox( 'Datenübertrag nicht möglich. Bitte überprüfen sie die Struktur der Küchen-Kostenstellen.', 'Datenübertrag nicht möglich', MB_IconExclamation | MB_Ok)
.head 8 -  Call SalDestroyWindow( hWndForm )
.head 7 -  ! Set bOk = TRUE
.head 5 +  ! Else
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 +  If sReturn = ''
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 5 -  Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160628 Case 4-> kein Falg gesetzt, Case 5-> ar aktuell; la_intern mit laden
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  String: sLA_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam2
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bFlag
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If TRUE
.head 6 -  Set sStmt = ' SELECT 
			1 
	       FROM
	             		artikel 
	       WHERE
	  	   	EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 5 +  If Sql_FetchOne( hSql, sStmt ) 
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_deklaration, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1, la_intern
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1, :sLA_INTERN
	     FROM           artikellieferart 
		   JOIN kueche                 ON ku_nr = al_ku_nr 
		   JOIN lieferartikel           ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 8 -  Set sStmt = ''
.head 8 +  If bAL_DEKLARATION
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, sLA_INTERN, sLogParam1, sLogParam2)
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, sLA_INTERN, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'UPDATE artikel SET ' ||  sStmt || 'WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 +  If bAL_TAX
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 9 -  Set sReturn = StrAppend( sReturn, CR, GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR))
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, sLA_INTERN, '', '' )
.head 9 +  If NOT bFlag
.head 10 -  Set bFlag = TRUE
.head 8 -  Set nCount = nCount + 1
.head 7 +  If NOT bFlag
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 4, '', '', '' )
.head 5 +  Else 
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag( 5, '', '', '' )
.head 6 -  Set bOk = TRUE
.head 5 -  Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160609: mit ZH
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_DEKLARATION
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam2
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = ' SELECT 
			1 
	       FROM
	             		artikel 
	       WHERE
	  	   	EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 5 +  If Sql_FetchOne( hSql, sStmt ) 
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_deklaration, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_DEKLARATION, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1
	     FROM           artikellieferart 
		   JOIN kueche                 ON ku_nr = al_ku_nr 
		   JOIN lieferartikel           ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 8 -  Set sStmt = ''
.head 8 +  If bAL_DEKLARATION
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, nAL_LA_NR, sLogParam1, sLogParam2)
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'UPDATE artikel SET ' ||  sStmt || 'WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 8 +  If bAL_TAX
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 9 -  Set sReturn = StrAppend( sReturn, CR, GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR))
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, nAL_LA_NR, '', '' )
.head 8 -  Set nCount = nCount + 1
.head 5 +  Else 
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(4, NUMBER_Null, '', '' )
.head 6 -  Set bOk = TRUE
.head 5 -  Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160419: mit WindowVariable für Update und erst bei ok ExecuteAndCommit weil Commit bei BLS ungewollt deklaration updatet; ar_update berücksichtigen
.head 4 -  Description: Schreibt Protokoll-Vorschau und gibt globales Stmt zurück, das bei OK durchgeführt wird
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam2
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sReturn
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = ' SELECT 
			1 
	       FROM
	             		artikel 
	       WHERE
	  	   	EXISTS(SELECT 
					 la_update 
			FROM 
					 lieferartikel 
			JOIN 
					artikellieferart x ON        la_nr = x.al_la_nr 
			JOIN
					artikel y 	         ON x.al_ar_nr = y.ar_nr
			AND 
					x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
			WHERE 		
					la_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
	   						             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR
					x.al_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
			OR		y.ar_update > @NULLVALUE(( SELECT  max(al_datum) 
							             FROM     artlog z 
    							             WHERE   z.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
	 	AND 	
			ar_nr = '||NumberToStrX(wp_nAR_NR)
.head 5 +  If Sql_FetchOne( hSql, sStmt ) 
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1
	     FROM           artikellieferart 
		   JOIN kueche ON ku_nr = al_ku_nr 
		   JOIN lieferartikel ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 8 -  Set sStmt = ''
.head 8 +  If nCount= 0
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, nAL_LA_NR, sLogParam1, sLogParam2)
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt)
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'UPDATE artikel SET ' ||  sStmt || 'WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 8 +  If bAL_TAX
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  Set sReturn = StrAppend( sReturn, CR, 'DELETE FROM artikeltaxierung WHERE at_art = 2 AND at_ar_nr = ' || NumberToStrX( p_nAR_NR ) )
.head 10 -  ! Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 9 -  Set sReturn = StrAppend( sReturn, CR, GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR))
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, nAL_LA_NR, '', '' )
.head 8 -  Set nCount = nCount + 1
.head 5 +  Else 
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(4, NUMBER_Null, '', '' )
.head 6 -  Set bOk = TRUE
.head 5 -  Return sReturn
.head 3 +  ! Function: GetLieferartikelDaten ! th20160318: zuerst prüfen ob sich etwas geändert hat (la_/al_update)  ; nur deklaration update wenn beim LA nicht leer; ZB+AR_NR in Protokoll; Deklarationen diferentieren und nur Daten übernehmen wenn anders
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sLogParam2
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If Sql_FetchOne( hSql, ' SELECT 
				1 
		       FROM
	              		artikel 
		       WHERE
		  	   	EXISTS(SELECT 
						 la_update 
				FROM 
						 lieferartikel 
				JOIN 
						artikellieferart x 
				ON 		
						la_nr = x.al_la_nr 
				AND 
						x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
				WHERE 		
						la_update > @NULLVALUE(( SELECT  max(al_datum) 
								             FROM     artlog y 
	    							             WHERE   y.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\')
				OR
						x.al_update > @NULLVALUE(( SELECT  max(al_datum) 
								             FROM     artlog y 
	    							             WHERE   y.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
	  	       AND 	
				ar_nr = '||NumberToStrX(wp_nAR_NR) ) 
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1
	     FROM           artikellieferart 
		   JOIN kueche ON ku_nr = al_ku_nr 
		   JOIN lieferartikel ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 8 -  Set sStmt = ''
.head 8 +  If nCount= 0
.head 9 -  Set sLogParam1 = ''
.head 9 -  Set sLogParam2 = ''
.head 9 -  Call Sql_FetchOne( oSql3.Sql (), 'SELECT ar_herkunft, ar_zutaten FROm artikel INTO :dlgArtikelDatenübertrag.sAR_HERKUNFT, :dlgArtikelDatenübertrag.lsAR_ZUTATEN WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR ) )
.head 9 +  If lsAR_ZUTATEN != lsLA_ZUTATEN AND lsLA_ZUTATEN != ''
.head 10 -  Set sStmt = ' ar_zutaten = \'' || lsLA_ZUTATEN || '\''
.head 10 -  Set sLogParam1 = 'Zutaten'
.head 9 +  If sAR_HERKUNFT != sLA_HERKUNFT AND sLA_HERKUNFT != ''
.head 10 -  Set sStmt = StrAppend( sStmt, ', ', 'ar_herkunft = \'' || sLA_HERKUNFT || '\'')
.head 10 -  Set sLogParam2 = 'Herkunft'
.head 9 +  If sStmt != ''
.head 10 -  Set sStmt = 'UPDATE artikel SET '|| sStmt ||' WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, nAL_LA_NR, sLogParam1, sLogParam2)
.head 8 +  If bAL_BLS
.head 9 -  Set sStmt = ''
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, 'XXX', 'ZB'||NumberToStrX(wp_nAR_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set sStmt = 'UPDATE artikel SET ' ||  sStmt || '
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 8 +  If bAL_TAX
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  Set sStmt = 'delete FROM ARTIKELTAXIERUNG
where AT_ART = 2 AND AT_AR_NR = ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 9 -  Set bOk = bOk AND GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, nAL_LA_NR, '', '' )
.head 8 -  Set nCount = nCount + 1
.head 5 +  Else 
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(4, NUMBER_Null, '', '' )
.head 6 -  Set bOk = TRUE
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelDaten ! th20160204: zuerst prüfen ob sich etwas geändert hat;  
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 +  If Sql_FetchOne( hSql, ' SELECT 
				1 
		       FROM
	              		artikel 
		       WHERE
		  	   	EXISTS(SELECT 
						 la_update 
				FROM 
						 lieferartikel 
				JOIN 
						artikellieferart x 
				ON 		la_nr = x.al_la_nr 

				AND 
						x.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'
				WHERE 		
						la_update > @NULLVALUE(( SELECT  max(al_datum) 
								             FROM     artlog y 
	    							             WHERE   y.al_ar_nr = '||NumberToStrX(wp_nAR_NR)||'), \'19120402\'))
	  	       AND 	
				ar_nr = '||NumberToStrX(wp_nAR_NR) ) 
.head 6 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 6 +  If sKuKstHiererchieString != STRING_Null
.head 7 -  Set sStmt = 'SELECT al_la_nr, al_std, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1
	     FROM           artikellieferart 
		   JOIN kueche ON ku_nr = al_ku_nr 
		   JOIN lieferartikel ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 7 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 7 -  Set nCount= 0
.head 7 -  Set bTaxDeleted = FALSE
.head 7 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 8 +  If nCount= 0
.head 9 -  Set sStmt = 'UPDATE artikel SET ar_zutaten = \'' || lsLA_ZUTATEN || '\', ar_herkunft = \'' || sLA_HERKUNFT || '\'
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 9 -  Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 9 -  ! wieder zurücksetzen weil nachher benutzt und konkateniert
.head 9 -  Set sStmt = ''
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, nAL_LA_NR, SalStrLeftX( lsLA_ZUTATEN, 20), SalStrLeftX( sLA_HERKUNFT, 20))
.head 8 +  If bAL_BLS
.head 9 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 10 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt )
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, 'XXX', 'ZB'||NumberToStrX(nAL_LA_NR) )
.head 9 +  Else If bLA_CHECKBLS
.head 10 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, sLA_SBLS, '' )
.head 9 +  Else If bLA_CHECKBLS1
.head 10 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 10 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, '', sLA_SBLS1 )
.head 9 +  If sStmt != ''
.head 10 -  Set sStmt = 'UPDATE artikel SET ' ||  sStmt || '
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 8 +  If bAL_TAX
.head 9 -  ! nur einmal löschen
.head 9 +  If bTaxDeleted = FALSE
.head 10 -  Set sStmt = 'delete FROM ARTIKELTAXIERUNG
where AT_ART = 2 AND AT_AR_NR = ' || NumberToStrX( p_nAR_NR )
.head 10 -  Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 10 -  Set bTaxDeleted = TRUE
.head 9 -  Set bOk = bOk AND GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, nAL_LA_NR, '', '' )
.head 8 -  Set nCount = nCount + 1
.head 5 +  Else 
.head 6 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(4, NUMBER_Null, '', '' )
.head 6 -  Set bOk = TRUE
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelDaten ! th20160201: JOIN auf lieferbereistellung-> bs_ps_nr <= 6 für selbstverwaltete LA und .. OR bs_datum IS NULL 
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 5 -  Number: nFetch 
.head 5 -  Number: nAL_LA_NR
.head 5 -  Boolean: bAL_STD
.head 5 -  Boolean: bAL_BLS
.head 5 -  Boolean: bAL_TAX
.head 5 -  Boolean: bLA_CHECKBLS
.head 5 -  String: sLA_SBLS
.head 5 -  String: sLA_SBLS1
.head 5 -  Boolean: bLA_CHECKBLS1
.head 5 -  Long String: lsLA_ZUTATEN
.head 5 -  String: sLA_HERKUNFT
.head 5 -  Number: nCount
.head 5 -  Boolean: bTaxDeleted
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sKuKstHiererchieString = GetKstString( nUserKuecheNrMandant, 'ku' )
.head 5 +  If sKuKstHiererchieString != STRING_Null
.head 6 -  Set sStmt = 'SELECT al_la_nr, al_std, al_bls, al_tax, LA_ZUTATEN, LA_HERKUNFT, la_checksbls, la_sbls, la_checksbls1, la_sbls1
	     INTO    :nAL_LA_NR, :bAL_STD, :bAL_BLS, :bAL_TAX, :lsLA_ZUTATEN, :sLA_HERKUNFT, :bLA_CHECKBLS, :sLA_SBLS, :bLA_CHECKBLS1, :sLA_SBLS1
	     FROM           artikellieferart 
		   JOIN kueche ON ku_nr = al_ku_nr 
		   JOIN lieferartikel ON la_nr = al_la_nr
		   JOIN lieferbereitstellung ON la_nr = bs_la_nr  AND bs_update = ( SELECT MAX( z.bs_update ) 
									FROM lieferbereitstellung z 
    									WHERE     z.bs_ps_nr <=6 
									           AND ( z.bs_datumvon <= SYSDATETIME OR z.bs_datumvon IS NULL)
                                                                                                                                         AND z.bs_ku_nr in ( '|| sKuKstHiererchieString ||' )
				                                                                                 AND z.bs_la_nr = al_la_nr
									)
	    WHERE           al_ar_nr = ' || NumberToStrX( wp_nAR_NR ) || 
		' AND ' || GetWhereKostenstellen( 'ku_kostenstelle', sUserKst ) || '
	ORDER BY al_std DESC, ku_kostenstelle DESC'
.head 6 -  Set bOk = Sql_ExecEx( oSql1.Sql(  ), sStmt, FALSE )
.head 6 -  Set nCount= 0
.head 6 -  Set bTaxDeleted = FALSE
.head 6 +  While SqlFetchNext( oSql1.Sql(  ), nFetch )
.head 7 +  If nCount= 0
.head 8 -  Set sStmt = 'UPDATE artikel SET ar_zutaten = \'' || lsLA_ZUTATEN || '\', ar_herkunft = \'' || sLA_HERKUNFT || '\'
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 8 -  Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 8 -  ! wieder zurücksetzen weil nachher benutzt und konkateniert
.head 8 -  Set sStmt = ''
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(1, nAL_LA_NR, SalStrLeftX( lsLA_ZUTATEN, 20), SalStrLeftX( sLA_HERKUNFT, 20))
.head 7 +  If bAL_BLS
.head 8 +  If bLA_CHECKBLS AND bLA_CHECKBLS1
.head 9 -  Set bOk = bOk AND GetLieferartikelBLS( nAL_LA_NR, sLA_SBLS, sLA_SBLS1, sStmt )
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, 'XXX', 'ZB'||NumberToStrX(nAL_LA_NR) )
.head 8 +  Else If bLA_CHECKBLS
.head 9 -  Set sStmt = 'ar_sbls = \'' || sLA_SBLS || '\''
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, sLA_SBLS, '' )
.head 8 +  Else If bLA_CHECKBLS1
.head 9 -  Set sStmt = 'ar_sbls1 = \'' || sLA_SBLS1 || '\''
.head 9 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(2, nAL_LA_NR, '', sLA_SBLS1 )
.head 8 +  If sStmt != ''
.head 9 -  Set sStmt = 'UPDATE artikel SET ' ||  sStmt || '
WHERE ar_nr =  ' || NumberToStrX( p_nAR_NR )
.head 9 -  Set bOk = bOk AND Sql_ExecEx( oSql2.Sql(  ), sStmt, FALSE )
.head 7 +  If bAL_TAX
.head 8 -  ! nur einmal löschen
.head 8 +  If bTaxDeleted = FALSE
.head 9 -  Set sStmt = 'delete FROM ARTIKELTAXIERUNG
where AT_ART = 2 AND AT_AR_NR = ' || NumberToStrX( p_nAR_NR )
.head 9 -  Set bOk = bOk AND Sql_Exec( oSql2.Sql(  ), sStmt )
.head 9 -  Set bTaxDeleted = TRUE
.head 8 -  Set bOk = bOk AND GetLieferartikelTAX( p_nAR_NR, nAL_LA_NR)
.head 8 -  Call tblArtikelDatenübertrag.NeuerArtLogEintrag(3, nAL_LA_NR, '', '' )
.head 7 -  Set nCount = nCount + 1
.head 6 -  Return bOk
.head 3 +  Function: GetLieferartikelTAX ! th 20160418: returnt stmt für globales stmt bei ok ...; at_art vom lieferartikel immer 2
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 4 +  Actions 
.head 5 -  Set dtGlobalTemp = DateOnly( SalDateCurrent(  ) )
.head 5 -  Set sStmt = 'INSERT INTO artikeltaxierung(AT_AR_NR, AT_ART,AT_TU_NR)
		SELECT DISTINCT ' || NumberToStrX( p_nAR_NR ) || ', 2, LT_TU_NR
		FROM lieferartikeltaxierung WHERE LT_LA_NR =  ' || NumberToStrX( p_nLA_NR ) || '
		AND NOT EXISTS (SELECT 1 FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' AND AT_ART = 2 AND  at_tu_nr = LT_TU_NR)'
.head 5 -  Return sStmt
.head 3 +  ! Function: GetLieferartikelTAX
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sStmt
.head 4 +  Actions 
.head 5 -  Set dtGlobalTemp = DateOnly( SalDateCurrent(  ) )
.head 5 -  Set sStmt = 'INSERT INTO artikeltaxierung(AT_AR_NR,AT_ART,AT_TU_NR)
		SELECT DISTINCT ' || NumberToStrX( p_nAR_NR ) || ' ,LT_ART,LT_TU_NR
		FROM lieferartikel WHERE LT_LA_NR =  ' || NumberToStrX( p_nLA_NR ) || '
		AND NOT EXISTS (SELECT 1 FROM artikeltaxierung WHERE at_ar_nr = ' || NumberToStrX( p_nAR_NR ) || ' AND AT_ART = 2 AND  at_tu_nr = LT_TU_NR)'
.head 5 -  Return Sql_Exec( hSql, sStmt )
.head 3 +  Function: MergeBlsErstellen
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
Produktdaten-BLS des Lieferartikels (LA_SBLS1) und dem BLS des Basisartikels (AR_SBLS)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 +  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 6 -  ! für Bezeichnung (sbls) des neuen Schlüssels
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  ! Receive String: r_sStatement
.head 6 -  ! gibt Stmt für update zurück in dem Fall dass la_sbls/sbls1 beide checked
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT 1,
ST,STE,SZ,SL,SE,GCAL,GJ,ZW,ZE,ZF,ZK,ZB,ZM,ZO,ZA,ZV,VA,VAR,VAC,VD,VE,VEAT,VK,VB1,VB2,VB3,VB3A,VB5,VB6,VB7,VB9,VB9G,VB9F,VB12,VC,MNA,MK,MCA,MMG,MP,MS,MCL,MFE,MZN,MCU,MMN,MF,MJ,KAM,KAS,KAX,KA,KMT,
KMF,KMG,KM,KDS,KDM,KDL,KD,KPOR,KPON,KPG,KPS,KP,KBP,KBH,KBU,KBC,KBL,KBW,KBN,EILE,ELEU,ELYS,EMET,ECYS,EPHE,ETYR,ETHR,ETRP,EVAL,EARG,EHIS,EEA,EALA,EASP,EGLU,EGLY,EPRO,ESER,ENA,EPF,EH,EP,F40,F60,F80,F100,
F120,F140,F150,F160,F170,F180,F200,F220,F240,FS,F141,F151,F161,F171,F181,F201,F221,F241,FU,F162,F164,F182,F183,F184,F193,F202,F203,F204,F205,F222,F223,F224,F225,F226,FP,FK,FM,FL,FG,FC,GFPS,GEBW,GEB,GKB,GMKO,
GMSB,GP,KMD,FO3,FO6
INTO :nGlobalTemp,
:sBLSDATArrayLoad[0],:sBLSDATArrayLoad[1],:sBLSDATArrayLoad[2],:sBLSDATArrayLoad[3],:sBLSDATArrayLoad[4],:sBLSDATArrayLoad[5],:sBLSDATArrayLoad[6],:sBLSDATArrayLoad[7],:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],:sBLSDATArrayLoad[10],:sBLSDATArrayLoad[11],:sBLSDATArrayLoad[12],:sBLSDATArrayLoad[13],:sBLSDATArrayLoad[14],:sBLSDATArrayLoad[15],:sBLSDATArrayLoad[16],:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],:sBLSDATArrayLoad[19],:sBLSDATArrayLoad[20],:sBLSDATArrayLoad[21],:sBLSDATArrayLoad[22],:sBLSDATArrayLoad[23],:sBLSDATArrayLoad[24],:sBLSDATArrayLoad[25],:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],:sBLSDATArrayLoad[28],:sBLSDATArrayLoad[29],:sBLSDATArrayLoad[30],:sBLSDATArrayLoad[31],:sBLSDATArrayLoad[32],:sBLSDATArrayLoad[33],:sBLSDATArrayLoad[34],:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],:sBLSDATArrayLoad[37],:sBLSDATArrayLoad[38],:sBLSDATArrayLoad[39],:sBLSDATArrayLoad[40],:sBLSDATArrayLoad[41],:sBLSDATArrayLoad[42],:sBLSDATArrayLoad[43],:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],:sBLSDATArrayLoad[46],:sBLSDATArrayLoad[47],:sBLSDATArrayLoad[48],:sBLSDATArrayLoad[49],:sBLSDATArrayLoad[50],:sBLSDATArrayLoad[51],:sBLSDATArrayLoad[52],:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],:sBLSDATArrayLoad[55],:sBLSDATArrayLoad[56],:sBLSDATArrayLoad[57],:sBLSDATArrayLoad[58],:sBLSDATArrayLoad[59],:sBLSDATArrayLoad[60],:sBLSDATArrayLoad[61],:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],:sBLSDATArrayLoad[64],:sBLSDATArrayLoad[65],:sBLSDATArrayLoad[66],:sBLSDATArrayLoad[67],:sBLSDATArrayLoad[68],:sBLSDATArrayLoad[69],:sBLSDATArrayLoad[70],:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],:sBLSDATArrayLoad[73],:sBLSDATArrayLoad[74],:sBLSDATArrayLoad[75],:sBLSDATArrayLoad[76],:sBLSDATArrayLoad[77],:sBLSDATArrayLoad[78],:sBLSDATArrayLoad[79],:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],:sBLSDATArrayLoad[82],:sBLSDATArrayLoad[83],:sBLSDATArrayLoad[84],:sBLSDATArrayLoad[85],:sBLSDATArrayLoad[86],:sBLSDATArrayLoad[87],:sBLSDATArrayLoad[88],:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],:sBLSDATArrayLoad[91],:sBLSDATArrayLoad[92],:sBLSDATArrayLoad[93],:sBLSDATArrayLoad[94],:sBLSDATArrayLoad[95],:sBLSDATArrayLoad[96],:sBLSDATArrayLoad[97],:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],:sBLSDATArrayLoad[100],:sBLSDATArrayLoad[101],:sBLSDATArrayLoad[102],:sBLSDATArrayLoad[103],:sBLSDATArrayLoad[104],:sBLSDATArrayLoad[105],:sBLSDATArrayLoad[106],:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],:sBLSDATArrayLoad[109],:sBLSDATArrayLoad[110],:sBLSDATArrayLoad[111],:sBLSDATArrayLoad[112],:sBLSDATArrayLoad[113],:sBLSDATArrayLoad[114],:sBLSDATArrayLoad[115],:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],:sBLSDATArrayLoad[118],:sBLSDATArrayLoad[119],:sBLSDATArrayLoad[120],:sBLSDATArrayLoad[121],:sBLSDATArrayLoad[122],:sBLSDATArrayLoad[123],:sBLSDATArrayLoad[124],:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],:sBLSDATArrayLoad[127],:sBLSDATArrayLoad[128],:sBLSDATArrayLoad[129],:sBLSDATArrayLoad[130],:sBLSDATArrayLoad[131],:sBLSDATArrayLoad[132],:sBLSDATArrayLoad[133],:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],:sBLSDATArrayLoad[136],:sBLSDATArrayLoad[137],:sBLSDATArrayLoad[138],:sBLSDATArrayLoad[139],:sBLSDATArrayLoad[140],:sBLSDATArrayLoad[141],:sBLSDATArrayLoad[142],:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],:sBLSDATArrayLoad[145],:sBLSDATArrayLoad[146],:sBLSDATArrayLoad[147],:sBLSDATArrayLoad[148]
FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\'' 
.head 5 -  Set sStmt = sStmt || '
UNION
SELECT 2,
ST,STE,SZ,SL,SE,GCAL,GJ,ZW,ZE,ZF,ZK,ZB,ZM,ZO,ZA,ZV,VA,VAR,VAC,VD,VE,VEAT,VK,VB1,VB2,VB3,VB3A,VB5,VB6,VB7,VB9,VB9G,VB9F,VB12,VC,MNA,MK,MCA,MMG,MP,MS,MCL,MFE,MZN,MCU,MMN,MF,MJ,KAM,KAS,KAX,KA,KMT,
KMF,KMG,KM,KDS,KDM,KDL,KD,KPOR,KPON,KPG,KPS,KP,KBP,KBH,KBU,KBC,KBL,KBW,KBN,EILE,ELEU,ELYS,EMET,ECYS,EPHE,ETYR,ETHR,ETRP,EVAL,EARG,EHIS,EEA,EALA,EASP,EGLU,EGLY,EPRO,ESER,ENA,EPF,EH,EP,F40,F60,F80,F100,
F120,F140,F150,F160,F170,F180,F200,F220,F240,FS,F141,F151,F161,F171,F181,F201,F221,F241,FU,F162,F164,F182,F183,F184,F193,F202,F203,F204,F205,F222,F223,F224,F225,F226,FP,FK,FM,FL,FG,FC,GFPS,GEBW,GEB,GKB,GMKO,
GMSB,GP,KMD,FO3,FO6
FROM BLSDAT 
WHERE SBLS = \'' || p_sAR_SBLS || '\' 
ORDER BY 1' 
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set saInsert[0] = wp_sAR_INTERN
.head 6 +  Set nArrayIndex = 1
.head 7 -  ! Ab 1 weil 0 ist st und st soll ar_intern sein
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set saInsert[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( p_nAR_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT ( 
SBLS,ST,STE,SZ,SL,SE,GCAL,GJ,ZW,ZE,ZF,ZK,ZB,ZM,ZO,ZA,ZV,VA,VAR,VAC,VD,VE,VEAT,VK,VB1,VB2,VB3,VB3A,VB5,VB6,VB7,VB9,VB9G,VB9F,VB12,VC,MNA,MK,MCA,MMG,MP,MS,MCL,MFE,MZN,MCU,MMN,MF,MJ,KAM,KAS,KAX,KA,KMT,
KMF,KMG,KM,KDS,KDM,KDL,KD,KPOR,KPON,KPG,KPS,KP,KBP,KBH,KBU,KBC,KBL,KBW,KBN,EILE,ELEU,ELYS,EMET,ECYS,EPHE,ETYR,ETHR,ETRP,EVAL,EARG,EHIS,EEA,EALA,EASP,EGLU,EGLY,EPRO,ESER,ENA,EPF,EH,EP,F40,F60,F80,F100,
F120,F140,F150,F160,F170,F180,F200,F220,F240,FS,F141,F151,F161,F171,F181,F201,F221,F241,FU,F162,F164,F182,F183,F184,F193,F202,F203,F204,F205,F222,F223,F224,F225,F226,FP,FK,FM,FL,FG,FC,GFPS,GEBW,GEB,GKB,GMKO,
GMSB,GP,KMD,FO3,FO6 )
VALUES ( :sGlobalTemp, :dlgArtikelDatenübertrag.saInsert[0], :dlgArtikelDatenübertrag.saInsert[1], :dlgArtikelDatenübertrag.saInsert[2], :dlgArtikelDatenübertrag.saInsert[3], 
:dlgArtikelDatenübertrag.saInsert[4], :dlgArtikelDatenübertrag.saInsert[5], :dlgArtikelDatenübertrag.saInsert[6], :dlgArtikelDatenübertrag.saInsert[7], 
:dlgArtikelDatenübertrag.saInsert[8], :dlgArtikelDatenübertrag.saInsert[9], :dlgArtikelDatenübertrag.saInsert[10], :dlgArtikelDatenübertrag.saInsert[11], 
:dlgArtikelDatenübertrag.saInsert[12], :dlgArtikelDatenübertrag.saInsert[13], :dlgArtikelDatenübertrag.saInsert[14], :dlgArtikelDatenübertrag.saInsert[15], 
:dlgArtikelDatenübertrag.saInsert[16], :dlgArtikelDatenübertrag.saInsert[17], :dlgArtikelDatenübertrag.saInsert[18], :dlgArtikelDatenübertrag.saInsert[19],
:dlgArtikelDatenübertrag.saInsert[20], :dlgArtikelDatenübertrag.saInsert[21], :dlgArtikelDatenübertrag.saInsert[22], :dlgArtikelDatenübertrag.saInsert[23],
:dlgArtikelDatenübertrag.saInsert[24], :dlgArtikelDatenübertrag.saInsert[25], :dlgArtikelDatenübertrag.saInsert[26], :dlgArtikelDatenübertrag.saInsert[27],
:dlgArtikelDatenübertrag.saInsert[28], :dlgArtikelDatenübertrag.saInsert[29], :dlgArtikelDatenübertrag.saInsert[30], :dlgArtikelDatenübertrag.saInsert[31], 
:dlgArtikelDatenübertrag.saInsert[32], :dlgArtikelDatenübertrag.saInsert[33], :dlgArtikelDatenübertrag.saInsert[34], :dlgArtikelDatenübertrag.saInsert[35],
:dlgArtikelDatenübertrag.saInsert[36], :dlgArtikelDatenübertrag.saInsert[37], :dlgArtikelDatenübertrag.saInsert[38], :dlgArtikelDatenübertrag.saInsert[39],
:dlgArtikelDatenübertrag.saInsert[40], :dlgArtikelDatenübertrag.saInsert[41], :dlgArtikelDatenübertrag.saInsert[42], :dlgArtikelDatenübertrag.saInsert[43],
:dlgArtikelDatenübertrag.saInsert[44], :dlgArtikelDatenübertrag.saInsert[45], :dlgArtikelDatenübertrag.saInsert[46], :dlgArtikelDatenübertrag.saInsert[47],
:dlgArtikelDatenübertrag.saInsert[48], :dlgArtikelDatenübertrag.saInsert[49], :dlgArtikelDatenübertrag.saInsert[50], :dlgArtikelDatenübertrag.saInsert[51],
:dlgArtikelDatenübertrag.saInsert[52], :dlgArtikelDatenübertrag.saInsert[53], :dlgArtikelDatenübertrag.saInsert[54], :dlgArtikelDatenübertrag.saInsert[55],
:dlgArtikelDatenübertrag.saInsert[56], :dlgArtikelDatenübertrag.saInsert[57], :dlgArtikelDatenübertrag.saInsert[58], :dlgArtikelDatenübertrag.saInsert[59],
:dlgArtikelDatenübertrag.saInsert[60], :dlgArtikelDatenübertrag.saInsert[61], :dlgArtikelDatenübertrag.saInsert[62], :dlgArtikelDatenübertrag.saInsert[63],
:dlgArtikelDatenübertrag.saInsert[64], :dlgArtikelDatenübertrag.saInsert[65], :dlgArtikelDatenübertrag.saInsert[66], :dlgArtikelDatenübertrag.saInsert[67],
:dlgArtikelDatenübertrag.saInsert[68], :dlgArtikelDatenübertrag.saInsert[69], :dlgArtikelDatenübertrag.saInsert[70], :dlgArtikelDatenübertrag.saInsert[71],
:dlgArtikelDatenübertrag.saInsert[72], :dlgArtikelDatenübertrag.saInsert[73], :dlgArtikelDatenübertrag.saInsert[74], :dlgArtikelDatenübertrag.saInsert[75],
:dlgArtikelDatenübertrag.saInsert[76], :dlgArtikelDatenübertrag.saInsert[77], :dlgArtikelDatenübertrag.saInsert[78], :dlgArtikelDatenübertrag.saInsert[79],
:dlgArtikelDatenübertrag.saInsert[80], :dlgArtikelDatenübertrag.saInsert[81], :dlgArtikelDatenübertrag.saInsert[82], :dlgArtikelDatenübertrag.saInsert[83],
:dlgArtikelDatenübertrag.saInsert[84], :dlgArtikelDatenübertrag.saInsert[85], :dlgArtikelDatenübertrag.saInsert[86], :dlgArtikelDatenübertrag.saInsert[87],
:dlgArtikelDatenübertrag.saInsert[88], :dlgArtikelDatenübertrag.saInsert[89], :dlgArtikelDatenübertrag.saInsert[90], :dlgArtikelDatenübertrag.saInsert[91],
:dlgArtikelDatenübertrag.saInsert[92], :dlgArtikelDatenübertrag.saInsert[93], :dlgArtikelDatenübertrag.saInsert[94], :dlgArtikelDatenübertrag.saInsert[95],
:dlgArtikelDatenübertrag.saInsert[96], :dlgArtikelDatenübertrag.saInsert[97], :dlgArtikelDatenübertrag.saInsert[98], :dlgArtikelDatenübertrag.saInsert[99],
:dlgArtikelDatenübertrag.saInsert[100], :dlgArtikelDatenübertrag.saInsert[101], :dlgArtikelDatenübertrag.saInsert[102], :dlgArtikelDatenübertrag.saInsert[103],
:dlgArtikelDatenübertrag.saInsert[104], :dlgArtikelDatenübertrag.saInsert[105], :dlgArtikelDatenübertrag.saInsert[106], :dlgArtikelDatenübertrag.saInsert[107],
:dlgArtikelDatenübertrag.saInsert[108], :dlgArtikelDatenübertrag.saInsert[109], :dlgArtikelDatenübertrag.saInsert[110], :dlgArtikelDatenübertrag.saInsert[111],
:dlgArtikelDatenübertrag.saInsert[112], :dlgArtikelDatenübertrag.saInsert[113], :dlgArtikelDatenübertrag.saInsert[114], :dlgArtikelDatenübertrag.saInsert[115],
:dlgArtikelDatenübertrag.saInsert[116], :dlgArtikelDatenübertrag.saInsert[117], :dlgArtikelDatenübertrag.saInsert[118], :dlgArtikelDatenübertrag.saInsert[119],
:dlgArtikelDatenübertrag.saInsert[120], :dlgArtikelDatenübertrag.saInsert[121], :dlgArtikelDatenübertrag.saInsert[122], :dlgArtikelDatenübertrag.saInsert[123],
:dlgArtikelDatenübertrag.saInsert[124], :dlgArtikelDatenübertrag.saInsert[125], :dlgArtikelDatenübertrag.saInsert[126], :dlgArtikelDatenübertrag.saInsert[127],
:dlgArtikelDatenübertrag.saInsert[128], :dlgArtikelDatenübertrag.saInsert[129], :dlgArtikelDatenübertrag.saInsert[130], :dlgArtikelDatenübertrag.saInsert[131],
:dlgArtikelDatenübertrag.saInsert[132], :dlgArtikelDatenübertrag.saInsert[133], :dlgArtikelDatenübertrag.saInsert[134], :dlgArtikelDatenübertrag.saInsert[135],
:dlgArtikelDatenübertrag.saInsert[136], :dlgArtikelDatenübertrag.saInsert[137], :dlgArtikelDatenübertrag.saInsert[138], :dlgArtikelDatenübertrag.saInsert[139],
:dlgArtikelDatenübertrag.saInsert[140], :dlgArtikelDatenübertrag.saInsert[141], :dlgArtikelDatenübertrag.saInsert[142], :dlgArtikelDatenübertrag.saInsert[143],
:dlgArtikelDatenübertrag.saInsert[144], :dlgArtikelDatenübertrag.saInsert[145], :dlgArtikelDatenübertrag.saInsert[146], :dlgArtikelDatenübertrag.saInsert[147],
:dlgArtikelDatenübertrag.saInsert[148] )'
.head 5 +  If Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Call Sql_Exec( oSql.Sql( ), 'DELETE FROM blsdat WHERE sbls = :sGlobalTemp' )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelBLS	! wl 20160821 drei Varianten #238
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  ! Receive String: r_sStatement
.head 6 -  ! gibt Stmt für update zurück in dem Fall dass la_sbls/sbls1 beide checked
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT 1,
ST,STE,SZ,SL,SE,GCAL,GJ,ZW,ZE,ZF,ZK,ZB,ZM,ZO,ZA,ZV,VA,VAR,VAC,VD,VE,VEAT,VK,VB1,VB2,VB3,VB3A,VB5,VB6,VB7,VB9,VB9G,VB9F,VB12,VC,MNA,MK,MCA,MMG,MP,MS,MCL,MFE,MZN,MCU,MMN,MF,MJ,KAM,KAS,KAX,KA,KMT,
KMF,KMG,KM,KDS,KDM,KDL,KD,KPOR,KPON,KPG,KPS,KP,KBP,KBH,KBU,KBC,KBL,KBW,KBN,EILE,ELEU,ELYS,EMET,ECYS,EPHE,ETYR,ETHR,ETRP,EVAL,EARG,EHIS,EEA,EALA,EASP,EGLU,EGLY,EPRO,ESER,ENA,EPF,EH,EP,F40,F60,F80,F100,
F120,F140,F150,F160,F170,F180,F200,F220,F240,FS,F141,F151,F161,F171,F181,F201,F221,F241,FU,F162,F164,F182,F183,F184,F193,F202,F203,F204,F205,F222,F223,F224,F225,F226,FP,FK,FM,FL,FG,FC,GFPS,GEBW,GEB,GKB,GMKO,
GMSB,GP,KMD,FO3,FO6
INTO :nGlobalTemp,
:sBLSDATArrayLoad[0],:sBLSDATArrayLoad[1],:sBLSDATArrayLoad[2],:sBLSDATArrayLoad[3],:sBLSDATArrayLoad[4],:sBLSDATArrayLoad[5],:sBLSDATArrayLoad[6],:sBLSDATArrayLoad[7],:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],:sBLSDATArrayLoad[10],:sBLSDATArrayLoad[11],:sBLSDATArrayLoad[12],:sBLSDATArrayLoad[13],:sBLSDATArrayLoad[14],:sBLSDATArrayLoad[15],:sBLSDATArrayLoad[16],:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],:sBLSDATArrayLoad[19],:sBLSDATArrayLoad[20],:sBLSDATArrayLoad[21],:sBLSDATArrayLoad[22],:sBLSDATArrayLoad[23],:sBLSDATArrayLoad[24],:sBLSDATArrayLoad[25],:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],:sBLSDATArrayLoad[28],:sBLSDATArrayLoad[29],:sBLSDATArrayLoad[30],:sBLSDATArrayLoad[31],:sBLSDATArrayLoad[32],:sBLSDATArrayLoad[33],:sBLSDATArrayLoad[34],:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],:sBLSDATArrayLoad[37],:sBLSDATArrayLoad[38],:sBLSDATArrayLoad[39],:sBLSDATArrayLoad[40],:sBLSDATArrayLoad[41],:sBLSDATArrayLoad[42],:sBLSDATArrayLoad[43],:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],:sBLSDATArrayLoad[46],:sBLSDATArrayLoad[47],:sBLSDATArrayLoad[48],:sBLSDATArrayLoad[49],:sBLSDATArrayLoad[50],:sBLSDATArrayLoad[51],:sBLSDATArrayLoad[52],:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],:sBLSDATArrayLoad[55],:sBLSDATArrayLoad[56],:sBLSDATArrayLoad[57],:sBLSDATArrayLoad[58],:sBLSDATArrayLoad[59],:sBLSDATArrayLoad[60],:sBLSDATArrayLoad[61],:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],:sBLSDATArrayLoad[64],:sBLSDATArrayLoad[65],:sBLSDATArrayLoad[66],:sBLSDATArrayLoad[67],:sBLSDATArrayLoad[68],:sBLSDATArrayLoad[69],:sBLSDATArrayLoad[70],:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],:sBLSDATArrayLoad[73],:sBLSDATArrayLoad[74],:sBLSDATArrayLoad[75],:sBLSDATArrayLoad[76],:sBLSDATArrayLoad[77],:sBLSDATArrayLoad[78],:sBLSDATArrayLoad[79],:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],:sBLSDATArrayLoad[82],:sBLSDATArrayLoad[83],:sBLSDATArrayLoad[84],:sBLSDATArrayLoad[85],:sBLSDATArrayLoad[86],:sBLSDATArrayLoad[87],:sBLSDATArrayLoad[88],:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],:sBLSDATArrayLoad[91],:sBLSDATArrayLoad[92],:sBLSDATArrayLoad[93],:sBLSDATArrayLoad[94],:sBLSDATArrayLoad[95],:sBLSDATArrayLoad[96],:sBLSDATArrayLoad[97],:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],:sBLSDATArrayLoad[100],:sBLSDATArrayLoad[101],:sBLSDATArrayLoad[102],:sBLSDATArrayLoad[103],:sBLSDATArrayLoad[104],:sBLSDATArrayLoad[105],:sBLSDATArrayLoad[106],:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],:sBLSDATArrayLoad[109],:sBLSDATArrayLoad[110],:sBLSDATArrayLoad[111],:sBLSDATArrayLoad[112],:sBLSDATArrayLoad[113],:sBLSDATArrayLoad[114],:sBLSDATArrayLoad[115],:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],:sBLSDATArrayLoad[118],:sBLSDATArrayLoad[119],:sBLSDATArrayLoad[120],:sBLSDATArrayLoad[121],:sBLSDATArrayLoad[122],:sBLSDATArrayLoad[123],:sBLSDATArrayLoad[124],:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],:sBLSDATArrayLoad[127],:sBLSDATArrayLoad[128],:sBLSDATArrayLoad[129],:sBLSDATArrayLoad[130],:sBLSDATArrayLoad[131],:sBLSDATArrayLoad[132],:sBLSDATArrayLoad[133],:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],:sBLSDATArrayLoad[136],:sBLSDATArrayLoad[137],:sBLSDATArrayLoad[138],:sBLSDATArrayLoad[139],:sBLSDATArrayLoad[140],:sBLSDATArrayLoad[141],:sBLSDATArrayLoad[142],:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],:sBLSDATArrayLoad[145],:sBLSDATArrayLoad[146],:sBLSDATArrayLoad[147],:sBLSDATArrayLoad[148]
























































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\'' 
.head 5 -  Set sStmt = sStmt || '
UNION
SELECT 2,
ST,STE,SZ,SL,SE,GCAL,GJ,ZW,ZE,ZF,ZK,ZB,ZM,ZO,ZA,ZV,VA,VAR,VAC,VD,VE,VEAT,VK,VB1,VB2,VB3,VB3A,VB5,VB6,VB7,VB9,VB9G,VB9F,VB12,VC,MNA,MK,MCA,MMG,MP,MS,MCL,MFE,MZN,MCU,MMN,MF,MJ,KAM,KAS,KAX,KA,KMT,
KMF,KMG,KM,KDS,KDM,KDL,KD,KPOR,KPON,KPG,KPS,KP,KBP,KBH,KBU,KBC,KBL,KBW,KBN,EILE,ELEU,ELYS,EMET,ECYS,EPHE,ETYR,ETHR,ETRP,EVAL,EARG,EHIS,EEA,EALA,EASP,EGLU,EGLY,EPRO,ESER,ENA,EPF,EH,EP,F40,F60,F80,F100,
F120,F140,F150,F160,F170,F180,F200,F220,F240,FS,F141,F151,F161,F171,F181,F201,F221,F241,FU,F162,F164,F182,F183,F184,F193,F202,F203,F204,F205,F222,F223,F224,F225,F226,FP,FK,FM,FL,FG,FC,GFPS,GEBW,GEB,GKB,GMKO,
GMSB,GP,KMD,FO3,FO6
FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY 1' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  ! wl 20160821 ist mir etwas zu zufällig, deshalb UNION
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set saInsert[0] = wp_sAR_INTERN
.head 6 +  Set nArrayIndex = 1
.head 7 -  ! Ab 1 weil 0 ist st und st soll ar_intern sein
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set saInsert[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( wp_nAR_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT ( 
SBLS,ST,STE,SZ,SL,SE,GCAL,GJ,ZW,ZE,ZF,ZK,ZB,ZM,ZO,ZA,ZV,VA,VAR,VAC,VD,VE,VEAT,VK,VB1,VB2,VB3,VB3A,VB5,VB6,VB7,VB9,VB9G,VB9F,VB12,VC,MNA,MK,MCA,MMG,MP,MS,MCL,MFE,MZN,MCU,MMN,MF,MJ,KAM,KAS,KAX,KA,KMT,
KMF,KMG,KM,KDS,KDM,KDL,KD,KPOR,KPON,KPG,KPS,KP,KBP,KBH,KBU,KBC,KBL,KBW,KBN,EILE,ELEU,ELYS,EMET,ECYS,EPHE,ETYR,ETHR,ETRP,EVAL,EARG,EHIS,EEA,EALA,EASP,EGLU,EGLY,EPRO,ESER,ENA,EPF,EH,EP,F40,F60,F80,F100,
F120,F140,F150,F160,F170,F180,F200,F220,F240,FS,F141,F151,F161,F171,F181,F201,F221,F241,FU,F162,F164,F182,F183,F184,F193,F202,F203,F204,F205,F222,F223,F224,F225,F226,FP,FK,FM,FL,FG,FC,GFPS,GEBW,GEB,GKB,GMKO,
GMSB,GP,KMD,FO3,FO6 )
VALUES ( :sGlobalTemp, :dlgArtikelDatenübertrag.saInsert[0], :dlgArtikelDatenübertrag.saInsert[1], :dlgArtikelDatenübertrag.saInsert[2], :dlgArtikelDatenübertrag.saInsert[3], 
:dlgArtikelDatenübertrag.saInsert[4], :dlgArtikelDatenübertrag.saInsert[5], :dlgArtikelDatenübertrag.saInsert[6], :dlgArtikelDatenübertrag.saInsert[7], 
:dlgArtikelDatenübertrag.saInsert[8], :dlgArtikelDatenübertrag.saInsert[9], :dlgArtikelDatenübertrag.saInsert[10], :dlgArtikelDatenübertrag.saInsert[11], 
:dlgArtikelDatenübertrag.saInsert[12], :dlgArtikelDatenübertrag.saInsert[13], :dlgArtikelDatenübertrag.saInsert[14], :dlgArtikelDatenübertrag.saInsert[15], 
:dlgArtikelDatenübertrag.saInsert[16], :dlgArtikelDatenübertrag.saInsert[17], :dlgArtikelDatenübertrag.saInsert[18], :dlgArtikelDatenübertrag.saInsert[19],
:dlgArtikelDatenübertrag.saInsert[20], :dlgArtikelDatenübertrag.saInsert[21], :dlgArtikelDatenübertrag.saInsert[22], :dlgArtikelDatenübertrag.saInsert[23],
:dlgArtikelDatenübertrag.saInsert[24], :dlgArtikelDatenübertrag.saInsert[25], :dlgArtikelDatenübertrag.saInsert[26], :dlgArtikelDatenübertrag.saInsert[27],
:dlgArtikelDatenübertrag.saInsert[28], :dlgArtikelDatenübertrag.saInsert[29], :dlgArtikelDatenübertrag.saInsert[30], :dlgArtikelDatenübertrag.saInsert[31], 
:dlgArtikelDatenübertrag.saInsert[32], :dlgArtikelDatenübertrag.saInsert[33], :dlgArtikelDatenübertrag.saInsert[34], :dlgArtikelDatenübertrag.saInsert[35],
:dlgArtikelDatenübertrag.saInsert[36], :dlgArtikelDatenübertrag.saInsert[37], :dlgArtikelDatenübertrag.saInsert[38], :dlgArtikelDatenübertrag.saInsert[39],
:dlgArtikelDatenübertrag.saInsert[40], :dlgArtikelDatenübertrag.saInsert[41], :dlgArtikelDatenübertrag.saInsert[42], :dlgArtikelDatenübertrag.saInsert[43],
:dlgArtikelDatenübertrag.saInsert[44], :dlgArtikelDatenübertrag.saInsert[45], :dlgArtikelDatenübertrag.saInsert[46], :dlgArtikelDatenübertrag.saInsert[47],
:dlgArtikelDatenübertrag.saInsert[48], :dlgArtikelDatenübertrag.saInsert[49], :dlgArtikelDatenübertrag.saInsert[50], :dlgArtikelDatenübertrag.saInsert[51],
:dlgArtikelDatenübertrag.saInsert[52], :dlgArtikelDatenübertrag.saInsert[53], :dlgArtikelDatenübertrag.saInsert[54], :dlgArtikelDatenübertrag.saInsert[55],
:dlgArtikelDatenübertrag.saInsert[56], :dlgArtikelDatenübertrag.saInsert[57], :dlgArtikelDatenübertrag.saInsert[58], :dlgArtikelDatenübertrag.saInsert[59],
:dlgArtikelDatenübertrag.saInsert[60], :dlgArtikelDatenübertrag.saInsert[61], :dlgArtikelDatenübertrag.saInsert[62], :dlgArtikelDatenübertrag.saInsert[63],
:dlgArtikelDatenübertrag.saInsert[64], :dlgArtikelDatenübertrag.saInsert[65], :dlgArtikelDatenübertrag.saInsert[66], :dlgArtikelDatenübertrag.saInsert[67],
:dlgArtikelDatenübertrag.saInsert[68], :dlgArtikelDatenübertrag.saInsert[69], :dlgArtikelDatenübertrag.saInsert[70], :dlgArtikelDatenübertrag.saInsert[71],
:dlgArtikelDatenübertrag.saInsert[72], :dlgArtikelDatenübertrag.saInsert[73], :dlgArtikelDatenübertrag.saInsert[74], :dlgArtikelDatenübertrag.saInsert[75],
:dlgArtikelDatenübertrag.saInsert[76], :dlgArtikelDatenübertrag.saInsert[77], :dlgArtikelDatenübertrag.saInsert[78], :dlgArtikelDatenübertrag.saInsert[79],
:dlgArtikelDatenübertrag.saInsert[80], :dlgArtikelDatenübertrag.saInsert[81], :dlgArtikelDatenübertrag.saInsert[82], :dlgArtikelDatenübertrag.saInsert[83],
:dlgArtikelDatenübertrag.saInsert[84], :dlgArtikelDatenübertrag.saInsert[85], :dlgArtikelDatenübertrag.saInsert[86], :dlgArtikelDatenübertrag.saInsert[87],
:dlgArtikelDatenübertrag.saInsert[88], :dlgArtikelDatenübertrag.saInsert[89], :dlgArtikelDatenübertrag.saInsert[90], :dlgArtikelDatenübertrag.saInsert[91],
:dlgArtikelDatenübertrag.saInsert[92], :dlgArtikelDatenübertrag.saInsert[93], :dlgArtikelDatenübertrag.saInsert[94], :dlgArtikelDatenübertrag.saInsert[95],
:dlgArtikelDatenübertrag.saInsert[96], :dlgArtikelDatenübertrag.saInsert[97], :dlgArtikelDatenübertrag.saInsert[98], :dlgArtikelDatenübertrag.saInsert[99],
:dlgArtikelDatenübertrag.saInsert[100], :dlgArtikelDatenübertrag.saInsert[101], :dlgArtikelDatenübertrag.saInsert[102], :dlgArtikelDatenübertrag.saInsert[103],
:dlgArtikelDatenübertrag.saInsert[104], :dlgArtikelDatenübertrag.saInsert[105], :dlgArtikelDatenübertrag.saInsert[106], :dlgArtikelDatenübertrag.saInsert[107],
:dlgArtikelDatenübertrag.saInsert[108], :dlgArtikelDatenübertrag.saInsert[109], :dlgArtikelDatenübertrag.saInsert[110], :dlgArtikelDatenübertrag.saInsert[111],
:dlgArtikelDatenübertrag.saInsert[112], :dlgArtikelDatenübertrag.saInsert[113], :dlgArtikelDatenübertrag.saInsert[114], :dlgArtikelDatenübertrag.saInsert[115],
:dlgArtikelDatenübertrag.saInsert[116], :dlgArtikelDatenübertrag.saInsert[117], :dlgArtikelDatenübertrag.saInsert[118], :dlgArtikelDatenübertrag.saInsert[119],
:dlgArtikelDatenübertrag.saInsert[120], :dlgArtikelDatenübertrag.saInsert[121], :dlgArtikelDatenübertrag.saInsert[122], :dlgArtikelDatenübertrag.saInsert[123],
:dlgArtikelDatenübertrag.saInsert[124], :dlgArtikelDatenübertrag.saInsert[125], :dlgArtikelDatenübertrag.saInsert[126], :dlgArtikelDatenübertrag.saInsert[127],
:dlgArtikelDatenübertrag.saInsert[128], :dlgArtikelDatenübertrag.saInsert[129], :dlgArtikelDatenübertrag.saInsert[130], :dlgArtikelDatenübertrag.saInsert[131],
:dlgArtikelDatenübertrag.saInsert[132], :dlgArtikelDatenübertrag.saInsert[133], :dlgArtikelDatenübertrag.saInsert[134], :dlgArtikelDatenübertrag.saInsert[135],
:dlgArtikelDatenübertrag.saInsert[136], :dlgArtikelDatenübertrag.saInsert[137], :dlgArtikelDatenübertrag.saInsert[138], :dlgArtikelDatenübertrag.saInsert[139],
:dlgArtikelDatenübertrag.saInsert[140], :dlgArtikelDatenübertrag.saInsert[141], :dlgArtikelDatenübertrag.saInsert[142], :dlgArtikelDatenübertrag.saInsert[143],
:dlgArtikelDatenübertrag.saInsert[144], :dlgArtikelDatenübertrag.saInsert[145], :dlgArtikelDatenübertrag.saInsert[146], :dlgArtikelDatenübertrag.saInsert[147],
:dlgArtikelDatenübertrag.saInsert[148] )'
.head 5 +  If Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Call Sql_Exec( oSql.Sql( ), 'DELETE FROM blsdat WHERE sbls = :sGlobalTemp' )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelBLS ! th 20160512: ar_intern bei Merge in st schreiben
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  Receive String: r_sStatement
.head 6 -  ! gibt Stmt für update zurück in dem Fall dass la_sbls/sbls1 beide checked
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6
INTO
:sDummy,
:sBLSDATArrayLoad[0],
:sBLSDATArrayLoad[1],
:sBLSDATArrayLoad[2],
:sBLSDATArrayLoad[3],
:sBLSDATArrayLoad[4],
:sBLSDATArrayLoad[5],
:sBLSDATArrayLoad[6],
:sBLSDATArrayLoad[7],
:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],
:sBLSDATArrayLoad[10],
:sBLSDATArrayLoad[11],
:sBLSDATArrayLoad[12],
:sBLSDATArrayLoad[13],
:sBLSDATArrayLoad[14],
:sBLSDATArrayLoad[15],
:sBLSDATArrayLoad[16],
:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],
:sBLSDATArrayLoad[19],
:sBLSDATArrayLoad[20],
:sBLSDATArrayLoad[21],
:sBLSDATArrayLoad[22],
:sBLSDATArrayLoad[23],
:sBLSDATArrayLoad[24],
:sBLSDATArrayLoad[25],
:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],
:sBLSDATArrayLoad[28],
:sBLSDATArrayLoad[29],
:sBLSDATArrayLoad[30],
:sBLSDATArrayLoad[31],
:sBLSDATArrayLoad[32],
:sBLSDATArrayLoad[33],
:sBLSDATArrayLoad[34],
:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],
:sBLSDATArrayLoad[37],
:sBLSDATArrayLoad[38],
:sBLSDATArrayLoad[39],
:sBLSDATArrayLoad[40],
:sBLSDATArrayLoad[41],
:sBLSDATArrayLoad[42],
:sBLSDATArrayLoad[43],
:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],
:sBLSDATArrayLoad[46],
:sBLSDATArrayLoad[47],
:sBLSDATArrayLoad[48],
:sBLSDATArrayLoad[49],
:sBLSDATArrayLoad[50],
:sBLSDATArrayLoad[51],
:sBLSDATArrayLoad[52],
:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],
:sBLSDATArrayLoad[55],
:sBLSDATArrayLoad[56],
:sBLSDATArrayLoad[57],
:sBLSDATArrayLoad[58],
:sBLSDATArrayLoad[59],
:sBLSDATArrayLoad[60],
:sBLSDATArrayLoad[61],
:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],
:sBLSDATArrayLoad[64],
:sBLSDATArrayLoad[65],
:sBLSDATArrayLoad[66],
:sBLSDATArrayLoad[67],
:sBLSDATArrayLoad[68],
:sBLSDATArrayLoad[69],
:sBLSDATArrayLoad[70],
:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],
:sBLSDATArrayLoad[73],
:sBLSDATArrayLoad[74],
:sBLSDATArrayLoad[75],
:sBLSDATArrayLoad[76],
:sBLSDATArrayLoad[77],
:sBLSDATArrayLoad[78],
:sBLSDATArrayLoad[79],
:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],
:sBLSDATArrayLoad[82],
:sBLSDATArrayLoad[83],
:sBLSDATArrayLoad[84],
:sBLSDATArrayLoad[85],
:sBLSDATArrayLoad[86],
:sBLSDATArrayLoad[87],
:sBLSDATArrayLoad[88],
:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],
:sBLSDATArrayLoad[91],
:sBLSDATArrayLoad[92],
:sBLSDATArrayLoad[93],
:sBLSDATArrayLoad[94],
:sBLSDATArrayLoad[95],
:sBLSDATArrayLoad[96],
:sBLSDATArrayLoad[97],
:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],
:sBLSDATArrayLoad[100],
:sBLSDATArrayLoad[101],
:sBLSDATArrayLoad[102],
:sBLSDATArrayLoad[103],
:sBLSDATArrayLoad[104],
:sBLSDATArrayLoad[105],
:sBLSDATArrayLoad[106],
:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],
:sBLSDATArrayLoad[109],
:sBLSDATArrayLoad[110],
:sBLSDATArrayLoad[111],
:sBLSDATArrayLoad[112],
:sBLSDATArrayLoad[113],
:sBLSDATArrayLoad[114],
:sBLSDATArrayLoad[115],
:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],
:sBLSDATArrayLoad[118],
:sBLSDATArrayLoad[119],
:sBLSDATArrayLoad[120],
:sBLSDATArrayLoad[121],
:sBLSDATArrayLoad[122],
:sBLSDATArrayLoad[123],
:sBLSDATArrayLoad[124],
:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],
:sBLSDATArrayLoad[127],
:sBLSDATArrayLoad[128],
:sBLSDATArrayLoad[129],
:sBLSDATArrayLoad[130],
:sBLSDATArrayLoad[131],
:sBLSDATArrayLoad[132],
:sBLSDATArrayLoad[133],
:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],
:sBLSDATArrayLoad[136],
:sBLSDATArrayLoad[137],
:sBLSDATArrayLoad[138],
:sBLSDATArrayLoad[139],
:sBLSDATArrayLoad[140],
:sBLSDATArrayLoad[141],
:sBLSDATArrayLoad[142],
:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],
:sBLSDATArrayLoad[145],
:sBLSDATArrayLoad[146],
:sBLSDATArrayLoad[147],
:sBLSDATArrayLoad[148]




























































































































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\' OR SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY SBLS' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set saInsert[0] = wp_sAR_INTERN
.head 6 +  Set nArrayIndex = 1
.head 7 -  ! Ab 1 weil 0 ist st und st soll ar_intern sein
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set saInsert[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( wp_nAR_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT ( 
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6 )
VALUES ( :sGlobalTemp, :dlgArtikelDatenübertrag.saInsert[0], :dlgArtikelDatenübertrag.saInsert[1], :dlgArtikelDatenübertrag.saInsert[2], :dlgArtikelDatenübertrag.saInsert[3], 
:dlgArtikelDatenübertrag.saInsert[4], :dlgArtikelDatenübertrag.saInsert[5], :dlgArtikelDatenübertrag.saInsert[6], :dlgArtikelDatenübertrag.saInsert[7], 
:dlgArtikelDatenübertrag.saInsert[8], :dlgArtikelDatenübertrag.saInsert[9], :dlgArtikelDatenübertrag.saInsert[10], :dlgArtikelDatenübertrag.saInsert[11], 
:dlgArtikelDatenübertrag.saInsert[12], :dlgArtikelDatenübertrag.saInsert[13], :dlgArtikelDatenübertrag.saInsert[14], :dlgArtikelDatenübertrag.saInsert[15], 
:dlgArtikelDatenübertrag.saInsert[16], :dlgArtikelDatenübertrag.saInsert[17], :dlgArtikelDatenübertrag.saInsert[18], :dlgArtikelDatenübertrag.saInsert[19],
:dlgArtikelDatenübertrag.saInsert[20], :dlgArtikelDatenübertrag.saInsert[21], :dlgArtikelDatenübertrag.saInsert[22], :dlgArtikelDatenübertrag.saInsert[23],
:dlgArtikelDatenübertrag.saInsert[24], :dlgArtikelDatenübertrag.saInsert[25], :dlgArtikelDatenübertrag.saInsert[26], :dlgArtikelDatenübertrag.saInsert[27],
:dlgArtikelDatenübertrag.saInsert[28], :dlgArtikelDatenübertrag.saInsert[29], :dlgArtikelDatenübertrag.saInsert[30], :dlgArtikelDatenübertrag.saInsert[31], 
:dlgArtikelDatenübertrag.saInsert[32], :dlgArtikelDatenübertrag.saInsert[33], :dlgArtikelDatenübertrag.saInsert[34], :dlgArtikelDatenübertrag.saInsert[35],
:dlgArtikelDatenübertrag.saInsert[36], :dlgArtikelDatenübertrag.saInsert[37], :dlgArtikelDatenübertrag.saInsert[38], :dlgArtikelDatenübertrag.saInsert[39],
:dlgArtikelDatenübertrag.saInsert[40], :dlgArtikelDatenübertrag.saInsert[41], :dlgArtikelDatenübertrag.saInsert[42], :dlgArtikelDatenübertrag.saInsert[43],
:dlgArtikelDatenübertrag.saInsert[44], :dlgArtikelDatenübertrag.saInsert[45], :dlgArtikelDatenübertrag.saInsert[46], :dlgArtikelDatenübertrag.saInsert[47],
:dlgArtikelDatenübertrag.saInsert[48], :dlgArtikelDatenübertrag.saInsert[49], :dlgArtikelDatenübertrag.saInsert[50], :dlgArtikelDatenübertrag.saInsert[51],
:dlgArtikelDatenübertrag.saInsert[52], :dlgArtikelDatenübertrag.saInsert[53], :dlgArtikelDatenübertrag.saInsert[54], :dlgArtikelDatenübertrag.saInsert[55],
:dlgArtikelDatenübertrag.saInsert[56], :dlgArtikelDatenübertrag.saInsert[57], :dlgArtikelDatenübertrag.saInsert[58], :dlgArtikelDatenübertrag.saInsert[59],
:dlgArtikelDatenübertrag.saInsert[60], :dlgArtikelDatenübertrag.saInsert[61], :dlgArtikelDatenübertrag.saInsert[62], :dlgArtikelDatenübertrag.saInsert[63],
:dlgArtikelDatenübertrag.saInsert[64], :dlgArtikelDatenübertrag.saInsert[65], :dlgArtikelDatenübertrag.saInsert[66], :dlgArtikelDatenübertrag.saInsert[67],
:dlgArtikelDatenübertrag.saInsert[68], :dlgArtikelDatenübertrag.saInsert[69], :dlgArtikelDatenübertrag.saInsert[70], :dlgArtikelDatenübertrag.saInsert[71],
:dlgArtikelDatenübertrag.saInsert[72], :dlgArtikelDatenübertrag.saInsert[73], :dlgArtikelDatenübertrag.saInsert[74], :dlgArtikelDatenübertrag.saInsert[75],
:dlgArtikelDatenübertrag.saInsert[76], :dlgArtikelDatenübertrag.saInsert[77], :dlgArtikelDatenübertrag.saInsert[78], :dlgArtikelDatenübertrag.saInsert[79],
:dlgArtikelDatenübertrag.saInsert[80], :dlgArtikelDatenübertrag.saInsert[81], :dlgArtikelDatenübertrag.saInsert[82], :dlgArtikelDatenübertrag.saInsert[83],
:dlgArtikelDatenübertrag.saInsert[84], :dlgArtikelDatenübertrag.saInsert[85], :dlgArtikelDatenübertrag.saInsert[86], :dlgArtikelDatenübertrag.saInsert[87],
:dlgArtikelDatenübertrag.saInsert[88], :dlgArtikelDatenübertrag.saInsert[89], :dlgArtikelDatenübertrag.saInsert[90], :dlgArtikelDatenübertrag.saInsert[91],
:dlgArtikelDatenübertrag.saInsert[92], :dlgArtikelDatenübertrag.saInsert[93], :dlgArtikelDatenübertrag.saInsert[94], :dlgArtikelDatenübertrag.saInsert[95],
:dlgArtikelDatenübertrag.saInsert[96], :dlgArtikelDatenübertrag.saInsert[97], :dlgArtikelDatenübertrag.saInsert[98], :dlgArtikelDatenübertrag.saInsert[99],
:dlgArtikelDatenübertrag.saInsert[100], :dlgArtikelDatenübertrag.saInsert[101], :dlgArtikelDatenübertrag.saInsert[102], :dlgArtikelDatenübertrag.saInsert[103],
:dlgArtikelDatenübertrag.saInsert[104], :dlgArtikelDatenübertrag.saInsert[105], :dlgArtikelDatenübertrag.saInsert[106], :dlgArtikelDatenübertrag.saInsert[107],
:dlgArtikelDatenübertrag.saInsert[108], :dlgArtikelDatenübertrag.saInsert[109], :dlgArtikelDatenübertrag.saInsert[110], :dlgArtikelDatenübertrag.saInsert[111],
:dlgArtikelDatenübertrag.saInsert[112], :dlgArtikelDatenübertrag.saInsert[113], :dlgArtikelDatenübertrag.saInsert[114], :dlgArtikelDatenübertrag.saInsert[115],
:dlgArtikelDatenübertrag.saInsert[116], :dlgArtikelDatenübertrag.saInsert[117], :dlgArtikelDatenübertrag.saInsert[118], :dlgArtikelDatenübertrag.saInsert[119],
:dlgArtikelDatenübertrag.saInsert[120], :dlgArtikelDatenübertrag.saInsert[121], :dlgArtikelDatenübertrag.saInsert[122], :dlgArtikelDatenübertrag.saInsert[123],
:dlgArtikelDatenübertrag.saInsert[124], :dlgArtikelDatenübertrag.saInsert[125], :dlgArtikelDatenübertrag.saInsert[126], :dlgArtikelDatenübertrag.saInsert[127],
:dlgArtikelDatenübertrag.saInsert[128], :dlgArtikelDatenübertrag.saInsert[129], :dlgArtikelDatenübertrag.saInsert[130], :dlgArtikelDatenübertrag.saInsert[131],
:dlgArtikelDatenübertrag.saInsert[132], :dlgArtikelDatenübertrag.saInsert[133], :dlgArtikelDatenübertrag.saInsert[134], :dlgArtikelDatenübertrag.saInsert[135],
:dlgArtikelDatenübertrag.saInsert[136], :dlgArtikelDatenübertrag.saInsert[137], :dlgArtikelDatenübertrag.saInsert[138], :dlgArtikelDatenübertrag.saInsert[139],
:dlgArtikelDatenübertrag.saInsert[140], :dlgArtikelDatenübertrag.saInsert[141], :dlgArtikelDatenübertrag.saInsert[142], :dlgArtikelDatenübertrag.saInsert[143],
:dlgArtikelDatenübertrag.saInsert[144], :dlgArtikelDatenübertrag.saInsert[145], :dlgArtikelDatenübertrag.saInsert[146], :dlgArtikelDatenübertrag.saInsert[147],
:dlgArtikelDatenübertrag.saInsert[148] )'
.head 5 +  If Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Call Sql_Exec( oSql.Sql( ), 'DELETE FROM blsdat WHERE sbls = :sGlobalTemp' )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 6 -  Set r_sStatement = STRING_Null
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 6 -  Set r_sStatement = 'ar_sbls1 = \'ZB'|| NumberToStrX( wp_nAR_NR ) ||'\''
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelBLS ! th 20160310: zb+ar_nr statt la_nr
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 +  Receive String: r_sStatement
.head 6 -  ! gibt Stmt für update zurück in dem Fall dass la_sbls/sbls1 beide checked
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6
INTO
:sDummy,
:sBLSDATArrayLoad[0],
:sBLSDATArrayLoad[1],
:sBLSDATArrayLoad[2],
:sBLSDATArrayLoad[3],
:sBLSDATArrayLoad[4],
:sBLSDATArrayLoad[5],
:sBLSDATArrayLoad[6],
:sBLSDATArrayLoad[7],
:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],
:sBLSDATArrayLoad[10],
:sBLSDATArrayLoad[11],
:sBLSDATArrayLoad[12],
:sBLSDATArrayLoad[13],
:sBLSDATArrayLoad[14],
:sBLSDATArrayLoad[15],
:sBLSDATArrayLoad[16],
:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],
:sBLSDATArrayLoad[19],
:sBLSDATArrayLoad[20],
:sBLSDATArrayLoad[21],
:sBLSDATArrayLoad[22],
:sBLSDATArrayLoad[23],
:sBLSDATArrayLoad[24],
:sBLSDATArrayLoad[25],
:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],
:sBLSDATArrayLoad[28],
:sBLSDATArrayLoad[29],
:sBLSDATArrayLoad[30],
:sBLSDATArrayLoad[31],
:sBLSDATArrayLoad[32],
:sBLSDATArrayLoad[33],
:sBLSDATArrayLoad[34],
:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],
:sBLSDATArrayLoad[37],
:sBLSDATArrayLoad[38],
:sBLSDATArrayLoad[39],
:sBLSDATArrayLoad[40],
:sBLSDATArrayLoad[41],
:sBLSDATArrayLoad[42],
:sBLSDATArrayLoad[43],
:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],
:sBLSDATArrayLoad[46],
:sBLSDATArrayLoad[47],
:sBLSDATArrayLoad[48],
:sBLSDATArrayLoad[49],
:sBLSDATArrayLoad[50],
:sBLSDATArrayLoad[51],
:sBLSDATArrayLoad[52],
:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],
:sBLSDATArrayLoad[55],
:sBLSDATArrayLoad[56],
:sBLSDATArrayLoad[57],
:sBLSDATArrayLoad[58],
:sBLSDATArrayLoad[59],
:sBLSDATArrayLoad[60],
:sBLSDATArrayLoad[61],
:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],
:sBLSDATArrayLoad[64],
:sBLSDATArrayLoad[65],
:sBLSDATArrayLoad[66],
:sBLSDATArrayLoad[67],
:sBLSDATArrayLoad[68],
:sBLSDATArrayLoad[69],
:sBLSDATArrayLoad[70],
:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],
:sBLSDATArrayLoad[73],
:sBLSDATArrayLoad[74],
:sBLSDATArrayLoad[75],
:sBLSDATArrayLoad[76],
:sBLSDATArrayLoad[77],
:sBLSDATArrayLoad[78],
:sBLSDATArrayLoad[79],
:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],
:sBLSDATArrayLoad[82],
:sBLSDATArrayLoad[83],
:sBLSDATArrayLoad[84],
:sBLSDATArrayLoad[85],
:sBLSDATArrayLoad[86],
:sBLSDATArrayLoad[87],
:sBLSDATArrayLoad[88],
:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],
:sBLSDATArrayLoad[91],
:sBLSDATArrayLoad[92],
:sBLSDATArrayLoad[93],
:sBLSDATArrayLoad[94],
:sBLSDATArrayLoad[95],
:sBLSDATArrayLoad[96],
:sBLSDATArrayLoad[97],
:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],
:sBLSDATArrayLoad[100],
:sBLSDATArrayLoad[101],
:sBLSDATArrayLoad[102],
:sBLSDATArrayLoad[103],
:sBLSDATArrayLoad[104],
:sBLSDATArrayLoad[105],
:sBLSDATArrayLoad[106],
:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],
:sBLSDATArrayLoad[109],
:sBLSDATArrayLoad[110],
:sBLSDATArrayLoad[111],
:sBLSDATArrayLoad[112],
:sBLSDATArrayLoad[113],
:sBLSDATArrayLoad[114],
:sBLSDATArrayLoad[115],
:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],
:sBLSDATArrayLoad[118],
:sBLSDATArrayLoad[119],
:sBLSDATArrayLoad[120],
:sBLSDATArrayLoad[121],
:sBLSDATArrayLoad[122],
:sBLSDATArrayLoad[123],
:sBLSDATArrayLoad[124],
:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],
:sBLSDATArrayLoad[127],
:sBLSDATArrayLoad[128],
:sBLSDATArrayLoad[129],
:sBLSDATArrayLoad[130],
:sBLSDATArrayLoad[131],
:sBLSDATArrayLoad[132],
:sBLSDATArrayLoad[133],
:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],
:sBLSDATArrayLoad[136],
:sBLSDATArrayLoad[137],
:sBLSDATArrayLoad[138],
:sBLSDATArrayLoad[139],
:sBLSDATArrayLoad[140],
:sBLSDATArrayLoad[141],
:sBLSDATArrayLoad[142],
:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],
:sBLSDATArrayLoad[145],
:sBLSDATArrayLoad[146],
:sBLSDATArrayLoad[147],
:sBLSDATArrayLoad[148]




























































































































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\' OR SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY SBLS' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set nArrayIndex = 0
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set saInsert[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( wp_nAR_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT ( 
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6 )
VALUES ( :sGlobalTemp, :dlgArtikelDatenübertrag.saInsert[0], :dlgArtikelDatenübertrag.saInsert[1], :dlgArtikelDatenübertrag.saInsert[2], :dlgArtikelDatenübertrag.saInsert[3], 
:dlgArtikelDatenübertrag.saInsert[4], :dlgArtikelDatenübertrag.saInsert[5], :dlgArtikelDatenübertrag.saInsert[6], :dlgArtikelDatenübertrag.saInsert[7], 
:dlgArtikelDatenübertrag.saInsert[8], :dlgArtikelDatenübertrag.saInsert[9], :dlgArtikelDatenübertrag.saInsert[10], :dlgArtikelDatenübertrag.saInsert[11], 
:dlgArtikelDatenübertrag.saInsert[12], :dlgArtikelDatenübertrag.saInsert[13], :dlgArtikelDatenübertrag.saInsert[14], :dlgArtikelDatenübertrag.saInsert[15], 
:dlgArtikelDatenübertrag.saInsert[16], :dlgArtikelDatenübertrag.saInsert[17], :dlgArtikelDatenübertrag.saInsert[18], :dlgArtikelDatenübertrag.saInsert[19],
:dlgArtikelDatenübertrag.saInsert[20], :dlgArtikelDatenübertrag.saInsert[21], :dlgArtikelDatenübertrag.saInsert[22], :dlgArtikelDatenübertrag.saInsert[23],
:dlgArtikelDatenübertrag.saInsert[24], :dlgArtikelDatenübertrag.saInsert[25], :dlgArtikelDatenübertrag.saInsert[26], :dlgArtikelDatenübertrag.saInsert[27],
:dlgArtikelDatenübertrag.saInsert[28], :dlgArtikelDatenübertrag.saInsert[29], :dlgArtikelDatenübertrag.saInsert[30], :dlgArtikelDatenübertrag.saInsert[31], 
:dlgArtikelDatenübertrag.saInsert[32], :dlgArtikelDatenübertrag.saInsert[33], :dlgArtikelDatenübertrag.saInsert[34], :dlgArtikelDatenübertrag.saInsert[35],
:dlgArtikelDatenübertrag.saInsert[36], :dlgArtikelDatenübertrag.saInsert[37], :dlgArtikelDatenübertrag.saInsert[38], :dlgArtikelDatenübertrag.saInsert[39],
:dlgArtikelDatenübertrag.saInsert[40], :dlgArtikelDatenübertrag.saInsert[41], :dlgArtikelDatenübertrag.saInsert[42], :dlgArtikelDatenübertrag.saInsert[43],
:dlgArtikelDatenübertrag.saInsert[44], :dlgArtikelDatenübertrag.saInsert[45], :dlgArtikelDatenübertrag.saInsert[46], :dlgArtikelDatenübertrag.saInsert[47],
:dlgArtikelDatenübertrag.saInsert[48], :dlgArtikelDatenübertrag.saInsert[49], :dlgArtikelDatenübertrag.saInsert[50], :dlgArtikelDatenübertrag.saInsert[51],
:dlgArtikelDatenübertrag.saInsert[52], :dlgArtikelDatenübertrag.saInsert[53], :dlgArtikelDatenübertrag.saInsert[54], :dlgArtikelDatenübertrag.saInsert[55],
:dlgArtikelDatenübertrag.saInsert[56], :dlgArtikelDatenübertrag.saInsert[57], :dlgArtikelDatenübertrag.saInsert[58], :dlgArtikelDatenübertrag.saInsert[59],
:dlgArtikelDatenübertrag.saInsert[60], :dlgArtikelDatenübertrag.saInsert[61], :dlgArtikelDatenübertrag.saInsert[62], :dlgArtikelDatenübertrag.saInsert[63],
:dlgArtikelDatenübertrag.saInsert[64], :dlgArtikelDatenübertrag.saInsert[65], :dlgArtikelDatenübertrag.saInsert[66], :dlgArtikelDatenübertrag.saInsert[67],
:dlgArtikelDatenübertrag.saInsert[68], :dlgArtikelDatenübertrag.saInsert[69], :dlgArtikelDatenübertrag.saInsert[70], :dlgArtikelDatenübertrag.saInsert[71],
:dlgArtikelDatenübertrag.saInsert[72], :dlgArtikelDatenübertrag.saInsert[73], :dlgArtikelDatenübertrag.saInsert[74], :dlgArtikelDatenübertrag.saInsert[75],
:dlgArtikelDatenübertrag.saInsert[76], :dlgArtikelDatenübertrag.saInsert[77], :dlgArtikelDatenübertrag.saInsert[78], :dlgArtikelDatenübertrag.saInsert[79],
:dlgArtikelDatenübertrag.saInsert[80], :dlgArtikelDatenübertrag.saInsert[81], :dlgArtikelDatenübertrag.saInsert[82], :dlgArtikelDatenübertrag.saInsert[83],
:dlgArtikelDatenübertrag.saInsert[84], :dlgArtikelDatenübertrag.saInsert[85], :dlgArtikelDatenübertrag.saInsert[86], :dlgArtikelDatenübertrag.saInsert[87],
:dlgArtikelDatenübertrag.saInsert[88], :dlgArtikelDatenübertrag.saInsert[89], :dlgArtikelDatenübertrag.saInsert[90], :dlgArtikelDatenübertrag.saInsert[91],
:dlgArtikelDatenübertrag.saInsert[92], :dlgArtikelDatenübertrag.saInsert[93], :dlgArtikelDatenübertrag.saInsert[94], :dlgArtikelDatenübertrag.saInsert[95],
:dlgArtikelDatenübertrag.saInsert[96], :dlgArtikelDatenübertrag.saInsert[97], :dlgArtikelDatenübertrag.saInsert[98], :dlgArtikelDatenübertrag.saInsert[99],
:dlgArtikelDatenübertrag.saInsert[100], :dlgArtikelDatenübertrag.saInsert[101], :dlgArtikelDatenübertrag.saInsert[102], :dlgArtikelDatenübertrag.saInsert[103],
:dlgArtikelDatenübertrag.saInsert[104], :dlgArtikelDatenübertrag.saInsert[105], :dlgArtikelDatenübertrag.saInsert[106], :dlgArtikelDatenübertrag.saInsert[107],
:dlgArtikelDatenübertrag.saInsert[108], :dlgArtikelDatenübertrag.saInsert[109], :dlgArtikelDatenübertrag.saInsert[110], :dlgArtikelDatenübertrag.saInsert[111],
:dlgArtikelDatenübertrag.saInsert[112], :dlgArtikelDatenübertrag.saInsert[113], :dlgArtikelDatenübertrag.saInsert[114], :dlgArtikelDatenübertrag.saInsert[115],
:dlgArtikelDatenübertrag.saInsert[116], :dlgArtikelDatenübertrag.saInsert[117], :dlgArtikelDatenübertrag.saInsert[118], :dlgArtikelDatenübertrag.saInsert[119],
:dlgArtikelDatenübertrag.saInsert[120], :dlgArtikelDatenübertrag.saInsert[121], :dlgArtikelDatenübertrag.saInsert[122], :dlgArtikelDatenübertrag.saInsert[123],
:dlgArtikelDatenübertrag.saInsert[124], :dlgArtikelDatenübertrag.saInsert[125], :dlgArtikelDatenübertrag.saInsert[126], :dlgArtikelDatenübertrag.saInsert[127],
:dlgArtikelDatenübertrag.saInsert[128], :dlgArtikelDatenübertrag.saInsert[129], :dlgArtikelDatenübertrag.saInsert[130], :dlgArtikelDatenübertrag.saInsert[131],
:dlgArtikelDatenübertrag.saInsert[132], :dlgArtikelDatenübertrag.saInsert[133], :dlgArtikelDatenübertrag.saInsert[134], :dlgArtikelDatenübertrag.saInsert[135],
:dlgArtikelDatenübertrag.saInsert[136], :dlgArtikelDatenübertrag.saInsert[137], :dlgArtikelDatenübertrag.saInsert[138], :dlgArtikelDatenübertrag.saInsert[139],
:dlgArtikelDatenübertrag.saInsert[140], :dlgArtikelDatenübertrag.saInsert[141], :dlgArtikelDatenübertrag.saInsert[142], :dlgArtikelDatenübertrag.saInsert[143],
:dlgArtikelDatenübertrag.saInsert[144], :dlgArtikelDatenübertrag.saInsert[145], :dlgArtikelDatenübertrag.saInsert[146], :dlgArtikelDatenübertrag.saInsert[147],
:dlgArtikelDatenübertrag.saInsert[148] )'
.head 5 +  If Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Call Sql_Exec( oSql.Sql( ), 'DELETE FROM blsdat WHERE sbls = :sGlobalTemp' )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 6 -  Set r_sStatement = STRING_Null
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 6 -  Set r_sStatement = 'ar_sbls1 = \'ZB'|| NumberToStrX( wp_nAR_NR ) ||'\''
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelBLS ! wl 
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: r_sStatement
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6
INTO
:sDummy,
:sBLSDATArrayLoad[0],
:sBLSDATArrayLoad[1],
:sBLSDATArrayLoad[2],
:sBLSDATArrayLoad[3],
:sBLSDATArrayLoad[4],
:sBLSDATArrayLoad[5],
:sBLSDATArrayLoad[6],
:sBLSDATArrayLoad[7],
:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],
:sBLSDATArrayLoad[10],
:sBLSDATArrayLoad[11],
:sBLSDATArrayLoad[12],
:sBLSDATArrayLoad[13],
:sBLSDATArrayLoad[14],
:sBLSDATArrayLoad[15],
:sBLSDATArrayLoad[16],
:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],
:sBLSDATArrayLoad[19],
:sBLSDATArrayLoad[20],
:sBLSDATArrayLoad[21],
:sBLSDATArrayLoad[22],
:sBLSDATArrayLoad[23],
:sBLSDATArrayLoad[24],
:sBLSDATArrayLoad[25],
:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],
:sBLSDATArrayLoad[28],
:sBLSDATArrayLoad[29],
:sBLSDATArrayLoad[30],
:sBLSDATArrayLoad[31],
:sBLSDATArrayLoad[32],
:sBLSDATArrayLoad[33],
:sBLSDATArrayLoad[34],
:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],
:sBLSDATArrayLoad[37],
:sBLSDATArrayLoad[38],
:sBLSDATArrayLoad[39],
:sBLSDATArrayLoad[40],
:sBLSDATArrayLoad[41],
:sBLSDATArrayLoad[42],
:sBLSDATArrayLoad[43],
:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],
:sBLSDATArrayLoad[46],
:sBLSDATArrayLoad[47],
:sBLSDATArrayLoad[48],
:sBLSDATArrayLoad[49],
:sBLSDATArrayLoad[50],
:sBLSDATArrayLoad[51],
:sBLSDATArrayLoad[52],
:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],
:sBLSDATArrayLoad[55],
:sBLSDATArrayLoad[56],
:sBLSDATArrayLoad[57],
:sBLSDATArrayLoad[58],
:sBLSDATArrayLoad[59],
:sBLSDATArrayLoad[60],
:sBLSDATArrayLoad[61],
:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],
:sBLSDATArrayLoad[64],
:sBLSDATArrayLoad[65],
:sBLSDATArrayLoad[66],
:sBLSDATArrayLoad[67],
:sBLSDATArrayLoad[68],
:sBLSDATArrayLoad[69],
:sBLSDATArrayLoad[70],
:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],
:sBLSDATArrayLoad[73],
:sBLSDATArrayLoad[74],
:sBLSDATArrayLoad[75],
:sBLSDATArrayLoad[76],
:sBLSDATArrayLoad[77],
:sBLSDATArrayLoad[78],
:sBLSDATArrayLoad[79],
:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],
:sBLSDATArrayLoad[82],
:sBLSDATArrayLoad[83],
:sBLSDATArrayLoad[84],
:sBLSDATArrayLoad[85],
:sBLSDATArrayLoad[86],
:sBLSDATArrayLoad[87],
:sBLSDATArrayLoad[88],
:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],
:sBLSDATArrayLoad[91],
:sBLSDATArrayLoad[92],
:sBLSDATArrayLoad[93],
:sBLSDATArrayLoad[94],
:sBLSDATArrayLoad[95],
:sBLSDATArrayLoad[96],
:sBLSDATArrayLoad[97],
:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],
:sBLSDATArrayLoad[100],
:sBLSDATArrayLoad[101],
:sBLSDATArrayLoad[102],
:sBLSDATArrayLoad[103],
:sBLSDATArrayLoad[104],
:sBLSDATArrayLoad[105],
:sBLSDATArrayLoad[106],
:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],
:sBLSDATArrayLoad[109],
:sBLSDATArrayLoad[110],
:sBLSDATArrayLoad[111],
:sBLSDATArrayLoad[112],
:sBLSDATArrayLoad[113],
:sBLSDATArrayLoad[114],
:sBLSDATArrayLoad[115],
:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],
:sBLSDATArrayLoad[118],
:sBLSDATArrayLoad[119],
:sBLSDATArrayLoad[120],
:sBLSDATArrayLoad[121],
:sBLSDATArrayLoad[122],
:sBLSDATArrayLoad[123],
:sBLSDATArrayLoad[124],
:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],
:sBLSDATArrayLoad[127],
:sBLSDATArrayLoad[128],
:sBLSDATArrayLoad[129],
:sBLSDATArrayLoad[130],
:sBLSDATArrayLoad[131],
:sBLSDATArrayLoad[132],
:sBLSDATArrayLoad[133],
:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],
:sBLSDATArrayLoad[136],
:sBLSDATArrayLoad[137],
:sBLSDATArrayLoad[138],
:sBLSDATArrayLoad[139],
:sBLSDATArrayLoad[140],
:sBLSDATArrayLoad[141],
:sBLSDATArrayLoad[142],
:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],
:sBLSDATArrayLoad[145],
:sBLSDATArrayLoad[146],
:sBLSDATArrayLoad[147],
:sBLSDATArrayLoad[148]




























































































































































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\' OR SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY SBLS' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set nArrayIndex = 0
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set saInsert[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( p_nLA_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT ( 
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6 )
VALUES ( :sGlobalTemp, :dlgArtikelDatenübertrag.saInsert[0], :dlgArtikelDatenübertrag.saInsert[1], :dlgArtikelDatenübertrag.saInsert[2], :dlgArtikelDatenübertrag.saInsert[3], 
:dlgArtikelDatenübertrag.saInsert[4], :dlgArtikelDatenübertrag.saInsert[5], :dlgArtikelDatenübertrag.saInsert[6], :dlgArtikelDatenübertrag.saInsert[7], 
:dlgArtikelDatenübertrag.saInsert[8], :dlgArtikelDatenübertrag.saInsert[9], :dlgArtikelDatenübertrag.saInsert[10], :dlgArtikelDatenübertrag.saInsert[11], 
:dlgArtikelDatenübertrag.saInsert[12], :dlgArtikelDatenübertrag.saInsert[13], :dlgArtikelDatenübertrag.saInsert[14], :dlgArtikelDatenübertrag.saInsert[15], 
:dlgArtikelDatenübertrag.saInsert[16], :dlgArtikelDatenübertrag.saInsert[17], :dlgArtikelDatenübertrag.saInsert[18], :dlgArtikelDatenübertrag.saInsert[19],
:dlgArtikelDatenübertrag.saInsert[20], :dlgArtikelDatenübertrag.saInsert[21], :dlgArtikelDatenübertrag.saInsert[22], :dlgArtikelDatenübertrag.saInsert[23],
:dlgArtikelDatenübertrag.saInsert[24], :dlgArtikelDatenübertrag.saInsert[25], :dlgArtikelDatenübertrag.saInsert[26], :dlgArtikelDatenübertrag.saInsert[27],
:dlgArtikelDatenübertrag.saInsert[28], :dlgArtikelDatenübertrag.saInsert[29], :dlgArtikelDatenübertrag.saInsert[30], :dlgArtikelDatenübertrag.saInsert[31], 
:dlgArtikelDatenübertrag.saInsert[32], :dlgArtikelDatenübertrag.saInsert[33], :dlgArtikelDatenübertrag.saInsert[34], :dlgArtikelDatenübertrag.saInsert[35],
:dlgArtikelDatenübertrag.saInsert[36], :dlgArtikelDatenübertrag.saInsert[37], :dlgArtikelDatenübertrag.saInsert[38], :dlgArtikelDatenübertrag.saInsert[39],
:dlgArtikelDatenübertrag.saInsert[40], :dlgArtikelDatenübertrag.saInsert[41], :dlgArtikelDatenübertrag.saInsert[42], :dlgArtikelDatenübertrag.saInsert[43],
:dlgArtikelDatenübertrag.saInsert[44], :dlgArtikelDatenübertrag.saInsert[45], :dlgArtikelDatenübertrag.saInsert[46], :dlgArtikelDatenübertrag.saInsert[47],
:dlgArtikelDatenübertrag.saInsert[48], :dlgArtikelDatenübertrag.saInsert[49], :dlgArtikelDatenübertrag.saInsert[50], :dlgArtikelDatenübertrag.saInsert[51],
:dlgArtikelDatenübertrag.saInsert[52], :dlgArtikelDatenübertrag.saInsert[53], :dlgArtikelDatenübertrag.saInsert[54], :dlgArtikelDatenübertrag.saInsert[55],
:dlgArtikelDatenübertrag.saInsert[56], :dlgArtikelDatenübertrag.saInsert[57], :dlgArtikelDatenübertrag.saInsert[58], :dlgArtikelDatenübertrag.saInsert[59],
:dlgArtikelDatenübertrag.saInsert[60], :dlgArtikelDatenübertrag.saInsert[61], :dlgArtikelDatenübertrag.saInsert[62], :dlgArtikelDatenübertrag.saInsert[63],
:dlgArtikelDatenübertrag.saInsert[64], :dlgArtikelDatenübertrag.saInsert[65], :dlgArtikelDatenübertrag.saInsert[66], :dlgArtikelDatenübertrag.saInsert[67],
:dlgArtikelDatenübertrag.saInsert[68], :dlgArtikelDatenübertrag.saInsert[69], :dlgArtikelDatenübertrag.saInsert[70], :dlgArtikelDatenübertrag.saInsert[71],
:dlgArtikelDatenübertrag.saInsert[72], :dlgArtikelDatenübertrag.saInsert[73], :dlgArtikelDatenübertrag.saInsert[74], :dlgArtikelDatenübertrag.saInsert[75],
:dlgArtikelDatenübertrag.saInsert[76], :dlgArtikelDatenübertrag.saInsert[77], :dlgArtikelDatenübertrag.saInsert[78], :dlgArtikelDatenübertrag.saInsert[79],
:dlgArtikelDatenübertrag.saInsert[80], :dlgArtikelDatenübertrag.saInsert[81], :dlgArtikelDatenübertrag.saInsert[82], :dlgArtikelDatenübertrag.saInsert[83],
:dlgArtikelDatenübertrag.saInsert[84], :dlgArtikelDatenübertrag.saInsert[85], :dlgArtikelDatenübertrag.saInsert[86], :dlgArtikelDatenübertrag.saInsert[87],
:dlgArtikelDatenübertrag.saInsert[88], :dlgArtikelDatenübertrag.saInsert[89], :dlgArtikelDatenübertrag.saInsert[90], :dlgArtikelDatenübertrag.saInsert[91],
:dlgArtikelDatenübertrag.saInsert[92], :dlgArtikelDatenübertrag.saInsert[93], :dlgArtikelDatenübertrag.saInsert[94], :dlgArtikelDatenübertrag.saInsert[95],
:dlgArtikelDatenübertrag.saInsert[96], :dlgArtikelDatenübertrag.saInsert[97], :dlgArtikelDatenübertrag.saInsert[98], :dlgArtikelDatenübertrag.saInsert[99],
:dlgArtikelDatenübertrag.saInsert[100], :dlgArtikelDatenübertrag.saInsert[101], :dlgArtikelDatenübertrag.saInsert[102], :dlgArtikelDatenübertrag.saInsert[103],
:dlgArtikelDatenübertrag.saInsert[104], :dlgArtikelDatenübertrag.saInsert[105], :dlgArtikelDatenübertrag.saInsert[106], :dlgArtikelDatenübertrag.saInsert[107],
:dlgArtikelDatenübertrag.saInsert[108], :dlgArtikelDatenübertrag.saInsert[109], :dlgArtikelDatenübertrag.saInsert[110], :dlgArtikelDatenübertrag.saInsert[111],
:dlgArtikelDatenübertrag.saInsert[112], :dlgArtikelDatenübertrag.saInsert[113], :dlgArtikelDatenübertrag.saInsert[114], :dlgArtikelDatenübertrag.saInsert[115],
:dlgArtikelDatenübertrag.saInsert[116], :dlgArtikelDatenübertrag.saInsert[117], :dlgArtikelDatenübertrag.saInsert[118], :dlgArtikelDatenübertrag.saInsert[119],
:dlgArtikelDatenübertrag.saInsert[120], :dlgArtikelDatenübertrag.saInsert[121], :dlgArtikelDatenübertrag.saInsert[122], :dlgArtikelDatenübertrag.saInsert[123],
:dlgArtikelDatenübertrag.saInsert[124], :dlgArtikelDatenübertrag.saInsert[125], :dlgArtikelDatenübertrag.saInsert[126], :dlgArtikelDatenübertrag.saInsert[127],
:dlgArtikelDatenübertrag.saInsert[128], :dlgArtikelDatenübertrag.saInsert[129], :dlgArtikelDatenübertrag.saInsert[130], :dlgArtikelDatenübertrag.saInsert[131],
:dlgArtikelDatenübertrag.saInsert[132], :dlgArtikelDatenübertrag.saInsert[133], :dlgArtikelDatenübertrag.saInsert[134], :dlgArtikelDatenübertrag.saInsert[135],
:dlgArtikelDatenübertrag.saInsert[136], :dlgArtikelDatenübertrag.saInsert[137], :dlgArtikelDatenübertrag.saInsert[138], :dlgArtikelDatenübertrag.saInsert[139],
:dlgArtikelDatenübertrag.saInsert[140], :dlgArtikelDatenübertrag.saInsert[141], :dlgArtikelDatenübertrag.saInsert[142], :dlgArtikelDatenübertrag.saInsert[143],
:dlgArtikelDatenübertrag.saInsert[144], :dlgArtikelDatenübertrag.saInsert[145], :dlgArtikelDatenübertrag.saInsert[146], :dlgArtikelDatenübertrag.saInsert[147],
:dlgArtikelDatenübertrag.saInsert[148] )'
.head 5 +  If Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Call Sql_Exec( oSql.Sql( ), 'DELETE FROM blsdat WHERE sbls = :sGlobalTemp' )
.head 5 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 6 -  Set r_sStatement = STRING_Null
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 6 -  Set r_sStatement = 'ar_sbls1 = \'ZB'|| NumberToStrX( p_nLA_NR ) ||'\''
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelBLS ! Fehler bei Insert mit sbls und sbls1 checked
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: r_sStatement
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6
INTO
:sDummy,
:sBLSDATArrayLoad[0],
:sBLSDATArrayLoad[1],
:sBLSDATArrayLoad[2],
:sBLSDATArrayLoad[3],
:sBLSDATArrayLoad[4],
:sBLSDATArrayLoad[5],
:sBLSDATArrayLoad[6],
:sBLSDATArrayLoad[7],
:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],
:sBLSDATArrayLoad[10],
:sBLSDATArrayLoad[11],
:sBLSDATArrayLoad[12],
:sBLSDATArrayLoad[13],
:sBLSDATArrayLoad[14],
:sBLSDATArrayLoad[15],
:sBLSDATArrayLoad[16],
:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],
:sBLSDATArrayLoad[19],
:sBLSDATArrayLoad[20],
:sBLSDATArrayLoad[21],
:sBLSDATArrayLoad[22],
:sBLSDATArrayLoad[23],
:sBLSDATArrayLoad[24],
:sBLSDATArrayLoad[25],
:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],
:sBLSDATArrayLoad[28],
:sBLSDATArrayLoad[29],
:sBLSDATArrayLoad[30],
:sBLSDATArrayLoad[31],
:sBLSDATArrayLoad[32],
:sBLSDATArrayLoad[33],
:sBLSDATArrayLoad[34],
:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],
:sBLSDATArrayLoad[37],
:sBLSDATArrayLoad[38],
:sBLSDATArrayLoad[39],
:sBLSDATArrayLoad[40],
:sBLSDATArrayLoad[41],
:sBLSDATArrayLoad[42],
:sBLSDATArrayLoad[43],
:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],
:sBLSDATArrayLoad[46],
:sBLSDATArrayLoad[47],
:sBLSDATArrayLoad[48],
:sBLSDATArrayLoad[49],
:sBLSDATArrayLoad[50],
:sBLSDATArrayLoad[51],
:sBLSDATArrayLoad[52],
:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],
:sBLSDATArrayLoad[55],
:sBLSDATArrayLoad[56],
:sBLSDATArrayLoad[57],
:sBLSDATArrayLoad[58],
:sBLSDATArrayLoad[59],
:sBLSDATArrayLoad[60],
:sBLSDATArrayLoad[61],
:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],
:sBLSDATArrayLoad[64],
:sBLSDATArrayLoad[65],
:sBLSDATArrayLoad[66],
:sBLSDATArrayLoad[67],
:sBLSDATArrayLoad[68],
:sBLSDATArrayLoad[69],
:sBLSDATArrayLoad[70],
:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],
:sBLSDATArrayLoad[73],
:sBLSDATArrayLoad[74],
:sBLSDATArrayLoad[75],
:sBLSDATArrayLoad[76],
:sBLSDATArrayLoad[77],
:sBLSDATArrayLoad[78],
:sBLSDATArrayLoad[79],
:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],
:sBLSDATArrayLoad[82],
:sBLSDATArrayLoad[83],
:sBLSDATArrayLoad[84],
:sBLSDATArrayLoad[85],
:sBLSDATArrayLoad[86],
:sBLSDATArrayLoad[87],
:sBLSDATArrayLoad[88],
:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],
:sBLSDATArrayLoad[91],
:sBLSDATArrayLoad[92],
:sBLSDATArrayLoad[93],
:sBLSDATArrayLoad[94],
:sBLSDATArrayLoad[95],
:sBLSDATArrayLoad[96],
:sBLSDATArrayLoad[97],
:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],
:sBLSDATArrayLoad[100],
:sBLSDATArrayLoad[101],
:sBLSDATArrayLoad[102],
:sBLSDATArrayLoad[103],
:sBLSDATArrayLoad[104],
:sBLSDATArrayLoad[105],
:sBLSDATArrayLoad[106],
:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],
:sBLSDATArrayLoad[109],
:sBLSDATArrayLoad[110],
:sBLSDATArrayLoad[111],
:sBLSDATArrayLoad[112],
:sBLSDATArrayLoad[113],
:sBLSDATArrayLoad[114],
:sBLSDATArrayLoad[115],
:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],
:sBLSDATArrayLoad[118],
:sBLSDATArrayLoad[119],
:sBLSDATArrayLoad[120],
:sBLSDATArrayLoad[121],
:sBLSDATArrayLoad[122],
:sBLSDATArrayLoad[123],
:sBLSDATArrayLoad[124],
:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],
:sBLSDATArrayLoad[127],
:sBLSDATArrayLoad[128],
:sBLSDATArrayLoad[129],
:sBLSDATArrayLoad[130],
:sBLSDATArrayLoad[131],
:sBLSDATArrayLoad[132],
:sBLSDATArrayLoad[133],
:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],
:sBLSDATArrayLoad[136],
:sBLSDATArrayLoad[137],
:sBLSDATArrayLoad[138],
:sBLSDATArrayLoad[139],
:sBLSDATArrayLoad[140],
:sBLSDATArrayLoad[141],
:sBLSDATArrayLoad[142],
:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],
:sBLSDATArrayLoad[145],
:sBLSDATArrayLoad[146],
:sBLSDATArrayLoad[147],
:sBLSDATArrayLoad[148]


































































































































































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\' OR SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY SBLS' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set nArrayIndex = 0
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set saAR_SBLS_InsertDaten[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( p_nLA_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT ( 
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6 )
VALUES ( :sGlobalTemp, :dlgArtikelDatenübertrag.saSBLS[0], :dlgArtikelDatenübertrag.saSBLS[1], :dlgArtikelDatenübertrag.saSBLS[2], :dlgArtikelDatenübertrag.saSBLS[3], 
:dlgArtikelDatenübertrag.saSBLS[4], :dlgArtikelDatenübertrag.saSBLS[5], :dlgArtikelDatenübertrag.saSBLS[6], :dlgArtikelDatenübertrag.saSBLS[7], 
:dlgArtikelDatenübertrag.saSBLS[8], :dlgArtikelDatenübertrag.saSBLS[9], :dlgArtikelDatenübertrag.saSBLS[10], :dlgArtikelDatenübertrag.saSBLS[11], 
:dlgArtikelDatenübertrag.saSBLS[12], :dlgArtikelDatenübertrag.saSBLS[13], :dlgArtikelDatenübertrag.saSBLS[14], :dlgArtikelDatenübertrag.saSBLS[15], 
:dlgArtikelDatenübertrag.saSBLS[16], :dlgArtikelDatenübertrag.saSBLS[17], :dlgArtikelDatenübertrag.saSBLS[18], :dlgArtikelDatenübertrag.saSBLS[19],
:dlgArtikelDatenübertrag.saSBLS[20], :dlgArtikelDatenübertrag.saSBLS[21], :dlgArtikelDatenübertrag.saSBLS[22], :dlgArtikelDatenübertrag.saSBLS[23],
:dlgArtikelDatenübertrag.saSBLS[24], :dlgArtikelDatenübertrag.saSBLS[25], :dlgArtikelDatenübertrag.saSBLS[26], :dlgArtikelDatenübertrag.saSBLS[27],
:dlgArtikelDatenübertrag.saSBLS[28], :dlgArtikelDatenübertrag.saSBLS[29], :dlgArtikelDatenübertrag.saSBLS[30], :dlgArtikelDatenübertrag.saSBLS[31], 
:dlgArtikelDatenübertrag.saSBLS[32], :dlgArtikelDatenübertrag.saSBLS[33], :dlgArtikelDatenübertrag.saSBLS[34], :dlgArtikelDatenübertrag.saSBLS[35],
:dlgArtikelDatenübertrag.saSBLS[36], :dlgArtikelDatenübertrag.saSBLS[37], :dlgArtikelDatenübertrag.saSBLS[38], :dlgArtikelDatenübertrag.saSBLS[39],
:dlgArtikelDatenübertrag.saSBLS[40], :dlgArtikelDatenübertrag.saSBLS[41], :dlgArtikelDatenübertrag.saSBLS[42], :dlgArtikelDatenübertrag.saSBLS[43],
:dlgArtikelDatenübertrag.saSBLS[44], :dlgArtikelDatenübertrag.saSBLS[45], :dlgArtikelDatenübertrag.saSBLS[46], :dlgArtikelDatenübertrag.saSBLS[47],
:dlgArtikelDatenübertrag.saSBLS[48], :dlgArtikelDatenübertrag.saSBLS[49], :dlgArtikelDatenübertrag.saSBLS[50], :dlgArtikelDatenübertrag.saSBLS[51],
:dlgArtikelDatenübertrag.saSBLS[52], :dlgArtikelDatenübertrag.saSBLS[53], :dlgArtikelDatenübertrag.saSBLS[54], :dlgArtikelDatenübertrag.saSBLS[55],
:dlgArtikelDatenübertrag.saSBLS[56], :dlgArtikelDatenübertrag.saSBLS[57], :dlgArtikelDatenübertrag.saSBLS[58], :dlgArtikelDatenübertrag.saSBLS[59],
:dlgArtikelDatenübertrag.saSBLS[60], :dlgArtikelDatenübertrag.saSBLS[61], :dlgArtikelDatenübertrag.saSBLS[62], :dlgArtikelDatenübertrag.saSBLS[63],
:dlgArtikelDatenübertrag.saSBLS[64], :dlgArtikelDatenübertrag.saSBLS[65], :dlgArtikelDatenübertrag.saSBLS[66], :dlgArtikelDatenübertrag.saSBLS[67],
:dlgArtikelDatenübertrag.saSBLS[68], :dlgArtikelDatenübertrag.saSBLS[69], :dlgArtikelDatenübertrag.saSBLS[70], :dlgArtikelDatenübertrag.saSBLS[71],
:dlgArtikelDatenübertrag.saSBLS[72], :dlgArtikelDatenübertrag.saSBLS[73], :dlgArtikelDatenübertrag.saSBLS[74], :dlgArtikelDatenübertrag.saSBLS[75],
:dlgArtikelDatenübertrag.saSBLS[76], :dlgArtikelDatenübertrag.saSBLS[77], :dlgArtikelDatenübertrag.saSBLS[78], :dlgArtikelDatenübertrag.saSBLS[79],
:dlgArtikelDatenübertrag.saSBLS[80], :dlgArtikelDatenübertrag.saSBLS[81], :dlgArtikelDatenübertrag.saSBLS[82], :dlgArtikelDatenübertrag.saSBLS[83],
:dlgArtikelDatenübertrag.saSBLS[84], :dlgArtikelDatenübertrag.saSBLS[85], :dlgArtikelDatenübertrag.saSBLS[86], :dlgArtikelDatenübertrag.saSBLS[87],
:dlgArtikelDatenübertrag.saSBLS[88], :dlgArtikelDatenübertrag.saSBLS[89], :dlgArtikelDatenübertrag.saSBLS[90], :dlgArtikelDatenübertrag.saSBLS[91],
:dlgArtikelDatenübertrag.saSBLS[92], :dlgArtikelDatenübertrag.saSBLS[93], :dlgArtikelDatenübertrag.saSBLS[94], :dlgArtikelDatenübertrag.saSBLS[95],
:dlgArtikelDatenübertrag.saSBLS[96], :dlgArtikelDatenübertrag.saSBLS[97], :dlgArtikelDatenübertrag.saSBLS[98], :dlgArtikelDatenübertrag.saSBLS[99],
:dlgArtikelDatenübertrag.saSBLS[100], :dlgArtikelDatenübertrag.saSBLS[101], :dlgArtikelDatenübertrag.saSBLS[102], :dlgArtikelDatenübertrag.saSBLS[103],
:dlgArtikelDatenübertrag.saSBLS[104], :dlgArtikelDatenübertrag.saSBLS[105], :dlgArtikelDatenübertrag.saSBLS[106], :dlgArtikelDatenübertrag.saSBLS[107],
:dlgArtikelDatenübertrag.saSBLS[108], :dlgArtikelDatenübertrag.saSBLS[109], :dlgArtikelDatenübertrag.saSBLS[110], :dlgArtikelDatenübertrag.saSBLS[111],
:dlgArtikelDatenübertrag.saSBLS[112], :dlgArtikelDatenübertrag.saSBLS[113], :dlgArtikelDatenübertrag.saSBLS[114], :dlgArtikelDatenübertrag.saSBLS[115],
:dlgArtikelDatenübertrag.saSBLS[116], :dlgArtikelDatenübertrag.saSBLS[117], :dlgArtikelDatenübertrag.saSBLS[118], :dlgArtikelDatenübertrag.saSBLS[119],
:dlgArtikelDatenübertrag.saSBLS[120], :dlgArtikelDatenübertrag.saSBLS[121], :dlgArtikelDatenübertrag.saSBLS[122], :dlgArtikelDatenübertrag.saSBLS[123],
:dlgArtikelDatenübertrag.saSBLS[124], :dlgArtikelDatenübertrag.saSBLS[125], :dlgArtikelDatenübertrag.saSBLS[126], :dlgArtikelDatenübertrag.saSBLS[127],
:dlgArtikelDatenübertrag.saSBLS[128], :dlgArtikelDatenübertrag.saSBLS[129], :dlgArtikelDatenübertrag.saSBLS[130], :dlgArtikelDatenübertrag.saSBLS[131],
:dlgArtikelDatenübertrag.saSBLS[132], :dlgArtikelDatenübertrag.saSBLS[133], :dlgArtikelDatenübertrag.saSBLS[134], :dlgArtikelDatenübertrag.saSBLS[135],
:dlgArtikelDatenübertrag.saSBLS[136], :dlgArtikelDatenübertrag.saSBLS[137], :dlgArtikelDatenübertrag.saSBLS[138], :dlgArtikelDatenübertrag.saSBLS[139],
:dlgArtikelDatenübertrag.saSBLS[140], :dlgArtikelDatenübertrag.saSBLS[141], :dlgArtikelDatenübertrag.saSBLS[142], :dlgArtikelDatenübertrag.saSBLS[143],
:dlgArtikelDatenübertrag.saSBLS[144], :dlgArtikelDatenübertrag.saSBLS[145], :dlgArtikelDatenübertrag.saSBLS[146], :dlgArtikelDatenübertrag.saSBLS[147],
:dlgArtikelDatenübertrag.saSBLS[148] )'
.head 5 +  If NOT Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 6 -  Set r_sStatement = STRING_Null
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 6 -  Set r_sStatement = 'ar_sbls1 = \'ZB'|| NumberToStrX( p_nLA_NR ) ||'\''
.head 5 -  Return bOk
.head 3 +  ! Function: GetLieferartikelBLS
.head 4 -  Description: erstellt einen neuen BLS-Eintrag ( "ZL"+LA_NR ) aus dem zugewiesenen 
BLS des Lieferartikels (LA_SBLS) und den Produktdaten (LA_SBLS1)
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  Number: p_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Receive String: r_sStatement
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: sStmt
.head 5 -  String: sBLSDATArrayLoad[149]
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  Number: nInd
.head 5 -  Number: nCount
.head 5 -  Number: nArrayIndex
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 5 -  String: sDummy
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +  Actions 
.head 5 -  Set sStmt = 'SELECT
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6
INTO
:sDummy,
:sBLSDATArrayLoad[0],
:sBLSDATArrayLoad[1],
:sBLSDATArrayLoad[2],
:sBLSDATArrayLoad[3],
:sBLSDATArrayLoad[4],
:sBLSDATArrayLoad[5],
:sBLSDATArrayLoad[6],
:sBLSDATArrayLoad[7],
:sBLSDATArrayLoad[8],
:sBLSDATArrayLoad[9],
:sBLSDATArrayLoad[10],
:sBLSDATArrayLoad[11],
:sBLSDATArrayLoad[12],
:sBLSDATArrayLoad[13],
:sBLSDATArrayLoad[14],
:sBLSDATArrayLoad[15],
:sBLSDATArrayLoad[16],
:sBLSDATArrayLoad[17],
:sBLSDATArrayLoad[18],
:sBLSDATArrayLoad[19],
:sBLSDATArrayLoad[20],
:sBLSDATArrayLoad[21],
:sBLSDATArrayLoad[22],
:sBLSDATArrayLoad[23],
:sBLSDATArrayLoad[24],
:sBLSDATArrayLoad[25],
:sBLSDATArrayLoad[26],
:sBLSDATArrayLoad[27],
:sBLSDATArrayLoad[28],
:sBLSDATArrayLoad[29],
:sBLSDATArrayLoad[30],
:sBLSDATArrayLoad[31],
:sBLSDATArrayLoad[32],
:sBLSDATArrayLoad[33],
:sBLSDATArrayLoad[34],
:sBLSDATArrayLoad[35],
:sBLSDATArrayLoad[36],
:sBLSDATArrayLoad[37],
:sBLSDATArrayLoad[38],
:sBLSDATArrayLoad[39],
:sBLSDATArrayLoad[40],
:sBLSDATArrayLoad[41],
:sBLSDATArrayLoad[42],
:sBLSDATArrayLoad[43],
:sBLSDATArrayLoad[44],
:sBLSDATArrayLoad[45],
:sBLSDATArrayLoad[46],
:sBLSDATArrayLoad[47],
:sBLSDATArrayLoad[48],
:sBLSDATArrayLoad[49],
:sBLSDATArrayLoad[50],
:sBLSDATArrayLoad[51],
:sBLSDATArrayLoad[52],
:sBLSDATArrayLoad[53],
:sBLSDATArrayLoad[54],
:sBLSDATArrayLoad[55],
:sBLSDATArrayLoad[56],
:sBLSDATArrayLoad[57],
:sBLSDATArrayLoad[58],
:sBLSDATArrayLoad[59],
:sBLSDATArrayLoad[60],
:sBLSDATArrayLoad[61],
:sBLSDATArrayLoad[62],
:sBLSDATArrayLoad[63],
:sBLSDATArrayLoad[64],
:sBLSDATArrayLoad[65],
:sBLSDATArrayLoad[66],
:sBLSDATArrayLoad[67],
:sBLSDATArrayLoad[68],
:sBLSDATArrayLoad[69],
:sBLSDATArrayLoad[70],
:sBLSDATArrayLoad[71],
:sBLSDATArrayLoad[72],
:sBLSDATArrayLoad[73],
:sBLSDATArrayLoad[74],
:sBLSDATArrayLoad[75],
:sBLSDATArrayLoad[76],
:sBLSDATArrayLoad[77],
:sBLSDATArrayLoad[78],
:sBLSDATArrayLoad[79],
:sBLSDATArrayLoad[80],
:sBLSDATArrayLoad[81],
:sBLSDATArrayLoad[82],
:sBLSDATArrayLoad[83],
:sBLSDATArrayLoad[84],
:sBLSDATArrayLoad[85],
:sBLSDATArrayLoad[86],
:sBLSDATArrayLoad[87],
:sBLSDATArrayLoad[88],
:sBLSDATArrayLoad[89],
:sBLSDATArrayLoad[90],
:sBLSDATArrayLoad[91],
:sBLSDATArrayLoad[92],
:sBLSDATArrayLoad[93],
:sBLSDATArrayLoad[94],
:sBLSDATArrayLoad[95],
:sBLSDATArrayLoad[96],
:sBLSDATArrayLoad[97],
:sBLSDATArrayLoad[98],
:sBLSDATArrayLoad[99],
:sBLSDATArrayLoad[100],
:sBLSDATArrayLoad[101],
:sBLSDATArrayLoad[102],
:sBLSDATArrayLoad[103],
:sBLSDATArrayLoad[104],
:sBLSDATArrayLoad[105],
:sBLSDATArrayLoad[106],
:sBLSDATArrayLoad[107],
:sBLSDATArrayLoad[108],
:sBLSDATArrayLoad[109],
:sBLSDATArrayLoad[110],
:sBLSDATArrayLoad[111],
:sBLSDATArrayLoad[112],
:sBLSDATArrayLoad[113],
:sBLSDATArrayLoad[114],
:sBLSDATArrayLoad[115],
:sBLSDATArrayLoad[116],
:sBLSDATArrayLoad[117],
:sBLSDATArrayLoad[118],
:sBLSDATArrayLoad[119],
:sBLSDATArrayLoad[120],
:sBLSDATArrayLoad[121],
:sBLSDATArrayLoad[122],
:sBLSDATArrayLoad[123],
:sBLSDATArrayLoad[124],
:sBLSDATArrayLoad[125],
:sBLSDATArrayLoad[126],
:sBLSDATArrayLoad[127],
:sBLSDATArrayLoad[128],
:sBLSDATArrayLoad[129],
:sBLSDATArrayLoad[130],
:sBLSDATArrayLoad[131],
:sBLSDATArrayLoad[132],
:sBLSDATArrayLoad[133],
:sBLSDATArrayLoad[134],
:sBLSDATArrayLoad[135],
:sBLSDATArrayLoad[136],
:sBLSDATArrayLoad[137],
:sBLSDATArrayLoad[138],
:sBLSDATArrayLoad[139],
:sBLSDATArrayLoad[140],
:sBLSDATArrayLoad[141],
:sBLSDATArrayLoad[142],
:sBLSDATArrayLoad[143],
:sBLSDATArrayLoad[144],
:sBLSDATArrayLoad[145],
:sBLSDATArrayLoad[146],
:sBLSDATArrayLoad[147],
:sBLSDATArrayLoad[148]













































































































































































FROM BLSDAT 
WHERE SBLS = \'' || p_sLA_SBLS || '\' OR SBLS = \'' || p_sLA_SBLS1 || '\' 
ORDER BY SBLS' 
.head 5 -  ! Produktdaten fangen mit ZL.. an deshalb durch "order by" immer als zweites (auch wenn sbls 'Z'+Nr. )
.head 5 -  Set nCount = 0
.head 5 -  Set bOk = Sql_ExecEx( oSql.Sql(  ), sStmt, FALSE )
.head 5 +  While SqlFetchNext( oSql.Sql( ), nInd )
.head 6 -  Set nArrayIndex = 0
.head 6 +  While nArrayIndex < 149
.head 7 -  ! Zuerst alle LA_SBLS reinschreiben; wenn LA_SBLS1 nicht leer, dann überschreiben
i.e. die vom 2ten Fetch nicht reinschreiben wenn leer
.head 7 +  If NOT ( ( nCount = 1 ) AND ( sBLSDATArrayLoad[ nArrayIndex ] = STRING_Null ) )
.head 8 -  Set dlgArtikelDatenübertrag.saAR_SBLS_InsertDaten[ nArrayIndex ] = sBLSDATArrayLoad[ nArrayIndex ]
.head 7 -  Set nArrayIndex = nArrayIndex + 1
.head 6 -  Set nCount = nCount + 1
.head 5 -  Set sGlobalTemp = 'ZB'|| NumberToStrX( p_nLA_NR )
.head 5 -  Set sStmt = 'INSERT INTO BLSDAT (
SBLS,
ST,
STE,
SZ,
SL,
SE,
GCAL,
GJ,
ZW,
ZE,
ZF,
ZK,
ZB,
ZM,
ZO,
ZA,
ZV,
VA,
VAR,
VAC,
VD,
VE,
VEAT,
VK,
VB1,
VB2,
VB3,
VB3A,
VB5,
VB6,
VB7,
VB9,
VB9G,
VB9F,
VB12,
VC,
MNA,
MK,
MCA,
MMG,
MP,
MS,
MCL,
MFE,
MZN,
MCU,
MMN,
MF,
MJ,
KAM,
KAS,
KAX,
KA,
KMT,
KMF,
KMG,
KM,
KDS,
KDM,
KDL,
KD,
KPOR,
KPON,
KPG,
KPS,
KP,
KBP,
KBH,
KBU,
KBC,
KBL,
KBW,
KBN,
EILE,
ELEU,
ELYS,
EMET,
ECYS,
EPHE,
ETYR,
ETHR,
ETRP,
EVAL,
EARG,
EHIS,
EEA,
EALA,
EASP,
EGLU,
EGLY,
EPRO,
ESER,
ENA,
EPF,
EH,
EP,
F40,
F60,
F80,
F100,
F120,
F140,
F150,
F160,
F170,
F180,
F200,
F220,
F240,
FS,
F141,
F151,
F161,
F171,
F181,
F201,
F221,
F241,
FU,
F162,
F164,
F182,
F183,
F184,
F193,
F202,
F203,
F204,
F205,
F222,
F223,
F224,
F225,
F226,
FP,
FK,
FM,
FL,
FG,
FC,
GFPS,
GEBW,
GEB,
GKB,
GMKO,
GMSB,
GP,
KMD,
FO3,
FO6 )
VALUES (
:sGlobalTemp,
:frmREZ_Artikel.saAR_SBLS_InsertDaten[0],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[1],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[2],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[3],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[4],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[5],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[6],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[7],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[8],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[9],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[10],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[11],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[12],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[13],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[14],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[15],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[16],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[17],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[18],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[19],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[20],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[21],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[22],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[23],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[24],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[25],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[26],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[27],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[28],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[29],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[30],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[31],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[32],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[33],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[34],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[35],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[36],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[37],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[38],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[39],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[40],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[41],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[42],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[43],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[44],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[45],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[46],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[47],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[48],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[49],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[50],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[51],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[52],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[53],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[54],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[55],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[56],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[57],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[58],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[59],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[60],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[61],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[62],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[63],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[64],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[65],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[66],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[67],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[68],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[69],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[70],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[71],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[72],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[73],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[74],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[75],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[76],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[77],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[78],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[79],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[80],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[81],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[82],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[83],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[84],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[85],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[86],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[87],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[88],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[89],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[90],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[91],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[92],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[93],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[94],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[95],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[96],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[97],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[98],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[99],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[100],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[101],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[102],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[103],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[104],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[105],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[106],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[107],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[108],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[109],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[110],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[111],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[112],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[113],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[114],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[115],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[116],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[117],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[118],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[119],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[120],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[121],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[122],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[123],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[124],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[125],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[126],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[127],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[128],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[129],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[130],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[131],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[132],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[133],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[134],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[135],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[136],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[137],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[138],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[139],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[140],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[141],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[142],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[143],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[144],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[145],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[146],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[147],
:frmREZ_Artikel.saAR_SBLS_InsertDaten[148] )'
.head 5 +  If NOT Sql_FetchOne( oSql.Sql( ), 'SELECT * FROM blsdat WHERE sbls = :sGlobalTemp')
.head 6 -  Set bOk = bOk AND Sql_ExecEx( oSql.Sql( ), sStmt, FALSE ) 
.head 5 +  If NOT bOk
.head 6 -  Call Sql_Exec( oSql.Sql(  ), 'ROLLBACK' )
.head 6 -  Set r_sStatement = STRING_Null
.head 5 +  Else 
.head 6 -  Set bOk = bOk AND  Sql_Commit( oSql.Sql(  ) )
.head 6 -  Set r_sStatement = 'ar_sbls1 = \'ZB'|| NumberToStrX( p_nLA_NR ) ||'\''
.head 5 -  Return bOk
.head 3 +  ! Function: UpdateLieferTax
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bOk
.head 5 -  String: sSelect
.head 4 +  Actions 
.head 5 -  Set sSelect = 'select * from ARTIKELLIEFERART
JOIN LIEFERARTIKELTAXIERUNG ON LT_LA_NR = AL_LA_NR AND LT_ART = 2
WHERE AL_STD = 1 AND AL_AR_NR = '  || NumberToStrX( p_nAR_NR )
.head 5 +  If Sql_FetchOne( hSql, sSelect )
.head 6 -  Set bOk = TRUE
.head 6 -  Set sSelect = 'delete FROM ARTIKELTAXIERUNG
where AT_ART = 2 AND AT_AR_NR = ' || NumberToStrX( p_nAR_NR )
.head 6 -  Set bOk = bOk AND Sql_Exec( hSql, sSelect )
.head 6 -  ! !
.head 6 -  ! wegen distinct
.head 6 -  Set dtGlobalTemp = DateOnly( SalDateCurrent(  ) )
.head 6 -  Set sSelect = 'insert into ARTIKELTAXIERUNG(AT_AR_NR,AT_ART,AT_TU_NR,AT_SB_NR,AT_UPDATE)
select DISTINCT AL_AR_NR,LT_ART,LT_TU_NR, :nUserNr, :dtGlobalTemp from ARTIKELLIEFERART
JOIN LIEFERARTIKELTAXIERUNG ON LT_LA_NR = AL_LA_NR AND LT_ART = 2
WHERE AL_STD = 1 AND AL_AR_NR = '  || NumberToStrX( p_nAR_NR )
.head 6 -  Set bOk = bOk AND Sql_Exec( hSqlSub, sSelect )
.head 6 -  ! !
.head 6 -  Set bOk = bOk AND Sql_Commit( hSqlSub )
.head 5 +  Else 
.head 6 -  Call MessageBox( 'Es sind keine Taxierungen vorhanden. Prüfen sie, ob
- ein als Standard markierter Lieferartikel mit dem Artikel verknüpft ist und
- der Lieferartikel Taxierungen hat', 'Taxierungen', MB_Ok )
.head 5 -  Return bOk
.head 3 +  Function: ÄnderungenÜbernehmen ! th 20160929 eigene Parameter statt Window vars
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: p_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sLA_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 5 -  String: p_sStmts[*]
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: n
.head 5 -  FunctionalVar: oSql
.winattr class
.head 6 -  Class: cObjSqlHandle
.end
.head 4 +  Actions 
.head 5 +  If sLA_SBLS1 != '' AND p_nAR_NR != NUMBER_Null
.head 6 -  Call MergeBlsErstellen( p_nAR_NR, p_sLA_SBLS1, p_sAR_SBLS ) 
.head 5 +  While p_sStmts[n] != ''
.head 6 -  Call Sql_ExecAndCommit( oSql.Sql (), p_sStmts[n] )
.head 6 -  Set n = n + 1
.head 5 -  ! Flag zurücksetzen
.head 5 -  Call Sql_ExecAndCommit( oSql.Sql (), 'UPDATE artikel SET ar_zuordnungneu = 0 WHERE ar_nr = '|| NumberToStrX( p_nAR_NR ) )
.head 5 -  Set tblArtikelDatenübertrag.sTableName = 'artlog'
.head 5 -  Call tblArtikelDatenübertrag.InsertRow ()
.head 5 -  Call SalEndDialog(hWndForm,TRUE)
.head 5 +  If NOT bAutomatik
.head 6 -  ! Tabelle neu laden
.head 6 -  Call SalSendMsg( tblArtikel, AM_POPULATE, 0, 0)
.head 3 +  ! Function: ÄnderungenÜbernehmen ! th 20160909 ar_zuordnung wieder auf 0, PARAM.Execute ARTIKEL.Refresh
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: n
.head 4 +  Actions 
.head 5 +  If sLA_SBLS1 != ''
.head 6 -  Call GetLieferartikelBLS( nLA_NR, sAR_SBLS, sLA_SBLS1)
.head 5 +  While saStmt[n] != ''
.head 6 -  Call Sql_ExecAndCommit( oSql2.Sql (), saStmt[n] )
.head 6 -  Set n = n + 1
.head 5 -  ! Flag zurücksetzen
.head 5 -  Call Sql_ExecAndCommit( hSql, 'UPDATE artikel SET ar_zuordnungneu = 0 WHERE ar_nr = :dlgArtikelDatenübertrag.wp_nAR_NR')
.head 5 -  Set tblArtikelDatenübertrag.sTableName = 'artlog'
.head 5 -  Call tblArtikelDatenübertrag.InsertRow ()
.head 5 -  Call SalEndDialog(hWndForm,TRUE)
.head 5 -  ! Tabelle neu laden
.head 5 -  ! Call dlgArtikelDatenübertrag.ParamSetInt( PARAM.Execute, ARTIKEL.Refresh)
.head 5 -  Call SalSendMsg( tblArtikel, AM_POPULATE, 0, 0)
.head 3 +  ! Function: ÄnderungenÜbernehmen
.head 4 -  Description: 
.head 4 -  Returns 
.head 4 -  Parameters 
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: n
.head 4 +  Actions 
.head 5 +  If sLA_SBLS1 != ''
.head 6 -  Call GetLieferartikelBLS( nLA_NR, sAR_SBLS, sLA_SBLS1)
.head 5 +  While saStmt[n] != ''
.head 6 -  Call Sql_ExecAndCommit( oSql2.Sql (), saStmt[n] )
.head 6 -  Set n = n + 1
.head 5 -  ! Flag zurücksetzen
.head 5 -  Set tblArtikelDatenübertrag.sTableName = 'artlog'
.head 5 -  Call tblArtikelDatenübertrag.InsertRow ()
.head 5 -  Call SalEndDialog(hWndForm,TRUE)
.head 5 -  Call dlgArtikelDatenübertrag.ParamSetInt( ARTIKEL.Refresh, wp_nAR_NR)
.head 2 +  Window Parameters 
.head 3 -  Number: wp_nAR_NR
.head 3 -  String: wp_sAR_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables 
.head 3 +  Boolean: bAutomatik
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  ! Dialog wurde durch Aktivität geöfnet
.head 3 -  String: saInsert[149]
.head 3 -  String: saSBLS[149]
.head 3 -  ! cObjSqlHandle: oSql1
.head 3 -  ! cObjSqlHandle: oSql2
.head 3 -  ! cObjSqlHandle: oSql3
.head 3 -  ! String: sKuKstHiererchieString
.head 3 -  ! Long String: lsAR_ZUTATEN
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! String: sAR_HERKUNFT
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! String: sAR_SBLS
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! String: sAR_SBLS1
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  ! String: sLA_SBLS1_temp
.head 3 -  String: sLA_SBLS1
.head 3 -  String: sAR_SBLS
.head 3 -  ! Boolean: bAL_BLS
.head 3 -  ! String: sStmtGlobal
.head 3 +  String: saStmt[*]
.head 4 -  ! Array aus allen Statements, die bei Ok durchgeführt werden
.head 3 -  ! Number: nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Date/Time: dtAL_DATUM
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Message Actions 
.head 3 +  On SAM_Create ! th 20160929 boolean Automatik setzen
.head 4 +  If wp_nAR_NR = NUMBER_Null
.head 5 -  Set bAutomatik = TRUE
.head 4 +  Else 
.head 5 -  Set bAutomatik = FALSE
.head 4 +  If wp_sAR_INTERN = STRING_Null
.head 5 +  If Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr ='||NumberToStrX(wp_nAR_NR) )
.head 6 -  Set dfAR_INTERN = sGlobalTemp
.head 4 +  Else 
.head 5 -  Set dfAR_INTERN = wp_sAR_INTERN
.head 4 -  Set dfAR_NR = wp_nAR_NR
.head 4 -  Call SalCenterWindow(hWndItem)
.head 3 +  ! On SAM_Create
.head 4 +  If Sql_FetchOne( hSql, 'SELECT ar_intern INTO :sGlobalTemp FROM artikel WHERE ar_nr ='||NumberToStrX(wp_nAR_NR) )
.head 5 -  Set dfAR_INTERN = sGlobalTemp
.head 5 -  Set dfAR_NR = wp_nAR_NR
.head 4 -  Call SalCenterWindow(hWndItem)
.head 3 +  On SAM_CreateComplete ! th 20160929 neue Fkt; Unterscheidung für Automatik
.head 4 +  If bAutomatik
.head 5 -  Call AlleArUebertragen ()
.head 4 +  Else 
.head 5 -  Call EinzelnenArUebertragen( wp_nAR_NR, saStmt, sLA_SBLS1, sAR_SBLS )
.head 3 +  ! On SAM_CreateComplete ! th 20160719 Stmts als recieve String Array
.head 4 -  Call GetLieferartikelDaten( wp_nAR_NR, saStmt )
.head 3 +  ! On SAM_CreateComplete ! th 20160418: mit global String
.head 4 -  Set sStmtGlobal = GetLieferartikelDaten(wp_nAR_NR)
.head 3 +  ! On SAM_CreateComplete
.head 4 -  Call GetLieferartikelDaten(wp_nAR_NR)
.head 1 +  Dialog Box: dlgArtikelTypGruppeZuordnung
.head 2 -  Class: DialogOkEsc
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Daten vom Basisartikel übernehmen
.head 2 -  Accessories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Allow Dock to Parent? Class Default
.head 3 -  Docking Orientation: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left: 11.075"
.head 4 -  Top: 3.781"
.head 4 -  Width:  6.817"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 2.021"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Vertical Scroll? Class Default
.head 3 -  Horizontal Scroll? Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Docking Toolbar? Class Default
.head 4 -  Toolbar Docking Orientation: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Resizable? Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ! MultilineShowOnly: mlText
.winattr class Multiline Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: MultilineShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left: 0.483"
.head 6 -  Top: 0.115"
.head 6 -  Width:  7.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 -  Message Actions 
.head 3 -  Background Text: alte Bezeichnung
.head 4 -  Resource Id: 3166
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.983"
.head 5 -  Top: 0.719"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: neue Bezeichnung
.head 4 -  Resource Id: 3167
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 3.783"
.head 5 -  Top: 0.719"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Background Text: Typ
.head 4 -  Resource Id: 3164
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.133"
.head 5 -  Top: 0.969"
.head 5 -  Width:  0.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfLA_Typ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.933"
.head 6 -  Top: 0.948"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAR_AT_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Gruppe
.head 4 -  Resource Id: 3165
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.033"
.head 5 -  Top: 1.219"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Data Field: dfLA_Gruppe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.933"
.head 6 -  Top: 1.198"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAR_Typ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.733"
.head 6 -  Top: 0.948"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAR_Gruppe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldShowOnly
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 3.733"
.head 6 -  Top: 1.198"
.head 6 -  Width:  2.75"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAR_AG_NR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DataFieldWithComboBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: Default
.head 6 -  Top: Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ja
.head 4 -  Window Location and Size
.head 5 -  Left: 3.983"
.head 5 -  Top: 1.531"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, UpdateLieferArtikel(  ) )
.head 3 +  Pushbutton: pbEsc
.head 4 -  Class Child Ref Key: 2
.head 4 -  Class ChildKey: 0
.head 4 -  Class: DialogOkEsc
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Nein
.head 4 -  Window Location and Size
.head 5 -  Left: 5.283"
.head 5 -  Top: 1.531"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Button Appearance: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Artikel-Typ und Artikel-Gruppe des Basisartikel auf den Lieferartikel übertragen?
.head 4 -  Resource Id: 3168
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: BackGroundText
.head 4 -  Window Location and Size
.head 5 -  Left: 0.983"
.head 5 -  Top: 0.135"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.396"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Justify: Left
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 2 +  Functions
.head 3 +  Function: Load
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Sql_FetchOne( hSql, 'SELECT ar_intern, la_intern, at.at_text, lt.at_text, ag.ag_text, lg.ag_text, at.at_nr, ag.ag_nr
INTO :dlgArtikelTypGruppeZuordnung.sAR_INTERN, :dlgArtikelTypGruppeZuordnung.sLA_INTERN,
:dlgArtikelTypGruppeZuordnung.dfAR_Typ, :dlgArtikelTypGruppeZuordnung.dfLA_Typ, :dlgArtikelTypGruppeZuordnung.dfAR_Gruppe, :dlgArtikelTypGruppeZuordnung.dfLA_Gruppe,
:dlgArtikelTypGruppeZuordnung.dfAR_AT_NR, :dlgArtikelTypGruppeZuordnung.dfAR_AG_NR
FROM artikel LEFT JOIN artikeltyp at ON at.at_nr = ar_at_nr LEFT JOIN artikelgruppe ag ON ag.ag_nr = ar_ag_nr,
lieferartikel LEFT JOIN artikeltyp lt ON lt.at_nr = la_at_nr LEFT JOIN artikelgruppe lg ON lg.ag_nr = la_ag_nr
WHERE ar_nr = ' || NumberToStrX( wp_nAR_NR  ) || ' and la_nr =  ' || NumberToStrX( wp_nLA_NR ) )
.head 5 -  ! Set mlText = Translate('ArtikelTyp und ArtikelGruppe von ') || sLA_INTERN || ' für ' || sAR_INTERN || ' übernehmen?'
.head 5 -  ! Set mlText = TranslateSubstString( 'ArtikelTyp und ArtikelGruppe von %1 übernehmen für', sLA_INTERN )  || ' ' || sAR_INTERN 
.head 3 +  Function: UpdateLieferArtikel
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If dfAR_AT_NR AND dfAR_AG_NR AND wp_nLA_NR
.head 6 -  Return Sql_ExecAndCommit( hSql, 'UPDATE lieferartikel SET la_at_nr = :dlgArtikelTypGruppeZuordnung.dfAR_AT_NR, la_ag_nr = :dlgArtikelTypGruppeZuordnung.dfAR_AG_NR
WHERE la_nr = ' || NumberToStrX( wp_nLA_NR  ) )
.head 2 +  Window Parameters
.head 3 -  Number: wp_nAR_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  Number: wp_nLA_NR
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Window Variables
.head 3 -  String: sAR_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 3 -  String: sLA_INTERN
.data INHERITPROPS
0000: 0100
.enddata
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Call Load(  )
